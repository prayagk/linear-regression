function ZTe(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function ox(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Lm(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var SL={exports:{}},Vv={},kL={exports:{}},jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jQ;function JTe(){if(jQ)return jt;jQ=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),f=Symbol.iterator;function d(V){return V===null||typeof V!="object"?null:(V=f&&V[f]||V["@@iterator"],typeof V=="function"?V:null)}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,m={};function x(V,X,re){this.props=V,this.context=X,this.refs=m,this.updater=re||h}x.prototype.isReactComponent={},x.prototype.setState=function(V,X){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,X,"setState")},x.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function b(){}b.prototype=x.prototype;function v(V,X,re){this.props=V,this.context=X,this.refs=m,this.updater=re||h}var $=v.prototype=new b;$.constructor=v,p($,x.prototype),$.isPureReactComponent=!0;var C=Array.isArray,S=Object.prototype.hasOwnProperty,A={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function _(V,X,re){var le,ue={},be=null,_e=null;if(X!=null)for(le in X.ref!==void 0&&(_e=X.ref),X.key!==void 0&&(be=""+X.key),X)S.call(X,le)&&!E.hasOwnProperty(le)&&(ue[le]=X[le]);var Ne=arguments.length-2;if(Ne===1)ue.children=re;else if(1<Ne){for(var Y=Array(Ne),ae=0;ae<Ne;ae++)Y[ae]=arguments[ae+2];ue.children=Y}if(V&&V.defaultProps)for(le in Ne=V.defaultProps,Ne)ue[le]===void 0&&(ue[le]=Ne[le]);return{$$typeof:e,type:V,key:be,ref:_e,props:ue,_owner:A.current}}function D(V,X){return{$$typeof:e,type:V.type,key:X,ref:V.ref,props:V.props,_owner:V._owner}}function N(V){return typeof V=="object"&&V!==null&&V.$$typeof===e}function T(V){var X={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(re){return X[re]})}var L=/\/+/g;function O(V,X){return typeof V=="object"&&V!==null&&V.key!=null?T(""+V.key):X.toString(36)}function M(V,X,re,le,ue){var be=typeof V;(be==="undefined"||be==="boolean")&&(V=null);var _e=!1;if(V===null)_e=!0;else switch(be){case"string":case"number":_e=!0;break;case"object":switch(V.$$typeof){case e:case t:_e=!0}}if(_e)return _e=V,ue=ue(_e),V=le===""?"."+O(_e,0):le,C(ue)?(re="",V!=null&&(re=V.replace(L,"$&/")+"/"),M(ue,X,re,"",function(ae){return ae})):ue!=null&&(N(ue)&&(ue=D(ue,re+(!ue.key||_e&&_e.key===ue.key?"":(""+ue.key).replace(L,"$&/")+"/")+V)),X.push(ue)),1;if(_e=0,le=le===""?".":le+":",C(V))for(var Ne=0;Ne<V.length;Ne++){be=V[Ne];var Y=le+O(be,Ne);_e+=M(be,X,re,Y,ue)}else if(Y=d(V),typeof Y=="function")for(V=Y.call(V),Ne=0;!(be=V.next()).done;)be=be.value,Y=le+O(be,Ne++),_e+=M(be,X,re,Y,ue);else if(be==="object")throw X=String(V),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.");return _e}function R(V,X,re){if(V==null)return V;var le=[],ue=0;return M(V,le,"","",function(be){return X.call(re,be,ue++)}),le}function P(V){if(V._status===-1){var X=V._result;X=X(),X.then(function(re){(V._status===0||V._status===-1)&&(V._status=1,V._result=re)},function(re){(V._status===0||V._status===-1)&&(V._status=2,V._result=re)}),V._status===-1&&(V._status=0,V._result=X)}if(V._status===1)return V._result.default;throw V._result}var j={current:null},z={transition:null},q={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:z,ReactCurrentOwner:A};function H(){throw Error("act(...) is not supported in production builds of React.")}return jt.Children={map:R,forEach:function(V,X,re){R(V,function(){X.apply(this,arguments)},re)},count:function(V){var X=0;return R(V,function(){X++}),X},toArray:function(V){return R(V,function(X){return X})||[]},only:function(V){if(!N(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},jt.Component=x,jt.Fragment=n,jt.Profiler=i,jt.PureComponent=v,jt.StrictMode=r,jt.Suspense=u,jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=q,jt.act=H,jt.cloneElement=function(V,X,re){if(V==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+V+".");var le=p({},V.props),ue=V.key,be=V.ref,_e=V._owner;if(X!=null){if(X.ref!==void 0&&(be=X.ref,_e=A.current),X.key!==void 0&&(ue=""+X.key),V.type&&V.type.defaultProps)var Ne=V.type.defaultProps;for(Y in X)S.call(X,Y)&&!E.hasOwnProperty(Y)&&(le[Y]=X[Y]===void 0&&Ne!==void 0?Ne[Y]:X[Y])}var Y=arguments.length-2;if(Y===1)le.children=re;else if(1<Y){Ne=Array(Y);for(var ae=0;ae<Y;ae++)Ne[ae]=arguments[ae+2];le.children=Ne}return{$$typeof:e,type:V.type,key:ue,ref:be,props:le,_owner:_e}},jt.createContext=function(V){return V={$$typeof:o,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},V.Provider={$$typeof:s,_context:V},V.Consumer=V},jt.createElement=_,jt.createFactory=function(V){var X=_.bind(null,V);return X.type=V,X},jt.createRef=function(){return{current:null}},jt.forwardRef=function(V){return{$$typeof:a,render:V}},jt.isValidElement=N,jt.lazy=function(V){return{$$typeof:c,_payload:{_status:-1,_result:V},_init:P}},jt.memo=function(V,X){return{$$typeof:l,type:V,compare:X===void 0?null:X}},jt.startTransition=function(V){var X=z.transition;z.transition={};try{V()}finally{z.transition=X}},jt.unstable_act=H,jt.useCallback=function(V,X){return j.current.useCallback(V,X)},jt.useContext=function(V){return j.current.useContext(V)},jt.useDebugValue=function(){},jt.useDeferredValue=function(V){return j.current.useDeferredValue(V)},jt.useEffect=function(V,X){return j.current.useEffect(V,X)},jt.useId=function(){return j.current.useId()},jt.useImperativeHandle=function(V,X,re){return j.current.useImperativeHandle(V,X,re)},jt.useInsertionEffect=function(V,X){return j.current.useInsertionEffect(V,X)},jt.useLayoutEffect=function(V,X){return j.current.useLayoutEffect(V,X)},jt.useMemo=function(V,X){return j.current.useMemo(V,X)},jt.useReducer=function(V,X,re){return j.current.useReducer(V,X,re)},jt.useRef=function(V){return j.current.useRef(V)},jt.useState=function(V){return j.current.useState(V)},jt.useSyncExternalStore=function(V,X,re){return j.current.useSyncExternalStore(V,X,re)},jt.useTransition=function(){return j.current.useTransition()},jt.version="18.3.1",jt}var WQ;function W7(){return WQ||(WQ=1,kL.exports=JTe()),kL.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VQ;function eIe(){if(VQ)return Vv;VQ=1;var e=W7(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,u,l){var c,f={},d=null,h=null;l!==void 0&&(d=""+l),u.key!==void 0&&(d=""+u.key),u.ref!==void 0&&(h=u.ref);for(c in u)r.call(u,c)&&!s.hasOwnProperty(c)&&(f[c]=u[c]);if(a&&a.defaultProps)for(c in u=a.defaultProps,u)f[c]===void 0&&(f[c]=u[c]);return{$$typeof:t,type:a,key:d,ref:h,props:f,_owner:i.current}}return Vv.Fragment=n,Vv.jsx=o,Vv.jsxs=o,Vv}var qQ;function tIe(){return qQ||(qQ=1,SL.exports=eIe()),SL.exports}var lt=tIe(),Ou=W7();const GQ=ox(Ou);var cA={},EL={exports:{}},lo={},AL={exports:{}},_L={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HQ;function nIe(){return HQ||(HQ=1,function(e){function t(z,q){var H=z.length;z.push(q);e:for(;0<H;){var V=H-1>>>1,X=z[V];if(0<i(X,q))z[V]=q,z[H]=X,H=V;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var q=z[0],H=z.pop();if(H!==q){z[0]=H;e:for(var V=0,X=z.length,re=X>>>1;V<re;){var le=2*(V+1)-1,ue=z[le],be=le+1,_e=z[be];if(0>i(ue,H))be<X&&0>i(_e,ue)?(z[V]=_e,z[be]=H,V=be):(z[V]=ue,z[le]=H,V=le);else if(be<X&&0>i(_e,H))z[V]=_e,z[be]=H,V=be;else break e}}return q}function i(z,q){var H=z.sortIndex-q.sortIndex;return H!==0?H:z.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var u=[],l=[],c=1,f=null,d=3,h=!1,p=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function $(z){for(var q=n(l);q!==null;){if(q.callback===null)r(l);else if(q.startTime<=z)r(l),q.sortIndex=q.expirationTime,t(u,q);else break;q=n(l)}}function C(z){if(m=!1,$(z),!p)if(n(u)!==null)p=!0,P(S);else{var q=n(l);q!==null&&j(C,q.startTime-z)}}function S(z,q){p=!1,m&&(m=!1,b(_),_=-1),h=!0;var H=d;try{for($(q),f=n(u);f!==null&&(!(f.expirationTime>q)||z&&!T());){var V=f.callback;if(typeof V=="function"){f.callback=null,d=f.priorityLevel;var X=V(f.expirationTime<=q);q=e.unstable_now(),typeof X=="function"?f.callback=X:f===n(u)&&r(u),$(q)}else r(u);f=n(u)}if(f!==null)var re=!0;else{var le=n(l);le!==null&&j(C,le.startTime-q),re=!1}return re}finally{f=null,d=H,h=!1}}var A=!1,E=null,_=-1,D=5,N=-1;function T(){return!(e.unstable_now()-N<D)}function L(){if(E!==null){var z=e.unstable_now();N=z;var q=!0;try{q=E(!0,z)}finally{q?O():(A=!1,E=null)}}else A=!1}var O;if(typeof v=="function")O=function(){v(L)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,R=M.port2;M.port1.onmessage=L,O=function(){R.postMessage(null)}}else O=function(){x(L,0)};function P(z){E=z,A||(A=!0,O())}function j(z,q){_=x(function(){z(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,P(S))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(z){switch(d){case 1:case 2:case 3:var q=3;break;default:q=d}var H=d;d=q;try{return z()}finally{d=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,q){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var H=d;d=z;try{return q()}finally{d=H}},e.unstable_scheduleCallback=function(z,q,H){var V=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?V+H:V):H=V,z){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=H+X,z={id:c++,callback:q,priorityLevel:z,startTime:H,expirationTime:X,sortIndex:-1},H>V?(z.sortIndex=H,t(l,z),n(u)===null&&z===n(l)&&(m?(b(_),_=-1):m=!0,j(C,H-V))):(z.sortIndex=X,t(u,z),p||h||(p=!0,P(S))),z},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(z){var q=d;return function(){var H=d;d=q;try{return z.apply(this,arguments)}finally{d=H}}}}(_L)),_L}var XQ;function rIe(){return XQ||(XQ=1,AL.exports=nIe()),AL.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YQ;function iIe(){if(YQ)return lo;YQ=1;var e=W7(),t=rIe();function n(g){for(var y="https://reactjs.org/docs/error-decoder.html?invariant="+g,w=1;w<arguments.length;w++)y+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(g,y){o(g,y),o(g+"Capture",y)}function o(g,y){for(i[g]=y,g=0;g<y.length;g++)r.add(y[g])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,l=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c={},f={};function d(g){return u.call(f,g)?!0:u.call(c,g)?!1:l.test(g)?f[g]=!0:(c[g]=!0,!1)}function h(g,y,w,k){if(w!==null&&w.type===0)return!1;switch(typeof y){case"function":case"symbol":return!0;case"boolean":return k?!1:w!==null?!w.acceptsBooleans:(g=g.toLowerCase().slice(0,5),g!=="data-"&&g!=="aria-");default:return!1}}function p(g,y,w,k){if(y===null||typeof y>"u"||h(g,y,w,k))return!0;if(k)return!1;if(w!==null)switch(w.type){case 3:return!y;case 4:return y===!1;case 5:return isNaN(y);case 6:return isNaN(y)||1>y}return!1}function m(g,y,w,k,I,F,B){this.acceptsBooleans=y===2||y===3||y===4,this.attributeName=k,this.attributeNamespace=I,this.mustUseProperty=w,this.propertyName=g,this.type=y,this.sanitizeURL=F,this.removeEmptyString=B}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(g){x[g]=new m(g,0,!1,g,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(g){var y=g[0];x[y]=new m(y,1,!1,g[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(g){x[g]=new m(g,2,!1,g.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(g){x[g]=new m(g,2,!1,g,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(g){x[g]=new m(g,3,!1,g.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(g){x[g]=new m(g,3,!0,g,null,!1,!1)}),["capture","download"].forEach(function(g){x[g]=new m(g,4,!1,g,null,!1,!1)}),["cols","rows","size","span"].forEach(function(g){x[g]=new m(g,6,!1,g,null,!1,!1)}),["rowSpan","start"].forEach(function(g){x[g]=new m(g,5,!1,g.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function v(g){return g[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(g){var y=g.replace(b,v);x[y]=new m(y,1,!1,g,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(g){var y=g.replace(b,v);x[y]=new m(y,1,!1,g,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(g){var y=g.replace(b,v);x[y]=new m(y,1,!1,g,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(g){x[g]=new m(g,1,!1,g.toLowerCase(),null,!1,!1)}),x.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(g){x[g]=new m(g,1,!1,g.toLowerCase(),null,!0,!0)});function $(g,y,w,k){var I=x.hasOwnProperty(y)?x[y]:null;(I!==null?I.type!==0:k||!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(p(y,w,I,k)&&(w=null),k||I===null?d(y)&&(w===null?g.removeAttribute(y):g.setAttribute(y,""+w)):I.mustUseProperty?g[I.propertyName]=w===null?I.type===3?!1:"":w:(y=I.attributeName,k=I.attributeNamespace,w===null?g.removeAttribute(y):(I=I.type,w=I===3||I===4&&w===!0?"":""+w,k?g.setAttributeNS(k,y,w):g.setAttribute(y,w))))}var C=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),A=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),T=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),j=Symbol.for("react.offscreen"),z=Symbol.iterator;function q(g){return g===null||typeof g!="object"?null:(g=z&&g[z]||g["@@iterator"],typeof g=="function"?g:null)}var H=Object.assign,V;function X(g){if(V===void 0)try{throw Error()}catch(w){var y=w.stack.trim().match(/\n( *(at )?)/);V=y&&y[1]||""}return`
`+V+g}var re=!1;function le(g,y){if(!g||re)return"";re=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(y)if(y=function(){throw Error()},Object.defineProperty(y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(y,[])}catch(ge){var k=ge}Reflect.construct(g,[],y)}else{try{y.call()}catch(ge){k=ge}g.call(y.prototype)}else{try{throw Error()}catch(ge){k=ge}g()}}catch(ge){if(ge&&k&&typeof ge.stack=="string"){for(var I=ge.stack.split(`
`),F=k.stack.split(`
`),B=I.length-1,Q=F.length-1;1<=B&&0<=Q&&I[B]!==F[Q];)Q--;for(;1<=B&&0<=Q;B--,Q--)if(I[B]!==F[Q]){if(B!==1||Q!==1)do if(B--,Q--,0>Q||I[B]!==F[Q]){var te=`
`+I[B].replace(" at new "," at ");return g.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",g.displayName)),te}while(1<=B&&0<=Q);break}}}finally{re=!1,Error.prepareStackTrace=w}return(g=g?g.displayName||g.name:"")?X(g):""}function ue(g){switch(g.tag){case 5:return X(g.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 2:case 15:return g=le(g.type,!1),g;case 11:return g=le(g.type.render,!1),g;case 1:return g=le(g.type,!0),g;default:return""}}function be(g){if(g==null)return null;if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g;switch(g){case E:return"Fragment";case A:return"Portal";case D:return"Profiler";case _:return"StrictMode";case O:return"Suspense";case M:return"SuspenseList"}if(typeof g=="object")switch(g.$$typeof){case T:return(g.displayName||"Context")+".Consumer";case N:return(g._context.displayName||"Context")+".Provider";case L:var y=g.render;return g=g.displayName,g||(g=y.displayName||y.name||"",g=g!==""?"ForwardRef("+g+")":"ForwardRef"),g;case R:return y=g.displayName||null,y!==null?y:be(g.type)||"Memo";case P:y=g._payload,g=g._init;try{return be(g(y))}catch{}}return null}function _e(g){var y=g.type;switch(g.tag){case 24:return"Cache";case 9:return(y.displayName||"Context")+".Consumer";case 10:return(y._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=y.render,g=g.displayName||g.name||"",y.displayName||(g!==""?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return y;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return be(y);case 8:return y===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y}return null}function Ne(g){switch(typeof g){case"boolean":case"number":case"string":case"undefined":return g;case"object":return g;default:return""}}function Y(g){var y=g.type;return(g=g.nodeName)&&g.toLowerCase()==="input"&&(y==="checkbox"||y==="radio")}function ae(g){var y=Y(g)?"checked":"value",w=Object.getOwnPropertyDescriptor(g.constructor.prototype,y),k=""+g[y];if(!g.hasOwnProperty(y)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var I=w.get,F=w.set;return Object.defineProperty(g,y,{configurable:!0,get:function(){return I.call(this)},set:function(B){k=""+B,F.call(this,B)}}),Object.defineProperty(g,y,{enumerable:w.enumerable}),{getValue:function(){return k},setValue:function(B){k=""+B},stopTracking:function(){g._valueTracker=null,delete g[y]}}}}function he(g){g._valueTracker||(g._valueTracker=ae(g))}function G(g){if(!g)return!1;var y=g._valueTracker;if(!y)return!0;var w=y.getValue(),k="";return g&&(k=Y(g)?g.checked?"true":"false":g.value),g=k,g!==w?(y.setValue(g),!0):!1}function je(g){if(g=g||(typeof document<"u"?document:void 0),typeof g>"u")return null;try{return g.activeElement||g.body}catch{return g.body}}function Ce(g,y){var w=y.checked;return H({},y,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:w??g._wrapperState.initialChecked})}function We(g,y){var w=y.defaultValue==null?"":y.defaultValue,k=y.checked!=null?y.checked:y.defaultChecked;w=Ne(y.value!=null?y.value:w),g._wrapperState={initialChecked:k,initialValue:w,controlled:y.type==="checkbox"||y.type==="radio"?y.checked!=null:y.value!=null}}function Ve(g,y){y=y.checked,y!=null&&$(g,"checked",y,!1)}function gt(g,y){Ve(g,y);var w=Ne(y.value),k=y.type;if(w!=null)k==="number"?(w===0&&g.value===""||g.value!=w)&&(g.value=""+w):g.value!==""+w&&(g.value=""+w);else if(k==="submit"||k==="reset"){g.removeAttribute("value");return}y.hasOwnProperty("value")?_s(g,y.type,w):y.hasOwnProperty("defaultValue")&&_s(g,y.type,Ne(y.defaultValue)),y.checked==null&&y.defaultChecked!=null&&(g.defaultChecked=!!y.defaultChecked)}function ct(g,y,w){if(y.hasOwnProperty("value")||y.hasOwnProperty("defaultValue")){var k=y.type;if(!(k!=="submit"&&k!=="reset"||y.value!==void 0&&y.value!==null))return;y=""+g._wrapperState.initialValue,w||y===g.value||(g.value=y),g.defaultValue=y}w=g.name,w!==""&&(g.name=""),g.defaultChecked=!!g._wrapperState.initialChecked,w!==""&&(g.name=w)}function _s(g,y,w){(y!=="number"||je(g.ownerDocument)!==g)&&(w==null?g.defaultValue=""+g._wrapperState.initialValue:g.defaultValue!==""+w&&(g.defaultValue=""+w))}var On=Array.isArray;function Fi(g,y,w,k){if(g=g.options,y){y={};for(var I=0;I<w.length;I++)y["$"+w[I]]=!0;for(w=0;w<g.length;w++)I=y.hasOwnProperty("$"+g[w].value),g[w].selected!==I&&(g[w].selected=I),I&&k&&(g[w].defaultSelected=!0)}else{for(w=""+Ne(w),y=null,I=0;I<g.length;I++){if(g[I].value===w){g[I].selected=!0,k&&(g[I].defaultSelected=!0);return}y!==null||g[I].disabled||(y=g[I])}y!==null&&(y.selected=!0)}}function zr(g,y){if(y.dangerouslySetInnerHTML!=null)throw Error(n(91));return H({},y,{value:void 0,defaultValue:void 0,children:""+g._wrapperState.initialValue})}function da(g,y){var w=y.value;if(w==null){if(w=y.children,y=y.defaultValue,w!=null){if(y!=null)throw Error(n(92));if(On(w)){if(1<w.length)throw Error(n(93));w=w[0]}y=w}y==null&&(y=""),w=y}g._wrapperState={initialValue:Ne(w)}}function si(g,y){var w=Ne(y.value),k=Ne(y.defaultValue);w!=null&&(w=""+w,w!==g.value&&(g.value=w),y.defaultValue==null&&g.defaultValue!==w&&(g.defaultValue=w)),k!=null&&(g.defaultValue=""+k)}function ro(g){var y=g.textContent;y===g._wrapperState.initialValue&&y!==""&&y!==null&&(g.value=y)}function Wo(g){switch(g){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ot(g,y){return g==null||g==="http://www.w3.org/1999/xhtml"?Wo(y):g==="http://www.w3.org/2000/svg"&&y==="foreignObject"?"http://www.w3.org/1999/xhtml":g}var Ts,sl=function(g){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(y,w,k,I){MSApp.execUnsafeLocalFunction(function(){return g(y,w,k,I)})}:g}(function(g,y){if(g.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in g)g.innerHTML=y;else{for(Ts=Ts||document.createElement("div"),Ts.innerHTML="<svg>"+y.valueOf().toString()+"</svg>",y=Ts.firstChild;g.firstChild;)g.removeChild(g.firstChild);for(;y.firstChild;)g.appendChild(y.firstChild)}});function eu(g,y){if(y){var w=g.firstChild;if(w&&w===g.lastChild&&w.nodeType===3){w.nodeValue=y;return}}g.textContent=y}var tu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ev=["Webkit","ms","Moz","O"];Object.keys(tu).forEach(function(g){ev.forEach(function(y){y=y+g.charAt(0).toUpperCase()+g.substring(1),tu[y]=tu[g]})});function Ic(g,y,w){return y==null||typeof y=="boolean"||y===""?"":w||typeof y!="number"||y===0||tu.hasOwnProperty(g)&&tu[g]?(""+y).trim():y+"px"}function F0(g,y){g=g.style;for(var w in y)if(y.hasOwnProperty(w)){var k=w.indexOf("--")===0,I=Ic(w,y[w],k);w==="float"&&(w="cssFloat"),k?g.setProperty(w,I):g[w]=I}}var tv=H({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nv(g,y){if(y){if(tv[g]&&(y.children!=null||y.dangerouslySetInnerHTML!=null))throw Error(n(137,g));if(y.dangerouslySetInnerHTML!=null){if(y.children!=null)throw Error(n(60));if(typeof y.dangerouslySetInnerHTML!="object"||!("__html"in y.dangerouslySetInnerHTML))throw Error(n(61))}if(y.style!=null&&typeof y.style!="object")throw Error(n(62))}}function rv(g,y){if(g.indexOf("-")===-1)return typeof y.is=="string";switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var iv=null;function sv(g){return g=g.target||g.srcElement||window,g.correspondingUseElement&&(g=g.correspondingUseElement),g.nodeType===3?g.parentNode:g}var ov=null,ed=null,td=null;function Qk(g){if(g=Tv(g)){if(typeof ov!="function")throw Error(n(280));var y=g.stateNode;y&&(y=kE(y),ov(g.stateNode,g.type,y))}}function Zk(g){ed?td?td.push(g):td=[g]:ed=g}function Jk(){if(ed){var g=ed,y=td;if(td=ed=null,Qk(g),y)for(g=0;g<y.length;g++)Qk(y[g])}}function eE(g,y){return g(y)}function tE(){}var av=!1;function nE(g,y,w){if(av)return g(y,w);av=!0;try{return eE(g,y,w)}finally{av=!1,(ed!==null||td!==null)&&(tE(),Jk())}}function _p(g,y){var w=g.stateNode;if(w===null)return null;var k=kE(w);if(k===null)return null;w=k[y];e:switch(y){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(g=g.type,k=!(g==="button"||g==="input"||g==="select"||g==="textarea")),g=!k;break e;default:g=!1}if(g)return null;if(w&&typeof w!="function")throw Error(n(231,y,typeof w));return w}var uv=!1;if(a)try{var Tp={};Object.defineProperty(Tp,"passive",{get:function(){uv=!0}}),window.addEventListener("test",Tp,Tp),window.removeEventListener("test",Tp,Tp)}catch{uv=!1}function LM(g,y,w,k,I,F,B,Q,te){var ge=Array.prototype.slice.call(arguments,3);try{y.apply(w,ge)}catch(Ie){this.onError(Ie)}}var Ip=!1,R0=null,O0=!1,lv=null,PM={onError:function(g){Ip=!0,R0=g}};function BM(g,y,w,k,I,F,B,Q,te){Ip=!1,R0=null,LM.apply(PM,arguments)}function zM(g,y,w,k,I,F,B,Q,te){if(BM.apply(this,arguments),Ip){if(Ip){var ge=R0;Ip=!1,R0=null}else throw Error(n(198));O0||(O0=!0,lv=ge)}}function Nc(g){var y=g,w=g;if(g.alternate)for(;y.return;)y=y.return;else{g=y;do y=g,y.flags&4098&&(w=y.return),g=y.return;while(g)}return y.tag===3?w:null}function rE(g){if(g.tag===13){var y=g.memoizedState;if(y===null&&(g=g.alternate,g!==null&&(y=g.memoizedState)),y!==null)return y.dehydrated}return null}function iE(g){if(Nc(g)!==g)throw Error(n(188))}function UM(g){var y=g.alternate;if(!y){if(y=Nc(g),y===null)throw Error(n(188));return y!==g?null:g}for(var w=g,k=y;;){var I=w.return;if(I===null)break;var F=I.alternate;if(F===null){if(k=I.return,k!==null){w=k;continue}break}if(I.child===F.child){for(F=I.child;F;){if(F===w)return iE(I),g;if(F===k)return iE(I),y;F=F.sibling}throw Error(n(188))}if(w.return!==k.return)w=I,k=F;else{for(var B=!1,Q=I.child;Q;){if(Q===w){B=!0,w=I,k=F;break}if(Q===k){B=!0,k=I,w=F;break}Q=Q.sibling}if(!B){for(Q=F.child;Q;){if(Q===w){B=!0,w=F,k=I;break}if(Q===k){B=!0,k=F,w=I;break}Q=Q.sibling}if(!B)throw Error(n(189))}}if(w.alternate!==k)throw Error(n(190))}if(w.tag!==3)throw Error(n(188));return w.stateNode.current===w?g:y}function sE(g){return g=UM(g),g!==null?oE(g):null}function oE(g){if(g.tag===5||g.tag===6)return g;for(g=g.child;g!==null;){var y=oE(g);if(y!==null)return y;g=g.sibling}return null}var aE=t.unstable_scheduleCallback,uE=t.unstable_cancelCallback,jM=t.unstable_shouldYield,WM=t.unstable_requestPaint,rr=t.unstable_now,VM=t.unstable_getCurrentPriorityLevel,cv=t.unstable_ImmediatePriority,lE=t.unstable_UserBlockingPriority,M0=t.unstable_NormalPriority,qM=t.unstable_LowPriority,K=t.unstable_IdlePriority,oe=null,Se=null;function Le(g){if(Se&&typeof Se.onCommitFiberRoot=="function")try{Se.onCommitFiberRoot(oe,g,void 0,(g.current.flags&128)===128)}catch{}}var et=Math.clz32?Math.clz32:Xn,Ht=Math.log,Ri=Math.LN2;function Xn(g){return g>>>=0,g===0?32:31-(Ht(g)/Ri|0)|0}var nd=64,nu=4194304;function vr(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return g&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function Np(g,y){var w=g.pendingLanes;if(w===0)return 0;var k=0,I=g.suspendedLanes,F=g.pingedLanes,B=w&268435455;if(B!==0){var Q=B&~I;Q!==0?k=vr(Q):(F&=B,F!==0&&(k=vr(F)))}else B=w&~I,B!==0?k=vr(B):F!==0&&(k=vr(F));if(k===0)return 0;if(y!==0&&y!==k&&!(y&I)&&(I=k&-k,F=y&-y,I>=F||I===16&&(F&4194240)!==0))return y;if(k&4&&(k|=w&16),y=g.entangledLanes,y!==0)for(g=g.entanglements,y&=k;0<y;)w=31-et(y),I=1<<w,k|=g[w],y&=~I;return k}function oi(g,y){switch(g){case 1:case 2:case 4:return y+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Is(g,y){for(var w=g.suspendedLanes,k=g.pingedLanes,I=g.expirationTimes,F=g.pendingLanes;0<F;){var B=31-et(F),Q=1<<B,te=I[B];te===-1?(!(Q&w)||Q&k)&&(I[B]=oi(Q,y)):te<=y&&(g.expiredLanes|=Q),F&=~Q}}function fv(g){return g=g.pendingLanes&-1073741825,g!==0?g:g&1073741824?1073741824:0}function bY(){var g=nd;return nd<<=1,!(nd&4194240)&&(nd=64),g}function GM(g){for(var y=[],w=0;31>w;w++)y.push(g);return y}function dv(g,y,w){g.pendingLanes|=y,y!==536870912&&(g.suspendedLanes=0,g.pingedLanes=0),g=g.eventTimes,y=31-et(y),g[y]=w}function v_e(g,y){var w=g.pendingLanes&~y;g.pendingLanes=y,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=y,g.mutableReadLanes&=y,g.entangledLanes&=y,y=g.entanglements;var k=g.eventTimes;for(g=g.expirationTimes;0<w;){var I=31-et(w),F=1<<I;y[I]=0,k[I]=-1,g[I]=-1,w&=~F}}function HM(g,y){var w=g.entangledLanes|=y;for(g=g.entanglements;w;){var k=31-et(w),I=1<<k;I&y|g[k]&y&&(g[k]|=y),w&=~I}}var vn=0;function vY(g){return g&=-g,1<g?4<g?g&268435455?16:536870912:4:1}var wY,XM,$Y,CY,SY,YM=!1,cE=[],rd=null,id=null,sd=null,hv=new Map,pv=new Map,od=[],w_e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kY(g,y){switch(g){case"focusin":case"focusout":rd=null;break;case"dragenter":case"dragleave":id=null;break;case"mouseover":case"mouseout":sd=null;break;case"pointerover":case"pointerout":hv.delete(y.pointerId);break;case"gotpointercapture":case"lostpointercapture":pv.delete(y.pointerId)}}function gv(g,y,w,k,I,F){return g===null||g.nativeEvent!==F?(g={blockedOn:y,domEventName:w,eventSystemFlags:k,nativeEvent:F,targetContainers:[I]},y!==null&&(y=Tv(y),y!==null&&XM(y)),g):(g.eventSystemFlags|=k,y=g.targetContainers,I!==null&&y.indexOf(I)===-1&&y.push(I),g)}function $_e(g,y,w,k,I){switch(y){case"focusin":return rd=gv(rd,g,y,w,k,I),!0;case"dragenter":return id=gv(id,g,y,w,k,I),!0;case"mouseover":return sd=gv(sd,g,y,w,k,I),!0;case"pointerover":var F=I.pointerId;return hv.set(F,gv(hv.get(F)||null,g,y,w,k,I)),!0;case"gotpointercapture":return F=I.pointerId,pv.set(F,gv(pv.get(F)||null,g,y,w,k,I)),!0}return!1}function EY(g){var y=Dp(g.target);if(y!==null){var w=Nc(y);if(w!==null){if(y=w.tag,y===13){if(y=rE(w),y!==null){g.blockedOn=y,SY(g.priority,function(){$Y(w)});return}}else if(y===3&&w.stateNode.current.memoizedState.isDehydrated){g.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}g.blockedOn=null}function fE(g){if(g.blockedOn!==null)return!1;for(var y=g.targetContainers;0<y.length;){var w=QM(g.domEventName,g.eventSystemFlags,y[0],g.nativeEvent);if(w===null){w=g.nativeEvent;var k=new w.constructor(w.type,w);iv=k,w.target.dispatchEvent(k),iv=null}else return y=Tv(w),y!==null&&XM(y),g.blockedOn=w,!1;y.shift()}return!0}function AY(g,y,w){fE(g)&&w.delete(y)}function C_e(){YM=!1,rd!==null&&fE(rd)&&(rd=null),id!==null&&fE(id)&&(id=null),sd!==null&&fE(sd)&&(sd=null),hv.forEach(AY),pv.forEach(AY)}function mv(g,y){g.blockedOn===y&&(g.blockedOn=null,YM||(YM=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,C_e)))}function yv(g){function y(I){return mv(I,g)}if(0<cE.length){mv(cE[0],g);for(var w=1;w<cE.length;w++){var k=cE[w];k.blockedOn===g&&(k.blockedOn=null)}}for(rd!==null&&mv(rd,g),id!==null&&mv(id,g),sd!==null&&mv(sd,g),hv.forEach(y),pv.forEach(y),w=0;w<od.length;w++)k=od[w],k.blockedOn===g&&(k.blockedOn=null);for(;0<od.length&&(w=od[0],w.blockedOn===null);)EY(w),w.blockedOn===null&&od.shift()}var L0=C.ReactCurrentBatchConfig,dE=!0;function S_e(g,y,w,k){var I=vn,F=L0.transition;L0.transition=null;try{vn=1,KM(g,y,w,k)}finally{vn=I,L0.transition=F}}function k_e(g,y,w,k){var I=vn,F=L0.transition;L0.transition=null;try{vn=4,KM(g,y,w,k)}finally{vn=I,L0.transition=F}}function KM(g,y,w,k){if(dE){var I=QM(g,y,w,k);if(I===null)p4(g,y,k,hE,w),kY(g,k);else if($_e(I,g,y,w,k))k.stopPropagation();else if(kY(g,k),y&4&&-1<w_e.indexOf(g)){for(;I!==null;){var F=Tv(I);if(F!==null&&wY(F),F=QM(g,y,w,k),F===null&&p4(g,y,k,hE,w),F===I)break;I=F}I!==null&&k.stopPropagation()}else p4(g,y,k,null,w)}}var hE=null;function QM(g,y,w,k){if(hE=null,g=sv(k),g=Dp(g),g!==null)if(y=Nc(g),y===null)g=null;else if(w=y.tag,w===13){if(g=rE(y),g!==null)return g;g=null}else if(w===3){if(y.stateNode.current.memoizedState.isDehydrated)return y.tag===3?y.stateNode.containerInfo:null;g=null}else y!==g&&(g=null);return hE=g,null}function _Y(g){switch(g){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VM()){case cv:return 1;case lE:return 4;case M0:case qM:return 16;case K:return 536870912;default:return 16}default:return 16}}var ad=null,ZM=null,pE=null;function TY(){if(pE)return pE;var g,y=ZM,w=y.length,k,I="value"in ad?ad.value:ad.textContent,F=I.length;for(g=0;g<w&&y[g]===I[g];g++);var B=w-g;for(k=1;k<=B&&y[w-k]===I[F-k];k++);return pE=I.slice(g,1<k?1-k:void 0)}function gE(g){var y=g.keyCode;return"charCode"in g?(g=g.charCode,g===0&&y===13&&(g=13)):g=y,g===10&&(g=13),32<=g||g===13?g:0}function mE(){return!0}function IY(){return!1}function Vo(g){function y(w,k,I,F,B){this._reactName=w,this._targetInst=I,this.type=k,this.nativeEvent=F,this.target=B,this.currentTarget=null;for(var Q in g)g.hasOwnProperty(Q)&&(w=g[Q],this[Q]=w?w(F):F[Q]);return this.isDefaultPrevented=(F.defaultPrevented!=null?F.defaultPrevented:F.returnValue===!1)?mE:IY,this.isPropagationStopped=IY,this}return H(y.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=mE)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=mE)},persist:function(){},isPersistent:mE}),y}var P0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},JM=Vo(P0),xv=H({},P0,{view:0,detail:0}),E_e=Vo(xv),e4,t4,bv,yE=H({},xv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:r4,button:0,buttons:0,relatedTarget:function(g){return g.relatedTarget===void 0?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){return"movementX"in g?g.movementX:(g!==bv&&(bv&&g.type==="mousemove"?(e4=g.screenX-bv.screenX,t4=g.screenY-bv.screenY):t4=e4=0,bv=g),e4)},movementY:function(g){return"movementY"in g?g.movementY:t4}}),NY=Vo(yE),A_e=H({},yE,{dataTransfer:0}),__e=Vo(A_e),T_e=H({},xv,{relatedTarget:0}),n4=Vo(T_e),I_e=H({},P0,{animationName:0,elapsedTime:0,pseudoElement:0}),N_e=Vo(I_e),D_e=H({},P0,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),F_e=Vo(D_e),R_e=H({},P0,{data:0}),DY=Vo(R_e),O_e={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},M_e={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},L_e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function P_e(g){var y=this.nativeEvent;return y.getModifierState?y.getModifierState(g):(g=L_e[g])?!!y[g]:!1}function r4(){return P_e}var B_e=H({},xv,{key:function(g){if(g.key){var y=O_e[g.key]||g.key;if(y!=="Unidentified")return y}return g.type==="keypress"?(g=gE(g),g===13?"Enter":String.fromCharCode(g)):g.type==="keydown"||g.type==="keyup"?M_e[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:r4,charCode:function(g){return g.type==="keypress"?gE(g):0},keyCode:function(g){return g.type==="keydown"||g.type==="keyup"?g.keyCode:0},which:function(g){return g.type==="keypress"?gE(g):g.type==="keydown"||g.type==="keyup"?g.keyCode:0}}),z_e=Vo(B_e),U_e=H({},yE,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),FY=Vo(U_e),j_e=H({},xv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:r4}),W_e=Vo(j_e),V_e=H({},P0,{propertyName:0,elapsedTime:0,pseudoElement:0}),q_e=Vo(V_e),G_e=H({},yE,{deltaX:function(g){return"deltaX"in g?g.deltaX:"wheelDeltaX"in g?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:"wheelDeltaY"in g?-g.wheelDeltaY:"wheelDelta"in g?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),H_e=Vo(G_e),X_e=[9,13,27,32],i4=a&&"CompositionEvent"in window,vv=null;a&&"documentMode"in document&&(vv=document.documentMode);var Y_e=a&&"TextEvent"in window&&!vv,RY=a&&(!i4||vv&&8<vv&&11>=vv),OY=" ",MY=!1;function LY(g,y){switch(g){case"keyup":return X_e.indexOf(y.keyCode)!==-1;case"keydown":return y.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function PY(g){return g=g.detail,typeof g=="object"&&"data"in g?g.data:null}var B0=!1;function K_e(g,y){switch(g){case"compositionend":return PY(y);case"keypress":return y.which!==32?null:(MY=!0,OY);case"textInput":return g=y.data,g===OY&&MY?null:g;default:return null}}function Q_e(g,y){if(B0)return g==="compositionend"||!i4&&LY(g,y)?(g=TY(),pE=ZM=ad=null,B0=!1,g):null;switch(g){case"paste":return null;case"keypress":if(!(y.ctrlKey||y.altKey||y.metaKey)||y.ctrlKey&&y.altKey){if(y.char&&1<y.char.length)return y.char;if(y.which)return String.fromCharCode(y.which)}return null;case"compositionend":return RY&&y.locale!=="ko"?null:y.data;default:return null}}var Z_e={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function BY(g){var y=g&&g.nodeName&&g.nodeName.toLowerCase();return y==="input"?!!Z_e[g.type]:y==="textarea"}function zY(g,y,w,k){Zk(k),y=$E(y,"onChange"),0<y.length&&(w=new JM("onChange","change",null,w,k),g.push({event:w,listeners:y}))}var wv=null,$v=null;function J_e(g){iK(g,0)}function xE(g){var y=V0(g);if(G(y))return g}function eTe(g,y){if(g==="change")return y}var UY=!1;if(a){var s4;if(a){var o4="oninput"in document;if(!o4){var jY=document.createElement("div");jY.setAttribute("oninput","return;"),o4=typeof jY.oninput=="function"}s4=o4}else s4=!1;UY=s4&&(!document.documentMode||9<document.documentMode)}function WY(){wv&&(wv.detachEvent("onpropertychange",VY),$v=wv=null)}function VY(g){if(g.propertyName==="value"&&xE($v)){var y=[];zY(y,$v,g,sv(g)),nE(J_e,y)}}function tTe(g,y,w){g==="focusin"?(WY(),wv=y,$v=w,wv.attachEvent("onpropertychange",VY)):g==="focusout"&&WY()}function nTe(g){if(g==="selectionchange"||g==="keyup"||g==="keydown")return xE($v)}function rTe(g,y){if(g==="click")return xE(y)}function iTe(g,y){if(g==="input"||g==="change")return xE(y)}function sTe(g,y){return g===y&&(g!==0||1/g===1/y)||g!==g&&y!==y}var ru=typeof Object.is=="function"?Object.is:sTe;function Cv(g,y){if(ru(g,y))return!0;if(typeof g!="object"||g===null||typeof y!="object"||y===null)return!1;var w=Object.keys(g),k=Object.keys(y);if(w.length!==k.length)return!1;for(k=0;k<w.length;k++){var I=w[k];if(!u.call(y,I)||!ru(g[I],y[I]))return!1}return!0}function qY(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function GY(g,y){var w=qY(g);g=0;for(var k;w;){if(w.nodeType===3){if(k=g+w.textContent.length,g<=y&&k>=y)return{node:w,offset:y-g};g=k}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=qY(w)}}function HY(g,y){return g&&y?g===y?!0:g&&g.nodeType===3?!1:y&&y.nodeType===3?HY(g,y.parentNode):"contains"in g?g.contains(y):g.compareDocumentPosition?!!(g.compareDocumentPosition(y)&16):!1:!1}function XY(){for(var g=window,y=je();y instanceof g.HTMLIFrameElement;){try{var w=typeof y.contentWindow.location.href=="string"}catch{w=!1}if(w)g=y.contentWindow;else break;y=je(g.document)}return y}function a4(g){var y=g&&g.nodeName&&g.nodeName.toLowerCase();return y&&(y==="input"&&(g.type==="text"||g.type==="search"||g.type==="tel"||g.type==="url"||g.type==="password")||y==="textarea"||g.contentEditable==="true")}function oTe(g){var y=XY(),w=g.focusedElem,k=g.selectionRange;if(y!==w&&w&&w.ownerDocument&&HY(w.ownerDocument.documentElement,w)){if(k!==null&&a4(w)){if(y=k.start,g=k.end,g===void 0&&(g=y),"selectionStart"in w)w.selectionStart=y,w.selectionEnd=Math.min(g,w.value.length);else if(g=(y=w.ownerDocument||document)&&y.defaultView||window,g.getSelection){g=g.getSelection();var I=w.textContent.length,F=Math.min(k.start,I);k=k.end===void 0?F:Math.min(k.end,I),!g.extend&&F>k&&(I=k,k=F,F=I),I=GY(w,F);var B=GY(w,k);I&&B&&(g.rangeCount!==1||g.anchorNode!==I.node||g.anchorOffset!==I.offset||g.focusNode!==B.node||g.focusOffset!==B.offset)&&(y=y.createRange(),y.setStart(I.node,I.offset),g.removeAllRanges(),F>k?(g.addRange(y),g.extend(B.node,B.offset)):(y.setEnd(B.node,B.offset),g.addRange(y)))}}for(y=[],g=w;g=g.parentNode;)g.nodeType===1&&y.push({element:g,left:g.scrollLeft,top:g.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<y.length;w++)g=y[w],g.element.scrollLeft=g.left,g.element.scrollTop=g.top}}var aTe=a&&"documentMode"in document&&11>=document.documentMode,z0=null,u4=null,Sv=null,l4=!1;function YY(g,y,w){var k=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;l4||z0==null||z0!==je(k)||(k=z0,"selectionStart"in k&&a4(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),Sv&&Cv(Sv,k)||(Sv=k,k=$E(u4,"onSelect"),0<k.length&&(y=new JM("onSelect","select",null,y,w),g.push({event:y,listeners:k}),y.target=z0)))}function bE(g,y){var w={};return w[g.toLowerCase()]=y.toLowerCase(),w["Webkit"+g]="webkit"+y,w["Moz"+g]="moz"+y,w}var U0={animationend:bE("Animation","AnimationEnd"),animationiteration:bE("Animation","AnimationIteration"),animationstart:bE("Animation","AnimationStart"),transitionend:bE("Transition","TransitionEnd")},c4={},KY={};a&&(KY=document.createElement("div").style,"AnimationEvent"in window||(delete U0.animationend.animation,delete U0.animationiteration.animation,delete U0.animationstart.animation),"TransitionEvent"in window||delete U0.transitionend.transition);function vE(g){if(c4[g])return c4[g];if(!U0[g])return g;var y=U0[g],w;for(w in y)if(y.hasOwnProperty(w)&&w in KY)return c4[g]=y[w];return g}var QY=vE("animationend"),ZY=vE("animationiteration"),JY=vE("animationstart"),eK=vE("transitionend"),tK=new Map,nK="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ud(g,y){tK.set(g,y),s(y,[g])}for(var f4=0;f4<nK.length;f4++){var d4=nK[f4],uTe=d4.toLowerCase(),lTe=d4[0].toUpperCase()+d4.slice(1);ud(uTe,"on"+lTe)}ud(QY,"onAnimationEnd"),ud(ZY,"onAnimationIteration"),ud(JY,"onAnimationStart"),ud("dblclick","onDoubleClick"),ud("focusin","onFocus"),ud("focusout","onBlur"),ud(eK,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cTe=new Set("cancel close invalid load scroll toggle".split(" ").concat(kv));function rK(g,y,w){var k=g.type||"unknown-event";g.currentTarget=w,zM(k,y,void 0,g),g.currentTarget=null}function iK(g,y){y=(y&4)!==0;for(var w=0;w<g.length;w++){var k=g[w],I=k.event;k=k.listeners;e:{var F=void 0;if(y)for(var B=k.length-1;0<=B;B--){var Q=k[B],te=Q.instance,ge=Q.currentTarget;if(Q=Q.listener,te!==F&&I.isPropagationStopped())break e;rK(I,Q,ge),F=te}else for(B=0;B<k.length;B++){if(Q=k[B],te=Q.instance,ge=Q.currentTarget,Q=Q.listener,te!==F&&I.isPropagationStopped())break e;rK(I,Q,ge),F=te}}}if(O0)throw g=lv,O0=!1,lv=null,g}function zn(g,y){var w=y[v4];w===void 0&&(w=y[v4]=new Set);var k=g+"__bubble";w.has(k)||(sK(y,g,2,!1),w.add(k))}function h4(g,y,w){var k=0;y&&(k|=4),sK(w,g,k,y)}var wE="_reactListening"+Math.random().toString(36).slice(2);function Ev(g){if(!g[wE]){g[wE]=!0,r.forEach(function(w){w!=="selectionchange"&&(cTe.has(w)||h4(w,!1,g),h4(w,!0,g))});var y=g.nodeType===9?g:g.ownerDocument;y===null||y[wE]||(y[wE]=!0,h4("selectionchange",!1,y))}}function sK(g,y,w,k){switch(_Y(y)){case 1:var I=S_e;break;case 4:I=k_e;break;default:I=KM}w=I.bind(null,y,w,g),I=void 0,!uv||y!=="touchstart"&&y!=="touchmove"&&y!=="wheel"||(I=!0),k?I!==void 0?g.addEventListener(y,w,{capture:!0,passive:I}):g.addEventListener(y,w,!0):I!==void 0?g.addEventListener(y,w,{passive:I}):g.addEventListener(y,w,!1)}function p4(g,y,w,k,I){var F=k;if(!(y&1)&&!(y&2)&&k!==null)e:for(;;){if(k===null)return;var B=k.tag;if(B===3||B===4){var Q=k.stateNode.containerInfo;if(Q===I||Q.nodeType===8&&Q.parentNode===I)break;if(B===4)for(B=k.return;B!==null;){var te=B.tag;if((te===3||te===4)&&(te=B.stateNode.containerInfo,te===I||te.nodeType===8&&te.parentNode===I))return;B=B.return}for(;Q!==null;){if(B=Dp(Q),B===null)return;if(te=B.tag,te===5||te===6){k=F=B;continue e}Q=Q.parentNode}}k=k.return}nE(function(){var ge=F,Ie=sv(w),De=[];e:{var Te=tK.get(g);if(Te!==void 0){var He=JM,Ze=g;switch(g){case"keypress":if(gE(w)===0)break e;case"keydown":case"keyup":He=z_e;break;case"focusin":Ze="focus",He=n4;break;case"focusout":Ze="blur",He=n4;break;case"beforeblur":case"afterblur":He=n4;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":He=NY;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":He=__e;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":He=W_e;break;case QY:case ZY:case JY:He=N_e;break;case eK:He=q_e;break;case"scroll":He=E_e;break;case"wheel":He=H_e;break;case"copy":case"cut":case"paste":He=F_e;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":He=FY}var tt=(y&4)!==0,wr=!tt&&g==="scroll",de=tt?Te!==null?Te+"Capture":null:Te;tt=[];for(var se=ge,pe;se!==null;){pe=se;var Re=pe.stateNode;if(pe.tag===5&&Re!==null&&(pe=Re,de!==null&&(Re=_p(se,de),Re!=null&&tt.push(Av(se,Re,pe)))),wr)break;se=se.return}0<tt.length&&(Te=new He(Te,Ze,null,w,Ie),De.push({event:Te,listeners:tt}))}}if(!(y&7)){e:{if(Te=g==="mouseover"||g==="pointerover",He=g==="mouseout"||g==="pointerout",Te&&w!==iv&&(Ze=w.relatedTarget||w.fromElement)&&(Dp(Ze)||Ze[Dc]))break e;if((He||Te)&&(Te=Ie.window===Ie?Ie:(Te=Ie.ownerDocument)?Te.defaultView||Te.parentWindow:window,He?(Ze=w.relatedTarget||w.toElement,He=ge,Ze=Ze?Dp(Ze):null,Ze!==null&&(wr=Nc(Ze),Ze!==wr||Ze.tag!==5&&Ze.tag!==6)&&(Ze=null)):(He=null,Ze=ge),He!==Ze)){if(tt=NY,Re="onMouseLeave",de="onMouseEnter",se="mouse",(g==="pointerout"||g==="pointerover")&&(tt=FY,Re="onPointerLeave",de="onPointerEnter",se="pointer"),wr=He==null?Te:V0(He),pe=Ze==null?Te:V0(Ze),Te=new tt(Re,se+"leave",He,w,Ie),Te.target=wr,Te.relatedTarget=pe,Re=null,Dp(Ie)===ge&&(tt=new tt(de,se+"enter",Ze,w,Ie),tt.target=pe,tt.relatedTarget=wr,Re=tt),wr=Re,He&&Ze)t:{for(tt=He,de=Ze,se=0,pe=tt;pe;pe=j0(pe))se++;for(pe=0,Re=de;Re;Re=j0(Re))pe++;for(;0<se-pe;)tt=j0(tt),se--;for(;0<pe-se;)de=j0(de),pe--;for(;se--;){if(tt===de||de!==null&&tt===de.alternate)break t;tt=j0(tt),de=j0(de)}tt=null}else tt=null;He!==null&&oK(De,Te,He,tt,!1),Ze!==null&&wr!==null&&oK(De,wr,Ze,tt,!0)}}e:{if(Te=ge?V0(ge):window,He=Te.nodeName&&Te.nodeName.toLowerCase(),He==="select"||He==="input"&&Te.type==="file")var at=eTe;else if(BY(Te))if(UY)at=iTe;else{at=nTe;var vt=tTe}else(He=Te.nodeName)&&He.toLowerCase()==="input"&&(Te.type==="checkbox"||Te.type==="radio")&&(at=rTe);if(at&&(at=at(g,ge))){zY(De,at,w,Ie);break e}vt&&vt(g,Te,ge),g==="focusout"&&(vt=Te._wrapperState)&&vt.controlled&&Te.type==="number"&&_s(Te,"number",Te.value)}switch(vt=ge?V0(ge):window,g){case"focusin":(BY(vt)||vt.contentEditable==="true")&&(z0=vt,u4=ge,Sv=null);break;case"focusout":Sv=u4=z0=null;break;case"mousedown":l4=!0;break;case"contextmenu":case"mouseup":case"dragend":l4=!1,YY(De,w,Ie);break;case"selectionchange":if(aTe)break;case"keydown":case"keyup":YY(De,w,Ie)}var wt;if(i4)e:{switch(g){case"compositionstart":var Et="onCompositionStart";break e;case"compositionend":Et="onCompositionEnd";break e;case"compositionupdate":Et="onCompositionUpdate";break e}Et=void 0}else B0?LY(g,w)&&(Et="onCompositionEnd"):g==="keydown"&&w.keyCode===229&&(Et="onCompositionStart");Et&&(RY&&w.locale!=="ko"&&(B0||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&B0&&(wt=TY()):(ad=Ie,ZM="value"in ad?ad.value:ad.textContent,B0=!0)),vt=$E(ge,Et),0<vt.length&&(Et=new DY(Et,g,null,w,Ie),De.push({event:Et,listeners:vt}),wt?Et.data=wt:(wt=PY(w),wt!==null&&(Et.data=wt)))),(wt=Y_e?K_e(g,w):Q_e(g,w))&&(ge=$E(ge,"onBeforeInput"),0<ge.length&&(Ie=new DY("onBeforeInput","beforeinput",null,w,Ie),De.push({event:Ie,listeners:ge}),Ie.data=wt))}iK(De,y)})}function Av(g,y,w){return{instance:g,listener:y,currentTarget:w}}function $E(g,y){for(var w=y+"Capture",k=[];g!==null;){var I=g,F=I.stateNode;I.tag===5&&F!==null&&(I=F,F=_p(g,w),F!=null&&k.unshift(Av(g,F,I)),F=_p(g,y),F!=null&&k.push(Av(g,F,I))),g=g.return}return k}function j0(g){if(g===null)return null;do g=g.return;while(g&&g.tag!==5);return g||null}function oK(g,y,w,k,I){for(var F=y._reactName,B=[];w!==null&&w!==k;){var Q=w,te=Q.alternate,ge=Q.stateNode;if(te!==null&&te===k)break;Q.tag===5&&ge!==null&&(Q=ge,I?(te=_p(w,F),te!=null&&B.unshift(Av(w,te,Q))):I||(te=_p(w,F),te!=null&&B.push(Av(w,te,Q)))),w=w.return}B.length!==0&&g.push({event:y,listeners:B})}var fTe=/\r\n?/g,dTe=/\u0000|\uFFFD/g;function aK(g){return(typeof g=="string"?g:""+g).replace(fTe,`
`).replace(dTe,"")}function CE(g,y,w){if(y=aK(y),aK(g)!==y&&w)throw Error(n(425))}function SE(){}var g4=null,m4=null;function y4(g,y){return g==="textarea"||g==="noscript"||typeof y.children=="string"||typeof y.children=="number"||typeof y.dangerouslySetInnerHTML=="object"&&y.dangerouslySetInnerHTML!==null&&y.dangerouslySetInnerHTML.__html!=null}var x4=typeof setTimeout=="function"?setTimeout:void 0,hTe=typeof clearTimeout=="function"?clearTimeout:void 0,uK=typeof Promise=="function"?Promise:void 0,pTe=typeof queueMicrotask=="function"?queueMicrotask:typeof uK<"u"?function(g){return uK.resolve(null).then(g).catch(gTe)}:x4;function gTe(g){setTimeout(function(){throw g})}function b4(g,y){var w=y,k=0;do{var I=w.nextSibling;if(g.removeChild(w),I&&I.nodeType===8)if(w=I.data,w==="/$"){if(k===0){g.removeChild(I),yv(y);return}k--}else w!=="$"&&w!=="$?"&&w!=="$!"||k++;w=I}while(w);yv(y)}function ld(g){for(;g!=null;g=g.nextSibling){var y=g.nodeType;if(y===1||y===3)break;if(y===8){if(y=g.data,y==="$"||y==="$!"||y==="$?")break;if(y==="/$")return null}}return g}function lK(g){g=g.previousSibling;for(var y=0;g;){if(g.nodeType===8){var w=g.data;if(w==="$"||w==="$!"||w==="$?"){if(y===0)return g;y--}else w==="/$"&&y++}g=g.previousSibling}return null}var W0=Math.random().toString(36).slice(2),ol="__reactFiber$"+W0,_v="__reactProps$"+W0,Dc="__reactContainer$"+W0,v4="__reactEvents$"+W0,mTe="__reactListeners$"+W0,yTe="__reactHandles$"+W0;function Dp(g){var y=g[ol];if(y)return y;for(var w=g.parentNode;w;){if(y=w[Dc]||w[ol]){if(w=y.alternate,y.child!==null||w!==null&&w.child!==null)for(g=lK(g);g!==null;){if(w=g[ol])return w;g=lK(g)}return y}g=w,w=g.parentNode}return null}function Tv(g){return g=g[ol]||g[Dc],!g||g.tag!==5&&g.tag!==6&&g.tag!==13&&g.tag!==3?null:g}function V0(g){if(g.tag===5||g.tag===6)return g.stateNode;throw Error(n(33))}function kE(g){return g[_v]||null}var w4=[],q0=-1;function cd(g){return{current:g}}function Un(g){0>q0||(g.current=w4[q0],w4[q0]=null,q0--)}function Mn(g,y){q0++,w4[q0]=g.current,g.current=y}var fd={},Yi=cd(fd),io=cd(!1),Fp=fd;function G0(g,y){var w=g.type.contextTypes;if(!w)return fd;var k=g.stateNode;if(k&&k.__reactInternalMemoizedUnmaskedChildContext===y)return k.__reactInternalMemoizedMaskedChildContext;var I={},F;for(F in w)I[F]=y[F];return k&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=y,g.__reactInternalMemoizedMaskedChildContext=I),I}function so(g){return g=g.childContextTypes,g!=null}function EE(){Un(io),Un(Yi)}function cK(g,y,w){if(Yi.current!==fd)throw Error(n(168));Mn(Yi,y),Mn(io,w)}function fK(g,y,w){var k=g.stateNode;if(y=y.childContextTypes,typeof k.getChildContext!="function")return w;k=k.getChildContext();for(var I in k)if(!(I in y))throw Error(n(108,_e(g)||"Unknown",I));return H({},w,k)}function AE(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||fd,Fp=Yi.current,Mn(Yi,g),Mn(io,io.current),!0}function dK(g,y,w){var k=g.stateNode;if(!k)throw Error(n(169));w?(g=fK(g,y,Fp),k.__reactInternalMemoizedMergedChildContext=g,Un(io),Un(Yi),Mn(Yi,g)):Un(io),Mn(io,w)}var Fc=null,_E=!1,$4=!1;function hK(g){Fc===null?Fc=[g]:Fc.push(g)}function xTe(g){_E=!0,hK(g)}function dd(){if(!$4&&Fc!==null){$4=!0;var g=0,y=vn;try{var w=Fc;for(vn=1;g<w.length;g++){var k=w[g];do k=k(!0);while(k!==null)}Fc=null,_E=!1}catch(I){throw Fc!==null&&(Fc=Fc.slice(g+1)),aE(cv,dd),I}finally{vn=y,$4=!1}}return null}var H0=[],X0=0,TE=null,IE=0,ha=[],pa=0,Rp=null,Rc=1,Oc="";function Op(g,y){H0[X0++]=IE,H0[X0++]=TE,TE=g,IE=y}function pK(g,y,w){ha[pa++]=Rc,ha[pa++]=Oc,ha[pa++]=Rp,Rp=g;var k=Rc;g=Oc;var I=32-et(k)-1;k&=~(1<<I),w+=1;var F=32-et(y)+I;if(30<F){var B=I-I%5;F=(k&(1<<B)-1).toString(32),k>>=B,I-=B,Rc=1<<32-et(y)+I|w<<I|k,Oc=F+g}else Rc=1<<F|w<<I|k,Oc=g}function C4(g){g.return!==null&&(Op(g,1),pK(g,1,0))}function S4(g){for(;g===TE;)TE=H0[--X0],H0[X0]=null,IE=H0[--X0],H0[X0]=null;for(;g===Rp;)Rp=ha[--pa],ha[pa]=null,Oc=ha[--pa],ha[pa]=null,Rc=ha[--pa],ha[pa]=null}var qo=null,Go=null,Yn=!1,iu=null;function gK(g,y){var w=xa(5,null,null,0);w.elementType="DELETED",w.stateNode=y,w.return=g,y=g.deletions,y===null?(g.deletions=[w],g.flags|=16):y.push(w)}function mK(g,y){switch(g.tag){case 5:var w=g.type;return y=y.nodeType!==1||w.toLowerCase()!==y.nodeName.toLowerCase()?null:y,y!==null?(g.stateNode=y,qo=g,Go=ld(y.firstChild),!0):!1;case 6:return y=g.pendingProps===""||y.nodeType!==3?null:y,y!==null?(g.stateNode=y,qo=g,Go=null,!0):!1;case 13:return y=y.nodeType!==8?null:y,y!==null?(w=Rp!==null?{id:Rc,overflow:Oc}:null,g.memoizedState={dehydrated:y,treeContext:w,retryLane:1073741824},w=xa(18,null,null,0),w.stateNode=y,w.return=g,g.child=w,qo=g,Go=null,!0):!1;default:return!1}}function k4(g){return(g.mode&1)!==0&&(g.flags&128)===0}function E4(g){if(Yn){var y=Go;if(y){var w=y;if(!mK(g,y)){if(k4(g))throw Error(n(418));y=ld(w.nextSibling);var k=qo;y&&mK(g,y)?gK(k,w):(g.flags=g.flags&-4097|2,Yn=!1,qo=g)}}else{if(k4(g))throw Error(n(418));g.flags=g.flags&-4097|2,Yn=!1,qo=g}}}function yK(g){for(g=g.return;g!==null&&g.tag!==5&&g.tag!==3&&g.tag!==13;)g=g.return;qo=g}function NE(g){if(g!==qo)return!1;if(!Yn)return yK(g),Yn=!0,!1;var y;if((y=g.tag!==3)&&!(y=g.tag!==5)&&(y=g.type,y=y!=="head"&&y!=="body"&&!y4(g.type,g.memoizedProps)),y&&(y=Go)){if(k4(g))throw xK(),Error(n(418));for(;y;)gK(g,y),y=ld(y.nextSibling)}if(yK(g),g.tag===13){if(g=g.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));e:{for(g=g.nextSibling,y=0;g;){if(g.nodeType===8){var w=g.data;if(w==="/$"){if(y===0){Go=ld(g.nextSibling);break e}y--}else w!=="$"&&w!=="$!"&&w!=="$?"||y++}g=g.nextSibling}Go=null}}else Go=qo?ld(g.stateNode.nextSibling):null;return!0}function xK(){for(var g=Go;g;)g=ld(g.nextSibling)}function Y0(){Go=qo=null,Yn=!1}function A4(g){iu===null?iu=[g]:iu.push(g)}var bTe=C.ReactCurrentBatchConfig;function Iv(g,y,w){if(g=w.ref,g!==null&&typeof g!="function"&&typeof g!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(n(309));var k=w.stateNode}if(!k)throw Error(n(147,g));var I=k,F=""+g;return y!==null&&y.ref!==null&&typeof y.ref=="function"&&y.ref._stringRef===F?y.ref:(y=function(B){var Q=I.refs;B===null?delete Q[F]:Q[F]=B},y._stringRef=F,y)}if(typeof g!="string")throw Error(n(284));if(!w._owner)throw Error(n(290,g))}return g}function DE(g,y){throw g=Object.prototype.toString.call(y),Error(n(31,g==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":g))}function bK(g){var y=g._init;return y(g._payload)}function vK(g){function y(de,se){if(g){var pe=de.deletions;pe===null?(de.deletions=[se],de.flags|=16):pe.push(se)}}function w(de,se){if(!g)return null;for(;se!==null;)y(de,se),se=se.sibling;return null}function k(de,se){for(de=new Map;se!==null;)se.key!==null?de.set(se.key,se):de.set(se.index,se),se=se.sibling;return de}function I(de,se){return de=vd(de,se),de.index=0,de.sibling=null,de}function F(de,se,pe){return de.index=pe,g?(pe=de.alternate,pe!==null?(pe=pe.index,pe<se?(de.flags|=2,se):pe):(de.flags|=2,se)):(de.flags|=1048576,se)}function B(de){return g&&de.alternate===null&&(de.flags|=2),de}function Q(de,se,pe,Re){return se===null||se.tag!==6?(se=xL(pe,de.mode,Re),se.return=de,se):(se=I(se,pe),se.return=de,se)}function te(de,se,pe,Re){var at=pe.type;return at===E?Ie(de,se,pe.props.children,Re,pe.key):se!==null&&(se.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===P&&bK(at)===se.type)?(Re=I(se,pe.props),Re.ref=Iv(de,se,pe),Re.return=de,Re):(Re=nA(pe.type,pe.key,pe.props,null,de.mode,Re),Re.ref=Iv(de,se,pe),Re.return=de,Re)}function ge(de,se,pe,Re){return se===null||se.tag!==4||se.stateNode.containerInfo!==pe.containerInfo||se.stateNode.implementation!==pe.implementation?(se=bL(pe,de.mode,Re),se.return=de,se):(se=I(se,pe.children||[]),se.return=de,se)}function Ie(de,se,pe,Re,at){return se===null||se.tag!==7?(se=Wp(pe,de.mode,Re,at),se.return=de,se):(se=I(se,pe),se.return=de,se)}function De(de,se,pe){if(typeof se=="string"&&se!==""||typeof se=="number")return se=xL(""+se,de.mode,pe),se.return=de,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case S:return pe=nA(se.type,se.key,se.props,null,de.mode,pe),pe.ref=Iv(de,null,se),pe.return=de,pe;case A:return se=bL(se,de.mode,pe),se.return=de,se;case P:var Re=se._init;return De(de,Re(se._payload),pe)}if(On(se)||q(se))return se=Wp(se,de.mode,pe,null),se.return=de,se;DE(de,se)}return null}function Te(de,se,pe,Re){var at=se!==null?se.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number")return at!==null?null:Q(de,se,""+pe,Re);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case S:return pe.key===at?te(de,se,pe,Re):null;case A:return pe.key===at?ge(de,se,pe,Re):null;case P:return at=pe._init,Te(de,se,at(pe._payload),Re)}if(On(pe)||q(pe))return at!==null?null:Ie(de,se,pe,Re,null);DE(de,pe)}return null}function He(de,se,pe,Re,at){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return de=de.get(pe)||null,Q(se,de,""+Re,at);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case S:return de=de.get(Re.key===null?pe:Re.key)||null,te(se,de,Re,at);case A:return de=de.get(Re.key===null?pe:Re.key)||null,ge(se,de,Re,at);case P:var vt=Re._init;return He(de,se,pe,vt(Re._payload),at)}if(On(Re)||q(Re))return de=de.get(pe)||null,Ie(se,de,Re,at,null);DE(se,Re)}return null}function Ze(de,se,pe,Re){for(var at=null,vt=null,wt=se,Et=se=0,li=null;wt!==null&&Et<pe.length;Et++){wt.index>Et?(li=wt,wt=null):li=wt.sibling;var sn=Te(de,wt,pe[Et],Re);if(sn===null){wt===null&&(wt=li);break}g&&wt&&sn.alternate===null&&y(de,wt),se=F(sn,se,Et),vt===null?at=sn:vt.sibling=sn,vt=sn,wt=li}if(Et===pe.length)return w(de,wt),Yn&&Op(de,Et),at;if(wt===null){for(;Et<pe.length;Et++)wt=De(de,pe[Et],Re),wt!==null&&(se=F(wt,se,Et),vt===null?at=wt:vt.sibling=wt,vt=wt);return Yn&&Op(de,Et),at}for(wt=k(de,wt);Et<pe.length;Et++)li=He(wt,de,Et,pe[Et],Re),li!==null&&(g&&li.alternate!==null&&wt.delete(li.key===null?Et:li.key),se=F(li,se,Et),vt===null?at=li:vt.sibling=li,vt=li);return g&&wt.forEach(function(wd){return y(de,wd)}),Yn&&Op(de,Et),at}function tt(de,se,pe,Re){var at=q(pe);if(typeof at!="function")throw Error(n(150));if(pe=at.call(pe),pe==null)throw Error(n(151));for(var vt=at=null,wt=se,Et=se=0,li=null,sn=pe.next();wt!==null&&!sn.done;Et++,sn=pe.next()){wt.index>Et?(li=wt,wt=null):li=wt.sibling;var wd=Te(de,wt,sn.value,Re);if(wd===null){wt===null&&(wt=li);break}g&&wt&&wd.alternate===null&&y(de,wt),se=F(wd,se,Et),vt===null?at=wd:vt.sibling=wd,vt=wd,wt=li}if(sn.done)return w(de,wt),Yn&&Op(de,Et),at;if(wt===null){for(;!sn.done;Et++,sn=pe.next())sn=De(de,sn.value,Re),sn!==null&&(se=F(sn,se,Et),vt===null?at=sn:vt.sibling=sn,vt=sn);return Yn&&Op(de,Et),at}for(wt=k(de,wt);!sn.done;Et++,sn=pe.next())sn=He(wt,de,Et,sn.value,Re),sn!==null&&(g&&sn.alternate!==null&&wt.delete(sn.key===null?Et:sn.key),se=F(sn,se,Et),vt===null?at=sn:vt.sibling=sn,vt=sn);return g&&wt.forEach(function(QTe){return y(de,QTe)}),Yn&&Op(de,Et),at}function wr(de,se,pe,Re){if(typeof pe=="object"&&pe!==null&&pe.type===E&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case S:e:{for(var at=pe.key,vt=se;vt!==null;){if(vt.key===at){if(at=pe.type,at===E){if(vt.tag===7){w(de,vt.sibling),se=I(vt,pe.props.children),se.return=de,de=se;break e}}else if(vt.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===P&&bK(at)===vt.type){w(de,vt.sibling),se=I(vt,pe.props),se.ref=Iv(de,vt,pe),se.return=de,de=se;break e}w(de,vt);break}else y(de,vt);vt=vt.sibling}pe.type===E?(se=Wp(pe.props.children,de.mode,Re,pe.key),se.return=de,de=se):(Re=nA(pe.type,pe.key,pe.props,null,de.mode,Re),Re.ref=Iv(de,se,pe),Re.return=de,de=Re)}return B(de);case A:e:{for(vt=pe.key;se!==null;){if(se.key===vt)if(se.tag===4&&se.stateNode.containerInfo===pe.containerInfo&&se.stateNode.implementation===pe.implementation){w(de,se.sibling),se=I(se,pe.children||[]),se.return=de,de=se;break e}else{w(de,se);break}else y(de,se);se=se.sibling}se=bL(pe,de.mode,Re),se.return=de,de=se}return B(de);case P:return vt=pe._init,wr(de,se,vt(pe._payload),Re)}if(On(pe))return Ze(de,se,pe,Re);if(q(pe))return tt(de,se,pe,Re);DE(de,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"?(pe=""+pe,se!==null&&se.tag===6?(w(de,se.sibling),se=I(se,pe),se.return=de,de=se):(w(de,se),se=xL(pe,de.mode,Re),se.return=de,de=se),B(de)):w(de,se)}return wr}var K0=vK(!0),wK=vK(!1),FE=cd(null),RE=null,Q0=null,_4=null;function T4(){_4=Q0=RE=null}function I4(g){var y=FE.current;Un(FE),g._currentValue=y}function N4(g,y,w){for(;g!==null;){var k=g.alternate;if((g.childLanes&y)!==y?(g.childLanes|=y,k!==null&&(k.childLanes|=y)):k!==null&&(k.childLanes&y)!==y&&(k.childLanes|=y),g===w)break;g=g.return}}function Z0(g,y){RE=g,_4=Q0=null,g=g.dependencies,g!==null&&g.firstContext!==null&&(g.lanes&y&&(oo=!0),g.firstContext=null)}function ga(g){var y=g._currentValue;if(_4!==g)if(g={context:g,memoizedValue:y,next:null},Q0===null){if(RE===null)throw Error(n(308));Q0=g,RE.dependencies={lanes:0,firstContext:g}}else Q0=Q0.next=g;return y}var Mp=null;function D4(g){Mp===null?Mp=[g]:Mp.push(g)}function $K(g,y,w,k){var I=y.interleaved;return I===null?(w.next=w,D4(y)):(w.next=I.next,I.next=w),y.interleaved=w,Mc(g,k)}function Mc(g,y){g.lanes|=y;var w=g.alternate;for(w!==null&&(w.lanes|=y),w=g,g=g.return;g!==null;)g.childLanes|=y,w=g.alternate,w!==null&&(w.childLanes|=y),w=g,g=g.return;return w.tag===3?w.stateNode:null}var hd=!1;function F4(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CK(g,y){g=g.updateQueue,y.updateQueue===g&&(y.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function Lc(g,y){return{eventTime:g,lane:y,tag:0,payload:null,callback:null,next:null}}function pd(g,y,w){var k=g.updateQueue;if(k===null)return null;if(k=k.shared,tn&2){var I=k.pending;return I===null?y.next=y:(y.next=I.next,I.next=y),k.pending=y,Mc(g,w)}return I=k.interleaved,I===null?(y.next=y,D4(k)):(y.next=I.next,I.next=y),k.interleaved=y,Mc(g,w)}function OE(g,y,w){if(y=y.updateQueue,y!==null&&(y=y.shared,(w&4194240)!==0)){var k=y.lanes;k&=g.pendingLanes,w|=k,y.lanes=w,HM(g,w)}}function SK(g,y){var w=g.updateQueue,k=g.alternate;if(k!==null&&(k=k.updateQueue,w===k)){var I=null,F=null;if(w=w.firstBaseUpdate,w!==null){do{var B={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};F===null?I=F=B:F=F.next=B,w=w.next}while(w!==null);F===null?I=F=y:F=F.next=y}else I=F=y;w={baseState:k.baseState,firstBaseUpdate:I,lastBaseUpdate:F,shared:k.shared,effects:k.effects},g.updateQueue=w;return}g=w.lastBaseUpdate,g===null?w.firstBaseUpdate=y:g.next=y,w.lastBaseUpdate=y}function ME(g,y,w,k){var I=g.updateQueue;hd=!1;var F=I.firstBaseUpdate,B=I.lastBaseUpdate,Q=I.shared.pending;if(Q!==null){I.shared.pending=null;var te=Q,ge=te.next;te.next=null,B===null?F=ge:B.next=ge,B=te;var Ie=g.alternate;Ie!==null&&(Ie=Ie.updateQueue,Q=Ie.lastBaseUpdate,Q!==B&&(Q===null?Ie.firstBaseUpdate=ge:Q.next=ge,Ie.lastBaseUpdate=te))}if(F!==null){var De=I.baseState;B=0,Ie=ge=te=null,Q=F;do{var Te=Q.lane,He=Q.eventTime;if((k&Te)===Te){Ie!==null&&(Ie=Ie.next={eventTime:He,lane:0,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null});e:{var Ze=g,tt=Q;switch(Te=y,He=w,tt.tag){case 1:if(Ze=tt.payload,typeof Ze=="function"){De=Ze.call(He,De,Te);break e}De=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=tt.payload,Te=typeof Ze=="function"?Ze.call(He,De,Te):Ze,Te==null)break e;De=H({},De,Te);break e;case 2:hd=!0}}Q.callback!==null&&Q.lane!==0&&(g.flags|=64,Te=I.effects,Te===null?I.effects=[Q]:Te.push(Q))}else He={eventTime:He,lane:Te,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},Ie===null?(ge=Ie=He,te=De):Ie=Ie.next=He,B|=Te;if(Q=Q.next,Q===null){if(Q=I.shared.pending,Q===null)break;Te=Q,Q=Te.next,Te.next=null,I.lastBaseUpdate=Te,I.shared.pending=null}}while(!0);if(Ie===null&&(te=De),I.baseState=te,I.firstBaseUpdate=ge,I.lastBaseUpdate=Ie,y=I.shared.interleaved,y!==null){I=y;do B|=I.lane,I=I.next;while(I!==y)}else F===null&&(I.shared.lanes=0);Bp|=B,g.lanes=B,g.memoizedState=De}}function kK(g,y,w){if(g=y.effects,y.effects=null,g!==null)for(y=0;y<g.length;y++){var k=g[y],I=k.callback;if(I!==null){if(k.callback=null,k=w,typeof I!="function")throw Error(n(191,I));I.call(k)}}}var Nv={},al=cd(Nv),Dv=cd(Nv),Fv=cd(Nv);function Lp(g){if(g===Nv)throw Error(n(174));return g}function R4(g,y){switch(Mn(Fv,y),Mn(Dv,g),Mn(al,Nv),g=y.nodeType,g){case 9:case 11:y=(y=y.documentElement)?y.namespaceURI:ot(null,"");break;default:g=g===8?y.parentNode:y,y=g.namespaceURI||null,g=g.tagName,y=ot(y,g)}Un(al),Mn(al,y)}function J0(){Un(al),Un(Dv),Un(Fv)}function EK(g){Lp(Fv.current);var y=Lp(al.current),w=ot(y,g.type);y!==w&&(Mn(Dv,g),Mn(al,w))}function O4(g){Dv.current===g&&(Un(al),Un(Dv))}var ir=cd(0);function LE(g){for(var y=g;y!==null;){if(y.tag===13){var w=y.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||w.data==="$!"))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if(y.flags&128)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===g)break;for(;y.sibling===null;){if(y.return===null||y.return===g)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}var M4=[];function L4(){for(var g=0;g<M4.length;g++)M4[g]._workInProgressVersionPrimary=null;M4.length=0}var PE=C.ReactCurrentDispatcher,P4=C.ReactCurrentBatchConfig,Pp=0,sr=null,Ur=null,ai=null,BE=!1,Rv=!1,Ov=0,vTe=0;function Ki(){throw Error(n(321))}function B4(g,y){if(y===null)return!1;for(var w=0;w<y.length&&w<g.length;w++)if(!ru(g[w],y[w]))return!1;return!0}function z4(g,y,w,k,I,F){if(Pp=F,sr=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,PE.current=g===null||g.memoizedState===null?STe:kTe,g=w(k,I),Rv){F=0;do{if(Rv=!1,Ov=0,25<=F)throw Error(n(301));F+=1,ai=Ur=null,y.updateQueue=null,PE.current=ETe,g=w(k,I)}while(Rv)}if(PE.current=jE,y=Ur!==null&&Ur.next!==null,Pp=0,ai=Ur=sr=null,BE=!1,y)throw Error(n(300));return g}function U4(){var g=Ov!==0;return Ov=0,g}function ul(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ai===null?sr.memoizedState=ai=g:ai=ai.next=g,ai}function ma(){if(Ur===null){var g=sr.alternate;g=g!==null?g.memoizedState:null}else g=Ur.next;var y=ai===null?sr.memoizedState:ai.next;if(y!==null)ai=y,Ur=g;else{if(g===null)throw Error(n(310));Ur=g,g={memoizedState:Ur.memoizedState,baseState:Ur.baseState,baseQueue:Ur.baseQueue,queue:Ur.queue,next:null},ai===null?sr.memoizedState=ai=g:ai=ai.next=g}return ai}function Mv(g,y){return typeof y=="function"?y(g):y}function j4(g){var y=ma(),w=y.queue;if(w===null)throw Error(n(311));w.lastRenderedReducer=g;var k=Ur,I=k.baseQueue,F=w.pending;if(F!==null){if(I!==null){var B=I.next;I.next=F.next,F.next=B}k.baseQueue=I=F,w.pending=null}if(I!==null){F=I.next,k=k.baseState;var Q=B=null,te=null,ge=F;do{var Ie=ge.lane;if((Pp&Ie)===Ie)te!==null&&(te=te.next={lane:0,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),k=ge.hasEagerState?ge.eagerState:g(k,ge.action);else{var De={lane:Ie,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null};te===null?(Q=te=De,B=k):te=te.next=De,sr.lanes|=Ie,Bp|=Ie}ge=ge.next}while(ge!==null&&ge!==F);te===null?B=k:te.next=Q,ru(k,y.memoizedState)||(oo=!0),y.memoizedState=k,y.baseState=B,y.baseQueue=te,w.lastRenderedState=k}if(g=w.interleaved,g!==null){I=g;do F=I.lane,sr.lanes|=F,Bp|=F,I=I.next;while(I!==g)}else I===null&&(w.lanes=0);return[y.memoizedState,w.dispatch]}function W4(g){var y=ma(),w=y.queue;if(w===null)throw Error(n(311));w.lastRenderedReducer=g;var k=w.dispatch,I=w.pending,F=y.memoizedState;if(I!==null){w.pending=null;var B=I=I.next;do F=g(F,B.action),B=B.next;while(B!==I);ru(F,y.memoizedState)||(oo=!0),y.memoizedState=F,y.baseQueue===null&&(y.baseState=F),w.lastRenderedState=F}return[F,k]}function AK(){}function _K(g,y){var w=sr,k=ma(),I=y(),F=!ru(k.memoizedState,I);if(F&&(k.memoizedState=I,oo=!0),k=k.queue,V4(NK.bind(null,w,k,g),[g]),k.getSnapshot!==y||F||ai!==null&&ai.memoizedState.tag&1){if(w.flags|=2048,Lv(9,IK.bind(null,w,k,I,y),void 0,null),ui===null)throw Error(n(349));Pp&30||TK(w,y,I)}return I}function TK(g,y,w){g.flags|=16384,g={getSnapshot:y,value:w},y=sr.updateQueue,y===null?(y={lastEffect:null,stores:null},sr.updateQueue=y,y.stores=[g]):(w=y.stores,w===null?y.stores=[g]:w.push(g))}function IK(g,y,w,k){y.value=w,y.getSnapshot=k,DK(y)&&FK(g)}function NK(g,y,w){return w(function(){DK(y)&&FK(g)})}function DK(g){var y=g.getSnapshot;g=g.value;try{var w=y();return!ru(g,w)}catch{return!0}}function FK(g){var y=Mc(g,1);y!==null&&uu(y,g,1,-1)}function RK(g){var y=ul();return typeof g=="function"&&(g=g()),y.memoizedState=y.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mv,lastRenderedState:g},y.queue=g,g=g.dispatch=CTe.bind(null,sr,g),[y.memoizedState,g]}function Lv(g,y,w,k){return g={tag:g,create:y,destroy:w,deps:k,next:null},y=sr.updateQueue,y===null?(y={lastEffect:null,stores:null},sr.updateQueue=y,y.lastEffect=g.next=g):(w=y.lastEffect,w===null?y.lastEffect=g.next=g:(k=w.next,w.next=g,g.next=k,y.lastEffect=g)),g}function OK(){return ma().memoizedState}function zE(g,y,w,k){var I=ul();sr.flags|=g,I.memoizedState=Lv(1|y,w,void 0,k===void 0?null:k)}function UE(g,y,w,k){var I=ma();k=k===void 0?null:k;var F=void 0;if(Ur!==null){var B=Ur.memoizedState;if(F=B.destroy,k!==null&&B4(k,B.deps)){I.memoizedState=Lv(y,w,F,k);return}}sr.flags|=g,I.memoizedState=Lv(1|y,w,F,k)}function MK(g,y){return zE(8390656,8,g,y)}function V4(g,y){return UE(2048,8,g,y)}function LK(g,y){return UE(4,2,g,y)}function PK(g,y){return UE(4,4,g,y)}function BK(g,y){if(typeof y=="function")return g=g(),y(g),function(){y(null)};if(y!=null)return g=g(),y.current=g,function(){y.current=null}}function zK(g,y,w){return w=w!=null?w.concat([g]):null,UE(4,4,BK.bind(null,y,g),w)}function q4(){}function UK(g,y){var w=ma();y=y===void 0?null:y;var k=w.memoizedState;return k!==null&&y!==null&&B4(y,k[1])?k[0]:(w.memoizedState=[g,y],g)}function jK(g,y){var w=ma();y=y===void 0?null:y;var k=w.memoizedState;return k!==null&&y!==null&&B4(y,k[1])?k[0]:(g=g(),w.memoizedState=[g,y],g)}function WK(g,y,w){return Pp&21?(ru(w,y)||(w=bY(),sr.lanes|=w,Bp|=w,g.baseState=!0),y):(g.baseState&&(g.baseState=!1,oo=!0),g.memoizedState=w)}function wTe(g,y){var w=vn;vn=w!==0&&4>w?w:4,g(!0);var k=P4.transition;P4.transition={};try{g(!1),y()}finally{vn=w,P4.transition=k}}function VK(){return ma().memoizedState}function $Te(g,y,w){var k=xd(g);if(w={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null},qK(g))GK(y,w);else if(w=$K(g,y,w,k),w!==null){var I=Ds();uu(w,g,k,I),HK(w,y,k)}}function CTe(g,y,w){var k=xd(g),I={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null};if(qK(g))GK(y,I);else{var F=g.alternate;if(g.lanes===0&&(F===null||F.lanes===0)&&(F=y.lastRenderedReducer,F!==null))try{var B=y.lastRenderedState,Q=F(B,w);if(I.hasEagerState=!0,I.eagerState=Q,ru(Q,B)){var te=y.interleaved;te===null?(I.next=I,D4(y)):(I.next=te.next,te.next=I),y.interleaved=I;return}}catch{}finally{}w=$K(g,y,I,k),w!==null&&(I=Ds(),uu(w,g,k,I),HK(w,y,k))}}function qK(g){var y=g.alternate;return g===sr||y!==null&&y===sr}function GK(g,y){Rv=BE=!0;var w=g.pending;w===null?y.next=y:(y.next=w.next,w.next=y),g.pending=y}function HK(g,y,w){if(w&4194240){var k=y.lanes;k&=g.pendingLanes,w|=k,y.lanes=w,HM(g,w)}}var jE={readContext:ga,useCallback:Ki,useContext:Ki,useEffect:Ki,useImperativeHandle:Ki,useInsertionEffect:Ki,useLayoutEffect:Ki,useMemo:Ki,useReducer:Ki,useRef:Ki,useState:Ki,useDebugValue:Ki,useDeferredValue:Ki,useTransition:Ki,useMutableSource:Ki,useSyncExternalStore:Ki,useId:Ki,unstable_isNewReconciler:!1},STe={readContext:ga,useCallback:function(g,y){return ul().memoizedState=[g,y===void 0?null:y],g},useContext:ga,useEffect:MK,useImperativeHandle:function(g,y,w){return w=w!=null?w.concat([g]):null,zE(4194308,4,BK.bind(null,y,g),w)},useLayoutEffect:function(g,y){return zE(4194308,4,g,y)},useInsertionEffect:function(g,y){return zE(4,2,g,y)},useMemo:function(g,y){var w=ul();return y=y===void 0?null:y,g=g(),w.memoizedState=[g,y],g},useReducer:function(g,y,w){var k=ul();return y=w!==void 0?w(y):y,k.memoizedState=k.baseState=y,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:y},k.queue=g,g=g.dispatch=$Te.bind(null,sr,g),[k.memoizedState,g]},useRef:function(g){var y=ul();return g={current:g},y.memoizedState=g},useState:RK,useDebugValue:q4,useDeferredValue:function(g){return ul().memoizedState=g},useTransition:function(){var g=RK(!1),y=g[0];return g=wTe.bind(null,g[1]),ul().memoizedState=g,[y,g]},useMutableSource:function(){},useSyncExternalStore:function(g,y,w){var k=sr,I=ul();if(Yn){if(w===void 0)throw Error(n(407));w=w()}else{if(w=y(),ui===null)throw Error(n(349));Pp&30||TK(k,y,w)}I.memoizedState=w;var F={value:w,getSnapshot:y};return I.queue=F,MK(NK.bind(null,k,F,g),[g]),k.flags|=2048,Lv(9,IK.bind(null,k,F,w,y),void 0,null),w},useId:function(){var g=ul(),y=ui.identifierPrefix;if(Yn){var w=Oc,k=Rc;w=(k&~(1<<32-et(k)-1)).toString(32)+w,y=":"+y+"R"+w,w=Ov++,0<w&&(y+="H"+w.toString(32)),y+=":"}else w=vTe++,y=":"+y+"r"+w.toString(32)+":";return g.memoizedState=y},unstable_isNewReconciler:!1},kTe={readContext:ga,useCallback:UK,useContext:ga,useEffect:V4,useImperativeHandle:zK,useInsertionEffect:LK,useLayoutEffect:PK,useMemo:jK,useReducer:j4,useRef:OK,useState:function(){return j4(Mv)},useDebugValue:q4,useDeferredValue:function(g){var y=ma();return WK(y,Ur.memoizedState,g)},useTransition:function(){var g=j4(Mv)[0],y=ma().memoizedState;return[g,y]},useMutableSource:AK,useSyncExternalStore:_K,useId:VK,unstable_isNewReconciler:!1},ETe={readContext:ga,useCallback:UK,useContext:ga,useEffect:V4,useImperativeHandle:zK,useInsertionEffect:LK,useLayoutEffect:PK,useMemo:jK,useReducer:W4,useRef:OK,useState:function(){return W4(Mv)},useDebugValue:q4,useDeferredValue:function(g){var y=ma();return Ur===null?y.memoizedState=g:WK(y,Ur.memoizedState,g)},useTransition:function(){var g=W4(Mv)[0],y=ma().memoizedState;return[g,y]},useMutableSource:AK,useSyncExternalStore:_K,useId:VK,unstable_isNewReconciler:!1};function su(g,y){if(g&&g.defaultProps){y=H({},y),g=g.defaultProps;for(var w in g)y[w]===void 0&&(y[w]=g[w]);return y}return y}function G4(g,y,w,k){y=g.memoizedState,w=w(k,y),w=w==null?y:H({},y,w),g.memoizedState=w,g.lanes===0&&(g.updateQueue.baseState=w)}var WE={isMounted:function(g){return(g=g._reactInternals)?Nc(g)===g:!1},enqueueSetState:function(g,y,w){g=g._reactInternals;var k=Ds(),I=xd(g),F=Lc(k,I);F.payload=y,w!=null&&(F.callback=w),y=pd(g,F,I),y!==null&&(uu(y,g,I,k),OE(y,g,I))},enqueueReplaceState:function(g,y,w){g=g._reactInternals;var k=Ds(),I=xd(g),F=Lc(k,I);F.tag=1,F.payload=y,w!=null&&(F.callback=w),y=pd(g,F,I),y!==null&&(uu(y,g,I,k),OE(y,g,I))},enqueueForceUpdate:function(g,y){g=g._reactInternals;var w=Ds(),k=xd(g),I=Lc(w,k);I.tag=2,y!=null&&(I.callback=y),y=pd(g,I,k),y!==null&&(uu(y,g,k,w),OE(y,g,k))}};function XK(g,y,w,k,I,F,B){return g=g.stateNode,typeof g.shouldComponentUpdate=="function"?g.shouldComponentUpdate(k,F,B):y.prototype&&y.prototype.isPureReactComponent?!Cv(w,k)||!Cv(I,F):!0}function YK(g,y,w){var k=!1,I=fd,F=y.contextType;return typeof F=="object"&&F!==null?F=ga(F):(I=so(y)?Fp:Yi.current,k=y.contextTypes,F=(k=k!=null)?G0(g,I):fd),y=new y(w,F),g.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=WE,g.stateNode=y,y._reactInternals=g,k&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=I,g.__reactInternalMemoizedMaskedChildContext=F),y}function KK(g,y,w,k){g=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(w,k),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(w,k),y.state!==g&&WE.enqueueReplaceState(y,y.state,null)}function H4(g,y,w,k){var I=g.stateNode;I.props=w,I.state=g.memoizedState,I.refs={},F4(g);var F=y.contextType;typeof F=="object"&&F!==null?I.context=ga(F):(F=so(y)?Fp:Yi.current,I.context=G0(g,F)),I.state=g.memoizedState,F=y.getDerivedStateFromProps,typeof F=="function"&&(G4(g,y,F,w),I.state=g.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(y=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),y!==I.state&&WE.enqueueReplaceState(I,I.state,null),ME(g,w,I,k),I.state=g.memoizedState),typeof I.componentDidMount=="function"&&(g.flags|=4194308)}function e1(g,y){try{var w="",k=y;do w+=ue(k),k=k.return;while(k);var I=w}catch(F){I=`
Error generating stack: `+F.message+`
`+F.stack}return{value:g,source:y,stack:I,digest:null}}function X4(g,y,w){return{value:g,source:null,stack:w??null,digest:y??null}}function Y4(g,y){try{console.error(y.value)}catch(w){setTimeout(function(){throw w})}}var ATe=typeof WeakMap=="function"?WeakMap:Map;function QK(g,y,w){w=Lc(-1,w),w.tag=3,w.payload={element:null};var k=y.value;return w.callback=function(){KE||(KE=!0,cL=k),Y4(g,y)},w}function ZK(g,y,w){w=Lc(-1,w),w.tag=3;var k=g.type.getDerivedStateFromError;if(typeof k=="function"){var I=y.value;w.payload=function(){return k(I)},w.callback=function(){Y4(g,y)}}var F=g.stateNode;return F!==null&&typeof F.componentDidCatch=="function"&&(w.callback=function(){Y4(g,y),typeof k!="function"&&(md===null?md=new Set([this]):md.add(this));var B=y.stack;this.componentDidCatch(y.value,{componentStack:B!==null?B:""})}),w}function JK(g,y,w){var k=g.pingCache;if(k===null){k=g.pingCache=new ATe;var I=new Set;k.set(y,I)}else I=k.get(y),I===void 0&&(I=new Set,k.set(y,I));I.has(w)||(I.add(w),g=UTe.bind(null,g,y,w),y.then(g,g))}function eQ(g){do{var y;if((y=g.tag===13)&&(y=g.memoizedState,y=y!==null?y.dehydrated!==null:!0),y)return g;g=g.return}while(g!==null);return null}function tQ(g,y,w,k,I){return g.mode&1?(g.flags|=65536,g.lanes=I,g):(g===y?g.flags|=65536:(g.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(y=Lc(-1,1),y.tag=2,pd(w,y,1))),w.lanes|=1),g)}var _Te=C.ReactCurrentOwner,oo=!1;function Ns(g,y,w,k){y.child=g===null?wK(y,null,w,k):K0(y,g.child,w,k)}function nQ(g,y,w,k,I){w=w.render;var F=y.ref;return Z0(y,I),k=z4(g,y,w,k,F,I),w=U4(),g!==null&&!oo?(y.updateQueue=g.updateQueue,y.flags&=-2053,g.lanes&=~I,Pc(g,y,I)):(Yn&&w&&C4(y),y.flags|=1,Ns(g,y,k,I),y.child)}function rQ(g,y,w,k,I){if(g===null){var F=w.type;return typeof F=="function"&&!yL(F)&&F.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(y.tag=15,y.type=F,iQ(g,y,F,k,I)):(g=nA(w.type,null,k,y,y.mode,I),g.ref=y.ref,g.return=y,y.child=g)}if(F=g.child,!(g.lanes&I)){var B=F.memoizedProps;if(w=w.compare,w=w!==null?w:Cv,w(B,k)&&g.ref===y.ref)return Pc(g,y,I)}return y.flags|=1,g=vd(F,k),g.ref=y.ref,g.return=y,y.child=g}function iQ(g,y,w,k,I){if(g!==null){var F=g.memoizedProps;if(Cv(F,k)&&g.ref===y.ref)if(oo=!1,y.pendingProps=k=F,(g.lanes&I)!==0)g.flags&131072&&(oo=!0);else return y.lanes=g.lanes,Pc(g,y,I)}return K4(g,y,w,k,I)}function sQ(g,y,w){var k=y.pendingProps,I=k.children,F=g!==null?g.memoizedState:null;if(k.mode==="hidden")if(!(y.mode&1))y.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mn(n1,Ho),Ho|=w;else{if(!(w&1073741824))return g=F!==null?F.baseLanes|w:w,y.lanes=y.childLanes=1073741824,y.memoizedState={baseLanes:g,cachePool:null,transitions:null},y.updateQueue=null,Mn(n1,Ho),Ho|=g,null;y.memoizedState={baseLanes:0,cachePool:null,transitions:null},k=F!==null?F.baseLanes:w,Mn(n1,Ho),Ho|=k}else F!==null?(k=F.baseLanes|w,y.memoizedState=null):k=w,Mn(n1,Ho),Ho|=k;return Ns(g,y,I,w),y.child}function oQ(g,y){var w=y.ref;(g===null&&w!==null||g!==null&&g.ref!==w)&&(y.flags|=512,y.flags|=2097152)}function K4(g,y,w,k,I){var F=so(w)?Fp:Yi.current;return F=G0(y,F),Z0(y,I),w=z4(g,y,w,k,F,I),k=U4(),g!==null&&!oo?(y.updateQueue=g.updateQueue,y.flags&=-2053,g.lanes&=~I,Pc(g,y,I)):(Yn&&k&&C4(y),y.flags|=1,Ns(g,y,w,I),y.child)}function aQ(g,y,w,k,I){if(so(w)){var F=!0;AE(y)}else F=!1;if(Z0(y,I),y.stateNode===null)qE(g,y),YK(y,w,k),H4(y,w,k,I),k=!0;else if(g===null){var B=y.stateNode,Q=y.memoizedProps;B.props=Q;var te=B.context,ge=w.contextType;typeof ge=="object"&&ge!==null?ge=ga(ge):(ge=so(w)?Fp:Yi.current,ge=G0(y,ge));var Ie=w.getDerivedStateFromProps,De=typeof Ie=="function"||typeof B.getSnapshotBeforeUpdate=="function";De||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(Q!==k||te!==ge)&&KK(y,B,k,ge),hd=!1;var Te=y.memoizedState;B.state=Te,ME(y,k,B,I),te=y.memoizedState,Q!==k||Te!==te||io.current||hd?(typeof Ie=="function"&&(G4(y,w,Ie,k),te=y.memoizedState),(Q=hd||XK(y,w,Q,k,Te,te,ge))?(De||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(y.flags|=4194308)):(typeof B.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=k,y.memoizedState=te),B.props=k,B.state=te,B.context=ge,k=Q):(typeof B.componentDidMount=="function"&&(y.flags|=4194308),k=!1)}else{B=y.stateNode,CK(g,y),Q=y.memoizedProps,ge=y.type===y.elementType?Q:su(y.type,Q),B.props=ge,De=y.pendingProps,Te=B.context,te=w.contextType,typeof te=="object"&&te!==null?te=ga(te):(te=so(w)?Fp:Yi.current,te=G0(y,te));var He=w.getDerivedStateFromProps;(Ie=typeof He=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(Q!==De||Te!==te)&&KK(y,B,k,te),hd=!1,Te=y.memoizedState,B.state=Te,ME(y,k,B,I);var Ze=y.memoizedState;Q!==De||Te!==Ze||io.current||hd?(typeof He=="function"&&(G4(y,w,He,k),Ze=y.memoizedState),(ge=hd||XK(y,w,ge,k,Te,Ze,te)||!1)?(Ie||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(k,Ze,te),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(k,Ze,te)),typeof B.componentDidUpdate=="function"&&(y.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof B.componentDidUpdate!="function"||Q===g.memoizedProps&&Te===g.memoizedState||(y.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||Q===g.memoizedProps&&Te===g.memoizedState||(y.flags|=1024),y.memoizedProps=k,y.memoizedState=Ze),B.props=k,B.state=Ze,B.context=te,k=ge):(typeof B.componentDidUpdate!="function"||Q===g.memoizedProps&&Te===g.memoizedState||(y.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||Q===g.memoizedProps&&Te===g.memoizedState||(y.flags|=1024),k=!1)}return Q4(g,y,w,k,F,I)}function Q4(g,y,w,k,I,F){oQ(g,y);var B=(y.flags&128)!==0;if(!k&&!B)return I&&dK(y,w,!1),Pc(g,y,F);k=y.stateNode,_Te.current=y;var Q=B&&typeof w.getDerivedStateFromError!="function"?null:k.render();return y.flags|=1,g!==null&&B?(y.child=K0(y,g.child,null,F),y.child=K0(y,null,Q,F)):Ns(g,y,Q,F),y.memoizedState=k.state,I&&dK(y,w,!0),y.child}function uQ(g){var y=g.stateNode;y.pendingContext?cK(g,y.pendingContext,y.pendingContext!==y.context):y.context&&cK(g,y.context,!1),R4(g,y.containerInfo)}function lQ(g,y,w,k,I){return Y0(),A4(I),y.flags|=256,Ns(g,y,w,k),y.child}var Z4={dehydrated:null,treeContext:null,retryLane:0};function J4(g){return{baseLanes:g,cachePool:null,transitions:null}}function cQ(g,y,w){var k=y.pendingProps,I=ir.current,F=!1,B=(y.flags&128)!==0,Q;if((Q=B)||(Q=g!==null&&g.memoizedState===null?!1:(I&2)!==0),Q?(F=!0,y.flags&=-129):(g===null||g.memoizedState!==null)&&(I|=1),Mn(ir,I&1),g===null)return E4(y),g=y.memoizedState,g!==null&&(g=g.dehydrated,g!==null)?(y.mode&1?g.data==="$!"?y.lanes=8:y.lanes=1073741824:y.lanes=1,null):(B=k.children,g=k.fallback,F?(k=y.mode,F=y.child,B={mode:"hidden",children:B},!(k&1)&&F!==null?(F.childLanes=0,F.pendingProps=B):F=rA(B,k,0,null),g=Wp(g,k,w,null),F.return=y,g.return=y,F.sibling=g,y.child=F,y.child.memoizedState=J4(w),y.memoizedState=Z4,g):eL(y,B));if(I=g.memoizedState,I!==null&&(Q=I.dehydrated,Q!==null))return TTe(g,y,B,k,Q,I,w);if(F){F=k.fallback,B=y.mode,I=g.child,Q=I.sibling;var te={mode:"hidden",children:k.children};return!(B&1)&&y.child!==I?(k=y.child,k.childLanes=0,k.pendingProps=te,y.deletions=null):(k=vd(I,te),k.subtreeFlags=I.subtreeFlags&14680064),Q!==null?F=vd(Q,F):(F=Wp(F,B,w,null),F.flags|=2),F.return=y,k.return=y,k.sibling=F,y.child=k,k=F,F=y.child,B=g.child.memoizedState,B=B===null?J4(w):{baseLanes:B.baseLanes|w,cachePool:null,transitions:B.transitions},F.memoizedState=B,F.childLanes=g.childLanes&~w,y.memoizedState=Z4,k}return F=g.child,g=F.sibling,k=vd(F,{mode:"visible",children:k.children}),!(y.mode&1)&&(k.lanes=w),k.return=y,k.sibling=null,g!==null&&(w=y.deletions,w===null?(y.deletions=[g],y.flags|=16):w.push(g)),y.child=k,y.memoizedState=null,k}function eL(g,y){return y=rA({mode:"visible",children:y},g.mode,0,null),y.return=g,g.child=y}function VE(g,y,w,k){return k!==null&&A4(k),K0(y,g.child,null,w),g=eL(y,y.pendingProps.children),g.flags|=2,y.memoizedState=null,g}function TTe(g,y,w,k,I,F,B){if(w)return y.flags&256?(y.flags&=-257,k=X4(Error(n(422))),VE(g,y,B,k)):y.memoizedState!==null?(y.child=g.child,y.flags|=128,null):(F=k.fallback,I=y.mode,k=rA({mode:"visible",children:k.children},I,0,null),F=Wp(F,I,B,null),F.flags|=2,k.return=y,F.return=y,k.sibling=F,y.child=k,y.mode&1&&K0(y,g.child,null,B),y.child.memoizedState=J4(B),y.memoizedState=Z4,F);if(!(y.mode&1))return VE(g,y,B,null);if(I.data==="$!"){if(k=I.nextSibling&&I.nextSibling.dataset,k)var Q=k.dgst;return k=Q,F=Error(n(419)),k=X4(F,k,void 0),VE(g,y,B,k)}if(Q=(B&g.childLanes)!==0,oo||Q){if(k=ui,k!==null){switch(B&-B){case 4:I=2;break;case 16:I=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:I=32;break;case 536870912:I=268435456;break;default:I=0}I=I&(k.suspendedLanes|B)?0:I,I!==0&&I!==F.retryLane&&(F.retryLane=I,Mc(g,I),uu(k,g,I,-1))}return mL(),k=X4(Error(n(421))),VE(g,y,B,k)}return I.data==="$?"?(y.flags|=128,y.child=g.child,y=jTe.bind(null,g),I._reactRetry=y,null):(g=F.treeContext,Go=ld(I.nextSibling),qo=y,Yn=!0,iu=null,g!==null&&(ha[pa++]=Rc,ha[pa++]=Oc,ha[pa++]=Rp,Rc=g.id,Oc=g.overflow,Rp=y),y=eL(y,k.children),y.flags|=4096,y)}function fQ(g,y,w){g.lanes|=y;var k=g.alternate;k!==null&&(k.lanes|=y),N4(g.return,y,w)}function tL(g,y,w,k,I){var F=g.memoizedState;F===null?g.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:k,tail:w,tailMode:I}:(F.isBackwards=y,F.rendering=null,F.renderingStartTime=0,F.last=k,F.tail=w,F.tailMode=I)}function dQ(g,y,w){var k=y.pendingProps,I=k.revealOrder,F=k.tail;if(Ns(g,y,k.children,w),k=ir.current,k&2)k=k&1|2,y.flags|=128;else{if(g!==null&&g.flags&128)e:for(g=y.child;g!==null;){if(g.tag===13)g.memoizedState!==null&&fQ(g,w,y);else if(g.tag===19)fQ(g,w,y);else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===y)break e;for(;g.sibling===null;){if(g.return===null||g.return===y)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}k&=1}if(Mn(ir,k),!(y.mode&1))y.memoizedState=null;else switch(I){case"forwards":for(w=y.child,I=null;w!==null;)g=w.alternate,g!==null&&LE(g)===null&&(I=w),w=w.sibling;w=I,w===null?(I=y.child,y.child=null):(I=w.sibling,w.sibling=null),tL(y,!1,I,w,F);break;case"backwards":for(w=null,I=y.child,y.child=null;I!==null;){if(g=I.alternate,g!==null&&LE(g)===null){y.child=I;break}g=I.sibling,I.sibling=w,w=I,I=g}tL(y,!0,w,null,F);break;case"together":tL(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function qE(g,y){!(y.mode&1)&&g!==null&&(g.alternate=null,y.alternate=null,y.flags|=2)}function Pc(g,y,w){if(g!==null&&(y.dependencies=g.dependencies),Bp|=y.lanes,!(w&y.childLanes))return null;if(g!==null&&y.child!==g.child)throw Error(n(153));if(y.child!==null){for(g=y.child,w=vd(g,g.pendingProps),y.child=w,w.return=y;g.sibling!==null;)g=g.sibling,w=w.sibling=vd(g,g.pendingProps),w.return=y;w.sibling=null}return y.child}function ITe(g,y,w){switch(y.tag){case 3:uQ(y),Y0();break;case 5:EK(y);break;case 1:so(y.type)&&AE(y);break;case 4:R4(y,y.stateNode.containerInfo);break;case 10:var k=y.type._context,I=y.memoizedProps.value;Mn(FE,k._currentValue),k._currentValue=I;break;case 13:if(k=y.memoizedState,k!==null)return k.dehydrated!==null?(Mn(ir,ir.current&1),y.flags|=128,null):w&y.child.childLanes?cQ(g,y,w):(Mn(ir,ir.current&1),g=Pc(g,y,w),g!==null?g.sibling:null);Mn(ir,ir.current&1);break;case 19:if(k=(w&y.childLanes)!==0,g.flags&128){if(k)return dQ(g,y,w);y.flags|=128}if(I=y.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),Mn(ir,ir.current),k)break;return null;case 22:case 23:return y.lanes=0,sQ(g,y,w)}return Pc(g,y,w)}var hQ,nL,pQ,gQ;hQ=function(g,y){for(var w=y.child;w!==null;){if(w.tag===5||w.tag===6)g.appendChild(w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===y)break;for(;w.sibling===null;){if(w.return===null||w.return===y)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},nL=function(){},pQ=function(g,y,w,k){var I=g.memoizedProps;if(I!==k){g=y.stateNode,Lp(al.current);var F=null;switch(w){case"input":I=Ce(g,I),k=Ce(g,k),F=[];break;case"select":I=H({},I,{value:void 0}),k=H({},k,{value:void 0}),F=[];break;case"textarea":I=zr(g,I),k=zr(g,k),F=[];break;default:typeof I.onClick!="function"&&typeof k.onClick=="function"&&(g.onclick=SE)}nv(w,k);var B;w=null;for(ge in I)if(!k.hasOwnProperty(ge)&&I.hasOwnProperty(ge)&&I[ge]!=null)if(ge==="style"){var Q=I[ge];for(B in Q)Q.hasOwnProperty(B)&&(w||(w={}),w[B]="")}else ge!=="dangerouslySetInnerHTML"&&ge!=="children"&&ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&ge!=="autoFocus"&&(i.hasOwnProperty(ge)?F||(F=[]):(F=F||[]).push(ge,null));for(ge in k){var te=k[ge];if(Q=I!=null?I[ge]:void 0,k.hasOwnProperty(ge)&&te!==Q&&(te!=null||Q!=null))if(ge==="style")if(Q){for(B in Q)!Q.hasOwnProperty(B)||te&&te.hasOwnProperty(B)||(w||(w={}),w[B]="");for(B in te)te.hasOwnProperty(B)&&Q[B]!==te[B]&&(w||(w={}),w[B]=te[B])}else w||(F||(F=[]),F.push(ge,w)),w=te;else ge==="dangerouslySetInnerHTML"?(te=te?te.__html:void 0,Q=Q?Q.__html:void 0,te!=null&&Q!==te&&(F=F||[]).push(ge,te)):ge==="children"?typeof te!="string"&&typeof te!="number"||(F=F||[]).push(ge,""+te):ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&(i.hasOwnProperty(ge)?(te!=null&&ge==="onScroll"&&zn("scroll",g),F||Q===te||(F=[])):(F=F||[]).push(ge,te))}w&&(F=F||[]).push("style",w);var ge=F;(y.updateQueue=ge)&&(y.flags|=4)}},gQ=function(g,y,w,k){w!==k&&(y.flags|=4)};function Pv(g,y){if(!Yn)switch(g.tailMode){case"hidden":y=g.tail;for(var w=null;y!==null;)y.alternate!==null&&(w=y),y=y.sibling;w===null?g.tail=null:w.sibling=null;break;case"collapsed":w=g.tail;for(var k=null;w!==null;)w.alternate!==null&&(k=w),w=w.sibling;k===null?y||g.tail===null?g.tail=null:g.tail.sibling=null:k.sibling=null}}function Qi(g){var y=g.alternate!==null&&g.alternate.child===g.child,w=0,k=0;if(y)for(var I=g.child;I!==null;)w|=I.lanes|I.childLanes,k|=I.subtreeFlags&14680064,k|=I.flags&14680064,I.return=g,I=I.sibling;else for(I=g.child;I!==null;)w|=I.lanes|I.childLanes,k|=I.subtreeFlags,k|=I.flags,I.return=g,I=I.sibling;return g.subtreeFlags|=k,g.childLanes=w,y}function NTe(g,y,w){var k=y.pendingProps;switch(S4(y),y.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qi(y),null;case 1:return so(y.type)&&EE(),Qi(y),null;case 3:return k=y.stateNode,J0(),Un(io),Un(Yi),L4(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(g===null||g.child===null)&&(NE(y)?y.flags|=4:g===null||g.memoizedState.isDehydrated&&!(y.flags&256)||(y.flags|=1024,iu!==null&&(hL(iu),iu=null))),nL(g,y),Qi(y),null;case 5:O4(y);var I=Lp(Fv.current);if(w=y.type,g!==null&&y.stateNode!=null)pQ(g,y,w,k,I),g.ref!==y.ref&&(y.flags|=512,y.flags|=2097152);else{if(!k){if(y.stateNode===null)throw Error(n(166));return Qi(y),null}if(g=Lp(al.current),NE(y)){k=y.stateNode,w=y.type;var F=y.memoizedProps;switch(k[ol]=y,k[_v]=F,g=(y.mode&1)!==0,w){case"dialog":zn("cancel",k),zn("close",k);break;case"iframe":case"object":case"embed":zn("load",k);break;case"video":case"audio":for(I=0;I<kv.length;I++)zn(kv[I],k);break;case"source":zn("error",k);break;case"img":case"image":case"link":zn("error",k),zn("load",k);break;case"details":zn("toggle",k);break;case"input":We(k,F),zn("invalid",k);break;case"select":k._wrapperState={wasMultiple:!!F.multiple},zn("invalid",k);break;case"textarea":da(k,F),zn("invalid",k)}nv(w,F),I=null;for(var B in F)if(F.hasOwnProperty(B)){var Q=F[B];B==="children"?typeof Q=="string"?k.textContent!==Q&&(F.suppressHydrationWarning!==!0&&CE(k.textContent,Q,g),I=["children",Q]):typeof Q=="number"&&k.textContent!==""+Q&&(F.suppressHydrationWarning!==!0&&CE(k.textContent,Q,g),I=["children",""+Q]):i.hasOwnProperty(B)&&Q!=null&&B==="onScroll"&&zn("scroll",k)}switch(w){case"input":he(k),ct(k,F,!0);break;case"textarea":he(k),ro(k);break;case"select":case"option":break;default:typeof F.onClick=="function"&&(k.onclick=SE)}k=I,y.updateQueue=k,k!==null&&(y.flags|=4)}else{B=I.nodeType===9?I:I.ownerDocument,g==="http://www.w3.org/1999/xhtml"&&(g=Wo(w)),g==="http://www.w3.org/1999/xhtml"?w==="script"?(g=B.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild)):typeof k.is=="string"?g=B.createElement(w,{is:k.is}):(g=B.createElement(w),w==="select"&&(B=g,k.multiple?B.multiple=!0:k.size&&(B.size=k.size))):g=B.createElementNS(g,w),g[ol]=y,g[_v]=k,hQ(g,y,!1,!1),y.stateNode=g;e:{switch(B=rv(w,k),w){case"dialog":zn("cancel",g),zn("close",g),I=k;break;case"iframe":case"object":case"embed":zn("load",g),I=k;break;case"video":case"audio":for(I=0;I<kv.length;I++)zn(kv[I],g);I=k;break;case"source":zn("error",g),I=k;break;case"img":case"image":case"link":zn("error",g),zn("load",g),I=k;break;case"details":zn("toggle",g),I=k;break;case"input":We(g,k),I=Ce(g,k),zn("invalid",g);break;case"option":I=k;break;case"select":g._wrapperState={wasMultiple:!!k.multiple},I=H({},k,{value:void 0}),zn("invalid",g);break;case"textarea":da(g,k),I=zr(g,k),zn("invalid",g);break;default:I=k}nv(w,I),Q=I;for(F in Q)if(Q.hasOwnProperty(F)){var te=Q[F];F==="style"?F0(g,te):F==="dangerouslySetInnerHTML"?(te=te?te.__html:void 0,te!=null&&sl(g,te)):F==="children"?typeof te=="string"?(w!=="textarea"||te!=="")&&eu(g,te):typeof te=="number"&&eu(g,""+te):F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&F!=="autoFocus"&&(i.hasOwnProperty(F)?te!=null&&F==="onScroll"&&zn("scroll",g):te!=null&&$(g,F,te,B))}switch(w){case"input":he(g),ct(g,k,!1);break;case"textarea":he(g),ro(g);break;case"option":k.value!=null&&g.setAttribute("value",""+Ne(k.value));break;case"select":g.multiple=!!k.multiple,F=k.value,F!=null?Fi(g,!!k.multiple,F,!1):k.defaultValue!=null&&Fi(g,!!k.multiple,k.defaultValue,!0);break;default:typeof I.onClick=="function"&&(g.onclick=SE)}switch(w){case"button":case"input":case"select":case"textarea":k=!!k.autoFocus;break e;case"img":k=!0;break e;default:k=!1}}k&&(y.flags|=4)}y.ref!==null&&(y.flags|=512,y.flags|=2097152)}return Qi(y),null;case 6:if(g&&y.stateNode!=null)gQ(g,y,g.memoizedProps,k);else{if(typeof k!="string"&&y.stateNode===null)throw Error(n(166));if(w=Lp(Fv.current),Lp(al.current),NE(y)){if(k=y.stateNode,w=y.memoizedProps,k[ol]=y,(F=k.nodeValue!==w)&&(g=qo,g!==null))switch(g.tag){case 3:CE(k.nodeValue,w,(g.mode&1)!==0);break;case 5:g.memoizedProps.suppressHydrationWarning!==!0&&CE(k.nodeValue,w,(g.mode&1)!==0)}F&&(y.flags|=4)}else k=(w.nodeType===9?w:w.ownerDocument).createTextNode(k),k[ol]=y,y.stateNode=k}return Qi(y),null;case 13:if(Un(ir),k=y.memoizedState,g===null||g.memoizedState!==null&&g.memoizedState.dehydrated!==null){if(Yn&&Go!==null&&y.mode&1&&!(y.flags&128))xK(),Y0(),y.flags|=98560,F=!1;else if(F=NE(y),k!==null&&k.dehydrated!==null){if(g===null){if(!F)throw Error(n(318));if(F=y.memoizedState,F=F!==null?F.dehydrated:null,!F)throw Error(n(317));F[ol]=y}else Y0(),!(y.flags&128)&&(y.memoizedState=null),y.flags|=4;Qi(y),F=!1}else iu!==null&&(hL(iu),iu=null),F=!0;if(!F)return y.flags&65536?y:null}return y.flags&128?(y.lanes=w,y):(k=k!==null,k!==(g!==null&&g.memoizedState!==null)&&k&&(y.child.flags|=8192,y.mode&1&&(g===null||ir.current&1?jr===0&&(jr=3):mL())),y.updateQueue!==null&&(y.flags|=4),Qi(y),null);case 4:return J0(),nL(g,y),g===null&&Ev(y.stateNode.containerInfo),Qi(y),null;case 10:return I4(y.type._context),Qi(y),null;case 17:return so(y.type)&&EE(),Qi(y),null;case 19:if(Un(ir),F=y.memoizedState,F===null)return Qi(y),null;if(k=(y.flags&128)!==0,B=F.rendering,B===null)if(k)Pv(F,!1);else{if(jr!==0||g!==null&&g.flags&128)for(g=y.child;g!==null;){if(B=LE(g),B!==null){for(y.flags|=128,Pv(F,!1),k=B.updateQueue,k!==null&&(y.updateQueue=k,y.flags|=4),y.subtreeFlags=0,k=w,w=y.child;w!==null;)F=w,g=k,F.flags&=14680066,B=F.alternate,B===null?(F.childLanes=0,F.lanes=g,F.child=null,F.subtreeFlags=0,F.memoizedProps=null,F.memoizedState=null,F.updateQueue=null,F.dependencies=null,F.stateNode=null):(F.childLanes=B.childLanes,F.lanes=B.lanes,F.child=B.child,F.subtreeFlags=0,F.deletions=null,F.memoizedProps=B.memoizedProps,F.memoizedState=B.memoizedState,F.updateQueue=B.updateQueue,F.type=B.type,g=B.dependencies,F.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),w=w.sibling;return Mn(ir,ir.current&1|2),y.child}g=g.sibling}F.tail!==null&&rr()>r1&&(y.flags|=128,k=!0,Pv(F,!1),y.lanes=4194304)}else{if(!k)if(g=LE(B),g!==null){if(y.flags|=128,k=!0,w=g.updateQueue,w!==null&&(y.updateQueue=w,y.flags|=4),Pv(F,!0),F.tail===null&&F.tailMode==="hidden"&&!B.alternate&&!Yn)return Qi(y),null}else 2*rr()-F.renderingStartTime>r1&&w!==1073741824&&(y.flags|=128,k=!0,Pv(F,!1),y.lanes=4194304);F.isBackwards?(B.sibling=y.child,y.child=B):(w=F.last,w!==null?w.sibling=B:y.child=B,F.last=B)}return F.tail!==null?(y=F.tail,F.rendering=y,F.tail=y.sibling,F.renderingStartTime=rr(),y.sibling=null,w=ir.current,Mn(ir,k?w&1|2:w&1),y):(Qi(y),null);case 22:case 23:return gL(),k=y.memoizedState!==null,g!==null&&g.memoizedState!==null!==k&&(y.flags|=8192),k&&y.mode&1?Ho&1073741824&&(Qi(y),y.subtreeFlags&6&&(y.flags|=8192)):Qi(y),null;case 24:return null;case 25:return null}throw Error(n(156,y.tag))}function DTe(g,y){switch(S4(y),y.tag){case 1:return so(y.type)&&EE(),g=y.flags,g&65536?(y.flags=g&-65537|128,y):null;case 3:return J0(),Un(io),Un(Yi),L4(),g=y.flags,g&65536&&!(g&128)?(y.flags=g&-65537|128,y):null;case 5:return O4(y),null;case 13:if(Un(ir),g=y.memoizedState,g!==null&&g.dehydrated!==null){if(y.alternate===null)throw Error(n(340));Y0()}return g=y.flags,g&65536?(y.flags=g&-65537|128,y):null;case 19:return Un(ir),null;case 4:return J0(),null;case 10:return I4(y.type._context),null;case 22:case 23:return gL(),null;case 24:return null;default:return null}}var GE=!1,Zi=!1,FTe=typeof WeakSet=="function"?WeakSet:Set,Ye=null;function t1(g,y){var w=g.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(k){cr(g,y,k)}else w.current=null}function rL(g,y,w){try{w()}catch(k){cr(g,y,k)}}var mQ=!1;function RTe(g,y){if(g4=dE,g=XY(),a4(g)){if("selectionStart"in g)var w={start:g.selectionStart,end:g.selectionEnd};else e:{w=(w=g.ownerDocument)&&w.defaultView||window;var k=w.getSelection&&w.getSelection();if(k&&k.rangeCount!==0){w=k.anchorNode;var I=k.anchorOffset,F=k.focusNode;k=k.focusOffset;try{w.nodeType,F.nodeType}catch{w=null;break e}var B=0,Q=-1,te=-1,ge=0,Ie=0,De=g,Te=null;t:for(;;){for(var He;De!==w||I!==0&&De.nodeType!==3||(Q=B+I),De!==F||k!==0&&De.nodeType!==3||(te=B+k),De.nodeType===3&&(B+=De.nodeValue.length),(He=De.firstChild)!==null;)Te=De,De=He;for(;;){if(De===g)break t;if(Te===w&&++ge===I&&(Q=B),Te===F&&++Ie===k&&(te=B),(He=De.nextSibling)!==null)break;De=Te,Te=De.parentNode}De=He}w=Q===-1||te===-1?null:{start:Q,end:te}}else w=null}w=w||{start:0,end:0}}else w=null;for(m4={focusedElem:g,selectionRange:w},dE=!1,Ye=y;Ye!==null;)if(y=Ye,g=y.child,(y.subtreeFlags&1028)!==0&&g!==null)g.return=y,Ye=g;else for(;Ye!==null;){y=Ye;try{var Ze=y.alternate;if(y.flags&1024)switch(y.tag){case 0:case 11:case 15:break;case 1:if(Ze!==null){var tt=Ze.memoizedProps,wr=Ze.memoizedState,de=y.stateNode,se=de.getSnapshotBeforeUpdate(y.elementType===y.type?tt:su(y.type,tt),wr);de.__reactInternalSnapshotBeforeUpdate=se}break;case 3:var pe=y.stateNode.containerInfo;pe.nodeType===1?pe.textContent="":pe.nodeType===9&&pe.documentElement&&pe.removeChild(pe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Re){cr(y,y.return,Re)}if(g=y.sibling,g!==null){g.return=y.return,Ye=g;break}Ye=y.return}return Ze=mQ,mQ=!1,Ze}function Bv(g,y,w){var k=y.updateQueue;if(k=k!==null?k.lastEffect:null,k!==null){var I=k=k.next;do{if((I.tag&g)===g){var F=I.destroy;I.destroy=void 0,F!==void 0&&rL(y,w,F)}I=I.next}while(I!==k)}}function HE(g,y){if(y=y.updateQueue,y=y!==null?y.lastEffect:null,y!==null){var w=y=y.next;do{if((w.tag&g)===g){var k=w.create;w.destroy=k()}w=w.next}while(w!==y)}}function iL(g){var y=g.ref;if(y!==null){var w=g.stateNode;switch(g.tag){case 5:g=w;break;default:g=w}typeof y=="function"?y(g):y.current=g}}function yQ(g){var y=g.alternate;y!==null&&(g.alternate=null,yQ(y)),g.child=null,g.deletions=null,g.sibling=null,g.tag===5&&(y=g.stateNode,y!==null&&(delete y[ol],delete y[_v],delete y[v4],delete y[mTe],delete y[yTe])),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function xQ(g){return g.tag===5||g.tag===3||g.tag===4}function bQ(g){e:for(;;){for(;g.sibling===null;){if(g.return===null||xQ(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;g.tag!==5&&g.tag!==6&&g.tag!==18;){if(g.flags&2||g.child===null||g.tag===4)continue e;g.child.return=g,g=g.child}if(!(g.flags&2))return g.stateNode}}function sL(g,y,w){var k=g.tag;if(k===5||k===6)g=g.stateNode,y?w.nodeType===8?w.parentNode.insertBefore(g,y):w.insertBefore(g,y):(w.nodeType===8?(y=w.parentNode,y.insertBefore(g,w)):(y=w,y.appendChild(g)),w=w._reactRootContainer,w!=null||y.onclick!==null||(y.onclick=SE));else if(k!==4&&(g=g.child,g!==null))for(sL(g,y,w),g=g.sibling;g!==null;)sL(g,y,w),g=g.sibling}function oL(g,y,w){var k=g.tag;if(k===5||k===6)g=g.stateNode,y?w.insertBefore(g,y):w.appendChild(g);else if(k!==4&&(g=g.child,g!==null))for(oL(g,y,w),g=g.sibling;g!==null;)oL(g,y,w),g=g.sibling}var Oi=null,ou=!1;function gd(g,y,w){for(w=w.child;w!==null;)vQ(g,y,w),w=w.sibling}function vQ(g,y,w){if(Se&&typeof Se.onCommitFiberUnmount=="function")try{Se.onCommitFiberUnmount(oe,w)}catch{}switch(w.tag){case 5:Zi||t1(w,y);case 6:var k=Oi,I=ou;Oi=null,gd(g,y,w),Oi=k,ou=I,Oi!==null&&(ou?(g=Oi,w=w.stateNode,g.nodeType===8?g.parentNode.removeChild(w):g.removeChild(w)):Oi.removeChild(w.stateNode));break;case 18:Oi!==null&&(ou?(g=Oi,w=w.stateNode,g.nodeType===8?b4(g.parentNode,w):g.nodeType===1&&b4(g,w),yv(g)):b4(Oi,w.stateNode));break;case 4:k=Oi,I=ou,Oi=w.stateNode.containerInfo,ou=!0,gd(g,y,w),Oi=k,ou=I;break;case 0:case 11:case 14:case 15:if(!Zi&&(k=w.updateQueue,k!==null&&(k=k.lastEffect,k!==null))){I=k=k.next;do{var F=I,B=F.destroy;F=F.tag,B!==void 0&&(F&2||F&4)&&rL(w,y,B),I=I.next}while(I!==k)}gd(g,y,w);break;case 1:if(!Zi&&(t1(w,y),k=w.stateNode,typeof k.componentWillUnmount=="function"))try{k.props=w.memoizedProps,k.state=w.memoizedState,k.componentWillUnmount()}catch(Q){cr(w,y,Q)}gd(g,y,w);break;case 21:gd(g,y,w);break;case 22:w.mode&1?(Zi=(k=Zi)||w.memoizedState!==null,gd(g,y,w),Zi=k):gd(g,y,w);break;default:gd(g,y,w)}}function wQ(g){var y=g.updateQueue;if(y!==null){g.updateQueue=null;var w=g.stateNode;w===null&&(w=g.stateNode=new FTe),y.forEach(function(k){var I=WTe.bind(null,g,k);w.has(k)||(w.add(k),k.then(I,I))})}}function au(g,y){var w=y.deletions;if(w!==null)for(var k=0;k<w.length;k++){var I=w[k];try{var F=g,B=y,Q=B;e:for(;Q!==null;){switch(Q.tag){case 5:Oi=Q.stateNode,ou=!1;break e;case 3:Oi=Q.stateNode.containerInfo,ou=!0;break e;case 4:Oi=Q.stateNode.containerInfo,ou=!0;break e}Q=Q.return}if(Oi===null)throw Error(n(160));vQ(F,B,I),Oi=null,ou=!1;var te=I.alternate;te!==null&&(te.return=null),I.return=null}catch(ge){cr(I,y,ge)}}if(y.subtreeFlags&12854)for(y=y.child;y!==null;)$Q(y,g),y=y.sibling}function $Q(g,y){var w=g.alternate,k=g.flags;switch(g.tag){case 0:case 11:case 14:case 15:if(au(y,g),ll(g),k&4){try{Bv(3,g,g.return),HE(3,g)}catch(tt){cr(g,g.return,tt)}try{Bv(5,g,g.return)}catch(tt){cr(g,g.return,tt)}}break;case 1:au(y,g),ll(g),k&512&&w!==null&&t1(w,w.return);break;case 5:if(au(y,g),ll(g),k&512&&w!==null&&t1(w,w.return),g.flags&32){var I=g.stateNode;try{eu(I,"")}catch(tt){cr(g,g.return,tt)}}if(k&4&&(I=g.stateNode,I!=null)){var F=g.memoizedProps,B=w!==null?w.memoizedProps:F,Q=g.type,te=g.updateQueue;if(g.updateQueue=null,te!==null)try{Q==="input"&&F.type==="radio"&&F.name!=null&&Ve(I,F),rv(Q,B);var ge=rv(Q,F);for(B=0;B<te.length;B+=2){var Ie=te[B],De=te[B+1];Ie==="style"?F0(I,De):Ie==="dangerouslySetInnerHTML"?sl(I,De):Ie==="children"?eu(I,De):$(I,Ie,De,ge)}switch(Q){case"input":gt(I,F);break;case"textarea":si(I,F);break;case"select":var Te=I._wrapperState.wasMultiple;I._wrapperState.wasMultiple=!!F.multiple;var He=F.value;He!=null?Fi(I,!!F.multiple,He,!1):Te!==!!F.multiple&&(F.defaultValue!=null?Fi(I,!!F.multiple,F.defaultValue,!0):Fi(I,!!F.multiple,F.multiple?[]:"",!1))}I[_v]=F}catch(tt){cr(g,g.return,tt)}}break;case 6:if(au(y,g),ll(g),k&4){if(g.stateNode===null)throw Error(n(162));I=g.stateNode,F=g.memoizedProps;try{I.nodeValue=F}catch(tt){cr(g,g.return,tt)}}break;case 3:if(au(y,g),ll(g),k&4&&w!==null&&w.memoizedState.isDehydrated)try{yv(y.containerInfo)}catch(tt){cr(g,g.return,tt)}break;case 4:au(y,g),ll(g);break;case 13:au(y,g),ll(g),I=g.child,I.flags&8192&&(F=I.memoizedState!==null,I.stateNode.isHidden=F,!F||I.alternate!==null&&I.alternate.memoizedState!==null||(lL=rr())),k&4&&wQ(g);break;case 22:if(Ie=w!==null&&w.memoizedState!==null,g.mode&1?(Zi=(ge=Zi)||Ie,au(y,g),Zi=ge):au(y,g),ll(g),k&8192){if(ge=g.memoizedState!==null,(g.stateNode.isHidden=ge)&&!Ie&&g.mode&1)for(Ye=g,Ie=g.child;Ie!==null;){for(De=Ye=Ie;Ye!==null;){switch(Te=Ye,He=Te.child,Te.tag){case 0:case 11:case 14:case 15:Bv(4,Te,Te.return);break;case 1:t1(Te,Te.return);var Ze=Te.stateNode;if(typeof Ze.componentWillUnmount=="function"){k=Te,w=Te.return;try{y=k,Ze.props=y.memoizedProps,Ze.state=y.memoizedState,Ze.componentWillUnmount()}catch(tt){cr(k,w,tt)}}break;case 5:t1(Te,Te.return);break;case 22:if(Te.memoizedState!==null){kQ(De);continue}}He!==null?(He.return=Te,Ye=He):kQ(De)}Ie=Ie.sibling}e:for(Ie=null,De=g;;){if(De.tag===5){if(Ie===null){Ie=De;try{I=De.stateNode,ge?(F=I.style,typeof F.setProperty=="function"?F.setProperty("display","none","important"):F.display="none"):(Q=De.stateNode,te=De.memoizedProps.style,B=te!=null&&te.hasOwnProperty("display")?te.display:null,Q.style.display=Ic("display",B))}catch(tt){cr(g,g.return,tt)}}}else if(De.tag===6){if(Ie===null)try{De.stateNode.nodeValue=ge?"":De.memoizedProps}catch(tt){cr(g,g.return,tt)}}else if((De.tag!==22&&De.tag!==23||De.memoizedState===null||De===g)&&De.child!==null){De.child.return=De,De=De.child;continue}if(De===g)break e;for(;De.sibling===null;){if(De.return===null||De.return===g)break e;Ie===De&&(Ie=null),De=De.return}Ie===De&&(Ie=null),De.sibling.return=De.return,De=De.sibling}}break;case 19:au(y,g),ll(g),k&4&&wQ(g);break;case 21:break;default:au(y,g),ll(g)}}function ll(g){var y=g.flags;if(y&2){try{e:{for(var w=g.return;w!==null;){if(xQ(w)){var k=w;break e}w=w.return}throw Error(n(160))}switch(k.tag){case 5:var I=k.stateNode;k.flags&32&&(eu(I,""),k.flags&=-33);var F=bQ(g);oL(g,F,I);break;case 3:case 4:var B=k.stateNode.containerInfo,Q=bQ(g);sL(g,Q,B);break;default:throw Error(n(161))}}catch(te){cr(g,g.return,te)}g.flags&=-3}y&4096&&(g.flags&=-4097)}function OTe(g,y,w){Ye=g,CQ(g)}function CQ(g,y,w){for(var k=(g.mode&1)!==0;Ye!==null;){var I=Ye,F=I.child;if(I.tag===22&&k){var B=I.memoizedState!==null||GE;if(!B){var Q=I.alternate,te=Q!==null&&Q.memoizedState!==null||Zi;Q=GE;var ge=Zi;if(GE=B,(Zi=te)&&!ge)for(Ye=I;Ye!==null;)B=Ye,te=B.child,B.tag===22&&B.memoizedState!==null?EQ(I):te!==null?(te.return=B,Ye=te):EQ(I);for(;F!==null;)Ye=F,CQ(F),F=F.sibling;Ye=I,GE=Q,Zi=ge}SQ(g)}else I.subtreeFlags&8772&&F!==null?(F.return=I,Ye=F):SQ(g)}}function SQ(g){for(;Ye!==null;){var y=Ye;if(y.flags&8772){var w=y.alternate;try{if(y.flags&8772)switch(y.tag){case 0:case 11:case 15:Zi||HE(5,y);break;case 1:var k=y.stateNode;if(y.flags&4&&!Zi)if(w===null)k.componentDidMount();else{var I=y.elementType===y.type?w.memoizedProps:su(y.type,w.memoizedProps);k.componentDidUpdate(I,w.memoizedState,k.__reactInternalSnapshotBeforeUpdate)}var F=y.updateQueue;F!==null&&kK(y,F,k);break;case 3:var B=y.updateQueue;if(B!==null){if(w=null,y.child!==null)switch(y.child.tag){case 5:w=y.child.stateNode;break;case 1:w=y.child.stateNode}kK(y,B,w)}break;case 5:var Q=y.stateNode;if(w===null&&y.flags&4){w=Q;var te=y.memoizedProps;switch(y.type){case"button":case"input":case"select":case"textarea":te.autoFocus&&w.focus();break;case"img":te.src&&(w.src=te.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(y.memoizedState===null){var ge=y.alternate;if(ge!==null){var Ie=ge.memoizedState;if(Ie!==null){var De=Ie.dehydrated;De!==null&&yv(De)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Zi||y.flags&512&&iL(y)}catch(Te){cr(y,y.return,Te)}}if(y===g){Ye=null;break}if(w=y.sibling,w!==null){w.return=y.return,Ye=w;break}Ye=y.return}}function kQ(g){for(;Ye!==null;){var y=Ye;if(y===g){Ye=null;break}var w=y.sibling;if(w!==null){w.return=y.return,Ye=w;break}Ye=y.return}}function EQ(g){for(;Ye!==null;){var y=Ye;try{switch(y.tag){case 0:case 11:case 15:var w=y.return;try{HE(4,y)}catch(te){cr(y,w,te)}break;case 1:var k=y.stateNode;if(typeof k.componentDidMount=="function"){var I=y.return;try{k.componentDidMount()}catch(te){cr(y,I,te)}}var F=y.return;try{iL(y)}catch(te){cr(y,F,te)}break;case 5:var B=y.return;try{iL(y)}catch(te){cr(y,B,te)}}}catch(te){cr(y,y.return,te)}if(y===g){Ye=null;break}var Q=y.sibling;if(Q!==null){Q.return=y.return,Ye=Q;break}Ye=y.return}}var MTe=Math.ceil,XE=C.ReactCurrentDispatcher,aL=C.ReactCurrentOwner,ya=C.ReactCurrentBatchConfig,tn=0,ui=null,Ar=null,Mi=0,Ho=0,n1=cd(0),jr=0,zv=null,Bp=0,YE=0,uL=0,Uv=null,ao=null,lL=0,r1=1/0,Bc=null,KE=!1,cL=null,md=null,QE=!1,yd=null,ZE=0,jv=0,fL=null,JE=-1,eA=0;function Ds(){return tn&6?rr():JE!==-1?JE:JE=rr()}function xd(g){return g.mode&1?tn&2&&Mi!==0?Mi&-Mi:bTe.transition!==null?(eA===0&&(eA=bY()),eA):(g=vn,g!==0||(g=window.event,g=g===void 0?16:_Y(g.type)),g):1}function uu(g,y,w,k){if(50<jv)throw jv=0,fL=null,Error(n(185));dv(g,w,k),(!(tn&2)||g!==ui)&&(g===ui&&(!(tn&2)&&(YE|=w),jr===4&&bd(g,Mi)),uo(g,k),w===1&&tn===0&&!(y.mode&1)&&(r1=rr()+500,_E&&dd()))}function uo(g,y){var w=g.callbackNode;Is(g,y);var k=Np(g,g===ui?Mi:0);if(k===0)w!==null&&uE(w),g.callbackNode=null,g.callbackPriority=0;else if(y=k&-k,g.callbackPriority!==y){if(w!=null&&uE(w),y===1)g.tag===0?xTe(_Q.bind(null,g)):hK(_Q.bind(null,g)),pTe(function(){!(tn&6)&&dd()}),w=null;else{switch(vY(k)){case 1:w=cv;break;case 4:w=lE;break;case 16:w=M0;break;case 536870912:w=K;break;default:w=M0}w=MQ(w,AQ.bind(null,g))}g.callbackPriority=y,g.callbackNode=w}}function AQ(g,y){if(JE=-1,eA=0,tn&6)throw Error(n(327));var w=g.callbackNode;if(i1()&&g.callbackNode!==w)return null;var k=Np(g,g===ui?Mi:0);if(k===0)return null;if(k&30||k&g.expiredLanes||y)y=tA(g,k);else{y=k;var I=tn;tn|=2;var F=IQ();(ui!==g||Mi!==y)&&(Bc=null,r1=rr()+500,Up(g,y));do try{BTe();break}catch(Q){TQ(g,Q)}while(!0);T4(),XE.current=F,tn=I,Ar!==null?y=0:(ui=null,Mi=0,y=jr)}if(y!==0){if(y===2&&(I=fv(g),I!==0&&(k=I,y=dL(g,I))),y===1)throw w=zv,Up(g,0),bd(g,k),uo(g,rr()),w;if(y===6)bd(g,k);else{if(I=g.current.alternate,!(k&30)&&!LTe(I)&&(y=tA(g,k),y===2&&(F=fv(g),F!==0&&(k=F,y=dL(g,F))),y===1))throw w=zv,Up(g,0),bd(g,k),uo(g,rr()),w;switch(g.finishedWork=I,g.finishedLanes=k,y){case 0:case 1:throw Error(n(345));case 2:jp(g,ao,Bc);break;case 3:if(bd(g,k),(k&130023424)===k&&(y=lL+500-rr(),10<y)){if(Np(g,0)!==0)break;if(I=g.suspendedLanes,(I&k)!==k){Ds(),g.pingedLanes|=g.suspendedLanes&I;break}g.timeoutHandle=x4(jp.bind(null,g,ao,Bc),y);break}jp(g,ao,Bc);break;case 4:if(bd(g,k),(k&4194240)===k)break;for(y=g.eventTimes,I=-1;0<k;){var B=31-et(k);F=1<<B,B=y[B],B>I&&(I=B),k&=~F}if(k=I,k=rr()-k,k=(120>k?120:480>k?480:1080>k?1080:1920>k?1920:3e3>k?3e3:4320>k?4320:1960*MTe(k/1960))-k,10<k){g.timeoutHandle=x4(jp.bind(null,g,ao,Bc),k);break}jp(g,ao,Bc);break;case 5:jp(g,ao,Bc);break;default:throw Error(n(329))}}}return uo(g,rr()),g.callbackNode===w?AQ.bind(null,g):null}function dL(g,y){var w=Uv;return g.current.memoizedState.isDehydrated&&(Up(g,y).flags|=256),g=tA(g,y),g!==2&&(y=ao,ao=w,y!==null&&hL(y)),g}function hL(g){ao===null?ao=g:ao.push.apply(ao,g)}function LTe(g){for(var y=g;;){if(y.flags&16384){var w=y.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var k=0;k<w.length;k++){var I=w[k],F=I.getSnapshot;I=I.value;try{if(!ru(F(),I))return!1}catch{return!1}}}if(w=y.child,y.subtreeFlags&16384&&w!==null)w.return=y,y=w;else{if(y===g)break;for(;y.sibling===null;){if(y.return===null||y.return===g)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function bd(g,y){for(y&=~uL,y&=~YE,g.suspendedLanes|=y,g.pingedLanes&=~y,g=g.expirationTimes;0<y;){var w=31-et(y),k=1<<w;g[w]=-1,y&=~k}}function _Q(g){if(tn&6)throw Error(n(327));i1();var y=Np(g,0);if(!(y&1))return uo(g,rr()),null;var w=tA(g,y);if(g.tag!==0&&w===2){var k=fv(g);k!==0&&(y=k,w=dL(g,k))}if(w===1)throw w=zv,Up(g,0),bd(g,y),uo(g,rr()),w;if(w===6)throw Error(n(345));return g.finishedWork=g.current.alternate,g.finishedLanes=y,jp(g,ao,Bc),uo(g,rr()),null}function pL(g,y){var w=tn;tn|=1;try{return g(y)}finally{tn=w,tn===0&&(r1=rr()+500,_E&&dd())}}function zp(g){yd!==null&&yd.tag===0&&!(tn&6)&&i1();var y=tn;tn|=1;var w=ya.transition,k=vn;try{if(ya.transition=null,vn=1,g)return g()}finally{vn=k,ya.transition=w,tn=y,!(tn&6)&&dd()}}function gL(){Ho=n1.current,Un(n1)}function Up(g,y){g.finishedWork=null,g.finishedLanes=0;var w=g.timeoutHandle;if(w!==-1&&(g.timeoutHandle=-1,hTe(w)),Ar!==null)for(w=Ar.return;w!==null;){var k=w;switch(S4(k),k.tag){case 1:k=k.type.childContextTypes,k!=null&&EE();break;case 3:J0(),Un(io),Un(Yi),L4();break;case 5:O4(k);break;case 4:J0();break;case 13:Un(ir);break;case 19:Un(ir);break;case 10:I4(k.type._context);break;case 22:case 23:gL()}w=w.return}if(ui=g,Ar=g=vd(g.current,null),Mi=Ho=y,jr=0,zv=null,uL=YE=Bp=0,ao=Uv=null,Mp!==null){for(y=0;y<Mp.length;y++)if(w=Mp[y],k=w.interleaved,k!==null){w.interleaved=null;var I=k.next,F=w.pending;if(F!==null){var B=F.next;F.next=I,k.next=B}w.pending=k}Mp=null}return g}function TQ(g,y){do{var w=Ar;try{if(T4(),PE.current=jE,BE){for(var k=sr.memoizedState;k!==null;){var I=k.queue;I!==null&&(I.pending=null),k=k.next}BE=!1}if(Pp=0,ai=Ur=sr=null,Rv=!1,Ov=0,aL.current=null,w===null||w.return===null){jr=1,zv=y,Ar=null;break}e:{var F=g,B=w.return,Q=w,te=y;if(y=Mi,Q.flags|=32768,te!==null&&typeof te=="object"&&typeof te.then=="function"){var ge=te,Ie=Q,De=Ie.tag;if(!(Ie.mode&1)&&(De===0||De===11||De===15)){var Te=Ie.alternate;Te?(Ie.updateQueue=Te.updateQueue,Ie.memoizedState=Te.memoizedState,Ie.lanes=Te.lanes):(Ie.updateQueue=null,Ie.memoizedState=null)}var He=eQ(B);if(He!==null){He.flags&=-257,tQ(He,B,Q,F,y),He.mode&1&&JK(F,ge,y),y=He,te=ge;var Ze=y.updateQueue;if(Ze===null){var tt=new Set;tt.add(te),y.updateQueue=tt}else Ze.add(te);break e}else{if(!(y&1)){JK(F,ge,y),mL();break e}te=Error(n(426))}}else if(Yn&&Q.mode&1){var wr=eQ(B);if(wr!==null){!(wr.flags&65536)&&(wr.flags|=256),tQ(wr,B,Q,F,y),A4(e1(te,Q));break e}}F=te=e1(te,Q),jr!==4&&(jr=2),Uv===null?Uv=[F]:Uv.push(F),F=B;do{switch(F.tag){case 3:F.flags|=65536,y&=-y,F.lanes|=y;var de=QK(F,te,y);SK(F,de);break e;case 1:Q=te;var se=F.type,pe=F.stateNode;if(!(F.flags&128)&&(typeof se.getDerivedStateFromError=="function"||pe!==null&&typeof pe.componentDidCatch=="function"&&(md===null||!md.has(pe)))){F.flags|=65536,y&=-y,F.lanes|=y;var Re=ZK(F,Q,y);SK(F,Re);break e}}F=F.return}while(F!==null)}DQ(w)}catch(at){y=at,Ar===w&&w!==null&&(Ar=w=w.return);continue}break}while(!0)}function IQ(){var g=XE.current;return XE.current=jE,g===null?jE:g}function mL(){(jr===0||jr===3||jr===2)&&(jr=4),ui===null||!(Bp&268435455)&&!(YE&268435455)||bd(ui,Mi)}function tA(g,y){var w=tn;tn|=2;var k=IQ();(ui!==g||Mi!==y)&&(Bc=null,Up(g,y));do try{PTe();break}catch(I){TQ(g,I)}while(!0);if(T4(),tn=w,XE.current=k,Ar!==null)throw Error(n(261));return ui=null,Mi=0,jr}function PTe(){for(;Ar!==null;)NQ(Ar)}function BTe(){for(;Ar!==null&&!jM();)NQ(Ar)}function NQ(g){var y=OQ(g.alternate,g,Ho);g.memoizedProps=g.pendingProps,y===null?DQ(g):Ar=y,aL.current=null}function DQ(g){var y=g;do{var w=y.alternate;if(g=y.return,y.flags&32768){if(w=DTe(w,y),w!==null){w.flags&=32767,Ar=w;return}if(g!==null)g.flags|=32768,g.subtreeFlags=0,g.deletions=null;else{jr=6,Ar=null;return}}else if(w=NTe(w,y,Ho),w!==null){Ar=w;return}if(y=y.sibling,y!==null){Ar=y;return}Ar=y=g}while(y!==null);jr===0&&(jr=5)}function jp(g,y,w){var k=vn,I=ya.transition;try{ya.transition=null,vn=1,zTe(g,y,w,k)}finally{ya.transition=I,vn=k}return null}function zTe(g,y,w,k){do i1();while(yd!==null);if(tn&6)throw Error(n(327));w=g.finishedWork;var I=g.finishedLanes;if(w===null)return null;if(g.finishedWork=null,g.finishedLanes=0,w===g.current)throw Error(n(177));g.callbackNode=null,g.callbackPriority=0;var F=w.lanes|w.childLanes;if(v_e(g,F),g===ui&&(Ar=ui=null,Mi=0),!(w.subtreeFlags&2064)&&!(w.flags&2064)||QE||(QE=!0,MQ(M0,function(){return i1(),null})),F=(w.flags&15990)!==0,w.subtreeFlags&15990||F){F=ya.transition,ya.transition=null;var B=vn;vn=1;var Q=tn;tn|=4,aL.current=null,RTe(g,w),$Q(w,g),oTe(m4),dE=!!g4,m4=g4=null,g.current=w,OTe(w),WM(),tn=Q,vn=B,ya.transition=F}else g.current=w;if(QE&&(QE=!1,yd=g,ZE=I),F=g.pendingLanes,F===0&&(md=null),Le(w.stateNode),uo(g,rr()),y!==null)for(k=g.onRecoverableError,w=0;w<y.length;w++)I=y[w],k(I.value,{componentStack:I.stack,digest:I.digest});if(KE)throw KE=!1,g=cL,cL=null,g;return ZE&1&&g.tag!==0&&i1(),F=g.pendingLanes,F&1?g===fL?jv++:(jv=0,fL=g):jv=0,dd(),null}function i1(){if(yd!==null){var g=vY(ZE),y=ya.transition,w=vn;try{if(ya.transition=null,vn=16>g?16:g,yd===null)var k=!1;else{if(g=yd,yd=null,ZE=0,tn&6)throw Error(n(331));var I=tn;for(tn|=4,Ye=g.current;Ye!==null;){var F=Ye,B=F.child;if(Ye.flags&16){var Q=F.deletions;if(Q!==null){for(var te=0;te<Q.length;te++){var ge=Q[te];for(Ye=ge;Ye!==null;){var Ie=Ye;switch(Ie.tag){case 0:case 11:case 15:Bv(8,Ie,F)}var De=Ie.child;if(De!==null)De.return=Ie,Ye=De;else for(;Ye!==null;){Ie=Ye;var Te=Ie.sibling,He=Ie.return;if(yQ(Ie),Ie===ge){Ye=null;break}if(Te!==null){Te.return=He,Ye=Te;break}Ye=He}}}var Ze=F.alternate;if(Ze!==null){var tt=Ze.child;if(tt!==null){Ze.child=null;do{var wr=tt.sibling;tt.sibling=null,tt=wr}while(tt!==null)}}Ye=F}}if(F.subtreeFlags&2064&&B!==null)B.return=F,Ye=B;else e:for(;Ye!==null;){if(F=Ye,F.flags&2048)switch(F.tag){case 0:case 11:case 15:Bv(9,F,F.return)}var de=F.sibling;if(de!==null){de.return=F.return,Ye=de;break e}Ye=F.return}}var se=g.current;for(Ye=se;Ye!==null;){B=Ye;var pe=B.child;if(B.subtreeFlags&2064&&pe!==null)pe.return=B,Ye=pe;else e:for(B=se;Ye!==null;){if(Q=Ye,Q.flags&2048)try{switch(Q.tag){case 0:case 11:case 15:HE(9,Q)}}catch(at){cr(Q,Q.return,at)}if(Q===B){Ye=null;break e}var Re=Q.sibling;if(Re!==null){Re.return=Q.return,Ye=Re;break e}Ye=Q.return}}if(tn=I,dd(),Se&&typeof Se.onPostCommitFiberRoot=="function")try{Se.onPostCommitFiberRoot(oe,g)}catch{}k=!0}return k}finally{vn=w,ya.transition=y}}return!1}function FQ(g,y,w){y=e1(w,y),y=QK(g,y,1),g=pd(g,y,1),y=Ds(),g!==null&&(dv(g,1,y),uo(g,y))}function cr(g,y,w){if(g.tag===3)FQ(g,g,w);else for(;y!==null;){if(y.tag===3){FQ(y,g,w);break}else if(y.tag===1){var k=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(md===null||!md.has(k))){g=e1(w,g),g=ZK(y,g,1),y=pd(y,g,1),g=Ds(),y!==null&&(dv(y,1,g),uo(y,g));break}}y=y.return}}function UTe(g,y,w){var k=g.pingCache;k!==null&&k.delete(y),y=Ds(),g.pingedLanes|=g.suspendedLanes&w,ui===g&&(Mi&w)===w&&(jr===4||jr===3&&(Mi&130023424)===Mi&&500>rr()-lL?Up(g,0):uL|=w),uo(g,y)}function RQ(g,y){y===0&&(g.mode&1?(y=nu,nu<<=1,!(nu&130023424)&&(nu=4194304)):y=1);var w=Ds();g=Mc(g,y),g!==null&&(dv(g,y,w),uo(g,w))}function jTe(g){var y=g.memoizedState,w=0;y!==null&&(w=y.retryLane),RQ(g,w)}function WTe(g,y){var w=0;switch(g.tag){case 13:var k=g.stateNode,I=g.memoizedState;I!==null&&(w=I.retryLane);break;case 19:k=g.stateNode;break;default:throw Error(n(314))}k!==null&&k.delete(y),RQ(g,w)}var OQ;OQ=function(g,y,w){if(g!==null)if(g.memoizedProps!==y.pendingProps||io.current)oo=!0;else{if(!(g.lanes&w)&&!(y.flags&128))return oo=!1,ITe(g,y,w);oo=!!(g.flags&131072)}else oo=!1,Yn&&y.flags&1048576&&pK(y,IE,y.index);switch(y.lanes=0,y.tag){case 2:var k=y.type;qE(g,y),g=y.pendingProps;var I=G0(y,Yi.current);Z0(y,w),I=z4(null,y,k,g,I,w);var F=U4();return y.flags|=1,typeof I=="object"&&I!==null&&typeof I.render=="function"&&I.$$typeof===void 0?(y.tag=1,y.memoizedState=null,y.updateQueue=null,so(k)?(F=!0,AE(y)):F=!1,y.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,F4(y),I.updater=WE,y.stateNode=I,I._reactInternals=y,H4(y,k,g,w),y=Q4(null,y,k,!0,F,w)):(y.tag=0,Yn&&F&&C4(y),Ns(null,y,I,w),y=y.child),y;case 16:k=y.elementType;e:{switch(qE(g,y),g=y.pendingProps,I=k._init,k=I(k._payload),y.type=k,I=y.tag=qTe(k),g=su(k,g),I){case 0:y=K4(null,y,k,g,w);break e;case 1:y=aQ(null,y,k,g,w);break e;case 11:y=nQ(null,y,k,g,w);break e;case 14:y=rQ(null,y,k,su(k.type,g),w);break e}throw Error(n(306,k,""))}return y;case 0:return k=y.type,I=y.pendingProps,I=y.elementType===k?I:su(k,I),K4(g,y,k,I,w);case 1:return k=y.type,I=y.pendingProps,I=y.elementType===k?I:su(k,I),aQ(g,y,k,I,w);case 3:e:{if(uQ(y),g===null)throw Error(n(387));k=y.pendingProps,F=y.memoizedState,I=F.element,CK(g,y),ME(y,k,null,w);var B=y.memoizedState;if(k=B.element,F.isDehydrated)if(F={element:k,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},y.updateQueue.baseState=F,y.memoizedState=F,y.flags&256){I=e1(Error(n(423)),y),y=lQ(g,y,k,w,I);break e}else if(k!==I){I=e1(Error(n(424)),y),y=lQ(g,y,k,w,I);break e}else for(Go=ld(y.stateNode.containerInfo.firstChild),qo=y,Yn=!0,iu=null,w=wK(y,null,k,w),y.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if(Y0(),k===I){y=Pc(g,y,w);break e}Ns(g,y,k,w)}y=y.child}return y;case 5:return EK(y),g===null&&E4(y),k=y.type,I=y.pendingProps,F=g!==null?g.memoizedProps:null,B=I.children,y4(k,I)?B=null:F!==null&&y4(k,F)&&(y.flags|=32),oQ(g,y),Ns(g,y,B,w),y.child;case 6:return g===null&&E4(y),null;case 13:return cQ(g,y,w);case 4:return R4(y,y.stateNode.containerInfo),k=y.pendingProps,g===null?y.child=K0(y,null,k,w):Ns(g,y,k,w),y.child;case 11:return k=y.type,I=y.pendingProps,I=y.elementType===k?I:su(k,I),nQ(g,y,k,I,w);case 7:return Ns(g,y,y.pendingProps,w),y.child;case 8:return Ns(g,y,y.pendingProps.children,w),y.child;case 12:return Ns(g,y,y.pendingProps.children,w),y.child;case 10:e:{if(k=y.type._context,I=y.pendingProps,F=y.memoizedProps,B=I.value,Mn(FE,k._currentValue),k._currentValue=B,F!==null)if(ru(F.value,B)){if(F.children===I.children&&!io.current){y=Pc(g,y,w);break e}}else for(F=y.child,F!==null&&(F.return=y);F!==null;){var Q=F.dependencies;if(Q!==null){B=F.child;for(var te=Q.firstContext;te!==null;){if(te.context===k){if(F.tag===1){te=Lc(-1,w&-w),te.tag=2;var ge=F.updateQueue;if(ge!==null){ge=ge.shared;var Ie=ge.pending;Ie===null?te.next=te:(te.next=Ie.next,Ie.next=te),ge.pending=te}}F.lanes|=w,te=F.alternate,te!==null&&(te.lanes|=w),N4(F.return,w,y),Q.lanes|=w;break}te=te.next}}else if(F.tag===10)B=F.type===y.type?null:F.child;else if(F.tag===18){if(B=F.return,B===null)throw Error(n(341));B.lanes|=w,Q=B.alternate,Q!==null&&(Q.lanes|=w),N4(B,w,y),B=F.sibling}else B=F.child;if(B!==null)B.return=F;else for(B=F;B!==null;){if(B===y){B=null;break}if(F=B.sibling,F!==null){F.return=B.return,B=F;break}B=B.return}F=B}Ns(g,y,I.children,w),y=y.child}return y;case 9:return I=y.type,k=y.pendingProps.children,Z0(y,w),I=ga(I),k=k(I),y.flags|=1,Ns(g,y,k,w),y.child;case 14:return k=y.type,I=su(k,y.pendingProps),I=su(k.type,I),rQ(g,y,k,I,w);case 15:return iQ(g,y,y.type,y.pendingProps,w);case 17:return k=y.type,I=y.pendingProps,I=y.elementType===k?I:su(k,I),qE(g,y),y.tag=1,so(k)?(g=!0,AE(y)):g=!1,Z0(y,w),YK(y,k,I),H4(y,k,I,w),Q4(null,y,k,!0,g,w);case 19:return dQ(g,y,w);case 22:return sQ(g,y,w)}throw Error(n(156,y.tag))};function MQ(g,y){return aE(g,y)}function VTe(g,y,w,k){this.tag=g,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xa(g,y,w,k){return new VTe(g,y,w,k)}function yL(g){return g=g.prototype,!(!g||!g.isReactComponent)}function qTe(g){if(typeof g=="function")return yL(g)?1:0;if(g!=null){if(g=g.$$typeof,g===L)return 11;if(g===R)return 14}return 2}function vd(g,y){var w=g.alternate;return w===null?(w=xa(g.tag,y,g.key,g.mode),w.elementType=g.elementType,w.type=g.type,w.stateNode=g.stateNode,w.alternate=g,g.alternate=w):(w.pendingProps=y,w.type=g.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=g.flags&14680064,w.childLanes=g.childLanes,w.lanes=g.lanes,w.child=g.child,w.memoizedProps=g.memoizedProps,w.memoizedState=g.memoizedState,w.updateQueue=g.updateQueue,y=g.dependencies,w.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},w.sibling=g.sibling,w.index=g.index,w.ref=g.ref,w}function nA(g,y,w,k,I,F){var B=2;if(k=g,typeof g=="function")yL(g)&&(B=1);else if(typeof g=="string")B=5;else e:switch(g){case E:return Wp(w.children,I,F,y);case _:B=8,I|=8;break;case D:return g=xa(12,w,y,I|2),g.elementType=D,g.lanes=F,g;case O:return g=xa(13,w,y,I),g.elementType=O,g.lanes=F,g;case M:return g=xa(19,w,y,I),g.elementType=M,g.lanes=F,g;case j:return rA(w,I,F,y);default:if(typeof g=="object"&&g!==null)switch(g.$$typeof){case N:B=10;break e;case T:B=9;break e;case L:B=11;break e;case R:B=14;break e;case P:B=16,k=null;break e}throw Error(n(130,g==null?g:typeof g,""))}return y=xa(B,w,y,I),y.elementType=g,y.type=k,y.lanes=F,y}function Wp(g,y,w,k){return g=xa(7,g,k,y),g.lanes=w,g}function rA(g,y,w,k){return g=xa(22,g,k,y),g.elementType=j,g.lanes=w,g.stateNode={isHidden:!1},g}function xL(g,y,w){return g=xa(6,g,null,y),g.lanes=w,g}function bL(g,y,w){return y=xa(4,g.children!==null?g.children:[],g.key,y),y.lanes=w,y.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},y}function GTe(g,y,w,k,I){this.tag=y,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=GM(0),this.expirationTimes=GM(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=GM(0),this.identifierPrefix=k,this.onRecoverableError=I,this.mutableSourceEagerHydrationData=null}function vL(g,y,w,k,I,F,B,Q,te){return g=new GTe(g,y,w,Q,te),y===1?(y=1,F===!0&&(y|=8)):y=0,F=xa(3,null,null,y),g.current=F,F.stateNode=g,F.memoizedState={element:k,isDehydrated:w,cache:null,transitions:null,pendingSuspenseBoundaries:null},F4(F),g}function HTe(g,y,w){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:A,key:k==null?null:""+k,children:g,containerInfo:y,implementation:w}}function LQ(g){if(!g)return fd;g=g._reactInternals;e:{if(Nc(g)!==g||g.tag!==1)throw Error(n(170));var y=g;do{switch(y.tag){case 3:y=y.stateNode.context;break e;case 1:if(so(y.type)){y=y.stateNode.__reactInternalMemoizedMergedChildContext;break e}}y=y.return}while(y!==null);throw Error(n(171))}if(g.tag===1){var w=g.type;if(so(w))return fK(g,w,y)}return y}function PQ(g,y,w,k,I,F,B,Q,te){return g=vL(w,k,!0,g,I,F,B,Q,te),g.context=LQ(null),w=g.current,k=Ds(),I=xd(w),F=Lc(k,I),F.callback=y??null,pd(w,F,I),g.current.lanes=I,dv(g,I,k),uo(g,k),g}function iA(g,y,w,k){var I=y.current,F=Ds(),B=xd(I);return w=LQ(w),y.context===null?y.context=w:y.pendingContext=w,y=Lc(F,B),y.payload={element:g},k=k===void 0?null:k,k!==null&&(y.callback=k),g=pd(I,y,B),g!==null&&(uu(g,I,B,F),OE(g,I,B)),B}function sA(g){if(g=g.current,!g.child)return null;switch(g.child.tag){case 5:return g.child.stateNode;default:return g.child.stateNode}}function BQ(g,y){if(g=g.memoizedState,g!==null&&g.dehydrated!==null){var w=g.retryLane;g.retryLane=w!==0&&w<y?w:y}}function wL(g,y){BQ(g,y),(g=g.alternate)&&BQ(g,y)}var zQ=typeof reportError=="function"?reportError:function(g){console.error(g)};function $L(g){this._internalRoot=g}oA.prototype.render=$L.prototype.render=function(g){var y=this._internalRoot;if(y===null)throw Error(n(409));iA(g,y,null,null)},oA.prototype.unmount=$L.prototype.unmount=function(){var g=this._internalRoot;if(g!==null){this._internalRoot=null;var y=g.containerInfo;zp(function(){iA(null,g,null,null)}),y[Dc]=null}};function oA(g){this._internalRoot=g}oA.prototype.unstable_scheduleHydration=function(g){if(g){var y=CY();g={blockedOn:null,target:g,priority:y};for(var w=0;w<od.length&&y!==0&&y<od[w].priority;w++);od.splice(w,0,g),w===0&&EY(g)}};function CL(g){return!(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)}function aA(g){return!(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11&&(g.nodeType!==8||g.nodeValue!==" react-mount-point-unstable "))}function UQ(){}function XTe(g,y,w,k,I){if(I){if(typeof k=="function"){var F=k;k=function(){var ge=sA(B);F.call(ge)}}var B=PQ(y,k,g,0,null,!1,!1,"",UQ);return g._reactRootContainer=B,g[Dc]=B.current,Ev(g.nodeType===8?g.parentNode:g),zp(),B}for(;I=g.lastChild;)g.removeChild(I);if(typeof k=="function"){var Q=k;k=function(){var ge=sA(te);Q.call(ge)}}var te=vL(g,0,!1,null,null,!1,!1,"",UQ);return g._reactRootContainer=te,g[Dc]=te.current,Ev(g.nodeType===8?g.parentNode:g),zp(function(){iA(y,te,w,k)}),te}function uA(g,y,w,k,I){var F=w._reactRootContainer;if(F){var B=F;if(typeof I=="function"){var Q=I;I=function(){var te=sA(B);Q.call(te)}}iA(y,B,g,I)}else B=XTe(w,y,g,I,k);return sA(B)}wY=function(g){switch(g.tag){case 3:var y=g.stateNode;if(y.current.memoizedState.isDehydrated){var w=vr(y.pendingLanes);w!==0&&(HM(y,w|1),uo(y,rr()),!(tn&6)&&(r1=rr()+500,dd()))}break;case 13:zp(function(){var k=Mc(g,1);if(k!==null){var I=Ds();uu(k,g,1,I)}}),wL(g,1)}},XM=function(g){if(g.tag===13){var y=Mc(g,134217728);if(y!==null){var w=Ds();uu(y,g,134217728,w)}wL(g,134217728)}},$Y=function(g){if(g.tag===13){var y=xd(g),w=Mc(g,y);if(w!==null){var k=Ds();uu(w,g,y,k)}wL(g,y)}},CY=function(){return vn},SY=function(g,y){var w=vn;try{return vn=g,y()}finally{vn=w}},ov=function(g,y,w){switch(y){case"input":if(gt(g,w),y=w.name,w.type==="radio"&&y!=null){for(w=g;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll("input[name="+JSON.stringify(""+y)+'][type="radio"]'),y=0;y<w.length;y++){var k=w[y];if(k!==g&&k.form===g.form){var I=kE(k);if(!I)throw Error(n(90));G(k),gt(k,I)}}}break;case"textarea":si(g,w);break;case"select":y=w.value,y!=null&&Fi(g,!!w.multiple,y,!1)}},eE=pL,tE=zp;var YTe={usingClientEntryPoint:!1,Events:[Tv,V0,kE,Zk,Jk,pL]},Wv={findFiberByHostInstance:Dp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KTe={bundleType:Wv.bundleType,version:Wv.version,rendererPackageName:Wv.rendererPackageName,rendererConfig:Wv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(g){return g=sE(g),g===null?null:g.stateNode},findFiberByHostInstance:Wv.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lA=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lA.isDisabled&&lA.supportsFiber)try{oe=lA.inject(KTe),Se=lA}catch{}}return lo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YTe,lo.createPortal=function(g,y){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!CL(y))throw Error(n(200));return HTe(g,y,null,w)},lo.createRoot=function(g,y){if(!CL(g))throw Error(n(299));var w=!1,k="",I=zQ;return y!=null&&(y.unstable_strictMode===!0&&(w=!0),y.identifierPrefix!==void 0&&(k=y.identifierPrefix),y.onRecoverableError!==void 0&&(I=y.onRecoverableError)),y=vL(g,1,!1,null,null,w,!1,k,I),g[Dc]=y.current,Ev(g.nodeType===8?g.parentNode:g),new $L(y)},lo.findDOMNode=function(g){if(g==null)return null;if(g.nodeType===1)return g;var y=g._reactInternals;if(y===void 0)throw typeof g.render=="function"?Error(n(188)):(g=Object.keys(g).join(","),Error(n(268,g)));return g=sE(y),g=g===null?null:g.stateNode,g},lo.flushSync=function(g){return zp(g)},lo.hydrate=function(g,y,w){if(!aA(y))throw Error(n(200));return uA(null,g,y,!0,w)},lo.hydrateRoot=function(g,y,w){if(!CL(g))throw Error(n(405));var k=w!=null&&w.hydratedSources||null,I=!1,F="",B=zQ;if(w!=null&&(w.unstable_strictMode===!0&&(I=!0),w.identifierPrefix!==void 0&&(F=w.identifierPrefix),w.onRecoverableError!==void 0&&(B=w.onRecoverableError)),y=PQ(y,null,g,1,w??null,I,!1,F,B),g[Dc]=y.current,Ev(g),k)for(g=0;g<k.length;g++)w=k[g],I=w._getVersion,I=I(w._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[w,I]:y.mutableSourceEagerHydrationData.push(w,I);return new oA(y)},lo.render=function(g,y,w){if(!aA(y))throw Error(n(200));return uA(null,g,y,!1,w)},lo.unmountComponentAtNode=function(g){if(!aA(g))throw Error(n(40));return g._reactRootContainer?(zp(function(){uA(null,null,g,!1,function(){g._reactRootContainer=null,g[Dc]=null})}),!0):!1},lo.unstable_batchedUpdates=pL,lo.unstable_renderSubtreeIntoContainer=function(g,y,w,k){if(!aA(w))throw Error(n(200));if(g==null||g._reactInternals===void 0)throw Error(n(38));return uA(g,y,w,!1,k)},lo.version="18.3.1-next-f1338f8080-20240426",lo}var KQ;function sIe(){if(KQ)return EL.exports;KQ=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),EL.exports=iIe(),EL.exports}var QQ;function oIe(){if(QQ)return cA;QQ=1;var e=sIe();return cA.createRoot=e.createRoot,cA.hydrateRoot=e.hydrateRoot,cA}var aIe=oIe();const uIe="modulepreload",lIe=function(e){return"/linear-regression/"+e},ZQ={},V7=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(u=>{if(u=lIe(u),u in ZQ)return;ZQ[u]=!0;const l=u.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${c}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":uIe,l||(f.as="script"),f.crossOrigin="",f.href=u,a&&f.setAttribute("nonce",a),document.head.appendChild(f),l)return new Promise((d,h)=>{f.addEventListener("load",d),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})};function cIe(){return lt.jsxs("header",{children:[lt.jsx("h1",{className:"font-bold",children:"Linear Regression with TensorFlow.js"}),lt.jsx("p",{children:"Train a model to predict house price from living space."})]})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fIe=1e-7,dIe=1e-4;class q7{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class gD{refCount(t){return co("refCount")}incRef(t){return co("incRef")}timerAvailable(){return!0}time(t){return co("time")}read(t){return co("read")}readSync(t){return co("readSync")}readToGPU(t,n){return co("readToGPU")}numDataIds(){return co("numDataIds")}disposeData(t,n){return co("disposeData")}write(t,n,r){return co("write")}move(t,n,r,i,s){return co("move")}createTensorFromGPUData(t,n,r){return co("createTensorFromGPUData")}memory(){return co("memory")}floatPrecision(){return co("floatPrecision")}epsilon(){return this.floatPrecision()===32?fIe:dIe}dispose(){return co("dispose")}}function co(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,ef(e,t,n)}function hIe(e,t){if(e.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,ef(e,n,r),ef(t,n,r)}function lh(e,t,n){return Math.max(e,Math.min(t,n))}function mD(e){return e%2===0?e:e+1}function ef(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Mue(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function pIe(e,t){const n=Math.random();return t*n+(1-n)*e}function gIe(e,t){let n=0;for(let r=0;r<e.length;r++){const i=Number(e[r])-Number(t[r]);n+=i*i}return n}function U(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Ci(e,t,n=""){U(Gt(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function Pm(e){U(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function me(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function mIe(e){return e.length===0}function Lue(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function Gt(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Jg(e){return e%1===0}function yIe(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{const t=Math.exp(2*e);return(t-1)/(t+1)}}function PT(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function xIe(e){const t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return G7(t),t}function Og(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function r6(e,t=i=>0,n,r){return new Promise((i,s)=>{let o=0;const a=()=>{if(e()){i();return}o++;const u=t(o);if(n!=null&&o>=n){s();return}r!=null?r(a,u):setTimeout(a,u)};a()})}function H7(e,t){let n=1,r=-1;for(let s=0;s<e.length;++s)if(e[s]>=0)n*=e[s];else if(e[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(e[s]<0)throw Error(`Shapes can not be < 0. Found ${e[s]} at dim ${s}`);if(r===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const i=e.slice();return i[r]=t/n,i}function Ot(e,t){const n=t.length;return e=e==null?t.map((r,i)=>i):[].concat(e),U(e.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),U(e.every(r=>Jg(r)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(r=>r<0?n+r:r)}function Lf(e,t){const n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,s=t==null||i?null:Ot(t,e).sort();let o=0;for(let a=0;a<e.length;++a){if(s!=null){if(s[o]===a&&e[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${e[a]}' is not 1`);(s[o]==null||s[o]>a)&&e[a]===1&&(n.push(e[a]),r.push(a)),s[o]<=a&&o++}e[a]!==1&&(n.push(e[a]),r.push(a))}return{newShape:n,keptDims:r}}function Zr(e,t){return ur(e,t)}function ur(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function Pue(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function Bue(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function X7(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function Fw(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function zue(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function kl(e){return typeof e=="string"||e instanceof String}function Uue(e){return typeof e=="boolean"}function BT(e){return typeof e=="number"}function Bm(e){return Array.isArray(e)?Bm(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":BT(e)?"float32":kl(e)?"string":Uue(e)?"bool":"float32"}function ch(e){return!!(e&&e.constructor&&e.call&&e.apply)}function zT(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function ut(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function jue(e,t,n,r=!1){const i=new Array;if(t.length===1){const s=t[0]*(r?2:1);for(let o=0;o<s;o++)i[o]=n[e+o]}else{const s=t[0],o=t.slice(1),a=o.reduce((u,l)=>u*l)*(r?2:1);for(let u=0;u<s;u++)i[u]=jue(e+u*a,o,n,r)}return i}function Oa(e,t,n=!1){if(e.length===0)return t[0];const r=e.reduce((i,s)=>i*s)*(n?2:1);if(r===0)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return jue(0,e,t,n)}function Wue(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function yD(e,t){const n=vi(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function vi(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function Y7(e,t){const n=e.reduce((r,i)=>r*i,1);if(t==null||t==="float32")return Oa(e,new Float32Array(n));if(t==="int32")return Oa(e,new Int32Array(n));if(t==="bool")return Oa(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function zo(e){e.forEach(t=>{U(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function _u(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function zm(e,t,n){if(t===0)return[];if(t===1)return[e];const r=new Array(t);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}function xD(e){return e&&e.then&&typeof e.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JQ="tfjsflags";class Vue{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=bIe,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(ce().getBool("IS_TEST")||ce().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){const i=this.urlFlags[t];ce().getBool("IS_TEST")||ce().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(xD(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);JQ in t&&t[JQ].split(",").forEach(r=>{const[i,s]=r.split(":");this.urlFlags[i]=wIe(i,s)})}}function bIe(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(vIe(t,r[0],r[1]),r.join("="))),t}function vIe(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function wIe(e,t){const n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function ce(){return K7}let K7=null;function $Ie(e){K7=e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let TL;function que(){if(TL==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");TL=e}return TL}function CIe(){const e=que();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function Q7(e,t){const n=CIe();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const hC="Abs",ax="Acos",ux="Acosh",Um="Add",pC="AddN",bD="All",vD="Any",gC="ArgMax",mC="ArgMin",lx="Asin",cx="Asinh",fx="Atan",dx="Atanh",hx="Atan2",yC="AvgPool",wD="AvgPoolGrad",xC="AvgPool3D",$D="AvgPool3DGrad",bC="BatchMatMul",vC="BatchToSpaceND",CD="Bincount",wC="BitwiseAnd",Gue="BroadcastTo",SD="BroadcastArgs",px="Cast",gx="Ceil",mx="ClipByValue",kD="Complex",$C="ComplexAbs",CC="Concat",SC="Conv2D",ED="Conv2DBackpropFilter",kC="Conv2DBackpropInput",EC="Conv3D",AD="Conv3DBackpropFilterV2",_D="Conv3DBackpropInputV2",yx="Cos",xx="Cosh",TD="Cumprod",AC="Cumsum",ID="CropAndResize",ND="DenseBincount",DD="DepthToSpace",_C="DepthwiseConv2dNative",FD="DepthwiseConv2dNativeBackpropFilter",RD="DepthwiseConv2dNativeBackpropInput",OD="Diag",TC="Dilation2D",UT="Dilation2DBackpropInput",jT="Dilation2DBackpropFilter",MD="Draw",bx="RealDiv",LD="Einsum",vx="Elu",PD="EluGrad",wx="Erf",IC="Equal",$x="Exp",NC="ExpandDims",Cx="Expm1",BD="FFT",zD="Fill",UD="FlipLeftRight",Sx="Floor",kx="FloorDiv",DC="FusedBatchNorm",FC="GatherV2",jD="GatherNd",RC="Greater",Ex="GreaterEqual",Ax="Identity",WD="IFFT",VD="Imag",_x="IsFinite",Tx="IsInf",Ix="IsNan",OC="LeakyRelu",MC="Less",LC="LessEqual",qD="LinSpace",Nx="Log",Dx="Log1p",PC="LogicalAnd",BC="LogicalNot",zC="LogicalOr",SIe="LogicalXor",Hue="LogSoftmax",kIe="LowerBound",UC="LRN",GD="LRNGrad",EIe="MatrixBandPart",jC="Max",Fx="Maximum",WC="MaxPool",HD="MaxPoolGrad",VC="MaxPool3D",XD="MaxPool3DGrad",YD="MaxPoolWithArgmax",qC="Mean",GC="Min",Rx="Minimum",HC="MirrorPad",Ox="Mod",KD="Multinomial",Mx="Multiply",XC="Neg",YC="NotEqual",QD="NonMaxSuppressionV3",ZD="NonMaxSuppressionV4",JD="NonMaxSuppressionV5",KC="OnesLike",QC="OneHot",ZC="Pack",JC="PadV2",AIe="Pool",Lx="Pow",eS="Prelu",tS="Prod",eF="RaggedGather",tF="RaggedRange",nF="RaggedTensorToTensor",rF="Range",iF="Real",Px="Reciprocal",Bx="Relu",nS="Reshape",rS="ResizeNearestNeighbor",sF="ResizeNearestNeighborGrad",iS="ResizeBilinear",oF="ResizeBilinearGrad",zx="Relu6",sS="Reverse",Ux="Round",jx="Rsqrt",aF="ScatterNd",uF="TensorScatterUpdate",lF="SearchSorted",oS="Select",Wx="Selu",aS="Slice",Vx="Sin",qx="Sinh",Gx="Sign",Hx="Sigmoid",Xx="Softplus",Yx="Sqrt",uS="Sum",lS="SpaceToBatchND",cS="SplitV",fS="Softmax",cF="SparseFillEmptyRows",fF="SparseReshape",dF="SparseSegmentMean",hF="SparseSegmentSum",pF="SparseToDense",Kx="SquaredDifference",gF="Square",dS="StaticRegexReplace",mF="StridedSlice",yF="StringNGrams",xF="StringSplit",bF="StringToHashBucketFast",Qx="Sub",Zx="Tan",Jx="Tanh",eb="Tile",vF="TopK",wF="Transform",Mg="Transpose",$F="Unique",hS="Unpack",pS="UnsortedSegmentSum",_Ie="UpperBound",gS="ZerosLike",tb="Step",WT="FromPixels",CF="RotateWithOffset",Rw="_FusedMatMul",Ow="FusedConv2D",Mw="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qo(...e){ce().getBool("IS_TEST")||ce().getBool("PROD")||console.warn(...e)}function TIe(...e){ce().getBool("IS_TEST")||ce().getBool("PROD")||console.log(...e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ny=Q7("kernelRegistry",()=>new Map),Lw=Q7("gradRegistry",()=>new Map);function Pw(e,t){const n=Z7(e,t);return ny.get(n)}function i6(e){return Lw.get(e)}function VT(e){const t=ny.entries(),n=[];for(;;){const{done:r,value:i}=t.next();if(r)break;const[s,o]=i,[a]=s.split("_");a===e&&n.push(o)}return n}function SF(e){const{kernelName:t,backendName:n}=e,r=Z7(t,n);ny.has(r)&&Qo(`The kernel '${t}' for backend '${n}' is already registered`),ny.set(r,e)}function Xue(e){const{kernelName:t}=e;Lw.has(t)&&ce().getBool("DEBUG")&&Qo(`Overriding the gradient for '${t}'`),Lw.set(t,e)}function IIe(e,t){const n=Z7(e,t);if(!ny.has(n))throw new Error(`The kernel '${e}' for backend '${t}' is not registered`);ny.delete(n)}function NIe(e){if(!Lw.has(e))throw new Error(`The gradient '${e}' for backend is not registered`);Lw.delete(e)}function DIe(e,t){VT(e).forEach(r=>{const i=Object.assign({},r,{backendName:t});SF(i)})}function Z7(e,t){return`${t}_${e}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yue(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var IL,eZ;function FIe(){if(eZ)return IL;eZ=1,IL=t;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(N,T,L){this.low=N|0,this.high=T|0,this.unsigned=!!L}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function n(N){return(N&&N.__isLong__)===!0}t.isLong=n;var r={},i={};function s(N,T){var L,O,M;return T?(N>>>=0,(M=0<=N&&N<256)&&(O=i[N],O)?O:(L=a(N,(N|0)<0?-1:0,!0),M&&(i[N]=L),L)):(N|=0,(M=-128<=N&&N<128)&&(O=r[N],O)?O:(L=a(N,N<0?-1:0,!1),M&&(r[N]=L),L))}t.fromInt=s;function o(N,T){if(isNaN(N))return T?v:b;if(T){if(N<0)return v;if(N>=p)return E}else{if(N<=-m)return _;if(N+1>=m)return A}return N<0?o(-N,T).neg():a(N%h|0,N/h|0,T)}t.fromNumber=o;function a(N,T,L){return new t(N,T,L)}t.fromBits=a;var u=Math.pow;function l(N,T,L){if(N.length===0)throw Error("empty string");if(N==="NaN"||N==="Infinity"||N==="+Infinity"||N==="-Infinity")return b;if(typeof T=="number"?(L=T,T=!1):T=!!T,L=L||10,L<2||36<L)throw RangeError("radix");var O;if((O=N.indexOf("-"))>0)throw Error("interior hyphen");if(O===0)return l(N.substring(1),T,L).neg();for(var M=o(u(L,8)),R=b,P=0;P<N.length;P+=8){var j=Math.min(8,N.length-P),z=parseInt(N.substring(P,P+j),L);if(j<8){var q=o(u(L,j));R=R.mul(q).add(o(z))}else R=R.mul(M),R=R.add(o(z))}return R.unsigned=T,R}t.fromString=l;function c(N,T){return typeof N=="number"?o(N,T):typeof N=="string"?l(N,T):a(N.low,N.high,typeof T=="boolean"?T:N.unsigned)}t.fromValue=c;var f=65536,d=1<<24,h=f*f,p=h*h,m=p/2,x=s(d),b=s(0);t.ZERO=b;var v=s(0,!0);t.UZERO=v;var $=s(1);t.ONE=$;var C=s(1,!0);t.UONE=C;var S=s(-1);t.NEG_ONE=S;var A=a(-1,2147483647,!1);t.MAX_VALUE=A;var E=a(-1,-1,!0);t.MAX_UNSIGNED_VALUE=E;var _=a(0,-2147483648,!1);t.MIN_VALUE=_;var D=t.prototype;return D.toInt=function(){return this.unsigned?this.low>>>0:this.low},D.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},D.toString=function(T){if(T=T||10,T<2||36<T)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(_)){var L=o(T),O=this.div(L),M=O.mul(L).sub(this);return O.toString(T)+M.toInt().toString(T)}else return"-"+this.neg().toString(T);for(var R=o(u(T,6),this.unsigned),P=this,j="";;){var z=P.div(R),q=P.sub(z.mul(R)).toInt()>>>0,H=q.toString(T);if(P=z,P.isZero())return H+j;for(;H.length<6;)H="0"+H;j=""+H+j}},D.getHighBits=function(){return this.high},D.getHighBitsUnsigned=function(){return this.high>>>0},D.getLowBits=function(){return this.low},D.getLowBitsUnsigned=function(){return this.low>>>0},D.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var T=this.high!=0?this.high:this.low,L=31;L>0&&!(T&1<<L);L--);return this.high!=0?L+33:L+1},D.isZero=function(){return this.high===0&&this.low===0},D.eqz=D.isZero,D.isNegative=function(){return!this.unsigned&&this.high<0},D.isPositive=function(){return this.unsigned||this.high>=0},D.isOdd=function(){return(this.low&1)===1},D.isEven=function(){return(this.low&1)===0},D.equals=function(T){return n(T)||(T=c(T)),this.unsigned!==T.unsigned&&this.high>>>31===1&&T.high>>>31===1?!1:this.high===T.high&&this.low===T.low},D.eq=D.equals,D.notEquals=function(T){return!this.eq(T)},D.neq=D.notEquals,D.ne=D.notEquals,D.lessThan=function(T){return this.comp(T)<0},D.lt=D.lessThan,D.lessThanOrEqual=function(T){return this.comp(T)<=0},D.lte=D.lessThanOrEqual,D.le=D.lessThanOrEqual,D.greaterThan=function(T){return this.comp(T)>0},D.gt=D.greaterThan,D.greaterThanOrEqual=function(T){return this.comp(T)>=0},D.gte=D.greaterThanOrEqual,D.ge=D.greaterThanOrEqual,D.compare=function(T){if(n(T)||(T=c(T)),this.eq(T))return 0;var L=this.isNegative(),O=T.isNegative();return L&&!O?-1:!L&&O?1:this.unsigned?T.high>>>0>this.high>>>0||T.high===this.high&&T.low>>>0>this.low>>>0?-1:1:this.sub(T).isNegative()?-1:1},D.comp=D.compare,D.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add($)},D.neg=D.negate,D.add=function(T){n(T)||(T=c(T));var L=this.high>>>16,O=this.high&65535,M=this.low>>>16,R=this.low&65535,P=T.high>>>16,j=T.high&65535,z=T.low>>>16,q=T.low&65535,H=0,V=0,X=0,re=0;return re+=R+q,X+=re>>>16,re&=65535,X+=M+z,V+=X>>>16,X&=65535,V+=O+j,H+=V>>>16,V&=65535,H+=L+P,H&=65535,a(X<<16|re,H<<16|V,this.unsigned)},D.subtract=function(T){return n(T)||(T=c(T)),this.add(T.neg())},D.sub=D.subtract,D.multiply=function(T){if(this.isZero())return b;if(n(T)||(T=c(T)),e){var L=e.mul(this.low,this.high,T.low,T.high);return a(L,e.get_high(),this.unsigned)}if(T.isZero())return b;if(this.eq(_))return T.isOdd()?_:b;if(T.eq(_))return this.isOdd()?_:b;if(this.isNegative())return T.isNegative()?this.neg().mul(T.neg()):this.neg().mul(T).neg();if(T.isNegative())return this.mul(T.neg()).neg();if(this.lt(x)&&T.lt(x))return o(this.toNumber()*T.toNumber(),this.unsigned);var O=this.high>>>16,M=this.high&65535,R=this.low>>>16,P=this.low&65535,j=T.high>>>16,z=T.high&65535,q=T.low>>>16,H=T.low&65535,V=0,X=0,re=0,le=0;return le+=P*H,re+=le>>>16,le&=65535,re+=R*H,X+=re>>>16,re&=65535,re+=P*q,X+=re>>>16,re&=65535,X+=M*H,V+=X>>>16,X&=65535,X+=R*q,V+=X>>>16,X&=65535,X+=P*z,V+=X>>>16,X&=65535,V+=O*H+M*q+R*z+P*j,V&=65535,a(re<<16|le,V<<16|X,this.unsigned)},D.mul=D.multiply,D.divide=function(T){if(n(T)||(T=c(T)),T.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&T.low===-1&&T.high===-1)return this;var L=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,T.low,T.high);return a(L,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?v:b;var O,M,R;if(this.unsigned){if(T.unsigned||(T=T.toUnsigned()),T.gt(this))return v;if(T.gt(this.shru(1)))return C;R=v}else{if(this.eq(_)){if(T.eq($)||T.eq(S))return _;if(T.eq(_))return $;var P=this.shr(1);return O=P.div(T).shl(1),O.eq(b)?T.isNegative()?$:S:(M=this.sub(T.mul(O)),R=O.add(M.div(T)),R)}else if(T.eq(_))return this.unsigned?v:b;if(this.isNegative())return T.isNegative()?this.neg().div(T.neg()):this.neg().div(T).neg();if(T.isNegative())return this.div(T.neg()).neg();R=b}for(M=this;M.gte(T);){O=Math.max(1,Math.floor(M.toNumber()/T.toNumber()));for(var j=Math.ceil(Math.log(O)/Math.LN2),z=j<=48?1:u(2,j-48),q=o(O),H=q.mul(T);H.isNegative()||H.gt(M);)O-=z,q=o(O,this.unsigned),H=q.mul(T);q.isZero()&&(q=$),R=R.add(q),M=M.sub(H)}return R},D.div=D.divide,D.modulo=function(T){if(n(T)||(T=c(T)),e){var L=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,T.low,T.high);return a(L,e.get_high(),this.unsigned)}return this.sub(this.div(T).mul(T))},D.mod=D.modulo,D.rem=D.modulo,D.not=function(){return a(~this.low,~this.high,this.unsigned)},D.and=function(T){return n(T)||(T=c(T)),a(this.low&T.low,this.high&T.high,this.unsigned)},D.or=function(T){return n(T)||(T=c(T)),a(this.low|T.low,this.high|T.high,this.unsigned)},D.xor=function(T){return n(T)||(T=c(T)),a(this.low^T.low,this.high^T.high,this.unsigned)},D.shiftLeft=function(T){return n(T)&&(T=T.toInt()),(T&=63)===0?this:T<32?a(this.low<<T,this.high<<T|this.low>>>32-T,this.unsigned):a(0,this.low<<T-32,this.unsigned)},D.shl=D.shiftLeft,D.shiftRight=function(T){return n(T)&&(T=T.toInt()),(T&=63)===0?this:T<32?a(this.low>>>T|this.high<<32-T,this.high>>T,this.unsigned):a(this.high>>T-32,this.high>=0?0:-1,this.unsigned)},D.shr=D.shiftRight,D.shiftRightUnsigned=function(T){if(n(T)&&(T=T.toInt()),T&=63,T===0)return this;var L=this.high;if(T<32){var O=this.low;return a(O>>>T|L<<32-T,L>>>T,this.unsigned)}else return T===32?a(L,0,this.unsigned):a(L>>>T-32,0,this.unsigned)},D.shru=D.shiftRightUnsigned,D.shr_u=D.shiftRightUnsigned,D.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},D.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},D.toBytes=function(T){return T?this.toBytesLE():this.toBytesBE()},D.toBytesLE=function(){var T=this.high,L=this.low;return[L&255,L>>>8&255,L>>>16&255,L>>>24,T&255,T>>>8&255,T>>>16&255,T>>>24]},D.toBytesBE=function(){var T=this.high,L=this.low;return[T>>>24,T>>>16&255,T>>>8&255,T&255,L>>>24,L>>>16&255,L>>>8&255,L&255]},t.fromBytes=function(T,L,O){return O?t.fromBytesLE(T,L):t.fromBytesBE(T,L)},t.fromBytesLE=function(T,L){return new t(T[0]|T[1]<<8|T[2]<<16|T[3]<<24,T[4]|T[5]<<8|T[6]<<16|T[7]<<24,L)},t.fromBytesBE=function(T,L){return new t(T[4]<<24|T[5]<<16|T[6]<<8|T[7],T[0]<<24|T[1]<<16|T[2]<<8|T[3],L)},IL}var Kue=FIe();const Que=ox(Kue),RIe=ZTe({__proto__:null,default:Que},[Kue]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gg=Que||RIe;function mS(e){return gg.fromString(e,!0,16)}const Zue=mS("c3a5c85c97cb3127"),lg=mS("b492b66fbe98f273"),as=mS("9ae16a3b2f90404f");function s6(e){return e.xor(e.shru(47))}function Jue(e,t,n){const r=e.slice(t,t+n);return gg.fromBytes(Array.from(r),!0,!0)}function In(e,t){return Jue(e,t,8)}function tZ(e,t){return Jue(e,t,4)}function Wr(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function Zd(e,t,n=mS("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function OIe(e,t,n,r,i,s){i=i.add(e),s=Wr(s.add(i).add(r),21);const o=i;return i=i.add(t),i=i.add(n),s=s.add(Wr(i,44)),[i.add(r),s.add(o)]}function fA(e,t,n,r){return OIe(In(e,t),In(e,t+8),In(e,t+16),In(e,t+24),n,r)}function MIe(e,t=e.length){if(t>=8){const n=as.add(t*2),r=In(e,0).add(as),i=In(e,t-8),s=Wr(i,37).mul(n).add(r),o=Wr(r,25).add(i).mul(n);return Zd(s,o,n)}if(t>=4){const n=as.add(t*2),r=tZ(e,0);return Zd(r.shl(3).add(t),tZ(e,t-4),n)}if(t>0){const n=e[0],r=e[t>>1],i=e[t-1],s=n+(r<<8),o=t+(i<<2);return s6(as.mul(s).xor(Zue.mul(o))).mul(as)}return as}function LIe(e,t=e.length){const n=as.add(t*2),r=In(e,0).mul(lg),i=In(e,8),s=In(e,t-8).mul(n),o=In(e,t-16).mul(as);return Zd(Wr(r.add(i),43).add(Wr(s,30)).add(o),r.add(Wr(i.add(as),18)).add(s),n)}function PIe(e,t=e.length){const n=as.add(t*2),r=In(e,0).mul(as),i=In(e,8),s=In(e,t-8).mul(n),o=In(e,t-16).mul(as),a=Wr(r.add(i),43).add(Wr(s,30)).add(o),u=Zd(a,r.add(Wr(i.add(as),18)).add(s),n),l=In(e,16).mul(n),c=In(e,24),f=a.add(In(e,t-32)).mul(n),d=u.add(In(e,t-24)).mul(n);return Zd(Wr(l.add(c),43).add(Wr(f,30)).add(d),l.add(Wr(c.add(r),18)).add(f),n)}function ele(e,t=e.length){const n=gg.fromNumber(81,!0);if(t<=32)return t<=16?MIe(e,t):LIe(e,t);if(t<=64)return PIe(e,t);let r=n,i=n.mul(lg).add(113),s=s6(i.mul(as).add(113)).mul(as),o=[gg.UZERO,gg.UZERO],a=[gg.UZERO,gg.UZERO];r=r.mul(as).add(In(e,0));let u=0;const l=(t-1>>6)*64,c=l+(t-1&63)-63;do r=Wr(r.add(i).add(o[0]).add(In(e,u+8)),37).mul(lg),i=Wr(i.add(o[1]).add(In(e,u+48)),42).mul(lg),r=r.xor(a[1]),i=i.add(o[0]).add(In(e,u+40)),s=Wr(s.add(a[0]),33).mul(lg),o=fA(e,u,o[1].mul(lg),r.add(a[0])),a=fA(e,u+32,s.add(a[1]),i.add(In(e,u+16))),[s,r]=[r,s],u+=64;while(u!==l);const f=lg.add(s.and(255).shl(1));return u=c,a[0]=a[0].add(t-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=Wr(r.add(i).add(o[0]).add(In(e,u+8)),37).mul(f),i=Wr(i.add(o[1]).add(In(e,u+48)),42).mul(f),r=r.xor(a[1].mul(9)),i=i.add(o[0].mul(9).add(In(e,u+40))),s=Wr(s.add(a[0]),33).mul(f),o=fA(e,u,o[1].mul(f),r.add(a[0])),a=fA(e,u+32,s.add(a[1]),i.add(In(e,u+16))),[s,r]=[r,s],Zd(Zd(o[0],a[0],f).add(s6(i).mul(Zue)).add(s),Zd(o[1],a[1],f).add(r),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pf(e,t){return t==="string"?Tl(e):Kh([e],t)}function BIe(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Kh(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=jl(e)),ce().getBool("DEBUG")&&Pue(e,t),BIe(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){const n=new Uint8Array(e.length);for(let r=0;r<n.length;++r)Math.round(e[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${t}`)}function ci(){return ce().platform.now()}function zIe(e,t){return ce().platform.fetch(e,t)}function Tl(e,t="utf-8"){return t=t||"utf-8",ce().platform.encode(e,t)}function Sf(e,t="utf-8"){return t=t||"utf-8",ce().platform.decode(e,t)}function Ir(e){return ce().platform.isTypedArray!=null?ce().platform.isTypedArray(e):Yue(e)}function jl(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||xD(e)||e==null||Ir(e)&&n)t.push(e);else if(Array.isArray(e)||Ir(e))for(let r=0;r<e.length;++r)jl(e[r],t,n);else{let r=-1;for(const i of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)jl(e[i],t,n)}return t}const UIe=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Gt,arraysEqualWithNull:Lue,assert:U,assertNonNegativeIntegerDimensions:zo,assertNonNull:Pm,assertShapesMatch:Ci,bytesFromStringArray:zue,bytesPerElement:Fw,checkConversionForErrors:Pue,clamp:lh,computeStrides:ut,convertBackendValuesAndArrayBuffer:Wue,createScalarValue:Pf,createShuffledIndices:xIe,decodeString:Sf,distSquared:gIe,encodeString:Tl,fetch:zIe,fingerPrint64:ele,flatten:jl,getArrayFromDType:ur,getTypedArrayFromDType:Zr,hasEncodingLoss:X7,hexToLong:mS,indexToLoc:zm,inferDtype:Bm,inferFromImplicitShape:H7,isBoolean:Uue,isFunction:ch,isInt:Jg,isNumber:BT,isPromise:xD,isScalarShape:mIe,isString:kl,isTypedArray:Ir,isValidDtype:Bue,locToIndex:_u,makeOnesTypedArray:yD,makeZerosNestedTypedArray:Y7,makeZerosTypedArray:vi,nearestDivisor:zT,nearestLargerEven:mD,now:ci,parseAxisParam:Ot,randUniform:pIe,repeatedTry:r6,rightPad:Og,shuffle:G7,shuffleCombo:hIe,sizeFromShape:me,sizeToSquarishShape:PT,squeezeShape:Lf,sum:Mue,swap:ef,tanh:yIe,toNestedArray:Oa,toTypedArray:Kh},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jIe{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new VIe)}profileKernel(t,n,r){let i;const s=()=>{i=r()};let o;const a=ci();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(s);else{s();for(const l of i)l.dataSync();o=Promise.resolve({kernelMs:ci()-a})}if(ce().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let l=0;l<i.length;l++){const c=i[l];c.data().then(f=>{WIe(f,c.dtype,t)})}return{kernelName:t,outputs:i,inputs:n,timeMs:o.then(l=>l.kernelMs),extraInfo:o.then(l=>l.getExtraProfileInfo!=null?l.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:r,timeMs:i,inputs:s,extraInfo:o}=t;r.forEach(a=>{Promise.all([a.data(),i,o]).then(u=>{this.logger.logKernelProfile(n,a,u[0],u[1],s,u[2])})})}}function WIe(e,t,n){if(t!=="float32")return!1;for(let r=0;r<e.length;r++){const i=e[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${n}'`),!0}return!1}class VIe{logKernelProfile(t,n,r,i,s,o){const a=typeof i=="number"?Og(`${i}ms`,9):i.error,u=Og(t,25),l=n.rank,c=n.size,f=Og(n.shape.toString(),14);let d="";for(const h in s){const p=s[h];if(p!=null){const m=p.shape||n.shape,x=m.length;d+=`${h}: ${x}D ${x>0?m:""} `}}console.log(`%c${u}	%c${a}	%c${l}D ${f}	%c${c}	%c${d}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qIe(e,t,n){const r={},i={};for(let u=0;u<t.length;u++)r[t[u].id]=!0;for(let u=0;u<e.length;u++){const l=e[u],c=l.inputs;for(const f in c){const d=c[f];let h=!1;for(let p=0;p<t.length;p++)if(r[d.id]){l.outputs.forEach(m=>r[m.id]=!0),h=!0,i[l.id]=!0;break}if(h)break}}const s={};s[n.id]=!0;const o={};for(let u=e.length-1;u>=0;u--){const l=e[u],c=l.inputs;for(let f=0;f<l.outputs.length;f++)if(s[l.outputs[f].id]){for(const d in c)s[c[d].id]=!0,o[l.id]=!0;break}}const a=[];for(let u=0;u<e.length;u++){const l=e[u];if(i[l.id]&&o[l.id]){const c={};for(const d in l.inputs){const h=l.inputs[d];r[h.id]&&(c[d]=h)}const f=Object.assign({},l);f.inputs=c,f.outputs=l.outputs,a.push(f)}}return a}function GIe(e,t,n,r){for(let i=t.length-1;i>=0;i--){const s=t[i],o=[];if(s.outputs.forEach(u=>{const l=e[u.id];l!=null?o.push(l):o.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const a=s.gradient(o);for(const u in s.inputs){if(!(u in a))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(a)}.`);const l=n(()=>a[u]());if(l.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${l.dtype}'`);const c=s.inputs[u];if(!Gt(l.shape,c.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${u}' has shape '${l.shape}', which does not match the shape of the input '${c.shape}'`);if(e[c.id]==null)e[c.id]=l;else{const f=e[c.id];e[c.id]=r(f,l),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nZ=20,qv=3,NL=7;function HIe(e,t,n,r){const i=ut(t),s=XIe(e,t,n,i),o=t.length,a=Y_(e,t,n,i,s),u=["Tensor"];return r&&(u.push(`  dtype: ${n}`),u.push(`  rank: ${o}`),u.push(`  shape: [${t}]`),u.push("  values:")),u.push(a.map(l=>"    "+l).join(`
`)),u.join(`
`)}function XIe(e,t,n,r){const i=me(t),s=r[r.length-1],o=new Array(s).fill(0),a=t.length,u=n==="complex64"?D2(e):e;if(a>1)for(let l=0;l<i/s;l++){const c=l*s;for(let f=0;f<s;f++)o[f]=Math.max(o[f],N2(u[c+f],0,n).length)}return o}function N2(e,t,n){let r;return Array.isArray(e)?r=`${parseFloat(e[0].toFixed(NL))} + ${parseFloat(e[1].toFixed(NL))}j`:kl(e)?r=`'${e}'`:n==="bool"?r=tle(e):r=parseFloat(e.toFixed(NL)).toString(),Og(r,t)}function tle(e){return e===0?"false":"true"}function Y_(e,t,n,r,i,s=!0){const o=n==="complex64"?2:1,a=t[0],u=t.length;if(u===0){if(n==="complex64"){const m=D2(e);return[N2(m[0],0,n)]}return n==="bool"?[tle(e[0])]:[e[0].toString()]}if(u===1){if(a>nZ){const x=qv*o;let b=Array.from(e.slice(0,x)),v=Array.from(e.slice((a-qv)*o,a*o));return n==="complex64"&&(b=D2(b),v=D2(v)),["["+b.map(($,C)=>N2($,i[C],n)).join(", ")+", ..., "+v.map(($,C)=>N2($,i[a-qv+C],n)).join(", ")+"]"]}return["["+(n==="complex64"?D2(e):Array.from(e)).map((x,b)=>N2(x,i[b],n)).join(", ")+"]"]}const l=t.slice(1),c=r.slice(1),f=r[0]*o,d=[];if(a>nZ){for(let m=0;m<qv;m++){const x=m*f,b=x+f;d.push(...Y_(e.slice(x,b),l,n,c,i,!1))}d.push("...");for(let m=a-qv;m<a;m++){const x=m*f,b=x+f;d.push(...Y_(e.slice(x,b),l,n,c,i,m===a-1))}}else for(let m=0;m<a;m++){const x=m*f,b=x+f;d.push(...Y_(e.slice(x,b),l,n,c,i,m===a-1))}const h=u===2?",":"";d[0]="["+(a>0?d[0]+h:"");for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+h;let p=`,
`;for(let m=2;m<u;m++)p+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(s?"":p),d}function D2(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sr{constructor(t,n,r){if(this.dtype=n,this.shape=t.slice(),this.size=me(t),r!=null){const i=r.length;U(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||ur(n,this.size),this.strides=ut(t)}set(t,...n){n.length===0&&(n=[0]),U(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const i of t){if(i<0||i>=this.shape[n]){const s=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(s)}n++}let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=this.strides[i]*t[i];return this.values[r]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return yu().makeTensor(this.values,this.shape,this.dtype)}}let yu=null,T1=null;function YIe(e){yu=e}function KIe(e){T1=e}class nn{constructor(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=me(t),this.strides=ut(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return T1.buffer(this.shape,this.dtype,t)}bufferSync(){return T1.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Oa(this.shape,t,this.dtype==="complex64")}arraySync(){return Oa(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=yu().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(r=>Sf(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),yu().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=yu().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>Sf(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await yu().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),yu().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return T1.print(this,t)}clone(){return this.throwIfDisposed(),T1.clone(this)}toString(t=!1){const n=this.dataSync();return HIe(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),T1.cast(this,t)}variable(t=!0,n,r){return this.throwIfDisposed(),yu().makeVariable(this,t,n,r)}}Object.defineProperty(nn,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function ye(){return Q7("Tensor",()=>nn)}ye();class Bw extends nn{constructor(t,n,r,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=n,this.name=r}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Gt(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);yu().disposeTensor(this),this.dataId=t.dataId,yu().incRef(this,null)}dispose(){yu().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Bw,Symbol.hasInstance,{value:e=>e instanceof nn&&e.assign!=null&&e.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var o6;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(o6||(o6={}));var a6;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(a6||(a6={}));var u6;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(u6||(u6={}));var l6;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(l6||(l6={}));var c6;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(c6||(c6={}));const QIe={float32:l6,int32:a6,bool:u6,complex64:c6};function Gs(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return QIe[e][t]}function kF(e){return Gs(e,"int32")}function nle(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function rle(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tr(e,t){if(e.dtype===t.dtype)return[e,t];const n=Gs(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function ile(e,t){U(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function EF(e,t){return t.some(n=>n.id===e.id)}function kf(e){const t=[];return sle(e,t,new Set),t}function sle(e,t,n){if(e==null)return;if(e instanceof nn){t.push(e);return}if(!ZIe(e))return;const r=e;for(const i in r){const s=r[i];n.has(s)||(n.add(s),sle(s,t,n))}}function ZIe(e){return Array.isArray(e)||typeof e=="object"}const JIe=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:ile,getTensorsInContainer:kf,isTensorInList:EF,makeTypesMatch:tr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DL(e){return e.kernelName!=null}class rZ{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class ry{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new rZ}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const r=t[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,r=1){return t in this.registryFactory?(Qo(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:r},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(t);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new jIe(this.backendInstance),!0}setupRegisteredKernels(){VT(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){VT(t).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof gD)&&typeof r.then=="function"){const i=++this.pendingBackendInitId,s=r.then(o=>i<this.pendingBackendInitId?!1:(this.registry[t]=o,this.pendingBackendInit=null,!0)).catch(o=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,Qo(`Initialization of backend ${t} failed`),Qo(o.stack||o.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(r){return Qo(`Initialization of backend ${t} failed`),Qo(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const r=t[n],{success:i,asyncInit:s}=this.initializeBackend(r);if(s||i)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const r=this.state.tensorInfo.get(n),i=r.backend,s=this.readSync(n),o=i.refCount(n);i.disposeData(n,!0),r.backend=t,t.move(n,s,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let r=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}let i;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(i),()=>(i=n(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(t,n,r){t();try{const i=r();return n(),i}catch(i){throw n(),i}}nextTensorId(){return ry.nextTensorId++}nextVariableId(){return ry.nextVariableId++}clone(t){const n=Z.runKernel(Ax,{x:t}),r={x:t},i=o=>({x:()=>{const a="float32",u={x:o},l={dtype:a};return Z.runKernel(px,u,l)}}),s=[];return this.addTapeNode(this.state.activeScope.name,r,[n],i,s,{}),n}runKernel(t,n,r){if(this.backendName==null&&this.backend,!(Pw(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,r){const i=this.backend.numDataIds();let s=0;r.forEach(u=>{s+=u.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=i-n-s-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${t}'`)}runKernelFunc(t){let n,r=[];const i=this.isTapeOn(),s=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let u;const l=DL(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(DL(t)){const{kernelName:p,inputs:m,attrs:x}=t;this.backendName==null&&this.backend;const b=Pw(p,this.backendName);U(b!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const v=this.backend.numDataIds();u=b.kernelFunc({inputs:m,attrs:x,backend:this.backend});const $=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,v,$);const C=$.map(S=>S.rank!=null?S:this.makeTensorFromTensorInfo(S));if(i){const S=this.getTensorsForGradient(p,m,C);r=this.saveTensorsForBackwardMode(S)}return C}}else{const{forwardFunc:p}=t,m=x=>{i&&(r=x.map(b=>this.keep(this.clone(b))))};a=()=>{const x=this.backend.numDataIds();u=this.tidy(()=>p(this.backend,m));const b=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,x,b),b}}const{inputs:c,attrs:f}=t,d=DL(t)?null:t.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(h=this.profiler.profileKernel(l,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),n=h.outputs)}),i&&this.addTapeNode(l,c,n,d,r,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(u)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(t,n,r){const i=i6(t);if(i!=null){const s=i.inputsToSave||[],o=i.outputsToSave||[];let a;i.saveAllInputs?(U(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(l=>n[l])):a=s.map(l=>n[l]);const u=r.filter((l,c)=>o[c]);return a.concat(u)}return[]}makeTensor(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;let s=t;r==="string"&&kl(t[0])&&(s=t.map(u=>Tl(u)));const o=i.write(s,n,r),a=new nn(n,r,o,this.nextTensorId());if(this.trackTensor(a,i),r==="string"){const u=this.state.tensorInfo.get(o),l=zue(s);this.state.numBytes+=l-u.bytes,u.bytes=l}return a}makeTensorFromDataId(t,n,r,i){r=r||"float32";const s={dataId:t,shape:n,dtype:r};return this.makeTensorFromTensorInfo(s,i)}makeTensorFromTensorInfo(t,n){const{dataId:r,shape:i,dtype:s}=t,o=new nn(i,s,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(t,n=!0,r,i){r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.cast(i));const s=new Bw(t,n,r,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let r=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(r=t.size*Fw(t.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:r})),t instanceof Bw||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const r=t.size*Fw(t.dtype);this.state.numBytes-=r}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,r,i,s,o){const a={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:s},u=i6(t);u!=null&&(i=u.gradFunc),i!=null&&(a.gradient=l=>(l=l.map((c,f)=>{if(c==null){const d=r[f],h=vi(d.size,d.dtype);return this.makeTensor(h,d.shape,d.dtype)}return c}),i(l.length>1?l:l[0],s,o))),this.state.activeTape.push(a)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=kf(t),r=new Set(n.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){const o=this.state.activeScope.track[s];!o.kept&&!r.has(o.id)&&o.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(s=>{!s.kept&&s.scopeId===i.id&&this.track(s)})}gradients(t,n,r,i=!1){if(U(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));U(s instanceof nn,()=>"The result y returned by f() must be a tensor.");const o=qIe(this.state.activeTape,n,s);if(!i&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[s.id]=r??eNe(s.shape),GIe(a,o,l=>this.tidy(l),tNe);const u=n.map(l=>a[l.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(l=>{for(const c of l.saved)c.dispose()}),this.state.activeTape=null),{value:s,grads:u}})}customGrad(t){return U(ch(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{U(n.every(a=>a instanceof nn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const i={};n.forEach((a,u)=>{i[u]=a});const s=(a,u)=>(r=t(...n,u),U(r.value instanceof nn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),U(ch(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,u)=>{const l=r.gradFunc(a,u),c=Array.isArray(l)?l:[l];U(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),U(c.every(d=>d instanceof nn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return c.forEach((d,h)=>{f[h]=()=>d}),f};return this.runKernelFunc({forwardFunc:s,backwardsFunc:o,inputs:i})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){const n=ci(),r=await this.backend.time(t);return r.wallMs=ci()-n,r}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new rZ;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}ry.nextTensorId=0;ry.nextVariableId=0;function eNe(e){const t=yD(me(e),"float32");return Z.makeTensor(t,e,"float32")}function ole(){const e=que();if(e._tfengine==null){const t=new Vue(e);e._tfengine=new ry(t)}return $Ie(e._tfengine.ENV),YIe(()=>e._tfengine),e._tfengine}const Z=ole();function tNe(e,t){const n={a:e,b:t};return Z.runKernel(Um,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nNe(){return typeof navigator<"u"&&navigator!=null}let f6;function rNe(e){f6=e}function J7(e){if(f6!==void 0)return f6;if(e||nNe()){if(e||(e=navigator),e.product==="ReactNative")return!0;const t=e.userAgent||e.vendor||(typeof window<"u"?window.opera:"");if(!t){const n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function e9(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const iNe=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:e9,isMobile:J7,mockIsMobile:rNe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hs=ce();Hs.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Hs.registerFlag("IS_BROWSER",()=>e9());Hs.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Hs.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Hs.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Hs.registerFlag("PROD",()=>!1);Hs.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Hs.getBool("DEBUG"));Hs.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Hs.registerFlag("IS_TEST",()=>!1);Hs.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Hs.getBool("DEBUG"));Hs.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Hs.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Hs.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wl(e,t){let n=e;if(Ir(e))return t==="string"?[]:[e.length];if(nle(e)){const i=e.channels||"RGBA";return[e.height,e.width*i.length]}else if(rle(e))return[e.buffer.size/(t==null?4:Fw(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||Ir(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&ce().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&ale(e,r,[]),r}function ale(e,t,n){if(n=n||[],!Array.isArray(e)&&!Ir(e)){U(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}U(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),U(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);const r=t.slice(1);for(let i=0;i<e.length;++i)ale(e[i],r,n.concat(i))}function iZ(e,t,n,r){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function W(e,t,n,r="numeric"){if(e instanceof ye())return iZ(r,e.dtype,t,n),e;let i=Bm(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),iZ(r,i,t,n),e==null||!Ir(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){const u=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${u}'`)}const s=Wl(e,i);!Ir(e)&&!Array.isArray(e)&&(e=[e]);const a=i!=="string"?Kh(e,i):jl(e,[],!0);return Z.makeTensor(a,s,i)}function zw(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((s,o)=>W(s,`${t}[${o}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ule="__op";function J(e){const t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+ule;const i=(...s)=>{Z.startScope(n);try{const o=r(...s);return xD(o)&&console.error("Cannot return a Promise inside of tidy."),Z.endScope(o),o}catch(o){throw Z.endScope(null),o}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sNe(e,t){const n=W(e,"real","complex"),r=W(t,"imag","complex");Ci(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:n,imag:r};return Z.runKernel(kD,i)}const fh=J({complex_:sNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qh(e,t,n,r){if(r==null)r=Bm(e);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(rle(e)||nle(e)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return Z.backend.createTensorFromGPUData(e,t||n,r)}if(!Ir(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){zo(t);const i=me(t),s=me(n);U(i===s,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${s}`);for(let o=0;o<n.length;++o){const a=n[o],u=o===n.length-1?a!==me(t.slice(o)):!0;U(n[o]===t[o]||!u,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Ir(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=r!=="string"?Kh(e,r):jl(e,[],!0),Z.makeTensor(e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jd(e,t,n){const r=Wl(e,n);return Qh(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const em={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Vu{static join(t){return new Vu(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(r=>Ir(r)?r.buffer:r),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let r=0;r<t.length;r++){const i=t[r];r!==t.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const s=n+i.byteLength;this.shards.push({buffer:i,start:n,end:s}),n=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);const r=this.findShardForByte(t);if(r===-1)throw new Error(`Could not find start shard for byte ${t}`);const i=n-t,s=new ArrayBuffer(i),o=new Uint8Array(s);let a=0;for(let u=r;u<this.shards.length;u++){const l=this.shards[u],f=t+a-l.start,d=a,p=Math.min(n,l.end)-l.start,m=new Uint8Array(l.buffer,f,p-f);if(o.set(m,d),a+=m.length,n<l.end)break}return s}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(i){return t<i.start?-1:t>=i.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=oNe(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function oNe(e,t){let n=0,r=e.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,s=t(e[i]);if(s===0)return i;s<0?r=i:n=i+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aNe(){ce().set("PROD",!0)}function uNe(){ce().set("DEBUG",!0)}function lNe(){ce().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function cNe(e){ce().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function fNe(){Z.disposeVariables()}function gu(){return Z}function d6(){return Z.memory()}function dNe(e){return Z.profile(e)}function fe(e,t){return Z.tidy(e,t)}function Tt(e){kf(e).forEach(n=>n.dispose())}function Tu(e){return Z.keep(e)}function hNe(e){return Z.time(e)}function pNe(e){return Z.setBackend(e)}function gNe(){return Z.ready()}function lle(){return Z.backendName}function mNe(e){Z.removeBackend(e)}function yNe(e){return Z.findBackend(e)}function xNe(e){return Z.findBackendFactory(e)}function t9(e,t,n=1){return Z.registerBackend(e,t,n)}function n9(){return Z.backend}function bNe(e,t){ce().setPlatform(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dh=4;async function h6(e,t){const n=[],r=[],i=Array.isArray(e)?e.map(o=>o.name):Object.keys(e);for(let o=0;o<i.length;++o){const a=i[o],u=Array.isArray(e)?e[o].tensor:e[a];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${u.dtype}`);const l={name:a,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const c=new Promise(async f=>{const d=await u.bytes(),h=d.reduce((x,b)=>x+b.length,0)+dh*d.length,p=new Uint8Array(h);let m=0;for(let x=0;x<d.length;x++){const b=d[x],v=new Uint8Array(new Uint32Array([b.length]).buffer);p.set(v,m),m+=dh,p.set(b,m),m+=b.length}f(p)});r.push(c)}else r.push(u.data());t!=null&&(l.group=t),n.push(l)}const s=await Promise.all(r);return{data:CNe(s),specs:n}}function r9(e,t){const n=new Vu(e),r={};let i=0;for(const s of t){const o=vNe(s,(a,u)=>n.slice(i+a,i+u));r[s.name]=cle(s,n.slice(i,i+o)),i+=o}return r}function vNe(e,t){const n=me(e.shape);let r;if("quantization"in e){const i=e.quantization;r=em[i.dtype]}else if(e.dtype==="string"){let i=0;for(let s=0;s<n;s++)i+=dh+new Uint32Array(t(i,i+dh))[0];return i}else r=em[e.dtype];return n*r}async function wNe(e,t){const n=me(e.shape);let r;if("quantization"in e){const i=e.quantization;r=em[i.dtype]}else if(e.dtype==="string"){let i=0;for(let s=0;s<n;s++)i+=dh+new Uint32Array(await t(i,i+dh))[0];return i}else r=em[e.dtype];return n*r}function cle(e,t){const n=e.name,r=e.dtype,i=e.shape,s=me(i);let o,a=0;if("quantization"in e){const u=e.quantization;if(u.dtype==="uint8"||u.dtype==="uint16"){if(!("min"in u&&"scale"in u))throw new Error(`Weight ${e.name} with quantization ${u.dtype} doesn't have corresponding metadata min and scale.`)}else if(u.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${e.name} is quantized with ${u.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${e.name} has unknown quantization dtype ${u.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const l=em[u.dtype],c=u.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(r==="float32")if(u.dtype==="uint8"||u.dtype==="uint16"){o=new Float32Array(c.length);for(let f=0;f<c.length;f++){const d=c[f];o[f]=d*u.scale+u.min}}else if(u.dtype==="float16")o=TNe()(c);else throw new Error(`Unsupported quantization type ${u.dtype} for weight type float32.`);else if(r==="int32"){if(u.dtype!=="uint8"&&u.dtype!=="uint16")throw new Error(`Unsupported quantization type ${u.dtype} for weight type int32.`);o=new Int32Array(c.length);for(let f=0;f<c.length;f++){const d=c[f];o[f]=Math.round(d*u.scale+u.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=s*l}else if(r==="string"){const u=me(e.shape);o=[];for(let l=0;l<u;l++){const c=new Uint32Array(t.slice(a,a+dh))[0];a+=dh;const f=new Uint8Array(t.slice(a,a+c));o.push(f),a+=c}}else{const u=em[r];if(r==="float32")o=new Float32Array(t);else if(r==="int32")o=new Int32Array(t);else if(r==="bool")o=new Uint8Array(t);else if(r==="complex64"){o=new Float32Array(t);const l=new Float32Array(o.length/2),c=new Float32Array(o.length/2);for(let p=0;p<l.length;p++)l[p]=o[p*2],c[p]=o[p*2+1];const f=Jd(l,i,"float32"),d=Jd(c,i,"float32"),h=fh(f,d);return f.dispose(),d.dispose(),h}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=s*u}return Jd(o,i,r)}async function sZ(e,t,n){let r=new Uint8Array(t);for(;r.byteLength<n;){const{done:i,value:s}=await e.read();if(i&&s==null){const a=n-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(r.length+s.byteLength);o.set(r,0),o.set(new Uint8Array(s),r.length),r=o}return r.buffer}async function $Ne(e,t){const n={},r=e.getReader();let i=new ArrayBuffer(0);for(const s of t){const o=await wNe(s,async(l,c)=>(i=await sZ(r,i,c),i.slice(l,c)));i=await sZ(r,i,o);const a=i.slice(0,o);i=i.slice(o);const u=cle(s,a);if(n[s.name]=u,lle()==="webgpu"){const l=n9();"uploadToGPU"in l&&me(u.shape)>=ce().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&l.uploadToGPU(u.dataId)}}return n}function CNe(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach(s=>{if(t+=s.byteLength,n.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});const r=new Uint8Array(t);let i=0;return n.forEach(s=>{r.set(new Uint8Array(s.buffer),i),i+=s.byteLength}),r.buffer}const i9=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function oZ(e){return i9?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function SNe(e){if(i9)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,i=t.length;r<i;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function kNe(e){if(i9){const r=Buffer.from(e,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}function fle(e){return Vu.join(e)}function aZ(e){const t="/";for(e=e.trim();e.endsWith(t);)e=e.slice(0,e.length-1);const n=e.split(t);return n[n.length-1]}function dle(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function hle(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),r}async function s9(e,t){let n,r;return e.weightsManifest!=null&&([n,r]=await t(e.weightsManifest)),hle(e,n,r)}function yS(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:oZ(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:oZ(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new Vu(e.weightData).byteLength}}function p6(e){const t=[];for(const n of e)t.push(...n.weights);return t}function ENe(){const e=n=>{let r=n<<13,i=0;for(;!(r&8388608);)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function ANe(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function _Ne(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function TNe(){const e=ENe(),t=ANe(),n=_Ne();return r=>{const i=new ArrayBuffer(4*r.length),s=new Uint32Array(i);for(let o=0;o<r.length;o++){const a=r[o],u=e[n[a>>10]+(a&1023)]+t[a>>10];s[o]=u}return new Float32Array(i)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Qn.instance==null&&(Qn.instance=new Qn),Qn.instance}static registerSaveRouter(t){Qn.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Qn.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Qn.getHandlers(t,"save")}static getLoadHandlers(t,n){return Qn.getHandlers(t,"load",n)}static getHandlers(t,n,r){const i=[];return(n==="load"?Qn.getInstance().loadRouters:Qn.getInstance().saveRouters).forEach(o=>{const a=o(t,r);a!==null&&i.push(a)}),i}}const INe=e=>Qn.registerSaveRouter(e),NNe=e=>Qn.registerLoadRouter(e),ple=e=>Qn.getSaveHandlers(e),gle=(e,t)=>Qn.getLoadHandlers(e,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g6="tensorflowjs",m6=1,Eg="models_store",Ld="model_info_store";function mle(){if(!ce().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function y6(e){const t=e.result;t.createObjectStore(Eg,{keyPath:"modelPath"}),t.createObjectStore(Ld,{keyPath:"modelPath"})}class tm{constructor(t){if(this.indexedDB=mle(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((r,i)=>{const s=this.indexedDB.open(g6,m6);s.onupgradeneeded=()=>y6(s),s.onsuccess=()=>{const o=s.result;if(n==null){const a=o.transaction(Eg,"readonly"),l=a.objectStore(Eg).get(this.modelPath);l.onsuccess=()=>{if(l.result==null)return o.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(l.result.modelArtifacts)},l.onerror=c=>(o.close(),i(l.error)),a.oncomplete=()=>o.close()}else{n.weightData=Vu.join(n.weightData);const a=yS(n),u=o.transaction(Ld,"readwrite");let l=u.objectStore(Ld),c;try{c=l.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(d){return i(d)}let f;c.onsuccess=()=>{f=o.transaction(Eg,"readwrite");const d=f.objectStore(Eg);let h;try{h=d.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return i(p)}h.onsuccess=()=>r({modelArtifactsInfo:a}),h.onerror=p=>{l=u.objectStore(Ld);const m=l.delete(this.modelPath);m.onsuccess=()=>(o.close(),i(h.error)),m.onerror=x=>(o.close(),i(h.error))}},c.onerror=d=>(o.close(),i(c.error)),u.oncomplete=()=>{f==null?o.close():f.oncomplete=()=>o.close()}}},s.onerror=o=>i(s.error)})}}tm.URL_SCHEME="indexeddb://";const yle=e=>ce().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(tm.URL_SCHEME)?DNe(e.slice(tm.URL_SCHEME.length)):null;Qn.registerSaveRouter(yle);Qn.registerLoadRouter(yle);function DNe(e){return new tm(e)}function FNe(e){return e.startsWith(tm.URL_SCHEME)?e.slice(tm.URL_SCHEME.length):e}class RNe{constructor(){this.indexedDB=mle()}async listModels(){return new Promise((t,n)=>{const r=this.indexedDB.open(g6,m6);r.onupgradeneeded=()=>y6(r),r.onsuccess=()=>{const i=r.result,s=i.transaction(Ld,"readonly"),a=s.objectStore(Ld).getAll();a.onsuccess=()=>{const u={};for(const l of a.result)u[l.modelPath]=l.modelArtifactsInfo;t(u)},a.onerror=u=>(i.close(),n(a.error)),s.oncomplete=()=>i.close()},r.onerror=i=>n(r.error)})}async removeModel(t){return t=FNe(t),new Promise((n,r)=>{const i=this.indexedDB.open(g6,m6);i.onupgradeneeded=()=>y6(i),i.onsuccess=()=>{const s=i.result,o=s.transaction(Ld,"readwrite"),a=o.objectStore(Ld),u=a.get(t);let l;u.onsuccess=()=>{if(u.result==null)return s.close(),r(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const c=a.delete(t),f=()=>{l=s.transaction(Eg,"readwrite");const h=l.objectStore(Eg).delete(t);h.onsuccess=()=>n(u.result.modelArtifactsInfo),h.onerror=p=>r(u.error)};c.onsuccess=f,c.onerror=d=>(f(),s.close(),r(u.error))}},u.onerror=c=>(s.close(),r(u.error)),o.oncomplete=()=>{l==null?s.close():l.oncomplete=()=>s.close()}},i.onerror=s=>r(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tf="/",I1="tensorflowjs_models",xle="info",ONe="model_topology",MNe="weight_specs",LNe="weight_data",PNe="model_metadata";function ble(e){return{info:[I1,e,xle].join(tf),topology:[I1,e,ONe].join(tf),weightSpecs:[I1,e,MNe].join(tf),weightData:[I1,e,LNe].join(tf),modelMetadata:[I1,e,PNe].join(tf)}}function vle(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function BNe(e){const t=e.split(tf);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(tf)}function zNe(e){return e.startsWith(nm.URL_SCHEME)?e.slice(nm.URL_SCHEME.length):e}class nm{constructor(t){if(!ce().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=ble(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=yS(t),s=Vu.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,SNe(s));const o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:i}}catch{throw vle(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=i;const s=this.LS.getItem(this.keys.modelMetadata);if(s!=null){const a=JSON.parse(s);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=kNe(o),n}}nm.URL_SCHEME="localstorage://";const wle=e=>ce().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(nm.URL_SCHEME)?UNe(e.slice(nm.URL_SCHEME.length)):null;Qn.registerSaveRouter(wle);Qn.registerLoadRouter(wle);function UNe(e){return new nm(e)}class jNe{constructor(){U(ce().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),U(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=I1+tf,r=tf+xle;for(let i=0;i<this.LS.length;++i){const s=this.LS.key(i);if(s.startsWith(n)&&s.endsWith(r)){const o=BNe(s);t[o]=JSON.parse(this.LS.getItem(s))}}return t}async removeModel(t){t=zNe(t);const n=ble(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const r=JSON.parse(this.LS.getItem(n.info));return vle(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U1="://";class ss{constructor(){this.managers={}}static getInstance(){return ss.instance==null&&(ss.instance=new ss),ss.instance}static registerManager(t,n){U(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(U1)&&(t=t.slice(0,t.indexOf(U1))),U(t.length>0,()=>"scheme must not be an empty string.");const r=ss.getInstance();U(r.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=n}static getManager(t){const n=ss.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(ss.getInstance().managers)}}function K_(e){if(e.indexOf(U1)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ss.getSchemes().join(",")}`);return{scheme:e.split(U1)[0],path:e.split(U1)[1]}}async function $le(e,t,n=!1){U(e!==t,()=>`Old path and new path are the same: '${e}'`);const r=Qn.getLoadHandlers(e);U(r.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),U(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`);const i=r[0],s=Qn.getSaveHandlers(t);U(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),U(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);const o=s[0],a=K_(e).scheme,u=K_(e).path,l=a===K_(e).scheme,c=await i.load();n&&l&&await ss.getManager(a).removeModel(u);const f=await o.save(c);return n&&!l&&await ss.getManager(a).removeModel(u),f.modelArtifactsInfo}async function Cle(){const e=ss.getSchemes(),t={};for(const n of e){const r=await ss.getManager(n).listModels();for(const i in r){const s=n+U1+i;t[s]=r[i]}}return t}async function WNe(e){const t=K_(e);return ss.getManager(t.scheme).removeModel(t.path)}async function VNe(e,t){return $le(e,t,!1)}async function qNe(e,t){return $le(e,t,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GNe{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(typeof window>"u"||!ce().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const i=this.functionRefs[r.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return Yue(t)}}if(ce().get("IS_BROWSER")){ce().setPlatform("browser",new GNe);try{ss.registerManager(nm.URL_SCHEME,new jNe)}catch{}try{ss.registerManager(tm.URL_SCHEME,new RNe)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HNe={importFetch:()=>require("node-fetch")};let FL;class XNe{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return ce().global.fetch!=null?ce().global.fetch(t,n):(FL==null&&(FL=HNe.importFetch()),FL(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}ce().get("IS_NODE")&&!ce().get("IS_BROWSER")&&ce().setPlatform("node",new XNe);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ft(e,t="float32",n){return t=t||"float32",zo(e),new Sr(e,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YNe(e,t){const n=W(e,"x","cast");if(!Bue(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:t};return Z.runKernel(px,r,i)}const Pe=J({cast_:YNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KNe(e){const n={x:W(e,"x","clone","string_or_numeric")};return Z.runKernel(Ax,n)}const eh=J({clone_:KNe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sle(e,t=!1){console.log(e.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ole();const QNe={buffer:Ft,cast:Pe,clone:eh,print:Sle};KIe(QNe);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZNe(e,t){let n=W(e,"a","add"),r=W(t,"b","add");[n,r]=tr(n,r);const i={a:n,b:r};return Z.runKernel(Um,i)}const Ee=J({add_:ZNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JNe(e,t){let n=W(e,"a","floorDiv"),r=W(t,"b","floorDiv");[n,r]=tr(n,r);const i={a:n,b:r};return Z.runKernel(kx,i)}const o9=J({floorDiv_:JNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eDe(e,t){let n=W(e,"a","div"),r=W(t,"b","div");if([n,r]=tr(n,r),n.dtype==="int32"&&r.dtype==="int32")return o9(n,r);const i={a:n,b:r},s={};return Z.runKernel(bx,i,s)}const st=J({div_:eDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tDe(e,t){let n=W(e,"a","mul"),r=W(t,"b","mul");[n,r]=tr(n,r);const i={a:n,b:r};return Z.runKernel(Mx,i)}const ee=J({mul_:tDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nDe(e){const t=W(e,"x","abs");if(t.dtype==="complex64"){const n={x:t};return Z.runKernel($C,n)}else{const n={x:t};return Z.runKernel(hC,n)}}const Tr=J({abs_:nDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rDe(e){const n={x:W(e,"x","acos")};return Z.runKernel(ax,n)}const kle=J({acos_:rDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iDe(e){const n={x:W(e,"x","acosh")};return Z.runKernel(ux,n)}const Ele=J({acosh_:iDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sDe(e){U(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),U(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);const t=e.map((i,s)=>W(i,`tensors${s}`,"addN")),n=t[0];t.forEach(i=>{if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(i=>{if(!Gt(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=t;return Z.runKernel(pC,r)}const oDe=J({addN_:sDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aDe(e,t=null,n=!1){const i={x:W(e,"x","all","bool")},s={axis:t,keepDims:n};return Z.runKernel(bD,i,s)}const a9=J({all_:aDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uDe(e,t=null,n=!1){const i={x:W(e,"x","any","bool")},s={axis:t,keepDims:n};return Z.runKernel(vD,i,s)}const qT=J({any_:uDe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lDe(e,t=0){const r={x:W(e,"x","argMax")},i={axis:t};return Z.runKernel(gC,r,i)}const iy=J({argMax_:lDe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cDe(e,t=0){const r={x:W(e,"x","argMin")},i={axis:t};return Z.runKernel(mC,r,i)}const Ale=J({argMin_:cDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fDe(e){const n={x:W(e,"x","asin")};return Z.runKernel(lx,n)}const _le=J({asin_:fDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dDe(e){const n={x:W(e,"x","asinh")};return Z.runKernel(cx,n)}const Tle=J({asinh_:dDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hDe(e){const n={x:W(e,"x","atan")};return Z.runKernel(fx,n)}const Ile=J({atan_:hDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pDe(e,t){let n=W(e,"a","atan2"),r=W(t,"b","atan2");[n,r]=tr(n,r);const i={a:n,b:r};return Z.runKernel(hx,i)}const Nle=J({atan2_:pDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gDe(e){const n={x:W(e,"x","atanh")};return Z.runKernel(dx,n)}const Dle=J({atanh_:gDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xS(e,t,n,r,i="NHWC",s){const o=e[3],a=[...t,o],u=zf(i);return Jr(e,a,n,s,r,null,null,u)}function Xa(e,t,n,r,i,s,o="channelsLast"){const[a,u]=Uw(t);let l;if(o==="channelsLast")l=[a,u,e[3],e[3]];else if(o==="channelsFirst")l=[a,u,e[1],e[1]];else throw new Error(`Unknown dataFormat ${o}`);return Jr(e,l,n,r,i,s,!1,o)}function Bf(e,t,n,r,i,s,o="NDHWC"){const[a,u,l]=x6(t);let c,f;if(o==="NDHWC")f="channelsLast",c=[a,u,l,e[4],e[4]];else if(o==="NCDHW")f="channelsFirst",c=[a,u,l,e[1],e[1]];else throw new Error(`Unknown dataFormat ${o}`);return Zh(e,c,n,r,i,!1,f,s)}function Jr(e,t,n,r,i,s,o=!1,a="channelsLast"){let[u,l,c,f]=[-1,-1,-1,-1];if(a==="channelsLast")[u,l,c,f]=e;else if(a==="channelsFirst")[u,f,l,c]=e;else throw new Error(`Unknown dataFormat ${a}`);const[d,h,,p]=t,[m,x]=Uw(n),[b,v]=Uw(r),$=j1(d,b),C=j1(h,v),{padInfo:S,outHeight:A,outWidth:E}=xDe(i,l,c,m,x,$,C,s,a),_=o?p*f:p;let D;return a==="channelsFirst"?D=[u,_,A,E]:a==="channelsLast"&&(D=[u,A,E,_]),{batchSize:u,dataFormat:a,inHeight:l,inWidth:c,inChannels:f,outHeight:A,outWidth:E,outChannels:_,padInfo:S,strideHeight:m,strideWidth:x,filterHeight:d,filterWidth:h,effectiveFilterHeight:$,effectiveFilterWidth:C,dilationHeight:b,dilationWidth:v,inShape:e,outShape:D,filterShape:t}}function Zh(e,t,n,r,i,s=!1,o="channelsLast",a){let[u,l,c,f,d]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[u,l,c,f,d]=e;else if(o==="channelsFirst")[u,d,l,c,f]=e;else throw new Error(`Unknown dataFormat ${o}`);const[h,p,m,,x]=t,[b,v,$]=x6(n),[C,S,A]=x6(r),E=j1(h,C),_=j1(p,S),D=j1(m,A),{padInfo:N,outDepth:T,outHeight:L,outWidth:O}=bDe(i,l,c,f,b,v,$,E,_,D,a),M=s?x*d:x;let R;return o==="channelsFirst"?R=[u,M,T,L,O]:o==="channelsLast"&&(R=[u,T,L,O,M]),{batchSize:u,dataFormat:o,inDepth:l,inHeight:c,inWidth:f,inChannels:d,outDepth:T,outHeight:L,outWidth:O,outChannels:M,padInfo:N,strideDepth:b,strideHeight:v,strideWidth:$,filterDepth:h,filterHeight:p,filterWidth:m,effectiveFilterDepth:E,effectiveFilterHeight:_,effectiveFilterWidth:D,dilationDepth:C,dilationHeight:S,dilationWidth:A,inShape:e,outShape:R,filterShape:t}}function mDe(e,t,n,r,i){r==null&&(r=u9(e,t,n));const s=e[0],o=e[1],a=jw((s-t+2*r)/n+1,i),u=jw((o-t+2*r)/n+1,i);return[a,u]}function yDe(e,t,n,r,i,s){i==null&&(i=u9(e,t[0],r[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)e[a]+2*i>=t[a]&&(o[a]=jw((e[a]-t[a]+2*i)/r[a]+1,s));return o}function u9(e,t,n,r=1){const i=j1(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function Uw(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function x6(e){return typeof e=="number"?[e,e,e]:e}function j1(e,t){return t<=1?e:e+(e-1)*(t-1)}function xDe(e,t,n,r,i,s,o,a,u){let l,c,f;if(typeof e=="number"){l={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};const h=mDe([t,n],s,r,e,a);c=h[0],f=h[1]}else if(e==="same"){c=Math.ceil(t/r),f=Math.ceil(n/i);const d=Math.max(0,(c-1)*r+s-t),h=Math.max(0,(f-1)*i+o-n),p=Math.floor(d/2),m=d-p,x=Math.floor(h/2),b=h-x;l={top:p,bottom:m,left:x,right:b,type:"SAME"}}else if(e==="valid")l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-s+1)/r),f=Math.ceil((n-o+1)/i);else if(typeof e=="object"){const d=u==="channelsLast"?e[1][0]:e[2][0],h=u==="channelsLast"?e[1][1]:e[2][1],p=u==="channelsLast"?e[2][0]:e[3][0],m=u==="channelsLast"?e[2][1]:e[3][1];l={top:d,bottom:h,left:p,right:m,type:d===0&&h===0&&p===0&&m===0?"VALID":"EXPLICIT"},c=jw((t-s+d+h)/r+1,a),f=jw((n-o+p+m)/i+1,a)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:l,outHeight:c,outWidth:f}}function bDe(e,t,n,r,i,s,o,a,u,l,c){let f,d,h,p;if(e==="valid"&&(e=0),typeof e=="number"){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};const x=yDe([t,n,r,1],[a,u,l],1,[i,s,o],e,c);d=x[0],h=x[1],p=x[2]}else if(e==="same"){d=Math.ceil(t/i),h=Math.ceil(n/s),p=Math.ceil(r/o);const m=(d-1)*i+a-t,x=(h-1)*s+u-n,b=(p-1)*o+l-r,v=Math.floor(m/2),$=m-v,C=Math.floor(x/2),S=x-C,A=Math.floor(b/2),E=b-A;f={top:C,bottom:S,left:A,right:E,front:v,back:$,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:f,outDepth:d,outHeight:h,outWidth:p}}function jw(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function hh(e){const[t,n,r]=Uw(e);return t===1&&n===1&&r===1}function Si(e,t){return hh(e)||hh(t)}function rm(e){return Uw(e).every(t=>t>0)}function zf(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function Es(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")U(Jg(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(r=>{r.forEach(i=>{U(Jg(i),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${i}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vDe(e,t){const r={x:W(e,"x","reshape","string_or_numeric")},i={shape:t};return Z.runKernel(nS,r,i)}const ie=J({reshape_:vDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wDe(e,t,n,r,i){const s=W(e,"x","avgPool","float32"),o=1;U(Si(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=s,u=!1;s.rank===3&&(u=!0,a=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),U(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Es("avgPool",r,i);const l={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i};let f=Z.runKernel(yC,l,c);return f=Pe(f,s.dtype),u?ie(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const AF=J({avgPool_:wDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $De(e,t,n,r,i,s="NDHWC"){const o=W(e,"x","avgPool3d","float32");let a=o,u=!1;o.rank===4&&(u=!0,a=ie(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),U(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),U(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),U(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Es("avgPool3d",r,i);const l={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:s};let f=Z.runKernel(xC,l,c);return f=Pe(f,a.dtype),u?ie(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Fle=J({avgPool3d_:$De});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CDe(e,t=0){U(e.length>=1,()=>"Pass at least one tensor to concat");const n=zw(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),n.length===1)return eh(n[0]);const r=n,i={axis:t};return Z.runKernel(CC,r,i)}const Yr=J({concat_:CDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SDe(e,t,n=!1,r=!1){let i=W(e,"a","matMul"),s=W(t,"b","matMul");[i,s]=tr(i,s);const o={a:i,b:s},a={transposeA:n,transposeB:r};return Z.runKernel(bC,o,a)}const Mt=J({matMul_:SDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kDe(e){const n={x:W(e,"x","sigmoid","float32")};return Z.runKernel(Hx,n)}const Il=J({sigmoid_:kDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EDe(e,t,n){const r=W(e,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const i={x:r},s={begin:t,size:n};return Z.runKernel(aS,i,s)}const Kt=J({slice_:EDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ADe(e){const n={x:W(e,"x","tanh","float32")};return Z.runKernel(Jx,n)}const im=J({tanh_:ADe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _De(e,t,n,r,i,s){const o=W(e,"forgetBias","basicLSTMCell"),a=W(t,"lstmKernel","basicLSTMCell"),u=W(n,"lstmBias","basicLSTMCell"),l=W(r,"data","basicLSTMCell"),c=W(i,"c","basicLSTMCell"),f=W(s,"h","basicLSTMCell"),d=Yr([l,f],1),h=Mt(d,a),p=Ee(h,u),m=p.shape[0],x=p.shape[1]/4,b=[m,x],v=Kt(p,[0,0],b),$=Kt(p,[0,x],b),C=Kt(p,[0,x*2],b),S=Kt(p,[0,x*3],b),A=Ee(ee(Il(v),im($)),ee(c,Il(Ee(o,C)))),E=ee(im(A),Il(S));return[A,E]}const TDe=J({basicLSTMCell_:_De});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IDe(e,t,n){const r=W(e,"x","batchToSpaceND"),i=t.reduce((a,u)=>a*u);U(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),U(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),U(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`);const s={x:r},o={blockShape:t,crops:n};return Z.runKernel(vC,s,o)}const _F=J({batchToSpaceND_:IDe});function NDe(e){let t;return e.rank===0||e.rank===1?t=ie(e,[1,1,1,e.size]):e.rank===2?t=ie(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DDe(e,t,n,r,i,s){s==null&&(s=.001);const o=W(e,"x","batchNorm"),a=W(t,"mean","batchNorm"),u=W(n,"variance","batchNorm");let l;i!=null&&(l=W(i,"scale","batchNorm"));let c;r!=null&&(c=W(r,"offset","batchNorm")),U(a.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),U(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),U(l==null||a.rank===l.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:NDe(o),scale:l,offset:c,mean:a,variance:u},h={varianceEpsilon:s},p=Z.runKernel(DC,d,h);return ie(p,o.shape)}const bS=J({batchNorm_:DDe});function FDe(e,t,n,r,i,s){const o=W(e,"x","batchNorm"),a=W(t,"mean","batchNorm"),u=W(n,"variance","batchNorm");let l;i!=null&&(l=W(i,"scale","batchNorm"));let c;return r!=null&&(c=W(r,"offset","batchNorm")),U(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),U(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),U(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),l!=null&&U(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&U(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),bS(o,a,u,c,l,s)}const Rle=J({batchNorm2d_:FDe});function RDe(e,t,n,r,i,s){const o=W(e,"x","batchNorm"),a=W(t,"mean","batchNorm"),u=W(n,"variance","batchNorm");let l;i!=null&&(l=W(i,"scale","batchNorm"));let c;return r!=null&&(c=W(r,"offset","batchNorm")),U(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),U(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),U(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),l!=null&&U(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&U(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),bS(o,a,u,c,l,s)}const Ole=J({batchNorm3d_:RDe});function ODe(e,t,n,r,i,s){const o=W(e,"x","batchNorm"),a=W(t,"mean","batchNorm"),u=W(n,"variance","batchNorm");let l;i!=null&&(l=W(i,"scale","batchNorm"));let c;return r!=null&&(c=W(r,"offset","batchNorm")),U(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),U(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),U(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),l!=null&&U(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&U(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),bS(o,a,u,c,l,s)}const Mle=J({batchNorm4d_:ODe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MDe(e,t,n){const r=W(e,"x","bincount"),i=W(t,"weights","bincount");U(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),U(n>=0,()=>`size must be non-negative, but got ${n}.`),U(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);const s={x:r,weights:i},o={size:n};return Z.runKernel(CD,s,o)}const Lle=J({bincount_:MDe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LDe(e,t){const n=W(e,"x","bitwiseAnd"),r=W(t,"y","bitwiseAnd");if(!Gt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const i={a:n,b:r};return Z.runKernel(wC,i)}const PDe=J({bitwiseAnd_:LDe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BDe(e,t){const n=W(e,"s0","broadcastArgs","int32"),r=W(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const i={s0:n,s1:r};return Z.runKernel(SD,i)}const zDe=J({broadcastArgs_:BDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UDe(e,t){let n=W(e,"broadcastTo","x");const r=n.shape;if(zo(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const l=n.shape.slice();for(;l.length<t.length;)l.unshift(1);n=ie(n,l)}const i=n.shape,s=Array.from(t);for(let l=t.length-1;l>=0;l--)if(i[l]===t[l])s[l]=1;else if(n.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(s.map((l,c)=>l>1?c:-1).filter(l=>l>=0).length===0)return eh(n);const a={x:n},u={reps:s};return Z.runKernel(eb,a,u)}const W1=J({broadcastTo_:UDe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jDe(e){const n={x:W(e,"x","ceil","float32")};return Z.runKernel(gx,n)}const Ple=J({ceil_:jDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nb(e,t,n){zo(e),n=n||Bm(t);const r={shape:e,value:t,dtype:n};return Z.runKernel(zD,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WDe(e,t,n){const r=W(e,"x","clipByValue");if(U(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return nb(r.shape,t,r.dtype);const i={x:r},s={clipValueMin:t,clipValueMax:n};return Z.runKernel(mx,i,s)}const _o=J({clipByValue_:WDe});function VDe(e){return Yr(e,0)}const Ble=J({concat1d_:VDe});function qDe(e,t){return Yr(e,t)}const zle=J({concat2d_:qDe});function GDe(e,t){return Yr(e,t)}const Ule=J({concat3d_:GDe});function HDe(e,t){return Yr(e,t)}const jle=J({concat4d_:HDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XDe(e,t,n,r,i="NHWC",s=[1,1],o){const a=W(e,"x","conv2d","float32"),u=W(t,"filter","conv2d","float32");let l=a,c=!1;a.rank===3&&(c=!0,l=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]])),U(l.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${l.rank}.`),U(u.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),Es("conv2d",r,o);const f=i==="NHWC"?l.shape[3]:l.shape[1];U(f===u.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${u.shape[2]}.`),U(Si(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),U(rm(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),U(rm(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:l,filter:u},h={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o},p=Z.runKernel(SC,d,h);return c?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const ph=J({conv2d_:XDe});function YDe(e,t,n,r,i="NWC",s=1,o){const a=W(e,"x","conv1d"),u=W(t,"filter","conv1d");let l=a,c=!1;a.rank===2&&(c=!0,l=ie(a,[1,a.shape[0],a.shape[1]])),U(l.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${l.rank}.`),U(u.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),Es("conv1d",r,o),U(l.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${l.shape[2]}) must match input depth for filter ${u.shape[1]}.`),U(Si(n,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`),U(rm(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),U(rm(n),()=>"Error in conv1D: Stride should be larger than 0."),U(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const f=ie(u,[1,u.shape[0],u.shape[1],u.shape[2]]),d=ie(l,[l.shape[0],1,l.shape[1],l.shape[2]]),x=ph(d,f,[1,n],r,"NHWC",[1,s],o);return c?ie(x,[x.shape[2],x.shape[3]]):ie(x,[x.shape[0],x.shape[2],x.shape[3]])}const l9=J({conv1d_:YDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KDe(e,t,n,r,i,s="NHWC",o){U(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let a=e,u=t,l=!1;t.rank===3&&(l=!0,u=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]]),a=[1,e[0],e[1],e[2]]),U(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),U(u.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),U(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=s==="NHWC"?a[3]:a[1],f=s==="NHWC"?u.shape[3]:u.shape[1];U(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),U(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),Es("conv2dDerInput",i,o);const d={dy:u,filter:n},h={strides:r,pad:i,dataFormat:s,dimRoundingMode:o,inputShape:a},p=Z.runKernel(kC,d,h);return l?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const c9=J({conv2DBackpropInput_:KDe});function QDe(e,t,n,r,i,s){const o=W(e,"x","conv2dTranspose"),a=W(t,"filter","conv2dTranspose");return c9(n,o,a,r,i,"NHWC",s)}const f9=J({conv2dTranspose_:QDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZDe(e,t,n,r,i="NDHWC",s=[1,1,1]){const o=W(e,"x","conv3d"),a=W(t,"filter","conv3d");let u=o,l=!1;o.rank===4&&(l=!0,u=ie(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),U(u.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),U(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),U(u.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${a.shape[3]}.`),U(Si(n,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),U(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),U(rm(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),U(rm(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:u,filter:a},f={strides:n,pad:r,dataFormat:i,dilations:s},d=Z.runKernel(EC,c,f);return l?ie(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Wle=J({conv3d_:ZDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JDe(e,t,n,r,i){U(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let s=e,o=t,a=!1;t.rank===4&&(a=!0,o=ie(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,e[0],e[1],e[2],e[3]]);const u=s[4],l=o.shape[4];U(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),U(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),U(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),U(u===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[3]}.`),U(l===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${l}) must match output depth for filter ${n.shape[4]}.`);const c={dy:o,filter:n},f={pad:i,strides:r,inputShape:s},d=Z.runKernel(_D,c,f);return a?ie(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Vle=J({conv3DBackpropInput_:JDe});function eFe(e,t,n,r,i){const s=W(e,"x","conv3dTranspose"),o=W(t,"filter","conv3dTranspose");return Vle(n,s,o,r,i)}const qle=J({conv3dTranspose_:eFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tFe(e){const n={x:W(e,"x","cos","float32")};return Z.runKernel(yx,n)}const TF=J({cos_:tFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nFe(e){const n={x:W(e,"x","cosh","float32")};return Z.runKernel(xx,n)}const d9=J({cosh_:nFe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rFe(e,t=0,n=!1,r=!1){const s={x:W(e,"x","cumprod")},o={axis:t,exclusive:n,reverse:r};return Z.runKernel(TD,s,o)}const GT=J({cumprod_:rFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iFe(e,t=0,n=!1,r=!1){const s={x:W(e,"x","cumsum")},o={axis:t,exclusive:n,reverse:r};return Z.runKernel(AC,s,o)}const h9=J({cumsum_:iFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sFe(e,t,n,r=!1){const i=W(e,"x","denseBincount"),s=W(t,"weights","denseBincount");U(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),U(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),U(n>=0,()=>`size must be non-negative, but got ${n}.`),U(s.size===i.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${s.shape}.`);const o={x:i,weights:s},a={size:n,binaryOutput:r};return Z.runKernel(ND,o,a)}const b6=J({denseBincount_:sFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oFe(e,t,n="NHWC"){const r=W(e,"x","depthToSpace","float32"),i=n==="NHWC"?r.shape[1]:r.shape[2],s=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];U(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),U(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t}  for depthToSpace with input shape
    ${r.shape}`),U(s*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${t} for depthToSpace with input shape
        ${r.shape}`),U(o%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},u={blockSize:t,dataFormat:n};return Z.runKernel(DD,a,u)}const Gle=J({depthToSpace_:oFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aFe(e,t,n,r,i="NHWC",s=[1,1],o){const a=W(e,"x","depthwiseConv2d","float32"),u=W(t,"filter","depthwiseConv2d","float32");let l=a,c=!1;a.rank===3&&(c=!0,l=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]])),U(l.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${l.rank}.`),U(u.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);const f=i==="NHWC"?l.shape[3]:l.shape[1];U(f===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${u.shape[2]}.`),Es("depthwiseConv2d",r,o);const d={x:l,filter:u},h={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o},p=Z.runKernel(_C,d,h);return c?ie(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const vS=J({depthwiseConv2d_:aFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uFe(e){const n={x:W(e,"x","diag")};return Z.runKernel(OD,n)}const lFe=J({diag_:uFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cFe(e,t,n,r,i=[1,1],s="NHWC"){const o=W(e,"x","dilation2d"),a=W(t,"filter","dilation2d");U(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),U(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),U(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let u=o,l=!1;o.rank===3&&(u=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=!0),U(u.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${a.shape[2]}`);const c={x:u,filter:a},f={strides:n,pad:r,dilations:i},d=Z.runKernel(TC,c,f);return l?ie(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Hle=J({dilation2d_:cFe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sm(e,t){const n=e.length,r=[];for(let i=0;i<n;i++){const s=n-1-i,o=e[s]||1;(t[t.length-1-i]||1)>1&&o===1&&r.unshift(s)}return r}function kr(e,t){const n=[];for(let r=0;r<t.length;r++){const i=e[e.length-r-1],s=t.length-r-1,o=t[s];(i==null||i===1&&o>1)&&n.unshift(s)}return n}function At(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let i=0;i<n;i++){let s=e[e.length-i-1];s==null&&(s=1);let o=t[t.length-i-1];if(o==null&&(o=1),s===1)r[n-i-1]=o;else if(o===1)r[n-i-1]=s;else if(s!==o){const a=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(a)}else r[n-i-1]=s}return r}const fFe=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:At,getBroadcastDims:sm,getReductionAxes:kr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dFe(e,t){let n=W(e,"a","equal","string_or_numeric"),r=W(t,"b","equal","string_or_numeric");[n,r]=tr(n,r),At(n.shape,r.shape);const i={a:n,b:r};return Z.runKernel(IC,i)}const Mu=J({equal_:dFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hFe(e,t,n){const r=W(t,"a","where"),i=W(n,"b","where"),s=W(e,"condition","where","bool"),o=At(At(s.shape,r.shape),i.shape),a=W1(s,o),u=W1(r,o),l=W1(i,o),c={condition:a,t:u,e:l};return Z.runKernel(oS,c)}const Wi=J({where_:hFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pFe(e){const n={x:W(e,"x","zerosLike")};return Z.runKernel(gS,n)}const Xt=J({zerosLike_:pFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gFe(e,t){let n=W(e,"a","div"),r=W(t,"b","div");[n,r]=tr(n,r);const i=st(n,r),s=Xt(i),o=Mu(r,s);return Wi(o,s,i)}const Xle=J({divNoNan_:gFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mFe(e,t){const n=W(e,"t1","dot"),r=W(t,"t2","dot");U((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const i=n.rank===1?n.size:n.shape[1],s=r.rank===1?r.size:r.shape[0];if(U(i===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${s}.`),n.rank===1&&r.rank===1){const o=ie(n,[1,-1]),a=ie(r,[-1,1]),u=Mt(o,a);return ie(u,[])}else if(n.rank===1&&r.rank===2){const o=ie(n,[1,-1]),a=ie(r,[r.shape[0],r.shape[1]]),u=Mt(o,a);return ie(u,[u.size])}else if(n.rank===2&&r.rank===1){const o=ie(r,[-1,1]),a=Mt(n,o);return ie(a,[a.size])}else{const o=ie(r,[r.shape[0],r.shape[1]]);return Mt(n,o)}}const Yle=J({dot_:mFe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yFe(e,...t){const n=t.map((i,s)=>W(i,`tensors${s}`,"einsum")),r={equation:e};return Z.runKernel(LD,n,r)}const N1=J({einsum_:yFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xFe(e){const n={x:W(e,"x","elu","float32")};return Z.runKernel(vx,n)}const wS=J({elu_:xFe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bFe(e,t){const n=W(e,"x","ensureShape","string_or_numeric");if(!Lue(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}const vFe=J({ensureShape_:bFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wFe(e){let t=W(e,"x","erf");U(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=Pe(t,"float32"));const n={x:t};return Z.runKernel(wx,n)}const p9=J({erf_:wFe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g9(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Kle(e,t,n){const r=e.length+t.length,i=[];let s=0,o=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?i.push(e[s++]):i.push(t[o++]);return i}function ei(e,t){const n=[],r=e.length;for(let s=0;s<r;s++)t.indexOf(s)===-1&&n.push(e[s]);const i=t.map(s=>e[s]);return[n,i]}function mr(e,t){const n=t.map(r=>1);return Kle(e,n,t)}function ki(e,t,n){U(g9(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function nr(e,t){if(g9(e,t))return null;const n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(r=>n.push(r)),n}function Jh(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function yr(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Fe(e,t=null,n=!1){const i={x:W(e,"x","max")},s={reductionIndices:t,keepDims:n};return Z.runKernel(jC,i,s)}const Ma=J({max_:$Fe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CFe(e,t=null,n=!1){const i={x:W(e,"x","min")},s={axis:t,keepDims:n};return Z.runKernel(GC,i,s)}const Ww=J({min_:CFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SFe(e,t){let n=W(e,"base","pow"),r=W(t,"exp","pow");[n,r]=tr(n,r);const i={a:n,b:r};return Z.runKernel(Lx,i)}const Ef=J({pow_:SFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $t(e,t){if((Ir(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ir(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Qh(e,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kFe(e){const n={x:W(e,"x","sqrt","float32")};return Z.runKernel(Yx,n)}const wi=J({sqrt_:kFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EFe(e){const t=W(e,"x","square"),n={};return Z.runKernel("Square",{x:t},n)}const kn=J({square_:EFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AFe(e,t=null,n=!1){let r=W(e,"x","sum");r.dtype==="bool"&&(r=Pe(r,"int32"));const i={x:r},s={axis:t,keepDims:n};return Z.runKernel(uS,i,s)}const Ke=J({sum_:AFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Fe(e,t="euclidean",n=null,r=!1){e=W(e,"x","norm");const i=Qle(e,t,n);let s=i.shape;if(r){const o=Ot(n,e.shape);s=mr(i.shape,o)}return ie(i,s)}function Qle(e,t,n=null){if(e.rank===0)return Tr(e);if(e.rank!==1&&n===null)return Qle(ie(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return Ke(Tr(e),n);if(t===1/0)return Ma(Tr(e),n);if(t===-1/0)return Ww(Tr(e),n);if(t==="euclidean"||t===2)return wi(Ke(Ef(Tr(e),$t(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return Ma(Ke(Tr(e),n[0]),n[1]-1);if(t===1/0)return Ma(Ke(Tr(e),n[1]),n[0]);if(t===-1/0)return Ww(Ke(Tr(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return wi(Ke(kn(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const $S=J({norm_:_Fe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TFe(e,t=null,n=!1){return $S(e,"euclidean",t,n)}const Zle=J({euclideanNorm_:TFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IFe(e){const n={x:W(e,"x","exp")};return Z.runKernel($x,n)}const To=J({exp_:IFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NFe(e,t=0){const n=W(e,"x","expandDims","string_or_numeric");U(t<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},i={dim:t};return Z.runKernel(NC,r,i)}const us=J({expandDims_:NFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DFe(e){const n={x:W(e,"x","expm1")};return Z.runKernel(Cx,n)}const Jle=J({expm1_:DFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FFe(e,t){const n=W(e,"x","tile","string_or_numeric");U(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const r={x:n},i={reps:t};return Z.runKernel(eb,r,i)}const Ea=J({tile_:FFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RFe(e,t,n,r="float32"){t==null&&(t=e);const i=Ft([e,t],r),s=e<=t?e:t;for(let a=0;a<s;++a)i.set(1,a,a);const o=ie(i.toTensor(),[e,t]);if(n==null)return o;if(n.length===1)return Ea(us(o,0),[n[0],1,1]);if(n.length===2)return Ea(us(us(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ea(us(us(us(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const m9=J({eye_:RFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OFe(e){const n={x:W(e,"x","floor","float32")};return Z.runKernel(Sx,n)}const CS=J({floor_:OFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MFe(e,t,n=0,r=0){const i=W(e,"x","gather"),s=W(t,"indices","gather","int32"),o={x:i,indices:s},a={axis:n,batchDims:r};return Z.runKernel(FC,o,a)}const SS=J({gather_:MFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LFe(e,t){let n=W(e,"a","greater","string_or_numeric"),r=W(t,"b","greater","string_or_numeric");[n,r]=tr(n,r),At(n.shape,r.shape);const i={a:n,b:r};return Z.runKernel(RC,i)}const Uo=J({greater_:LFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PFe(e,t){let n=W(e,"a","greaterEqual","string_or_numeric"),r=W(t,"b","greaterEqual","string_or_numeric");[n,r]=tr(n,r),At(n.shape,r.shape);const i={a:n,b:r};return Z.runKernel(Ex,i)}const ep=J({greaterEqual_:PFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BFe(e){const n={input:W(e,"input","imag")};return Z.runKernel(VD,n)}const IF=J({imag_:BFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zFe(e){const n={x:W(e,"x","isFinite")};return Z.runKernel(_x,n)}const ece=J({isFinite_:zFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UFe(e){const n={x:W(e,"x","isInf")};return Z.runKernel(Tx,n)}const tce=J({isInf_:UFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jFe(e){const n={x:W(e,"x","isNaN")};return Z.runKernel(Ix,n)}const nce=J({isNaN_:jFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WFe(e,t=.2){const r={x:W(e,"x","leakyRelu")},i={alpha:t};return Z.runKernel(OC,r,i)}const NF=J({leakyRelu_:WFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VFe(e,t){let n=W(e,"a","less","string_or_numeric"),r=W(t,"b","less","string_or_numeric");[n,r]=tr(n,r),At(n.shape,r.shape);const i={a:n,b:r};return Z.runKernel(MC,i)}const Vw=J({less_:VFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qFe(e,t){let n=W(e,"a","lessEqual","string_or_numeric"),r=W(t,"b","lessEqual","string_or_numeric");[n,r]=tr(n,r),At(n.shape,r.shape);const i={a:n,b:r};return Z.runKernel(LC,i)}const jm=J({lessEqual_:qFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GFe(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:e,stop:t,num:n};return Z.runKernel(qD,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HFe(e,t=5,n=1,r=1,i=.5){const s=W(e,"x","localResponseNormalization");U(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),U(Jg(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let o=s,a=!1;s.rank===3&&(a=!0,o=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const u={x:o},l={depthRadius:t,bias:n,alpha:r,beta:i},c=Z.runKernel(UC,u,l);return a?ie(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const rce=J({localResponseNormalization_:HFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XFe(e){const n={x:W(e,"x","log","float32")};return Z.runKernel(Nx,n)}const ia=J({log_:XFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YFe(e){const n={x:W(e,"x","log1p")};return Z.runKernel(Dx,n)}const DF=J({log1p_:YFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KFe(e){return U(ch(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{const r=W(t,"x","tf.grad","string_or_numeric"),i=n!=null?W(n,"dy","tf.grad"):null;return Z.tidy(()=>{const{value:s,grads:o}=Z.gradients(()=>e(r),[r],i);return i!=null&&Ci(s.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),FF(o),o[0]})}}function QFe(e){return U(ch(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{U(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=zw(t,"args","tf.grads","string_or_numeric"),i=n!=null?W(n,"dy","tf.grads"):null;return Z.tidy(()=>{const{value:s,grads:o}=Z.gradients(()=>e(...r),r,i);return i!=null&&Ci(s.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),FF(o),o})}}function ZFe(e){return U(ch(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{U(t instanceof nn,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),U(n==null||n instanceof nn,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:i}=Z.gradients(()=>e(t),[t],n);return FF(r),{grad:r[0],value:i}}}function JFe(e){return U(ch(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{U(Array.isArray(t)&&t.every(i=>i instanceof nn),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),U(n==null||n instanceof nn,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=Z.gradients(()=>e(...t),t,n);return n!=null&&Ci(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),FF(r.grads),r}}function ice(e,t){U(ch(e),()=>"The f passed in variableGrads(f) must be a function"),U(t==null||Array.isArray(t)&&t.every(l=>l instanceof Bw),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const l in Z.registeredVariables)t.push(Z.registeredVariables[l])}const r=n?t.filter(l=>!l.trainable):null,i=t.length;t=t.filter(l=>l.trainable),U(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const s=!0,{value:o,grads:a}=Z.gradients(e,t,null,s);U(a.some(l=>l!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),U(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const u={};return t.forEach((l,c)=>{a[c]!=null&&(u[l.name]=a[c])}),r!=null&&r.forEach(l=>u[l.name]=null),{value:o,grads:u}}function Vl(e){return Z.customGrad(e)}function FF(e){if(e.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3e(e){const n={x:W(e,"x","neg")};return Z.runKernel(XC,n)}const Ln=J({neg_:e3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t3e(e){const n={x:W(e,"x","softplus")};return Z.runKernel(Xx,n)}const rb=J({softplus_:t3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n3e(e){const t=W(e,"x","logSigmoid");return Vl(r=>({value:Ln(rb(Ln(r))),gradFunc:o=>ee(o,Il(Ln(r)))}))(t)}const sce=J({logSigmoid_:n3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r3e(e,t){let n=W(e,"a","sub"),r=W(t,"b","sub");[n,r]=tr(n,r);const i={a:n,b:r};return Z.runKernel(Qx,i)}const Xe=J({sub_:r3e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3e(e,t=-1){const n=W(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Vl((i,s)=>{const a=Ma(i,t,!0),u=Xe(i,a),l=Xe(Pe(u,"float32"),ia(Ke(To(u),t,!0)));return s([l]),{value:l,gradFunc:(f,d)=>{const[h]=d,p=!0,m=To(h);return Xe(f,ee(Ke(f,t,p),m))}}})(n)}const y9=J({logSoftmax_:i3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3e(e,t=null,n=!1){const r=W(e,"x","logSumExp"),i=Ot(t,r.shape),s=Ma(r,i,!0),o=Xe(r,s),a=To(o),u=Ke(a,i),l=ia(u),c=Ee(ie(s,l.shape),l);if(n){const f=mr(c.shape,i);return ie(c,f)}return c}const RF=J({logSumExp_:s3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o3e(e,t){const n=W(e,"a","logicalAnd","bool"),r=W(t,"b","logicalAnd","bool");At(n.shape,r.shape);const i={a:n,b:r};return Z.runKernel(PC,i)}const ql=J({logicalAnd_:o3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3e(e){const n={x:W(e,"x","logicalNot","bool")};return Z.runKernel(BC,n)}const OF=J({logicalNot_:a3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3e(e,t){const n=W(e,"a","logicalOr","bool"),r=W(t,"b","logicalOr","bool");At(n.shape,r.shape);const i={a:n,b:r};return Z.runKernel(zC,i)}const x9=J({logicalOr_:u3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l3e(e,t){const n=W(e,"a","logicalXor","bool"),r=W(t,"b","logicalXor","bool");return At(n.shape,r.shape),ql(x9(e,t),OF(ql(e,t)))}const oce=J({logicalXor_:l3e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dA=2147483648;function c3e(e,t,n="left"){const r=W(e,"sortedSequence","searchSorted"),i=W(t,"values","searchSorted"),s=r.shape[r.shape.length-1],o=i.shape[i.shape.length-1],a=ie(r,[-1,s]),u=ie(i,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(me(u.shape)>=dA)throw new Error(`values tensor size must less than ${dA}`);if(a.shape[1]>=dA)throw new Error(`trailing dim_size must less than ${dA} for int32 output type, was ${a.shape[1]}`);const l={sortedSequence:a,values:u},c={side:n};return Z.runKernel(lF,l,c)}const b9=J({searchSorted_:c3e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f3e(e,t){return b9(e,t,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d3e(e,t,n,r,i){const s=W(e,"x","maxPool"),o=1;let a=s,u=!1;s.rank===3&&(u=!0,a=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),U(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),U(Si(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Es("maxPool",r,i);const l={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i},f=Z.runKernel(WC,l,c);return u?ie(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const MF=J({maxPool_:d3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h3e(e,t=[1,1,1],n,r,i,s="NDHWC"){const o=W(e,"x","maxPool3d");let a=o,u=!1;o.rank===4&&(u=!0,a=ie(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),U(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),U(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),Es("maxPool3d",r,i);const l={x:a},c={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:s},f=Z.runKernel(VC,l,c);return u?ie(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const ace=J({maxPool3d_:h3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3e(e,t,n,r,i=!1){const o={x:W(e,"x","maxPoolWithArgmax")},a={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},u=Z.runKernel(YD,o,a);return{result:u[0],indexes:u[1]}}const g3e=J({maxPoolWithArgmax_:p3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m3e(e,t){let n=W(e,"a","maximum"),r=W(t,"b","maximum");[n,r]=tr(n,r),n.dtype==="bool"&&(n=Pe(n,"int32"),r=Pe(r,"int32")),At(n.shape,r.shape);const i={a:n,b:r};return Z.runKernel(Fx,i)}const Uf=J({maximum_:m3e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y3e(e,t=null,n=!1){const i={x:W(e,"x","mean")},s={axis:t,keepDims:n};return Z.runKernel(qC,i,s)}const ar=J({mean_:y3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nr(e,t="float32"){if(zo(e),t==="complex64"){const r=Nr(e,"float32"),i=Nr(e,"float32");return fh(r,i)}const n=vi(me(e),t);return Z.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Co(e,t="float32"){if(zo(e),t==="complex64"){const r=Co(e,"float32"),i=Nr(e,"float32");return fh(r,i)}const n=yD(me(e),t);return Z.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x3e(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let r=W(e,"x","meshgrid",e instanceof nn?e.dtype:"float32");if(t===void 0)return[r];let i=W(t,"y","meshgrid",t instanceof nn?t.dtype:"float32");const s=me(r.shape),o=me(i.shape);return n==="xy"?(r=ie(r,[1,-1]),i=ie(i,[-1,1]),[Mt(Co([o,1],r.dtype),r),Mt(i,Co([1,s],i.dtype))]):(r=ie(r,[-1,1]),i=ie(i,[1,-1]),[Mt(r,Co([1,o],r.dtype)),Mt(Co([s,1],i.dtype),i)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3e(e,t){let n=W(e,"a","minimum"),r=W(t,"b","minimum");[n,r]=tr(n,r),n.dtype==="bool"&&(n=Pe(n,"int32"),r=Pe(r,"int32")),At(n.shape,r.shape);const i={a:n,b:r};return Z.runKernel(Rx,i)}const om=J({minimum_:b3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3e(e,t,n){U(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=W(e,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");U(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);const i=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)U(t[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),U(t[a][0]>=0&&t[a][0]<=r.shape[a]-i&&t[a][1]>=0&&t[a][1]<=r.shape[a]-i,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-i} or less than 0 for input of shape ${r.shape}`);const s={paddings:t,mode:n},o={x:r};return Z.runKernel(HC,o,s)}const uce=J({mirrorPad_:v3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w3e(e,t){let n=W(e,"a","mod"),r=W(t,"b","mod");[n,r]=tr(n,r);const i={a:n,b:r};return Z.runKernel(Ox,i)}const lce=J({mod_:w3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3e(e,t=null,n=!1){e=W(e,"x","moments");const r=Ot(t,e.shape),i=ar(e,r,n);let s=i.shape;n||(s=mr(i.shape,r));const o=kn(Xe(Pe(e,"float32"),ie(i,s))),a=ar(o,r,n);return{mean:i,variance:a}}const LF=J({moments_:$3e});function C3e(e,t,n,r){const i=W(t,"data","multiRNNCell"),s=zw(n,"c","multiRNNCell"),o=zw(r,"h","multiRNNCell");let a=i;const u=[];for(let f=0;f<e.length;f++){const d=e[f](a,s[f],o[f]);u.push(d[0]),u.push(d[1]),a=d[1]}const l=[],c=[];for(let f=0;f<u.length;f+=2)l.push(u[f]),c.push(u[f+1]);return[l,c]}const S3e=J({multiRNNCell_:C3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k3e(e,t,n,r=!1){const i=W(e,"logits","multinomial"),s=i.size,o=i.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const u={logits:o===1?ie(i,[1,-1]):i},l={numSamples:t,seed:n,normalized:r},c=Z.runKernel(KD,u,l);return o===1?ie(c,[c.size]):c}const E3e=J({multinomial_:k3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A3e(e,t){let n=W(e,"a","notEqual","string_or_numeric"),r=W(t,"b","notEqual","string_or_numeric");[n,r]=tr(n,r),At(n.shape,r.shape);const i={a:n,b:r};return Z.runKernel(YC,i)}const sy=J({notEqual_:A3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _3e(e,t,n=1,r=0,i="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const o={indices:W(e,"indices","oneHot","int32")},a={dtype:i,depth:t,onValue:n,offValue:r};return Z.runKernel(QC,o,a)}const qw=J({oneHot_:_3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T3e(e){const n={x:W(e,"x","onesLike")};return Z.runKernel(KC,n)}const sa=J({onesLike_:T3e});function I3e(e,t){const n=W(e,"v1","outerProduct"),r=W(t,"v2","outerProduct");U(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const i=ie(n,[-1,1]),s=ie(r,[1,-1]);return Mt(i,s)}const N3e=J({outerProduct_:I3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D3e(e,t,n=0){const r=W(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:t,constantValue:n},s={x:r};return Z.runKernel(JC,s,i)}const tp=J({pad_:D3e});function F3e(e,t,n=0){return U(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),tp(e,[t],n)}const R3e=J({pad1d_:F3e});function O3e(e,t,n=0){return U(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),tp(e,t,n)}const M3e=J({pad2d_:O3e});function L3e(e,t,n=0){return U(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),tp(e,t,n)}const P3e=J({pad3d_:L3e});function B3e(e,t,n=0){return U(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),tp(e,t,n)}const z3e=J({pad4d_:B3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3e(e,t,n){const r=W(e,"x","spaceToBatchND");U(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),U(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),U(r.shape.reduce((o,a,u)=>u>0&&u<=t.length?o&&(a+n[u-1][0]+n[u-1][1])%t[u-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const i={x:r},s={blockShape:t,paddings:n};return Z.runKernel(lS,i,s)}const PF=J({spaceToBatchND_:U3e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3e(e,t,n,r,i,s,o){i==null&&(i=[1,1]),s==null&&(s=1),r===0&&(r="valid");const a=W(e,"x","maxPool");let u=a,l=!1;a.rank===3&&(l=!0,u=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]])),U(Si(s,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`);const c=Xa(u.shape,t,s,i,r),f=[c.dilationHeight,c.dilationWidth];let d;r==="same"?d=V3e([c.filterHeight,c.filterWidth],f):d=[[0,0],[0,0]];const h=f[0]===1&&f[1]===1,[p,m]=W3e([c.inHeight,c.inWidth],f,d),x=h?r:"valid",b=h?u:PF(u,f,p),$=(n==="avg"?()=>AF(b,t,s,x,o):()=>MF(b,t,s,x,o))(),C=h?$:_F($,f,m);return l?ie(C,[C.shape[1],C.shape[2],C.shape[3]]):C}function W3e(e,t,n){const r=n.map(c=>c[0]),i=n.map(c=>c[1]),s=e.concat(r,i),o=t.map((c,f)=>(c-s[f]%c)%c),a=i.map((c,f)=>c+o[f]),u=t.map((c,f)=>[r[f],a[f]]),l=t.map((c,f)=>[0,o[f]]);return[u,l]}function V3e(e,t){const r=e.map((o,a)=>o+(o-1)*(t[a]-1)).map(o=>o-1),i=r.map(o=>Math.floor(o/2)),s=r.map((o,a)=>o-i[a]);return r.map((o,a)=>[i[a],s[a]])}const cce=J({pool_:j3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q3e(e,t){const n=W(e,"x","prelu"),r=W(t,"alpha","prelu"),i={x:n,alpha:r};return Z.runKernel(eS,i)}const BF=J({prelu_:q3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G3e(e,t=null,n=!1){let r=W(e,"x","prod");r.dtype==="bool"&&(r=Pe(r,"int32"));const i={x:r},s={axis:t,keepDims:n};return Z.runKernel(tS,i,s)}const fce=J({prod_:G3e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H3e(e,t,n,r){const i=e.map((c,f)=>W(c,`tensors${f}`,"raggedGather","int32")),s=W(t,"paramsDenseValues","raggedGather"),o=W(n,"indices","raggedGather","int32"),a={paramsNestedSplits:i,paramsDenseValues:s,indices:o},u={outputRaggedRank:r},l=Z.runKernel(eF,a,u);return{outputNestedSplits:l.slice(0,l.length-1),outputDenseValues:l[l.length-1]}}const X3e=J({raggedGather_:H3e});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y3e(e,t,n){const r=W(e,"starts","raggedRange"),i=W(t,"limits","raggedRange",r.dtype),s=W(n,"deltas","raggedRange",r.dtype),o={starts:r,limits:i,deltas:s},a=Z.runKernel(tF,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const K3e=J({raggedRange_:Y3e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q3e(e,t,n,r,i){const s=W(e,"shape","raggedTensorToTensor","int32"),o=W(t,"values","raggedTensorToTensor"),a=W(n,"defaultValue","raggedTensorToTensor",o.dtype),u=r.map((f,d)=>W(f,`tensors${d}`,"raggedTensorToTensor","int32")),l={shape:s,values:o,defaultValue:a,rowPartitionTensors:u},c={rowPartitionTypes:i};return Z.runKernel(nF,l,c)}const Z3e=J({raggedTensorToTensor_:Q3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J3e(e,t,n){zo(e);const r=me(e);let i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else if(n==="bool")i=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let s=0;s<r;s++)i[s]=t();return Z.makeTensor(i,e,n)}const eRe=J({rand_:J3e});var Q_={exports:{}},tRe=Q_.exports,uZ;function nRe(){return uZ||(uZ=1,function(e){(function(t,n,r){function i(u){var l=this,c=a();l.next=function(){var f=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=f|0)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(u),l.s0<0&&(l.s0+=1),l.s1-=c(u),l.s1<0&&(l.s1+=1),l.s2-=c(u),l.s2<0&&(l.s2+=1),c=null}function s(u,l){return l.c=u.c,l.s0=u.s0,l.s1=u.s1,l.s2=u.s2,l}function o(u,l){var c=new i(u),f=l&&l.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,f&&(typeof f=="object"&&s(f,c),d.state=function(){return s(c,{})}),d}function a(){var u=4022871197,l=function(c){c=String(c);for(var f=0;f<c.length;f++){u+=c.charCodeAt(f);var d=.02519603282416938*u;u=d>>>0,d-=u,d*=u,u=d>>>0,d-=u,u+=d*4294967296}return(u>>>0)*23283064365386963e-26};return l}n.exports?n.exports=o:this.alea=o})(tRe,e)}(Q_)),Q_.exports}var Z_={exports:{}},rRe=Z_.exports,lZ;function iRe(){return lZ||(lZ=1,function(e){(function(t,n,r){function i(a){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},a===(a|0)?u.x=a:l+=a;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,u.next()}function s(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u}function o(a,u){var l=new i(a),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&s(c,l),f.state=function(){return s(l,{})}),f}n.exports?n.exports=o:this.xor128=o})(rRe,e)}(Z_)),Z_.exports}var J_={exports:{}},sRe=J_.exports,cZ;function oRe(){return cZ||(cZ=1,function(e){(function(t,n,r){function i(a){var u=this,l="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(f^f<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,a===(a|0)?u.x=a:l+=a;for(var c=0;c<l.length+64;c++)u.x^=l.charCodeAt(c)|0,c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function s(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u.v=a.v,u.d=a.d,u}function o(a,u){var l=new i(a),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&s(c,l),f.state=function(){return s(l,{})}),f}n.exports?n.exports=o:this.xorwow=o})(sRe,e)}(J_)),J_.exports}var eT={exports:{}},aRe=eT.exports,fZ;function uRe(){return fZ||(fZ=1,function(e){(function(t,n,r){function i(a){var u=this;u.next=function(){var c=u.x,f=u.i,d,h;return d=c[f],d^=d>>>7,h=d^d<<24,d=c[f+1&7],h^=d^d>>>10,d=c[f+3&7],h^=d^d>>>3,d=c[f+4&7],h^=d^d<<7,d=c[f+7&7],d=d^d<<13,h^=d^d<<9,c[f]=h,u.i=f+1&7,h};function l(c,f){var d,h=[];if(f===(f|0))h[0]=f;else for(f=""+f,d=0;d<f.length;++d)h[d&7]=h[d&7]<<15^f.charCodeAt(d)+h[d+1&7]<<13;for(;h.length<8;)h.push(0);for(d=0;d<8&&h[d]===0;++d);for(d==8?h[7]=-1:h[d],c.x=h,c.i=0,d=256;d>0;--d)c.next()}l(u,a)}function s(a,u){return u.x=a.x.slice(),u.i=a.i,u}function o(a,u){a==null&&(a=+new Date);var l=new i(a),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},f.int32=l.next,f.quick=f,c&&(c.x&&s(c,l),f.state=function(){return s(l,{})}),f}n.exports?n.exports=o:this.xorshift7=o})(aRe,e)}(eT)),eT.exports}var tT={exports:{}},lRe=tT.exports,dZ;function cRe(){return dZ||(dZ=1,function(e){(function(t,n,r){function i(a){var u=this;u.next=function(){var c=u.w,f=u.X,d=u.i,h,p;return u.w=c=c+1640531527|0,p=f[d+34&127],h=f[d=d+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=f[d]=p^h,u.i=d,p+(c^c>>>16)|0};function l(c,f){var d,h,p,m,x,b=[],v=128;for(f===(f|0)?(h=f,f=null):(f=f+"\0",h=0,v=Math.max(v,f.length)),p=0,m=-32;m<v;++m)f&&(h^=f.charCodeAt((m+32)%f.length)),m===0&&(x=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,m>=0&&(x=x+1640531527|0,d=b[m&127]^=h+x,p=d==0?p+1:0);for(p>=128&&(b[(f&&f.length||0)&127]=-1),p=127,m=4*128;m>0;--m)h=b[p+34&127],d=b[p=p+1&127],h^=h<<13,d^=d<<17,h^=h>>>15,d^=d>>>12,b[p]=h^d;c.w=x,c.X=b,c.i=p}l(u,a)}function s(a,u){return u.i=a.i,u.w=a.w,u.X=a.X.slice(),u}function o(a,u){a==null&&(a=+new Date);var l=new i(a),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},f.int32=l.next,f.quick=f,c&&(c.X&&s(c,l),f.state=function(){return s(l,{})}),f}n.exports?n.exports=o:this.xor4096=o})(lRe,e)}(tT)),tT.exports}var nT={exports:{}},fRe=nT.exports,hZ;function dRe(){return hZ||(hZ=1,function(e){(function(t,n,r){function i(a){var u=this,l="";u.next=function(){var f=u.b,d=u.c,h=u.d,p=u.a;return f=f<<25^f>>>7^d,d=d-h|0,h=h<<24^h>>>8^p,p=p-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-h|0,u.d=h<<16^d>>>16^p,u.a=p-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,a===Math.floor(a)?(u.a=a/4294967296|0,u.b=a|0):l+=a;for(var c=0;c<l.length+20;c++)u.b^=l.charCodeAt(c)|0,u.next()}function s(a,u){return u.a=a.a,u.b=a.b,u.c=a.c,u.d=a.d,u}function o(a,u){var l=new i(a),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,h=(l.next()>>>0)/4294967296,p=(d+h)/(1<<21);while(p===0);return p},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&s(c,l),f.state=function(){return s(l,{})}),f}n.exports?n.exports=o:this.tychei=o})(fRe,e)}(nT)),nT.exports}var rT={exports:{}};const hRe={},pRe=Object.freeze(Object.defineProperty({__proto__:null,default:hRe},Symbol.toStringTag,{value:"Module"})),gRe=Lm(pRe);var mRe=rT.exports,pZ;function yRe(){return pZ||(pZ=1,function(e){(function(t,n,r){var i=256,s=6,o=52,a="random",u=r.pow(i,s),l=r.pow(2,o),c=l*2,f=i-1,d;function h(C,S,A){var E=[];S=S==!0?{entropy:!0}:S||{};var _=b(x(S.entropy?[C,$(n)]:C??v(),3),E),D=new p(E),N=function(){for(var T=D.g(s),L=u,O=0;T<l;)T=(T+O)*i,L*=i,O=D.g(1);for(;T>=c;)T/=2,L/=2,O>>>=1;return(T+O)/L};return N.int32=function(){return D.g(4)|0},N.quick=function(){return D.g(4)/4294967296},N.double=N,b($(D.S),n),(S.pass||A||function(T,L,O,M){return M&&(M.S&&m(M,D),T.state=function(){return m(D,{})}),O?(r[a]=T,L):T})(N,_,"global"in S?S.global:this==r,S.state)}function p(C){var S,A=C.length,E=this,_=0,D=E.i=E.j=0,N=E.S=[];for(A||(C=[A++]);_<i;)N[_]=_++;for(_=0;_<i;_++)N[_]=N[D=f&D+C[_%A]+(S=N[_])],N[D]=S;(E.g=function(T){for(var L,O=0,M=E.i,R=E.j,P=E.S;T--;)L=P[M=f&M+1],O=O*i+P[f&(P[M]=P[R=f&R+L])+(P[R]=L)];return E.i=M,E.j=R,O})(i)}function m(C,S){return S.i=C.i,S.j=C.j,S.S=C.S.slice(),S}function x(C,S){var A=[],E=typeof C,_;if(S&&E=="object")for(_ in C)try{A.push(x(C[_],S-1))}catch{}return A.length?A:E=="string"?C:C+"\0"}function b(C,S){for(var A=C+"",E,_=0;_<A.length;)S[f&_]=f&(E^=S[f&_]*19)+A.charCodeAt(_++);return $(S)}function v(){try{var C;return d&&(C=d.randomBytes)?C=C(i):(C=new Uint8Array(i),(t.crypto||t.msCrypto).getRandomValues(C)),$(C)}catch{var S=t.navigator,A=S&&S.plugins;return[+new Date,t,A,t.screen,$(n)]}}function $(C){return String.fromCharCode.apply(0,C)}if(b(r.random(),n),e.exports){e.exports=h;try{d=gRe}catch{}}else r["seed"+a]=h})(typeof self<"u"?self:mRe,[],Math)}(rT)),rT.exports}var RL,gZ;function xRe(){if(gZ)return RL;gZ=1;var e=nRe(),t=iRe(),n=oRe(),r=uRe(),i=cRe(),s=dRe(),o=yRe();return o.alea=e,o.xor128=t,o.xorwow=n,o.xorshift7=r,o.xor4096=i,o.tychei=s,RL=o,RL}var ib=xRe();/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bRe=.001,dce=.1;function vRe(e,t,n){return n==null&&(n=v9()),v6(e,t,(r,i)=>w9(r,i,n))}function v9(){return Z.backend.floatPrecision()===32?bRe:dce}function v6(e,t,n){let r=!0;if((Ir(e)||Ir(t))&&(r=!1),Ir(e)&&Ir(t)&&(r=!0),r){const o=e.constructor.name,a=t.constructor.name;if(o!==a)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${a}`)}if(Array.isArray(e)&&Array.isArray(t)){const o=Wl(e),a=Wl(t);if(!Gt(o,a))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${a}]`)}const i=Ir(e)?e:jl(e),s=Ir(t)?t:jl(t);if(i.length!==s.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${s.length}.
Actual:   ${i}.
Expected: ${s}.`);for(let o=0;o<s.length;++o){const a=i[o],u=s[o];if(!n(a,u))throw new Error(`Arrays differ: actual[${o}] = ${a}, expected[${o}] = ${u}.
Actual:   ${i}.
Expected: ${s}.`)}typeof expect<"u"&&expect().nothing()}function wRe(e,t){e().then(()=>t.fail(),()=>t()),typeof expect<"u"&&expect().nothing()}function $Re(e,t){const n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return kl(e)||kl(e[0])||kl(t)||kl(t[0])?v6(e,n,(r,i)=>r==i):v6(e,t,(r,i)=>w9(r,i,0))}function CRe(e,t,n){if(n==null&&(n=v9()),!w9(e,t,n))throw new Error(`Numbers differ: actual === ${e}, expected === ${t}`);typeof expect<"u"&&expect().nothing()}function w9(e,t,n){return!isFinite(e)&&!isFinite(t)?!0:!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function SRe(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function kRe(e,t){const n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let i=0;i<r.length;i++)if(n[i]!==r[i])throw new Error(`Expected ArrayBuffer value at ${i} to be ${r[i]} but got ${n[i]} instead`)}function hce(e){for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(n)?hce(n):e[t]=Tl(n)}return e}function ERe(e){const t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(n=>{t.addEventListener("loadeddata",r=>n(t)),t.load()})}async function ARe(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}const _Re=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:dce,createVideoElement:ERe,encodeStrings:hce,expectArrayBuffersEqual:kRe,expectArraysClose:vRe,expectArraysEqual:$Re,expectNumbersClose:CRe,expectPromiseToFail:wRe,expectValuesInRange:SRe,play:ARe,testEpsilon:v9},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $9{constructor(t,n,r,i,s){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=s||Math.random();this.random=ib.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let t,n,r=!1;for(;!r;){let i,s,o;do i=2*this.random()-1,s=2*this.random()-1,o=i*i+s*s;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*i*a,n=this.mean+this.stdDev*s*a,(!this.truncated||this.isValidTruncated(t))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class TRe{constructor(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;const s=i||Math.random();this.randu=ib.alea(s.toString()),this.randn=new $9(0,1,r,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,n,r,i,s,o;for(;;){do i=this.randn.nextValue(),o=1+this.c*i;while(o<=0);if(o*=o*o,t=i*i,n=1-.331*t*t,r=.5*t+this.d*(1-o+Math.log(o)),s=this.randu(),s<n||Math.log(s)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class IRe{constructor(t=0,n=1,r,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=ib.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NRe(e,t,n=1,r="float32",i){if(zo(e),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const s=new TRe(t,n,r,i),o=Ft(e,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}const DRe=J({randomGamma_:NRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FRe(e,t=0,n=1,r,i){if(zo(e),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const s=new $9(t,n,r,!1,i),o=Ft(e,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}const C9=J({randomNormal_:FRe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RRe(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return C9(e,0,1,t,n)}const ORe=J({randomStandardNormal_:RRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MRe(e,t=0,n=1,r="float32",i){zo(e);const s=Ft(e,r),o=new IRe(t,n,null,i);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}const Wm=J({randomUniform_:MRe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LRe(e,t,n,r){return Wm(e,t,n,"int32",r)}const PRe=J({randomUniformInt_:LRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oy(e,t,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const i={start:e,stop:t,step:n,dtype:r};return Z.runKernel(rF,{},i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BRe(e){const n={input:W(e,"input","real")};return Z.runKernel(iF,n)}const Gw=J({real_:BRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zRe(e){const n={x:W(e,"x","reciprocal")};return Z.runKernel(Px,n)}const pce=J({reciprocal_:zRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function URe(e){const n={x:W(e,"x","relu")};return Z.runKernel(Bx,n)}const uc=J({relu_:URe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jRe(e){const n={x:W(e,"x","relu6")};return Z.runKernel(zx,n)}const S9=J({relu6_:jRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WRe(e,t){const r={x:W(e,"x","reverse")},i={dims:t};return Z.runKernel(sS,r,i)}const Ba=J({reverse_:WRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VRe(e){const t=W(e,"x","reverse");return U(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Ba(t,0)}const qRe=J({reverse1d_:VRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GRe(e,t){const n=W(e,"x","reverse");return U(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Ba(n,t)}const HRe=J({reverse2d_:GRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XRe(e,t){const n=W(e,"x","reverse");return U(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Ba(n,t)}const YRe=J({reverse3d_:XRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KRe(e,t){const n=W(e,"x","reverse");return U(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Ba(n,t)}const QRe=J({reverse4d_:KRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZRe(e){const n={x:W(e,"x","round")};return Z.runKernel(Ux,n)}const k9=J({round_:ZRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JRe(e){const n={x:W(e,"x","rsqrt","float32")};return Z.runKernel(jx,n)}const E9=J({rsqrt_:JRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eOe(e){const n={x:W(e,"x","selu")};return Z.runKernel(Wx,n)}const A9=J({selu_:eOe});function tOe(e,t,n,r,i,s=[1,1],o="NHWC"){const a=W(e,"x","separableConv2d"),u=W(t,"depthwiseFilter","separableConv2d"),l=W(n,"pointwiseFilter","separableConv2d");let c=a,f=!1;if(a.rank===3&&(f=!0,c=ie(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");U(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),U(u.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),U(l.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),U(l.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${l.shape[0]}.`),U(l.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${l.shape[1]}.`);const d=u.shape[2],h=u.shape[3];U(l.shape[2]===d*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*h}, but got ${l.shape[2]}.`);const p=vS(c,u,r,i,o,s),x=ph(p,l,1,"valid",o);return f?ie(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const _9=J({separableConv2d_:tOe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function nOe(e,t){const n=W(e,"x","setdiff1d"),r=W(t,"y","setdiff1d");U(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),U(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),U(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const i=await n.data(),s=await r.data(),o=new Set(s);let a=0;for(let c=0;c<i.length;c++)o.has(i[c])||a++;const u=new Sr([a],n.dtype),l=new Sr([a],"int32");for(let c=0,f=0;c<i.length;c++)o.has(i[c])||(u.values[f]=i[c],l.values[f]=c,f++);return[u.toTensor(),l.toTensor()]}const rOe=nOe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iOe(e){const n={x:W(e,"x","sign")};return Z.runKernel(Gx,n)}const gce=J({sign_:iOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sOe(e){const n={x:W(e,"x","sin","float32")};return Z.runKernel(Vx,n)}const T9=J({sin_:sOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oOe(e){const n={x:W(e,"x","sinh")};return Z.runKernel(qx,n)}const I9=J({sinh_:oOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aOe(e,t,n){const r=W(e,"x","slice1d");return U(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Kt(r,[t],[n])}const zF=J({slice1d_:aOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uOe(e,t,n){const r=W(e,"x","slice2d");return U(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Kt(r,t,n)}const N9=J({slice2d_:uOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lOe(e,t,n){const r=W(e,"x","slice3d");return U(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Kt(r,t,n)}const UF=J({slice3d_:lOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cOe(e,t,n){const r=W(e,"x","slice4d");return U(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Kt(r,t,n)}const Hw=J({slice4d_:cOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fOe(e,t=-1){const n=W(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const r={logits:n},i={dim:t};return Z.runKernel(fS,r,i)}const jF=J({softmax_:fOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dOe(e){U(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);const t={input:e};return Z.runKernel(BD,t)}const WF=J({fft_:dOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hOe(e){U(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);const t={input:e};return Z.runKernel(WD,t)}const Xw=J({ifft_:hOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pOe(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const i=ie(e,[n,t]);r=Xw(i)}else{const i=[n,2*(t-1)],s=ie(Gw(e),[n,t]),o=ie(IF(e),[n,t]),a=Ba(Kt(s,[0,1],[n,t-2]),1),u=ee(Ba(Kt(o,[0,1],[n,t-2]),1),$t(-1)),l=Yr([s,a],1),c=Yr([o,u],1),f=ie(fh(l,c),[i[0],i[1]]);r=Xw(f)}if(r=Gw(r),e.rank===3&&e.shape[0]!==0){const i=r,s=e.shape[0];r=ie(r,[s,r.shape[0]/s,r.shape[1]]),i.dispose()}return r}const D9=J({irfft_:pOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gOe(e,t,n=0){const i={x:W(e,"x","split")},s={numOrSizeSplits:t,axis:n};return Z.runKernel(cS,i,s)}const Ws=J({split_:gOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mOe(e,t){U(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1];const r=e.size/n;let i;if(t!=null&&t<n){const p=e.shape.map(x=>0),m=e.shape.map(x=>x);m[e.shape.length-1]=t,i=Kt(e,p,m),n=t}else if(t!=null&&t>n){const p=e.shape.map(m=>m);p[e.shape.length-1]=t-n,i=Yr([e,Nr(p)],e.shape.length-1),n=t}else i=e;const s=Xt(i),o=ie(fh(i,s),[r,n]),a=WF(o),u=Math.floor(n/2)+1,l=Gw(a),c=IF(a),f=Ws(l,[u,n-u],l.shape.length-1),d=Ws(c,[u,n-u],c.shape.length-1),h=i.shape.slice();return h[i.shape.length-1]=u,ie(fh(f[0],d[0]),h)}const VF=J({rfft_:mOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yOe(e,t){let n=W(e,"a","squaredDifference"),r=W(t,"b","squaredDifference");[n,r]=tr(n,r),At(n.shape,r.shape);const i={a:n,b:r},s={};return Z.runKernel(Kx,i,s)}const F9=J({squaredDifference_:yOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xOe(e,t){const n=W(e,"x","squeeze","string_or_numeric");return ie(n,Lf(n.shape,t).newShape)}const Vm=J({squeeze_:xOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bOe(e,t=0){const n=zw(e,"tensors","stack","string_or_numeric");U(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&U(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,i={axis:t};return Z.runKernel(ZC,r,i)}const Lu=J({stack_:bOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vOe(e,t=0){const r={x:W(e,"x","step")},i={alpha:t};return Z.runKernel(tb,r,i)}const sb=J({step_:vOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wOe(e,t,n,r,i=0,s=0,o=0,a=0,u=0){const c={x:W(e,"x","stridedSlice","string_or_numeric")},f={begin:t,end:n,strides:r,beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:u};return Z.runKernel(mF,c,f)}const mce=J({stridedSlice_:wOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Oe(e){const n={x:W(e,"x","tan","float32")};return Z.runKernel(Zx,n)}const yce=J({tan_:$Oe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Li(e,t){Pm(e);const n=Wl(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Qh(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lw(e,t,n){if(Pm(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Wl(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Qh(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xce(e,t,n){if(Pm(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Wl(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Qh(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function COe(e,t,n){if(Pm(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Wl(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Qh(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SOe(e,t,n){if(Pm(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Wl(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Qh(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kOe(e,t,n){if(Pm(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Wl(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,Qh(e,t,r,n)}function R9(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(s+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw new Error(s+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw new Error(s+` update.rank != ${i+e.length-r}`);for(let o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(s+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${t.shape[o]}).`);for(let o=0;o<n.rank-i;++o)if(n.shape[o+i]!==e[o+r])throw new Error(s+` updates.shape[${o+i}] (${n.shape[o+i]}) != shape[${o+i}] (${e[o+i]})`)}function qF(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}R9(n,t,e)}function np(e,t,n){const r=t.shape.length,i=r>1?t.shape[r-1]:1,s=n.length;let o=1;for(let f=i;f<s;++f)o*=n[f];const a=i<1?1:i,u=me(t.shape)/a,l=[...ut(n.slice(0,i)),1],c=me(n);return{sliceRank:i,numUpdates:u,sliceSize:o,strides:l,outputSize:c}}const EOe=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:np,validateInput:qF,validateUpdateShape:R9},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AOe(e,t,n){const r=W(e,"tensor","tensorScatterupdate"),i=W(t,"indices","tensorScatterupdate","int32"),s=W(n,"updates","tensorScatterupdate");if(qF(s,i,r.shape),r.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${s.dtype}.`);const o={tensor:r,indices:i,updates:s},a={};return Z.runKernel(uF,o,a)}const _Oe=J({tensorScatterUpdate_:AOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TOe(e,t=1,n=!0){const r=W(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const s={x:r},o={k:t,sorted:n},[a,u]=Z.runKernel(vF,s,o);return{values:a,indices:u}}const bce=J({topk_:TOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IOe(e,t=0,n=1,r,i){if(zo(e),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const s=new $9(t,n,r,!0,i),o=Ft(e,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}const O9=J({truncatedNormal_:IOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NOe(e,t=0){const n=W(e,"x","unique","string_or_numeric");U(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},i={axis:t},[s,o]=Z.runKernel($F,r,i);return{values:s,indices:o}}const vce=J({unique_:NOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DOe(e,t,n){const r=W(e,"x","unsortedSegmentSum"),i=W(t,"segmentIds","unsortedSegmentSum","int32");U(Jg(n),()=>"numSegments must be of dtype int");const s={x:r,segmentIds:i},o={numSegments:n};return Z.runKernel(pS,s,o)}const M9=J({unsortedSegmentSum_:DOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FOe(e,t=0){const n=W(e,"x","unstack","string_or_numeric");U(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},i={axis:t};return Z.runKernel(hS,r,i)}const gh=J({unstack_:FOe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ROe(e,t){return b9(e,t,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wce(e,t=!0,n,r){return Z.makeVariable(e,t,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GF(e,t){const n=[];for(let s=0;s<t.length;s++)t[s]&&n.push(s);const r=Ft(e,"int32"),i=Ft([n.length,e.length],"int32");for(let s=0;s<n.length;s++){const o=r.indexToLoc(n[s]),a=s*e.length;i.values.set(o,a)}return i.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function OOe(e){const t=W(e,"condition","whereAsync","bool"),n=await t.data(),r=GF(t.shape,n);return e!==t&&t.dispose(),r}const $ce=OOe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function MOe(e,t,n){const r=W(e,"tensor","boolMask"),i=W(t,"mask","boolMask","bool"),s=n??0,o=i.rank,a=r.shape;U(o>0,()=>"mask cannot be scalar"),Ci(a.slice(s,s+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let m=s;m<s+o;m++)u*=a[m];const l=a.slice(0,s).concat([u],a.slice(s+o)),c=ie(r,l),f=ie(i,[-1]),d=await $ce(f),h=Vm(d,[1]),p=SS(c,h,s);return e!==r&&r.dispose(),t!==i&&i.dispose(),h.dispose(),c.dispose(),f.dispose(),d.dispose(),p}const LOe=MOe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function POe(e,t,n){const r=W(e,"x","transpose");if(t==null&&(t=r.shape.map((o,a)=>a).reverse()),U(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(o=>{U(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();const i={x:r},s={perm:t};return r.dtype==="complex64"?fe(()=>{let o=Gw(r),a=IF(r);return o=Z.runKernel(Mg,{x:o},s),a=Z.runKernel(Mg,{x:a},s),n&&(a=Ln(a)),fh(o,a)}):Z.runKernel(Mg,i,s)}const Vt=J({transpose_:POe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BOe(e,t,n,r,i=!0){const s=W(e,"v","movingAverage"),o=W(t,"x","movingAverage"),a=W(n,"decay","movingAverage");ile(s,o),U(Gt(s.shape,o.shape),()=>"Shape mismatch in v and x");const u=$t(1),l=Xe(u,a);let c=ee(Xe(o,s),l);if(i){U(r!=null,()=>"When using zeroDebias: true, step is required.");const f=W(r,"step","movingAverage");c=st(c,Xe(u,Ef(a,f)))}return Ee(s,c)}const zOe=J({movingAverage_:BOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UOe(e,t,n){zo(n);const r=W(e,"indices","scatterND","int32"),i=W(t,"updates","scatterND");qF(i,r,n);const s={indices:r,updates:i},o={shape:n};return Z.runKernel(aF,s,o)}const jOe=J({scatterND_:UOe});function WOe(e,t,n,r){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const i=e.rank>0?e.shape[0]:1,s=e.rank>1?e.shape[1]:1;if(n.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${s}.`);const o=t.size;if(!(t.rank===0||t.rank===1&&o===i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VOe(e,t,n,r=0){zo(n);const i=W(e,"sparseIndices","sparseToDense","int32"),s=W(t,"sparseValues","sparseToDense","string_or_numeric"),o=W(r,"defaultValue","sparseToDense",s.dtype);WOe(i,s,n,o);const a={sparseIndices:i,sparseValues:s,defaultValue:o},u={outputShape:n};return Z.runKernel(pF,a,u)}const qOe=J({sparseToDense_:VOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GOe(e,t){const n=W(t,"indices","gatherND","int32"),i={params:W(e,"x","gatherND","string_or_numeric"),indices:n};return Z.runKernel(jD,i)}const HOe=J({gatherND_:GOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XOe(e,t){if(t==null)return e.shape.slice();if(Gt(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YOe(e,t,n,r){const i=W(e,"x","dropout");if(U(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),U(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof nn?i.clone():i;const s=XOe(i,n),o=1-t,a=st(CS(Ee(Wm(s,0,1,"float32",r),o)),o);return ee(i,a)}const Cce=J({dropout_:YOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sce(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function L9(e,t,n){const r=1-e%2,i=new Float32Array(e);for(let s=0;s<e;++s){const o=2*Math.PI*s/(e+r-1);i[s]=t-n*Math.cos(o)}return Li(i,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function KOe(e,t,n=1){const r=W(e,"predictions","inTopK"),i=W(t,"targets","inTopK");U(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),U(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),Ci(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=r.shape[r.shape.length-1];U(n>0&&n<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${n}`);const o=await r.data(),a=await i.data(),[u,l]=[o.length/s,s],c=Zr("bool",u);for(let f=0;f<u;f++){const d=f*l,h=o.subarray(d,d+l),p=[];for(let m=0;m<h.length;m++)p.push({value:h[m],index:m});p.sort((m,x)=>x.value-m.value),c[f]=0;for(let m=0;m<n;m++)if(p[m].index===a[f]){c[f]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),Jd(c,i.shape,"bool")}const QOe=KOe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZOe(e,t,n,r,i,s="NHWC",o){let a=e;e.rank===3&&(a=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;u.rank===3&&(u=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]])),U(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),U(u.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),U(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const l=s==="NHWC"?a.shape[3]:a.shape[1],c=s==="NHWC"?u.shape[3]:u.shape[1];U(l===n[2],()=>`Error in conv2dDerFilter: depth of input ${l}) must match input depth in filter (${n[2]}.`),U(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Es("conv2dDerFilter",i,o);const f={x:a,dy:u},d={strides:r,pad:i,dataFormat:s,dimRoundingMode:o,filterShape:n};return Z.runKernel(ED,f,d)}const P9=J({conv2DBackpropFilter_:ZOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HF(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return ee(e,sb(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function XF(e,t){let n=t;const r=kr(e.shape,t.shape);return r.length>0&&(n=Ke(n,r)),ie(n,e.shape)}function YF(e,t,n,r){if(t==="linear")return e;if(t==="relu")return uc(e);if(t==="elu")return wS(e);if(t==="relu6")return S9(e);if(t==="prelu")return BF(e,n);if(t==="leakyrelu")return NF(e,r);if(t==="sigmoid")return Il(e);throw new Error(`Unknown fused activation ${t}.`)}const KF=(e,t)=>!(e>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JOe({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:u="linear",preluActivationWeights:l,leakyreluAlpha:c}){if(u=u||"linear",KF(Z.state.gradientDepth,u)===!1){U(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let A=ph(e,t,n,r,i,s,o);return a!=null&&(A=Ee(A,a)),YF(A,u,l,c)}const f=W(e,"x","conv2d","float32"),d=W(t,"filter","conv2d","float32");let h=f,p=!1;f.rank===3&&(p=!0,h=ie(f,[1,f.shape[0],f.shape[1],f.shape[2]])),U(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),U(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),Es("fused conv2d",r,o);const m=i==="NHWC"?h.shape[3]:h.shape[1];U(d.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${d.shape[2]}.`),U(Si(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);const x=Jr(h.shape,d.shape,n,s,r,o);let b;a!=null&&(b=W(a,"bias","fused conv2d"),[b]=tr(b,f),i==="NHWC"?At(x.outShape,b.shape):(U(b.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${b.shape.length}.`),U(b.shape.length===0||b.shape[0]===x.outChannels||b.shape[0]===1,()=>`Error in fused conv2d: bias shape (${b.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let v;if(l!=null){const A=l.shape;if(U(A.length<=1||A.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${A.length}.`),A.length===1)U(A[0]===1||A[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${A}) is not compatible with the number of output channels (${x.outChannels}).`);else if(A.length===3)try{At(A,x.outShape)}catch{const _=`Error in fused conv2d: PReLU activation weights (${A}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(_)}v=W(l,"prelu weights","fused conv2d")}const $=(A,E)=>{U(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[_,D,N,T]=E,L=HF(A,N,u);U(hh(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const O=c9(D.shape,L,_,n,r),M=P9(D,L,_.shape,n,r),R=[O,M];if(T!=null){const P=XF(T,L);R.push(P)}return R},C={x:h,filter:d,bias:b,preluActivationWeights:v},S={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:u,leakyreluAlpha:c};return a==null?Vl((E,_,D)=>{let N=Z.runKernel(Ow,C,S);return D([_,E,N]),p&&(N=ie(N,[N.shape[1],N.shape[2],N.shape[3]])),{value:N,gradFunc:$}})(h,d):Vl((E,_,D,N)=>{let T=Z.runKernel(Ow,C,S);return N([_,E,T,D]),p&&(T=ie(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:$}})(h,d,b)}const kce=J({fusedConv2d_:JOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eMe(e,t,n,r,i,s=[1,1],o){let a=e;e.rank===3&&(a=ie(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;u.rank===3&&(u=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const l={x:a,dy:u},c={strides:r,pad:i,dimRoundingMode:o,dilations:s,filterShape:n};return Z.runKernel(FD,l,c)}const Ece=J({depthwiseConv2dNativeBackpropFilter_:eMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tMe(e,t,n,r,i,s=[1,1],o){let a=t,u=!1;t.rank===3&&(u=!0,a=ie(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const l={dy:a,filter:n},c={strides:r,pad:i,dimRoundingMode:o,dilations:s,inputShape:e},f=Z.runKernel(RD,l,c);return u?ie(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Ace=J({depthwiseConv2dNativeBackpropInput_:tMe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nMe({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:u="linear",preluActivationWeights:l,leakyreluAlpha:c}){if(KF(Z.state.gradientDepth,u)===!1){let S=vS(e,t,n,r,i,s,o);return a!=null&&(S=Ee(S,a)),YF(S,u,l,c)}const f=W(e,"x","depthwiseConv2d","float32"),d=W(t,"filter","depthwiseConv2d","float32");let h=f,p=!1;f.rank===3&&(p=!0,h=ie(f,[1,f.shape[0],f.shape[1],f.shape[2]])),U(h.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),U(d.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),U(h.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),s==null&&(s=[1,1]),U(Si(n,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),Es("fused depthwiseConv2d",r,o);const m=Jr(h.shape,d.shape,n,s,r,o,!0);let x;a!=null&&(x=W(a,"bias","fused conv2d"),[x]=tr(x,f),At(m.outShape,x.shape));let b;l!=null&&(b=W(l,"prelu weights","fused depthwiseConv2d"));const v=(S,A)=>{U(hh(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[E,_,D,N]=A,T=HF(S,D,u),L=Ace(_.shape,T,E,n,r,s,o),O=Ece(_,T,E.shape,n,r,s,o);if(N!=null){const M=XF(x,T);return[L,O,M]}return[L,O]},$={x:h,filter:d,bias:x,preluActivationWeights:b},C={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:u,leakyreluAlpha:c};return a==null?Vl((A,E,_)=>{let D=Z.runKernel(Mw,$,C);return _([E,A,D]),p&&(D=ie(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:v}})(h,d):Vl((A,E,_,D)=>{let N=Z.runKernel(Mw,$,C);return D([E,A,N,_]),p&&(N=ie(N,[N.shape[1],N.shape[2],N.shape[3]])),{value:N,gradFunc:v}})(h,d,x)}const rMe=J({fusedDepthwiseConv2d_:nMe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iMe({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:s="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(KF(Z.state.gradientDepth,s)===!1){let T=Mt(e,t,n,r);return i!=null&&(T=Ee(T,i)),YF(T,s,o,a)}let u=W(e,"a","fused matMul"),l=W(t,"b","fused matMul");[u,l]=tr(u,l);const c=n?u.shape[u.rank-2]:u.shape[u.rank-1],f=r?l.shape[l.rank-1]:l.shape[l.rank-2],d=n?u.shape[u.rank-1]:u.shape[u.rank-2],h=r?l.shape[l.rank-2]:l.shape[l.rank-1],p=u.shape.slice(0,-2),m=l.shape.slice(0,-2),x=me(p),b=me(m);U(c===f,()=>`Error in fused matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${u.shape} and ${l.shape} and transposeA=${n} and transposeB=${r} must match.`);const $=At(u.shape.slice(0,-2),l.shape.slice(0,-2)).concat([d,h]),C=n?ie(u,[x,c,d]):ie(u,[x,d,c]),S=r?ie(l,[b,h,f]):ie(l,[b,f,h]);let A;i!=null&&(A=W(i,"bias","fused matMul"),[A]=tr(A,u),At($,A.shape));let E;o!=null&&(E=W(o,"prelu weights","fused matMul"));const _=(T,L)=>{const[O,M,R,P]=L,j=HF(ie(T,R.shape),R,s);let z,q;if(!n&&!r?(z=Mt(j,M,!1,!0),q=Mt(O,j,!0,!1)):!n&&r?(z=Mt(j,M,!1,!1),q=Mt(j,O,!0,!1)):n&&!r?(z=Mt(M,j,!1,!0),q=Mt(O,j,!1,!1)):(z=Mt(M,j,!0,!0),q=Mt(j,O,!0,!0)),i!=null){const H=XF(P,j);return[z,q,H]}else return[z,q]},D={a:C,b:S,bias:A,preluActivationWeights:E},N={transposeA:n,transposeB:r,activation:s,leakyreluAlpha:a};return i==null?Vl((L,O,M)=>{const R=Z.runKernel(Rw,D,N);return M([L,O,R]),{value:ie(R,$),gradFunc:_}})(C,S):Vl((L,O,M,R)=>{const P=Z.runKernel(Rw,D,N);return R([L,O,P,M]),{value:ie(P,$),gradFunc:_}})(C,S,A)}const w6=J({fusedMatMul_:iMe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sMe=Object.freeze(Object.defineProperty({__proto__:null,conv2d:kce,depthwiseConv2d:rMe,matMul:w6},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oMe(e){return L9(e,.54,.46)}const aMe=J({hammingWindow_:oMe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uMe(e){return L9(e,.5,.5)}const _ce=J({hannWindow_:uMe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lMe(e,t,n,r=!1,i=0){let s=0;const o=[];for(;s+t<=e.size;)o.push(Kt(e,s,t)),s+=n;if(r)for(;s<e.size;){const a=s+t-e.size,u=Yr([Kt(e,s,t-a),nb([a],i)]);o.push(u),s+=n}return o.length===0?lw([],[0,t]):ie(Yr(o),[o.length,t])}const Tce=J({frame_:lMe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cMe(e,t,n,r,i=_ce){r==null&&(r=Sce(t));const s=Tce(e,t,n),o=ee(s,i(t));return VF(o,r)}const fMe=J({stft_:cMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dMe(e,t,n,r,i="bilinear",s=0){const o=W(e,"image","cropAndResize"),a=W(t,"boxes","cropAndResize","float32"),u=W(n,"boxInd","cropAndResize","int32"),l=a.shape[0];U(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),U(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${l},4] but had shape ${a.shape}.`),U(u.rank===1&&u.shape[0]===l,()=>`Error in cropAndResize: boxInd must be have size [${l}] but had shape ${a.shape}.`),U(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),U(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),U(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const c={image:o,boxes:a,boxInd:u},f={method:i,extrapolationValue:s,cropSize:r};return Z.runKernel(ID,c,f)}const hMe=J({cropAndResize_:dMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pMe(e){const t=W(e,"image","flipLeftRight","float32");U(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return Z.runKernel(UD,n,{})}const gMe=J({flipLeftRight_:pMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mMe(e){const t=W(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];U(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),U(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,Ea(t,i)}const yMe=J({grayscaleToRGB_:mMe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xMe(e){const t=W(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];U(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),U(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const i=t.dtype,s=Pe(t,"float32"),o=Li([.2989,.587,.114]);let a;switch(t.rank){case 2:a=N1("ij,j->i",s,o);break;case 3:a=N1("ijk,k->ij",s,o);break;case 4:a=N1("ijkl,l->ijk",s,o);break;case 5:a=N1("ijklm,m->ijkl",s,o);break;case 6:a=N1("ijklmn,n->ijklm",s,o);break;default:throw new Error("Not a valid tensor rank.")}return a=us(a,-1),Pe(a,i)}const bMe=J({rgbToGrayscale_:xMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vMe(e,t,n=0,r=.5){const i=W(e,"image","rotateWithOffset","float32");U(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const s={image:i},o={radians:t,fillValue:n,center:r};return Z.runKernel(CF,s,o)}const wMe=J({rotateWithOffset_:vMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ob(e,t,n,r,i,s){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),s==null&&(s=0);const o=e.shape[0];return n=Math.min(n,o),U(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),U(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),U(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),U(t.rank===1,()=>"scores must be a 1D tensor"),U(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),U(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Me(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const s=W(e,"boxes","nonMaxSuppression","float32"),o=W(t,"scores","nonMaxSuppression","float32"),a=ob(s,o,n,r,i);n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return Z.runKernel(QD,{boxes:s,scores:o},u)}const CMe=J({nonMaxSuppression_:$Me});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SMe(e,t,n){const r=kMe(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function kMe(e,t,n){return EMe(e,t,n)}function EMe(e,t,n){let r=0,i=e.length,s=0,o=!1;for(;r<i;){s=r+(i-r>>>1);const a=n(t,e[s]);a>0?r=s+1:(i=s,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QF(e,t,n,r,i){return B9(e,t,n,r,i,0)}function ZF(e,t,n,r,i,s){return B9(e,t,n,r,i,0,!1,s,!0)}function JF(e,t,n,r,i,s){return B9(e,t,n,r,i,s,!0)}function B9(e,t,n,r,i,s,o=!1,a=!1,u=!1){const l=[];for(let x=0;x<t.length;x++)t[x]>i&&l.push({score:t[x],boxIndex:x,suppressBeginIndex:0});l.sort(mZ);const c=s>0?-.5/s:0,f=[],d=[];for(;f.length<n&&l.length>0;){const x=l.pop(),{score:b,boxIndex:v,suppressBeginIndex:$}=x;if(b<i)break;let C=!1;for(let S=f.length-1;S>=$;--S){const A=AMe(e,v,f[S]);if(A>=r){C=!0;break}if(x.score=x.score*_Me(r,c,A),x.score<=i)break}x.suppressBeginIndex=f.length,C||(x.score===b?(f.push(v),d.push(x.score)):x.score>i&&SMe(l,x,mZ))}const h=f.length,p=n-h;a&&p>0&&(f.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const m={selectedIndices:f};return o&&(m.selectedScores=d),u&&(m.validOutputs=h),m}function AMe(e,t,n){const r=e.subarray(t*4,t*4+4),i=e.subarray(n*4,n*4+4),s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),h=(a-s)*(u-o),p=(f-l)*(d-c);if(h<=0||p<=0)return 0;const m=Math.max(s,l),x=Math.max(o,c),b=Math.min(a,f),v=Math.min(u,d),$=Math.max(b-m,0)*Math.max(v-x,0);return $/(h+p-$)}function _Me(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function mZ(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function TMe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const s=W(e,"boxes","nonMaxSuppressionAsync"),o=W(t,"scores","nonMaxSuppressionAsync"),a=ob(s,o,n,r,i);n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const u=await Promise.all([s.data(),o.data()]),l=u[0],c=u[1],{selectedIndices:f}=QF(l,c,n,r,i);return s!==e&&s.dispose(),o!==t&&o.dispose(),Li(f,"int32")}const IMe=TMe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NMe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const o=W(e,"boxes","nonMaxSuppression"),a=W(t,"scores","nonMaxSuppression"),u=ob(o,a,n,r,i,s);n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,s=u.softNmsSigma;const l={boxes:o,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s},f=Z.runKernel(JD,l,c);return{selectedIndices:f[0],selectedScores:f[1]}}const DMe=J({nonMaxSuppressionWithScore_:NMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function FMe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const o=W(e,"boxes","nonMaxSuppressionAsync"),a=W(t,"scores","nonMaxSuppressionAsync"),u=ob(o,a,n,r,i,s);n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,s=u.softNmsSigma;const l=await Promise.all([o.data(),a.data()]),c=l[0],f=l[1],{selectedIndices:d,selectedScores:h}=JF(c,f,n,r,i,s);return o!==e&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:Li(d,"int32"),selectedScores:Li(h)}}const RMe=FMe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OMe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const o=W(e,"boxes","nonMaxSuppression"),a=W(t,"scores","nonMaxSuppression"),u=ob(o,a,n,r,i,null),l=u.maxOutputSize,c=u.iouThreshold,f=u.scoreThreshold,d={boxes:o,scores:a},h={maxOutputSize:l,iouThreshold:c,scoreThreshold:f,padToMaxOutputSize:s},p=Z.runKernel(ZD,d,h);return{selectedIndices:p[0],validOutputs:p[1]}}const MMe=J({nonMaxSuppressionPadded_:OMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function LMe(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const o=W(e,"boxes","nonMaxSuppressionAsync"),a=W(t,"scores","nonMaxSuppressionAsync"),u=ob(o,a,n,r,i,null),l=u.maxOutputSize,c=u.iouThreshold,f=u.scoreThreshold,[d,h]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:m}=ZF(d,h,l,c,f,s);return o!==e&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:Li(p,"int32"),validOutputs:$t(m,"int32")}}const PMe=LMe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BMe(e,t,n=!1,r=!1){const i=W(e,"images","resizeBilinear");U(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),U(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),U(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=i,o=!1;i.rank===3&&(o=!0,s=ie(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const a={images:s},u={alignCorners:n,halfPixelCenters:r,size:t},l=Z.runKernel(iS,a,u);return o?ie(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const Ice=J({resizeBilinear_:BMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zMe(e,t,n=!1,r=!1){const i=W(e,"images","resizeNearestNeighbor");U(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),U(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),U(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),U(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=i,o=!1;i.rank===3&&(o=!0,s=ie(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const a={images:s},u={alignCorners:n,halfPixelCenters:r,size:t},l=Z.runKernel(rS,a,u);return o?ie(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const Nce=J({resizeNearestNeighbor_:zMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UMe(e,t="binary",n=!1,r=.5){const i=W(e,"image","threshold"),s=.2989,o=.587,a=.114,u=i.shape[0]*i.shape[1];let l=ee(Li([r]),255),c,f,d,h;if(U(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),U(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),U(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),U(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),i.shape[2]===3){[c,f,d]=Ws(i,[1,1,1],-1);const x=ee(c,s),b=ee(f,o),v=ee(d,a);h=Ee(Ee(x,b),v)}else h=e;if(t==="otsu"){const x=Lle(Pe(k9(h),"int32"),Jd([]),256);l=jMe(x,u)}const p=n?jm(h,l):Uo(h,l);return Pe(ee(p,255),"int32")}function jMe(e,t){let n=Li([-1]),r=Li([0]),i=Li([0]),s,o,a,u,l,c;for(let f=0;f<e.size-1;f++){s=Kt(e,0,f+1),o=Kt(e,f+1),l=st(Ke(s),t),c=st(Ke(o),t);const d=Ke(ee(s,oy(0,s.size)));a=st(d,Ke(s));const h=nb(o.shape,s.size),p=Ee(oy(0,o.size),h),m=ee(o,p);u=st(Ke(m),Ke(o));const x=Xe(a,u),b=Xe(a,u),v=ee(l,c);i=ee(ee(v,x),b);const $=Uo(i,r);r=Wi($,i,r),n=Wi($,Li([f]),n)}return n}const WMe=J({threshold_:UMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VMe(e,t,n="nearest",r="constant",i=0,s){const o=W(e,"image","transform","float32"),a=W(t,"transforms","transform","float32");U(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),U(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),U(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);const u={image:o,transforms:a},l={interpolation:n,fillMode:r,fillValue:i,outputShape:s};return Z.runKernel(wF,u,l)}const qMe=J({transform_:VMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GMe(e,t,n){const r=W(e,"a","bandPart");U(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[s,o]=r.shape.slice(-2);let a,u;typeof t=="number"?(U(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),U(t<=s,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`),a=W(t<0?s:t,"numLower","bandPart")):(U(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Wi(Vw(t,0),s,om(t,s))),typeof n=="number"?(U(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),U(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),u=W(n<0?o:n,"numUpper","bandPart")):(U(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=Wi(Vw(n,0),o,om(n,o)));const l=ie(oy(0,s,1,"int32"),[-1,1]),c=oy(0,o,1,"int32"),f=Xe(l,c),d=ql(jm(f,a),ep(f,Ln(u))),h=Nr([s,o],r.dtype);return ie(Lu(gh(ie(r,[-1,s,o])).map(p=>Wi(d,p,h))),i)}const HMe=J({bandPart_:GMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XMe(e){let t;if(Array.isArray(e)){t=!1,U(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=e[0].shape[0];for(let s=1;s<e.length;++s)U(e[s].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[s].shape[0]} vs. ${i})`)}else t=!0,e=Ws(e,e.shape[0],0).map(i=>Vm(i,[0]));U(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);const n=[],r=e;for(let i=0;i<e.length;++i)n.push(Z.tidy(()=>{let s=r[i];if(i>0)for(let o=0;o<i;++o){const a=ee(Ke(ee(n[o],s)),n[o]);s=Xe(s,a)}return st(s,$S(s,"euclidean"))}));return t?Lu(n,0):n}const YMe=J({gramSchmidt_:XMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KMe(e,t=!1){if(U(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return yZ(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((u,l)=>u*l),r=gh(ie(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],s=[];r.forEach(u=>{const[l,c]=yZ(u,t);i.push(l),s.push(c)});const o=ie(Lu(i,0),e.shape),a=ie(Lu(s,0),e.shape);return[o,a]}}function yZ(e,t=!1){return Z.tidy(()=>{U(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);const n=e.shape[0],r=e.shape[1];let i=m9(n),s=eh(e);const o=lw([[1]],[1,1]);let a=eh(o);const u=n>=r?r:n;for(let l=0;l<u;++l){const c=s,f=a,d=i;[a,s,i]=Z.tidy(()=>{const h=Kt(s,[l,l],[n-l,1]),p=$S(h),m=Kt(s,[l,l],[1,1]),x=Wi(Uo(m,0),lw([[-1]]),lw([[1]])),b=Xe(m,ee(x,p)),v=st(h,b);v.shape[0]===1?a=eh(o):a=Yr([o,Kt(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const $=Ln(st(Mt(x,b),p)),C=Kt(s,[l,0],[n-l,r]),S=ee($,a),A=Vt(a);if(l===0)s=Xe(C,Mt(S,Mt(A,C)));else{const D=Xe(C,Mt(S,Mt(A,C)));s=Yr([Kt(s,[0,0],[l,r]),D],0)}const E=Vt(S),_=Kt(i,[0,l],[n,i.shape[1]-l]);if(l===0)i=Xe(_,Mt(Mt(_,a),E));else{const D=Xe(_,Mt(Mt(_,a),E));i=Yr([Kt(i,[0,0],[n,l]),D],1)}return[a,s,i]}),Tt([c,f,d])}return!t&&n>r&&(i=Kt(i,[0,0],[n,r]),s=Kt(s,[0,0],[r,r])),[i,s]})}const QMe=J({qr_:KMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ls;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(ls||(ls={}));function ZMe(e,t,n=ls.SUM_BY_NONZERO_WEIGHTS){const r=W(e,"losses","computeWeightedLoss");let i=null;t!=null&&(i=W(t,"weights","computeWeightedLoss"));const s=i==null?r:ee(r,i);if(n===ls.NONE)return s;if(n===ls.SUM)return Ke(s);if(n===ls.MEAN){if(i==null)return ar(s);{const o=r.size/i.size,a=st(Ke(s),Ke(i));return o>1?st(a,$t(o)):a}}if(n===ls.SUM_BY_NONZERO_WEIGHTS){if(i==null)return st(Ke(s),$t(r.size));{const o=ee(i,Co(r.shape)),a=Pe(Ke(sy(o,$t(0))),"float32");return st(Ke(s),a)}}throw Error(`Unknown reduction: ${n}`)}const jf=J({computeWeightedLoss_:ZMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JMe(e,t,n,r=ls.SUM_BY_NONZERO_WEIGHTS){const i=W(e,"labels","absoluteDifference"),s=W(t,"predictions","absoluteDifference");let o=null;n!=null&&(o=W(n,"weights","absoluteDifference")),Ci(i.shape,s.shape,"Error in absoluteDifference: ");const a=Tr(Xe(i,s));return jf(a,o,r)}const e4e=J({absoluteDifference_:JMe});function t4e(e,t,n,r,i=ls.SUM_BY_NONZERO_WEIGHTS){const s=W(e,"labels","cosineDistance"),o=W(t,"predictions","cosineDistance");let a=null;r!=null&&(a=W(r,"weights","cosineDistance")),Ci(s.shape,o.shape,"Error in cosineDistance: ");const u=$t(1),l=Xe(u,Ke(ee(s,o),n,!0));return jf(l,a,i)}const n4e=J({cosineDistance_:t4e});function r4e(e,t,n,r=ls.SUM_BY_NONZERO_WEIGHTS){let i=W(e,"labels","hingeLoss");const s=W(t,"predictions","hingeLoss");let o=null;n!=null&&(o=W(n,"weights","hingeLoss")),Ci(i.shape,s.shape,"Error in hingeLoss: ");const a=$t(1);i=Xe(ee($t(2),i),a);const u=uc(Xe(a,ee(i,s)));return jf(u,o,r)}const i4e=J({hingeLoss_:r4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s4e(e,t,n,r=1,i=ls.SUM_BY_NONZERO_WEIGHTS){const s=W(e,"labels","huberLoss"),o=W(t,"predictions","huberLoss");let a=null;n!=null&&(a=W(n,"weights","huberLoss")),Ci(s.shape,o.shape,"Error in huberLoss: ");const u=$t(r),l=Tr(Xe(o,s)),c=om(l,u),f=Xe(l,c),d=Ee(ee($t(.5),kn(c)),ee(u,f));return jf(d,a,i)}const o4e=J({huberLoss_:s4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a4e(e,t,n,r=1e-7,i=ls.SUM_BY_NONZERO_WEIGHTS){const s=W(e,"labels","logLoss"),o=W(t,"predictions","logLoss");let a=null;n!=null&&(a=W(n,"weights","logLoss")),Ci(s.shape,o.shape,"Error in logLoss: ");const u=$t(1),l=$t(r),c=Ln(ee(s,ia(Ee(o,l)))),f=ee(Xe(u,s),ia(Ee(Xe(u,o),l))),d=Xe(c,f);return jf(d,a,i)}const u4e=J({logLoss_:a4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4e(e,t,n,r=ls.SUM_BY_NONZERO_WEIGHTS){const i=W(e,"labels","meanSquaredError"),s=W(t,"predictions","meanSquaredError");let o=null;n!=null&&(o=W(n,"weights","meanSquaredError")),Ci(i.shape,s.shape,"Error in meanSquaredError: ");const a=F9(i,s);return jf(a,o,r)}const c4e=J({meanSquaredError_:l4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f4e(e,t){const n=W(e,"labels","sigmoidCrossEntropyWithLogits"),r=W(t,"logits","sigmoidCrossEntropyWithLogits");Ci(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=uc(r),s=ee(r,n),o=DF(To(Ln(Tr(r))));return Ee(Xe(i,s),o)}function d4e(e,t,n,r=0,i=ls.SUM_BY_NONZERO_WEIGHTS){let s=W(e,"multiClassLabels","sigmoidCrossEntropy");const o=W(t,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=W(n,"weights","sigmoidCrossEntropy")),Ci(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const l=$t(r),c=$t(1),f=$t(.5);s=Ee(ee(s,Xe(c,l)),ee(f,l))}const u=f4e(s,o);return jf(u,a,i)}const h4e=J({sigmoidCrossEntropy_:d4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p4e(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Vl((i,s,o)=>{const u=RF(s,[n],!0),l=Xe(Pe(s,"float32"),u);o([i,l]);const c=Ln(ee(l,i));return{value:Ke(c,[n]),gradFunc:(h,p)=>{const[m,x]=p,b=mr(h.shape,[n]);return[ee(ie(h,b),Xe(Pe(m,"float32"),To(x))),ee(ie(h,b),Xe(To(x),Pe(m,"float32")))]}}})(e,t)}function g4e(e,t,n,r=0,i=ls.SUM_BY_NONZERO_WEIGHTS){let s=W(e,"onehotLabels","softmaxCrossEntropy");const o=W(t,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=W(n,"weights","softmaxCrossEntropy")),Ci(s.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const l=$t(r),c=$t(1),f=$t(s.shape[1]);s=Ee(ee(s,Xe(c,l)),st(l,f))}const u=p4e(s,o);return jf(u,a,i)}const m4e=J({softmaxCrossEntropy_:g4e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4e(e,t,n,r){const i=W(e,"indices","sparseFillEmptyRows","int32"),s=W(t,"values","sparseFillEmptyRows"),o=W(n,"denseShape","sparseFillEmptyRows","int32"),a=W(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(i.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(s.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const u={indices:i,values:s,denseShape:o,defaultValue:a},l=Z.runKernel(cF,u);return{outputIndices:l[0],outputValues:l[1],emptyRowIndicator:l[2],reverseIndexMap:l[3]}}const x4e=J({sparseFillEmptyRows_:y4e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b4e(e,t,n){const r=W(e,"inputIndices","sparseReshape","int32"),i=W(t,"inputShape","sparseReshape","int32"),s=W(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(s.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const o={inputIndices:r,inputShape:i,newShape:s},a=Z.runKernel(fF,o);return{outputIndices:a[0],outputShape:a[1]}}const v4e=J({sparseReshape_:b4e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w4e(e,t,n){const r=W(e,"data","sparseSegmentMean"),i=W(t,"indices","sparseSegmentMean","int32"),s=W(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${s.shape}`);const o={data:r,indices:i,segmentIds:s};return Z.runKernel(dF,o)}const $4e=J({sparseSegmentMean_:w4e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4e(e,t,n){const r=W(e,"data","sparseSegmentSum"),i=W(t,"indices","sparseSegmentSum","int32"),s=W(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${s.shape}`);const o={data:r,indices:i,segmentIds:s};return Z.runKernel(hF,o)}const S4e=J({sparseSegmentSum_:C4e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k4e(e,t,n,r,i,s,o,a){const u=W(e,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error(`Data must be a vector, saw: ${u.shape}`);const l=W(t,"dataSplits","stringNGrams");if(l.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:i,rightPad:s,padWidth:o,preserveShortSequences:a},f={data:u,dataSplits:l},d=Z.runKernel(yF,f,c);return{nGrams:d[0],nGramsSplits:d[1]}}const E4e=J({stringNGrams_:k4e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A4e(e,t,n=!0){const r=W(e,"input","stringSplit","string"),i=W(t,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(i.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const s={skipEmpty:n},o={input:r,delimiter:i},a=Z.runKernel(xF,o,s);return{indices:a[0],values:a[1],shape:a[2]}}const _4e=J({stringSplit_:A4e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T4e(e,t){const n=W(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return Z.runKernel(bF,i,r)}const I4e=J({stringToHashBucketFast_:T4e});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4e(e,t,n,r=!0){const i=W(e,"input","staticRegexReplace","string"),s={pattern:t,rewrite:n,replaceGlobal:r};return Z.runKernel(dS,{x:i},s)}const D4e=J({staticRegexReplace_:N4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F4e={fft:WF,ifft:Xw,rfft:VF,irfft:D9},R4e={hammingWindow:aMe,hannWindow:_ce,frame:Tce,stft:fMe},El={flipLeftRight:gMe,grayscaleToRGB:yMe,resizeNearestNeighbor:Nce,resizeBilinear:Ice,rgbToGrayscale:bMe,rotateWithOffset:wMe,cropAndResize:hMe,nonMaxSuppression:CMe,nonMaxSuppressionAsync:IMe,nonMaxSuppressionWithScore:DMe,nonMaxSuppressionWithScoreAsync:RMe,nonMaxSuppressionPadded:MMe,nonMaxSuppressionPaddedAsync:PMe,threshold:WMe,transform:qMe},Dce={bandPart:HMe,gramSchmidt:YMe,qr:QMe},z9={absoluteDifference:e4e,computeWeightedLoss:jf,cosineDistance:n4e,hingeLoss:i4e,huberLoss:o4e,logLoss:u4e,meanSquaredError:c4e,sigmoidCrossEntropy:h4e,softmaxCrossEntropy:m4e},O4e={sparseFillEmptyRows:x4e,sparseReshape:v4e,sparseSegmentMean:$4e,sparseSegmentSum:S4e},M4e={stringNGrams:E4e,stringSplit:_4e,stringToHashBucketFast:I4e,staticRegexReplace:D4e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L4e=new Map,$6=new Map;class qm{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class Zo{constructor(){this.classNameMap={}}static getMap(){return Zo.instance==null&&(Zo.instance=new Zo),Zo.instance}static register(t){Zo.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function Ae(e,t,n){U(e.className!=null,()=>"Class being registered does not have the static className property defined."),U(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),U(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);const r=n,i=t+">"+r;return Zo.register(e),L4e.set(i,e),$6.set(e,i),e}function P4e(e){return $6.has(e)?$6.get(e):e.className}const B4e=Object.freeze(Object.defineProperty({__proto__:null,Serializable:qm,SerializationMap:Zo,getRegisteredName:P4e,registerClass:Ae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wf extends qm{minimize(t,n=!1,r){const{value:i,grads:s}=this.computeGradients(t,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:s[a.name]}));this.applyGradients(o)}else this.applyGradients(s);return Tt(s),n?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return ice(t,n)}dispose(){this.iterations_!=null&&Tt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:$t(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Wf,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U9 extends Wf{static get className(){return"Adadelta"}constructor(t,n,r=null){super(),this.learningRate=t,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=Z.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Z.registeredVariables[r],o=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:fe(()=>Xt(s).variable(o))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:fe(()=>Xt(s).variable(o))});const a=Array.isArray(t)?t[i].tensor:t[r];if(a==null)return;const u=this.accumulatedGrads[i].variable,l=this.accumulatedUpdates[i].variable;fe(()=>{const c=Ee(ee(u,this.rho),ee(kn(a),1-this.rho)),f=ee(st(wi(Ee(l,this.epsilon)),wi(Ee(u,this.epsilon))),a),d=Ee(ee(l,this.rho),ee(kn(f),1-this.rho));u.assign(c),l.assign(d);const h=Ee(ee(f,-this.learningRate),s);s.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Tt(this.accumulatedGrads.map(t=>t.variable)),Tt(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=t.length/2,r=!1;this.accumulatedGrads=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedUpdates=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j9 extends Wf{static get className(){return"Adagrad"}constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Z.registeredVariables[r];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:fe(()=>nb(s.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(t)?t[i].tensor:t[r];if(o==null)return;const a=this.accumulatedGrads[i].variable;fe(()=>{const u=Ee(a,kn(o));a.assign(u);const l=Ee(ee(st(o,wi(Ee(u,Z.backend.epsilon()))),-this.learningRate),s);s.assign(l)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Tt(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W9 extends Wf{static get className(){return"Adam"}constructor(t,n,r,i=null){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],fe(()=>{this.accBeta1=$t(n).variable(),this.accBeta2=$t(r).variable()}),i==null&&(this.epsilon=Z.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);fe(()=>{const r=Xe(1,this.accBeta1),i=Xe(1,this.accBeta2);n.forEach((s,o)=>{const a=Z.registeredVariables[s],u=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:fe(()=>Xt(a).variable(u))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${s}/v`,variable:fe(()=>Xt(a).variable(u))});const l=Array.isArray(t)?t[o].tensor:t[s];if(l==null)return;const c=this.accumulatedFirstMoment[o].variable,f=this.accumulatedSecondMoment[o].variable,d=Ee(ee(c,this.beta1),ee(l,1-this.beta1)),h=Ee(ee(f,this.beta2),ee(kn(l),1-this.beta2)),p=st(d,r),m=st(h,i);c.assign(d),f.assign(h);const x=Ee(ee(st(p,Ee(wi(m),this.epsilon)),-this.learningRate),a);a.assign(x)}),this.accBeta1.assign(ee(this.accBeta1,this.beta1)),this.accBeta2.assign(ee(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Tt(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&Tt(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t),fe(()=>{this.accBeta1.assign(Ef(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ef(this.beta2,this.iterations_+1))});const n=t.length/2,r=!1;this.accumulatedFirstMoment=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V9 extends Wf{static get className(){return"Adamax"}constructor(t,n,r,i=null,s=0){super(),this.learningRate=t,this.beta1=n,this.beta2=r,this.epsilon=i,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],fe(()=>{this.iteration=$t(0).variable(),this.accBeta1=$t(n).variable()}),i==null&&(this.epsilon=Z.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);fe(()=>{const r=Xe(1,this.accBeta1),i=st(-this.learningRate,Ee(ee(this.iteration,this.decay),1));n.forEach((s,o)=>{const a=Z.registeredVariables[s],u=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:Xt(a).variable(u)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${s}/v`,variable:Xt(a).variable(u)});const l=Array.isArray(t)?t[o].tensor:t[s];if(l==null)return;const c=this.accumulatedFirstMoment[o].variable,f=this.accumulatedWeightedInfNorm[o].variable,d=Ee(ee(c,this.beta1),ee(l,1-this.beta1)),h=ee(f,this.beta2),p=Tr(l),m=Uf(h,p);c.assign(d),f.assign(m);const x=Ee(ee(st(i,r),st(d,Ee(m,this.epsilon))),a);a.assign(x)}),this.iteration.assign(Ee(this.iteration,1)),this.accBeta1.assign(ee(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Tt(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&Tt(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e3 extends Wf{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Array.isArray(t)?t[i].tensor:t[r];if(s==null)return;const o=Z.registeredVariables[r];fe(()=>{const a=Ee(ee(this.c,s),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=Tu($t(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q9 extends e3{static get className(){return"Momentum"}constructor(t,n,r=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=$t(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Z.registeredVariables[r];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:fe(()=>Xt(s).variable(!1))});const o=this.accumulations[i].variable,a=Array.isArray(t)?t[i].tensor:t[r];a!=null&&fe(()=>{let u;const l=Ee(ee(this.m,o),a);this.useNesterov?u=Ee(ee(this.c,Ee(a,ee(l,this.m))),s):u=Ee(ee(this.c,l),s),o.assign(l),s.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Tt(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulations=t.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G9 extends Wf{static get className(){return"RMSProp"}constructor(t,n=.9,r=0,i=null,s=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,i==null&&(this.epsilon=Z.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Z.registeredVariables[r],o=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:fe(()=>Xt(s).variable(o))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:fe(()=>Xt(s).variable(o))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:fe(()=>Xt(s).variable(o))});const a=Array.isArray(t)?t[i].tensor:t[r];if(a==null)return;const u=this.accumulatedMeanSquares[i].variable,l=this.accumulatedMoments[i].variable;fe(()=>{const c=Ee(ee(u,this.decay),ee(kn(a),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[i].variable,d=Ee(ee(f,this.decay),ee(a,1-this.decay)),h=st(ee(a,this.learningRate),wi(Xe(c,Ee(kn(d),this.epsilon)))),p=Ee(ee(l,this.momentum),h);u.assign(c),f.assign(d),l.assign(p);const m=Xe(s,p);s.assign(m)}else{const f=Ee(ee(u,this.decay),ee(kn(a),1-this.decay)),d=Ee(ee(l,this.momentum),st(ee(a,this.learningRate),wi(Ee(f,this.epsilon))));u.assign(f),l.assign(d);const h=Xe(s,d);s.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Tt(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Tt(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&Tt(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,r=!1;this.accumulatedMeanSquares=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedMoments=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z4e=[U9,j9,W9,V9,q9,G9,e3];function U4e(){for(const e of z4e)Ae(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j4e="model",W4e=".json",V4e=".weights.bin";function xZ(e){return new Promise(t=>setTimeout(t)).then(e)}class am{constructor(t){if(!ce().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(am.URL_SCHEME)&&(t=t.slice(am.URL_SCHEME.length)),(t==null||t.length===0)&&(t=j4e),this.modelJsonFileName=t+W4e,this.weightDataFileName=t+V4e}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=Vu.join(t.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const i=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],s=dle(t,i),o=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await xZ(()=>a.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=r,await xZ(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:yS(t)}}}}am.URL_SCHEME="downloads://";class q4e{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,n)=>{const r=new FileReader;r.onload=i=>{const s=JSON.parse(i.target.result),o=s.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(s.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){t({modelTopology:o});return}const u=s9(s,l=>this.loadWeights(l));t(u)},r.onerror=i=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(t){const n=[],r=[];for(const o of t)n.push(...o.weights),r.push(...o.paths);const i=this.checkManifestAndWeightFiles(t),s=r.map(o=>this.loadWeightsFile(o,i[o]));return Promise.all(s).then(o=>[n,o])}loadWeightsFile(t,n){return new Promise((r,i)=>{const s=new FileReader;s.onload=o=>{const a=o.target.result;r(a)},s.onerror=o=>i(`Failed to weights data from file of path '${t}'.`),s.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(t){const n=[],r=this.weightsFiles.map(s=>aZ(s.name)),i={};for(const s of t)s.paths.forEach(o=>{const a=aZ(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);i[o]=this.weightsFiles[r.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}}const G4e=e=>ce().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(am.URL_SCHEME)?H4e(e.slice(am.URL_SCHEME.length)):null;Qn.registerSaveRouter(G4e);function H4e(e="model"){return new am(e)}function X4e(e){return new q4e(e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bZ(e,t,n,r){o(e),n=n??0,r=r??1,a(n,r);let i=0;const s=u=>(u.then(l=>{const c=n+ ++i/e.length*(r-n);return t(c),l}),u);function o(u){U(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function a(u,l){U(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),U(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${l}`),U(l>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${l}`)}return Promise.all(e.map(s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Fce(e,t){t==null&&(t={});const n=t.fetchFunc==null?ce().platform.fetch:t.fetchFunc,r=e.map(f=>n(f,t.requestInit,{isBinary:!0})),a=(t.onProgress==null?await Promise.all(r):await bZ(r,t.onProgress,0,.5)).map(f=>f.arrayBuffer());return t.onProgress==null?await Promise.all(a):await bZ(a,t.onProgress,.5,1)}function Y4e(e,t){var n;const r=t.fetchFunc==null?ce().platform.fetch:t.fetchFunc;let i=0,s;return(n=t.onProgress)===null||n===void 0||n.call(t,0),new ReadableStream({pull:async o=>{for(var a;i<e.length;){s||(s=(await r(e[i],t.requestInit,{isBinary:!0})).body.getReader());const{done:u,value:l}=await s.read();if(u){i++,s=void 0,(a=t.onProgress)===null||a===void 0||a.call(t,i/e.length);continue}o.enqueue(l);return}o.close()}})}async function K4e(e,t="",n,r){return Rce(o=>Fce(o,{requestInit:r}))(e,t,n)}function Rce(e){return async(t,n="",r)=>{const i=t.map(()=>!1),s={},o=r!=null?r.map(()=>!1):[],a=[];if(t.forEach((h,p)=>{let m=0;h.weights.forEach(x=>{const b="quantization"in x?x.quantization.dtype:x.dtype,v=em[b]*me(x.shape),$=()=>{i[p]=!0,s[p]==null&&(s[p]=[]),s[p].push({manifestEntry:x,groupOffset:m,sizeBytes:v})};r!=null?r.forEach((C,S)=>{C===x.name&&($(),o[S]=!0)}):$(),a.push(x.name),m+=v})}),!o.every(h=>h)){const h=r.filter((p,m)=>!o[m]);throw new Error(`Could not find weights in manifest with names: ${h.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const u=i.reduce((h,p,m)=>(p&&h.push(m),h),[]),l=[];u.forEach(h=>{t[h].paths.forEach(p=>{const m=n+(n.endsWith("/")?"":"/")+p;l.push(m)})});const c=await e(l),f={};let d=0;return u.forEach(h=>{const p=t[h].paths.length,m=new Vu(c.slice(d,d+p));s[h].forEach(b=>{const v=m.slice(b.groupOffset,b.groupOffset+b.sizeBytes),$=r9(v,[b.manifestEntry]);for(const C in $)f[C]=$[C]}),d+=p}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q4e="application/octet-stream",Z4e="application/json";class H9{constructor(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(U(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=ce().platform.fetch,U(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&U(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i=dle(t,r);if(n.body.append("model.json",new Blob([JSON.stringify(i)],{type:Z4e}),"model.json"),t.weightData!=null){const o=Vu.join(t.weightData);n.body.append("model.weights.bin",new Blob([o],{type:Q4e}),"model.weights.bin")}const s=await this.fetch(this.path,n);if(s.ok)return{modelArtifactsInfo:yS(t),responses:[s]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${s.status}.`)}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await t.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=n.modelTopology,i=n.weightsManifest;if(r==null&&i==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const t=await this.loadModelJSON();return s9(t,n=>this.loadWeights(n))}async loadStream(){const t=await this.loadModelJSON(),n=await this.getWeightUrls(t.weightsManifest),r=p6(t.weightsManifest),i=()=>Y4e(n,this.loadOptions);return Object.assign(Object.assign({},t),{weightSpecs:r,getWeightStream:i})}async getWeightUrls(t){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,i]=J4e(n),s=this.weightPathPrefix||r,o=[],a=[];for(const u of t)for(const l of u.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(l)):o.push(s+l+i);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(t){const n=await this.getWeightUrls(t),r=p6(t),i=await Fce(n,this.loadOptions);return[r,i]}}H9.URL_SCHEME_REGEX=/^https?:\/\//;function J4e(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),i=n>t?e.substring(n):"";return[r+"/",i]}function C6(e){return e.match(H9.URL_SCHEME_REGEX)!=null}const Oce=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(r=>C6(r)):n=C6(e),n)return X9(e,t)}return null};Qn.registerSaveRouter(Oce);Qn.registerLoadRouter(Oce);function X9(e,t){return new H9(e,t)}function Mce(e,t){return X9(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OL{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class Lce{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class eLe{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=n=>Promise.resolve(t.save(n)))}}function tLe(e,t,n,r){const i=arguments;return new eLe(Pce(...i))}function Pce(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new OL(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new OL({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new OL({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function nLe(e){return new Lce(e)}function rLe(e){return new Lce(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iLe=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Vu,browserFiles:X4e,browserHTTPRequest:Mce,concatenateArrayBuffers:fle,copyModel:VNe,decodeWeights:r9,decodeWeightsStream:$Ne,encodeWeights:h6,fromMemory:tLe,fromMemorySync:Pce,getLoadHandlers:gle,getModelArtifactsForJSON:s9,getModelArtifactsForJSONSync:hle,getModelArtifactsInfoForJSON:yS,getSaveHandlers:ple,getWeightSpecs:p6,http:X9,isHTTPScheme:C6,listModels:Cle,loadWeights:K4e,moveModel:qNe,registerLoadRouter:NNe,registerSaveRouter:INe,removeModel:WNe,weightsLoaderFactory:Rce,withSaveHandler:nLe,withSaveHandlerSync:rLe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sLe(e,t,n){const r=W(e,"labels","confusionMatrix"),i=W(t,"predictions","confusionMatrix");U(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),U(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),U(i.rank===1,()=>`Expected the rank of predictions to be 1, but got ${i.rank}`),U(r.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),U(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const s=qw(Pe(r,"int32"),n),o=qw(Pe(i,"int32"),n),a=Vt(s),u=Mt(a,o);return Pe(u,"int32")}const oLe=J({confusionMatrix_:sLe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aLe=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:oLe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Vp,vZ=!1;function Bce(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,s=!1,o=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)s=!0;else if(e.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(Pw(WT,Z.backendName)!=null){const p={pixels:e},m={numChannels:t};return Z.runKernel(WT,p,m)}const[l,c]=i?[e.videoWidth,e.videoHeight]:[e.width,e.height];let f;if(o)f=e.getContext("2d").getImageData(0,0,l,c).data;else if(r||n)f=e.data;else if(s||i||a){if(Vp==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Vp=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Vp=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Vp.canvas.width=l,Vp.canvas.height=c,Vp.drawImage(e,0,0,l,c),f=Vp.getImageData(0,0,l,c).data}let d;if(t===4)d=new Int32Array(f);else{const p=l*c;d=new Int32Array(p*t);for(let m=0;m<p;m++)for(let x=0;x<t;++x)d[m*t+x]=f[m*4+x]}return xce(d,[c,l,t],"int32")}function uLe(e){return e!=null&&e.data instanceof Uint8Array}function lLe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function cLe(e){return e!=null&&e.width!==0&&e.height!==0}function fLe(e){return lLe()&&!(e instanceof ImageBitmap)&&cLe(e)&&!uLe(e)}async function dLe(e,t=3){let n=null;if(ce().getBool("WRAP_TO_IMAGEBITMAP")&&fLe(e)){let r;try{r=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===e.width&&r.height===e.height?n=r:n=e}else n=e;return Bce(n,t)}function zce(e){if(e.rank!==2&&e.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);const t=e.rank===2?1:e.shape[2];if(t>4||t===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if(e.dtype!=="float32"&&e.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}function hLe(e){const t=(e==null?void 0:e.alpha)||1;if(t>1||t<0)throw new Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}async function pLe(e,t){let n=W(e,"img","toPixels");if(!(e instanceof nn)){const l=n;n=Pe(l,"int32"),l.dispose()}zce(n);const[r,i]=n.shape.slice(0,2),s=n.rank===2?1:n.shape[2],o=await n.data(),a=n.dtype==="float32"?255:1,u=new Uint8ClampedArray(i*r*4);for(let l=0;l<r*i;++l){const c=[0,0,0,255];for(let d=0;d<s;d++){const h=o[l*s+d];if(n.dtype==="float32"){if(h<0||h>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${h}.`)}else if(n.dtype==="int32"&&(h<0||h>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${h}.`);s===1?(c[0]=h*a,c[1]=h*a,c[2]=h*a):c[d]=h*a}const f=l*4;u[f+0]=Math.round(c[0]),u[f+1]=Math.round(c[1]),u[f+2]=Math.round(c[2]),u[f+3]=Math.round(c[3])}if(t!=null){vZ||Pw(MD,Z.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),vZ=!0),t.width=i,t.height=r;const l=t.getContext("2d"),c=new ImageData(u,i,r);l.putImageData(c,0,0)}return n!==e&&n.dispose(),u}function gLe(e,t,n){let r=W(e,"img","draw");if(!(e instanceof nn)){const o=r;r=Pe(o,"int32"),o.dispose()}zce(r),hLe(n==null?void 0:n.imageOptions);const i={image:r},s={canvas:t,options:n};Z.runKernel(MD,i,s)}const mLe=J({fromPixels_:Bce}),yLe=Object.freeze(Object.defineProperty({__proto__:null,draw:gLe,fromPixels:mLe,fromPixelsAsync:dLe,toPixels:pLe},Symbol.toStringTag,{value:"Module"}));function t3(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(me(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const i=t.shape,s=i[i.length-1];let o=1;for(let f=0;f<i.length-1;++f)o*=i[f];const a=e.shape,u=i.slice();u.pop();let l=1;for(let f=s;f<n;++f)l*=a[f],u.push(a[f]);const c=[...ut(e.shape).map(f=>f/l),1].slice(0,s);return[u,o,l,c]}const xLe=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:t3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S6=-2,bLe=-1;function Y9(e,t,n){const r=e.shape.length;U(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),U(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)U(t[i]+n[i]<=e.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`)}function vLe(e){const t=[];let n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function K9(e,t,n){const r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function Uce(e,t,n,r){const i=[...e];for(let s=i.length;s<r.length;s++)i.push(1);for(let s=0;s<n;s++)s===0?i[t]=1:(i.splice(t,0,1),i.pop());return i}function jce(e,t,n){return n<=e?n:n-(t-1)}function Wce(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function wLe(e,t,n,r,i,s,o,a,u){const l=e.length;let c=new Array(l),f=new Array(l),d=new Array(l);if(t.length&&n>0){const h=t[0],p=n+1;c=Vce(o,h,p,r,e),f=qce(a,h,p,i,e),d=Uce(s,h,p,e)}else for(let h=0;h<l;h++)c[h]=Hce(o,r,s,e,h,u),f[h]=Xce(a,i,s,e,h,u),d[h]=Gce(s,h,u);return{begin:c,end:f,strides:d}}function Vce(e,t,n,r,i){const s=[...i],o=Wce(n,t);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=0;else{const u=jce(t,n,a);let l=r[u];e&1<<u&&(l=0),s[a]=l}return s}function qce(e,t,n,r,i){const s=[...i],o=Wce(n,t);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{const u=jce(t,n,a);let l=r[u];e&1<<u&&(l=Number.MAX_SAFE_INTEGER),s[a]=l}for(let a=0;a<s.length;a++){const u=i[a];s[a]<0&&(s[a]+=u),s[a]=lh(0,s[a],i[a])}return s}function Gce(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function Hce(e,t,n,r,i,s){let o=t[i];const a=n[i]||1;(e&1<<i||s&1<<i||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const u=r[i];return o<0&&(o+=u),o=lh(0,o,u-1),o}function Xce(e,t,n,r,i,s){let o=t[i];const a=n[i]||1;(e&1<<i||s&1<<i||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const u=r[i];return o<0&&(o+=u),a>0?o=lh(0,o,u):o=lh(-1,o,u-1),o}function Q9(e,t,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function Z9(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function n3(e,t,n){let r;const i=e.shape.length;typeof t=="number"?r=[t,...new Array(i-1).fill(0)]:t.length<i?r=t.concat(new Array(i-t.length).fill(0)):r=t.slice(),r.forEach(o=>{U(o!==-1,()=>"slice() does not support negative begin indexing.")});let s;return n==null?s=new Array(i).fill(-1):typeof n=="number"?s=[n,...new Array(i-1).fill(-1)]:n.length<i?s=n.concat(new Array(i-n.length).fill(-1)):s=n,s=s.map((o,a)=>o>=0?o:(U(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),e.shape[a]-r[a])),[r,s]}function J9(e,t,n,r,i,s,o,a,u){let l;if(r==null?(l=new Array(t.length),l.fill(1)):l=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const f={dims:l.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:l.slice(),beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:u};for(let $=0;$<f.dims;$++)c&&1<<$&a&&f.numAddAxisAfterEllipsis++,1<<$&o&&(c=!0);c||(f.ellipsisMask|=1<<f.dims,f.dims++);const d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};$Le(f,d);let h=!0,p=!0,m=!0;const x=[],b=[];for(let $=0;$<e.length;++$){if(d.strides[$]===0)throw Error(`strides[${$}] must be non-zero`);const C=!!(d.shrinkAxisMask&1<<$),S=e[$];if(S===-1){x.push(C?1:-1);continue}const A=[d.beginMask&1<<$,d.endMask&1<<$],E=[d.strides[$]>0?0:-1,d.strides[$]>0?S:S-1];if(C&&d.strides[$]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&d.strides[$]===1;const _=!!(d.beginMask&1<<$&&d.endMask&1<<$);if(d.beginValid&&d.endValid){if(C){const L=d.begin[$]<0?S+d.begin[$]:d.begin[$];if(d.begin[$]=L,d.end[$]=d.begin[$]+1,L<0||L>=S)throw Error(`slice index ${d.begin[$]} of dimension ${$} out of bounds.`)}else d.begin[$]=wZ(d.begin[$],0,d.strides[$],S,A,E),d.end[$]=wZ(d.end[$],1,d.strides[$],S,A,E);const T=d.strides[$]===1&&d.begin[$]===0&&d.end[$]===S;h=h&&T,p=p&&($===0&&d.strides[$]===1||T)}else h=h&&d.strides[$]===1&&_,p=p&&($===0&&d.strides[$]===1||_);let D,N=!1;if(d.beginValid&&d.endValid?(D=d.end[$]-d.begin[$],N=!0):C?(D=1,N=!0):_&&S>=0&&(d.strides[$]<0?D=-S:D=S,N=!0),N){let T;D===0||D<0!=d.strides[$]<0?T=0:T=Math.trunc(D/d.strides[$])+(D%d.strides[$]!==0?1:0),x.push(T)}else x.push(-1)}for(let $=0;$<d.finalShapeGatherIndices.length;++$){const C=d.finalShapeGatherIndices[$];C>=0?b.push(x[C]):C===S6&&b.push(1)}return{finalShapeSparse:b.filter(($,C)=>d.finalShapeGatherIndices[C]!==S6),finalShape:b,isIdentity:h,sliceDim0:p,isSimpleSlice:m,begin:d.begin,end:d.end,strides:d.strides}}function $Le(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(S6),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(bLe),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function wZ(e,t,n,r,i,s){if(i[t])return n>0?s[t]:s[t+1&1];{const o=e<0?r+e:e;return o<s[0]?s[0]:o>s[1]?s[1]:o}}const Yce=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:Y9,computeFlatOffset:Z9,computeOutShape:K9,getNormalizedAxes:wLe,isSliceContinous:Q9,maskToAxes:vLe,parseSliceParams:n3,sliceInfo:J9,startForAxis:Hce,startIndicesWithElidedDims:Vce,stopForAxis:Xce,stopIndicesWithElidedDims:qce,stridesForAxis:Gce,stridesWithElidedDims:Uce},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const CLe="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kce{static sgd(t){return new e3(t)}static momentum(t,n,r=!1){return new q9(t,n,r)}static rmsprop(t,n=.9,r=0,i=null,s=!1){return new G9(t,n,r,i,s)}static adam(t=.001,n=.9,r=.999,i=null){return new W9(t,n,r,i)}static adadelta(t=.001,n=.95,r=null){return new U9(t,n,r)}static adamax(t=.002,n=.9,r=.999,i=null,s=0){return new V9(t,n,r,i,s)}static adagrad(t,n=.1){return new j9(t,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hc=Kce;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SLe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:e=>e();function eU(){return new Promise(e=>SLe(()=>e()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(e,t){const n=e[0].length;e.forEach((i,s)=>{U(i.length===n,()=>`Error in concat${n}D: rank of tensors[${s}] must be the same as the rank of the rest (${n})`)}),U(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=e[0];e.forEach((i,s)=>{for(let o=0;o<n;o++)U(o===t||i[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${s}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function Nl(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var xu;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(xu||(xu={}));function Qce(e,t,n){let r=new Array;if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){const s=n[i],o=r[r.length-n.length+i],a=r[o];if(s>=0)if(a>=0){if(a!==s)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${s} but shape[${i+e}] = ${a}`)}else r[o]=s}return r}function Zce(e){const t={FIRST_DIM_SIZE:xu.FIRST_DIM_SIZE,VALUE_ROWIDS:xu.VALUE_ROWIDS,ROW_LENGTHS:xu.ROW_LENGTHS,ROW_SPLITS:xu.ROW_SPLITS,ROW_LIMITS:xu.ROW_LIMITS,ROW_STARTS:xu.ROW_STARTS},n=[];for(const r of e)if(r in t)n.push(t[r]);else break;return n}function Jce(e){return e.length===0?0:e[0]===xu.FIRST_DIM_SIZE?e.length-1:e.length}function efe(e,t){if(e==null||t==null)return;const n=e.length,r=t.length;if(n>=r)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){const s=e[i],o=t[i+1];if(s>=0&&o>=0&&s!==1&&s!==o)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${s} but ragged tensor input.flatValues.shape[${i-e.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nU=30;function r3(e){return e<=nU?e:zT(e,Math.floor(Math.sqrt(e)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rU(e,t,n){const r=n*(typeof e=="number"?e:e[0]),i=t*(typeof e=="number"?e:e[1]);return[r,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kS(e,t,n,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);const s=t.length;for(let o=0;o<s;++o)i=i.concat([e[o+1]/t[o],t[o]]);i=i.concat(e.slice(s+1))}return i}function ES(e,t,n=!0){const r=[];if(n){r.push(t);for(let i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{const i=[],s=[];for(let o=1;o<e;++o)o>=t*2+1||o%2===1?s.push(o):i.push(o);r.push(...i),r.push(0),r.push(...s)}return r}function AS(e,t,n,r=!0){const i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let s=1;s<e.length;++s)s<=t.length?r?i.push(t[s-1]*e[s]):i.push(e[s]/t[s-1]):i.push(e[s]);return i}function iU(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function sU(e,t,n){const r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i3=1.7580993408473768,s3=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oU=.3275911,aU=.254829592,uU=-.284496736,lU=1.421413741,cU=-1.453152027,fU=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Af(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function tfe(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function nfe(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=0;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function rfe(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let i=2;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}function dU(e,t){const n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function ife(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function sfe(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){const s=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(s),r[i]=Math.sin(s)}return{real:n,imag:r}}function ofe(e,t,n){const r=(n?2:-2)*Math.PI*(e/t),i=Math.cos(r),s=Math.sin(r);return{real:i,imag:s}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ML="->",kLe=/->/g,$Z=",",CZ="...";function hU(e,t){e=e.replace(/\s/g,"");const n=(e.length-e.replace(kLe,"").length)/ML.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${ML}").`);const[r,i]=e.split(ML);U(r.indexOf(CZ)===-1,()=>`The ellipsis notation ("${CZ}") is not supported yet.`);const s=r.split($Z),o=s.length;if(t!==o)throw new Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<i.length;++d){const h=i[d];if(!s.some(p=>p.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);a.indexOf(h)===-1&&a.push(h)}for(let d=0;d<r.length;++d){const h=r[d];a.indexOf(h)===-1&&h!==$Z&&a.push(h)}const u=new Array(s.length);for(let d=0;d<o;++d){if(new Set(s[d].split("")).size!==s[d].length)throw new Error(`Found duplicate axes in input component ${s[d]}. Support for duplicate axes in input is not implemented yet.`);u[d]=[];for(let h=0;h<s[d].length;++h)u[d].push(a.indexOf(s[d][h]))}const l=a.length,c=i.length,f=[];for(let d=c;d<l;++d)f.push(d);return{allDims:a,summedDims:f,idDims:u}}function pU(e,t){let n=new Array(e);n.fill(-1);for(let i=0;i<t.length;++i)n[t[i]]=i;const r=[];for(let i=0;i<e;++i)n[i]===-1&&r.push(i);return n=n.filter(i=>i!==-1),{permutationIndices:n,expandDims:r}}function gU(e,t,n){const r=new Array(e);for(let i=0;i<n.length;++i){const s=n[i].shape;for(let o=0;o<t[i].length;++o)r[t[i][o]]===void 0?r[t[i][o]]=s[o]:U(r[t[i][o]]===s[o],()=>`Expected dimension ${r[t[i][o]]} at axis ${o} of input shaped ${JSON.stringify(s)}, but got dimension ${s[o]}`)}}function mU(e,t){const n=e,r=[];let i=0;e.length===0&&n.push(-1),i=e.length+1;for(let o=0;o<i;++o)r.push([]);const s=[];for(let o=0;o<n.length;++o){const a=n[o],u=ELe(t,a);for(const l of u)s.indexOf(l)===-1&&(r[o].push(l),s.push(l))}return{path:n,steps:r}}function yU(e){return e.every((t,n)=>t===n)}function ELe(e,t){const n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}function xU(e,t,n=0){let r=[];if(typeof t=="number")U(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{const i=t.reduce((o,a)=>(a===-1&&(o+=1),o),0);U(i<=1,()=>"There should be only one negative value in split array.");const s=t.indexOf(-1);if(s!==-1){const o=t.reduce((a,u)=>u>0?a+u:a);t[s]=e.shape[n]-o}U(e.shape[n]===t.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function afe(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function ufe(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function lfe(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cfe(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function ffe(e,t){return`size ${e} must be non-negative, not ${t}`}function dfe(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function hfe(e,t){const n=me(e),r=me(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function pfe(e,t){const n=me(e),r=me(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k6(){return"segment ids must be >= 0"}function gfe(){return"segment ids are not increasing"}function mfe(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function yfe(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xfe(e,t){let n=!1,r;for(e<=nU?(r=e,n=!0):r=zT(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=zT(e,r+1);return r}function bfe(e,t,n){const r=[],i=e.length;for(let s=0;s<i;s++)s!==t?r.push(e[s]):r.push(n);return r}function bU(e,t,n,r){const i=t.shape.length,s=e.shape.length;if(r!==0&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let f=0;f<r;++f)if(e.shape[f]!==t.shape[f])throw new Error(`x.shape[${f}]: ${e.shape[f]} should be equal to indices.shape[${f}]: ${t.shape[f]}.`);const o=e.shape[n],a=[];let u=1,l=1,c=1;for(let f=0;f<r;++f)a.push(e.shape[f]),u*=e.shape[f];for(let f=r;f<n;f++)a.push(e.shape[f]),l*=e.shape[f];for(let f=r;f<i;f++)a.push(t.shape[f]);for(let f=n+1;f<s;f++)a.push(e.shape[f]),c*=e.shape[f];return{batchSize:u,sliceSize:c,outerSize:l,dimSize:o,outputShape:a}}const ALe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:bU,computeOutShape:bfe,segOpComputeOptimalWindowSize:xfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _f(e){try{return e.map(t=>Sf(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function vfe(e){return e.map(t=>Tl(t))}const wfe=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:aU,ERF_A2:uU,ERF_A3:lU,ERF_A4:cU,ERF_A5:fU,ERF_P:oU,PARALLELIZE_THRESHOLD:nU,get RowPartitionType(){return xu},SELU_SCALE:s3,SELU_SCALEALPHA:i3,applyActivation:YF,assertAndGetBroadcastShape:At,assertAxesAreInnerMostDims:ki,assertParamsConsistent:tU,assignToTypedArray:ife,axesAreInnerMostDims:g9,calculateShapes:np,checkEinsumDimSizes:gU,checkPadOnDimRoundingMode:Es,combineLocations:Kle,combineRaggedTensorToTensorShapes:Qce,complexWithEvenIndex:nfe,complexWithOddIndex:rfe,computeConv2DInfo:Jr,computeConv3DInfo:Zh,computeDefaultPad:u9,computeDilation2DInfo:xS,computeOptimalWindowSize:r3,computeOutAndReduceShapes:ei,computeOutShape:Nl,computePool2DInfo:Xa,computePool3DInfo:Bf,convertConv2DDataFormat:zf,decodeEinsumEquation:hU,eitherStridesOrDilationsAreOne:Si,expandShapeToKeepDim:mr,exponent:ofe,exponents:sfe,fromStringArrayToUint8:vfe,fromUint8ToStringArray:_f,getAxesPermutation:nr,getBroadcastDims:sm,getComplexWithIndex:dU,getEinsumComputePath:mU,getEinsumPermutation:pU,getFusedBiasGradient:XF,getFusedDyActivation:HF,getImageCenter:rU,getInnerMostAxes:yr,getPermuted:ES,getRaggedRank:Jce,getReductionAxes:kr,getReshaped:kS,getReshapedPermuted:AS,getRowPartitionTypesHelper:Zce,getSliceBeginCoords:iU,getSliceSize:sU,getSparseFillEmptyRowsIndicesDenseShapeMismatch:afe,getSparseFillEmptyRowsNegativeIndexErrorMessage:ufe,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:lfe,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:dfe,getSparseReshapeInputOutputMismatchErrorMessage:pfe,getSparseReshapeInputOutputMultipleErrorMessage:hfe,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:cfe,getSparseReshapeNegativeOutputDimErrorMessage:ffe,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:yfe,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:k6,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:gfe,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:mfe,getUndoAxesPermutation:Jh,isIdentityPermutation:yU,log:TIe,mergeRealAndImagArrays:Af,prepareAndValidate:t3,prepareSplitSize:xU,segment_util:ALe,shouldFuse:KF,slice_util:Yce,splitRealAndImagArrays:tfe,stridesOrDilationsArePositive:rm,tupleValuesAreOne:hh,upcastType:Gs,validateDefaultValueShape:efe,validateInput:qF,validateUpdateShape:R9,warn:Qo},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Le=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:QF,nonMaxSuppressionV4Impl:ZF,nonMaxSuppressionV5Impl:JF,whereImpl:GF},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */U4e();const TLe=Object.freeze(Object.defineProperty({__proto__:null,Abs:hC,Acos:ax,Acosh:ux,AdadeltaOptimizer:U9,AdagradOptimizer:j9,AdamOptimizer:W9,AdamaxOptimizer:V9,Add:Um,AddN:pC,All:bD,Any:vD,ArgMax:gC,ArgMin:mC,Asin:lx,Asinh:cx,Atan:fx,Atan2:hx,Atanh:dx,AvgPool:yC,AvgPool3D:xC,AvgPool3DGrad:$D,AvgPoolGrad:wD,BatchMatMul:bC,BatchToSpaceND:vC,Bincount:CD,BitwiseAnd:wC,BroadcastArgs:SD,BroadcastTo:Gue,Cast:px,Ceil:gx,ClipByValue:mx,Complex:kD,ComplexAbs:$C,Concat:CC,Conv2D:SC,Conv2DBackpropFilter:ED,Conv2DBackpropInput:kC,Conv3D:EC,Conv3DBackpropFilterV2:AD,Conv3DBackpropInputV2:_D,Cos:yx,Cosh:xx,CropAndResize:ID,Cumprod:TD,Cumsum:AC,DataStorage:q7,DenseBincount:ND,DepthToSpace:DD,DepthwiseConv2dNative:_C,DepthwiseConv2dNativeBackpropFilter:FD,DepthwiseConv2dNativeBackpropInput:RD,Diag:OD,Dilation2D:TC,Dilation2DBackpropFilter:jT,Dilation2DBackpropInput:UT,Draw:MD,get ENV(){return K7},Einsum:LD,Elu:vx,EluGrad:PD,Environment:Vue,Equal:IC,Erf:wx,Exp:$x,ExpandDims:NC,Expm1:Cx,FFT:BD,Fill:zD,FlipLeftRight:UD,Floor:Sx,FloorDiv:kx,FromPixels:WT,FusedBatchNorm:DC,FusedConv2D:Ow,FusedDepthwiseConv2D:Mw,GatherNd:jD,GatherV2:FC,Greater:RC,GreaterEqual:Ex,IFFT:WD,Identity:Ax,Imag:VD,IsFinite:_x,IsInf:Tx,IsNan:Ix,KernelBackend:gD,LRN:UC,LRNGrad:GD,LeakyRelu:OC,Less:MC,LessEqual:LC,LinSpace:qD,Log:Nx,Log1p:Dx,LogSoftmax:Hue,LogicalAnd:PC,LogicalNot:BC,LogicalOr:zC,LogicalXor:SIe,LowerBound:kIe,MatrixBandPart:EIe,Max:jC,MaxPool:WC,MaxPool3D:VC,MaxPool3DGrad:XD,MaxPoolGrad:HD,MaxPoolWithArgmax:YD,Maximum:Fx,Mean:qC,Min:GC,Minimum:Rx,MirrorPad:HC,Mod:Ox,MomentumOptimizer:q9,Multinomial:KD,Multiply:Mx,Neg:XC,NonMaxSuppressionV3:QD,NonMaxSuppressionV4:ZD,NonMaxSuppressionV5:JD,NotEqual:YC,OP_SCOPE_SUFFIX:ule,OneHot:QC,OnesLike:KC,Optimizer:Wf,OptimizerConstructors:Kce,Pack:ZC,PadV2:JC,Pool:AIe,Pow:Lx,Prelu:eS,Prod:tS,RMSPropOptimizer:G9,RaggedGather:eF,RaggedRange:tF,RaggedTensorToTensor:nF,Range:rF,get Rank(){return o6},Real:iF,RealDiv:bx,Reciprocal:Px,get Reduction(){return ls},Relu:Bx,Relu6:zx,Reshape:nS,ResizeBilinear:iS,ResizeBilinearGrad:oF,ResizeNearestNeighbor:rS,ResizeNearestNeighborGrad:sF,Reverse:sS,RotateWithOffset:CF,Round:Ux,Rsqrt:jx,SGDOptimizer:e3,ScatterNd:aF,SearchSorted:lF,Select:oS,Selu:Wx,Sigmoid:Hx,Sign:Gx,Sin:Vx,Sinh:qx,Slice:aS,Softmax:fS,Softplus:Xx,SpaceToBatchND:lS,SparseFillEmptyRows:cF,SparseReshape:fF,SparseSegmentMean:dF,SparseSegmentSum:hF,SparseToDense:pF,SplitV:cS,Sqrt:Yx,Square:gF,SquaredDifference:Kx,StaticRegexReplace:dS,Step:tb,StridedSlice:mF,StringNGrams:yF,StringSplit:xF,StringToHashBucketFast:bF,Sub:Qx,Sum:uS,Tan:Zx,Tanh:Jx,Tensor:nn,TensorBuffer:Sr,TensorScatterUpdate:uF,Tile:eb,TopK:vF,Transform:wF,Transpose:Mg,Unique:$F,Unpack:hS,UnsortedSegmentSum:pS,UpperBound:_Ie,Variable:Bw,ZerosLike:gS,_FusedMatMul:Rw,abs:Tr,acos:kle,acosh:Ele,add:Ee,addN:oDe,all:a9,any:qT,argMax:iy,argMin:Ale,asin:_le,asinh:Tle,atan:Ile,atan2:Nle,atanh:Dle,avgPool:AF,avgPool3d:Fle,backend:n9,backend_util:wfe,basicLSTMCell:TDe,batchNorm:bS,batchNorm2d:Rle,batchNorm3d:Ole,batchNorm4d:Mle,batchToSpaceND:_F,bincount:Lle,bitwiseAnd:PDe,booleanMaskAsync:LOe,broadcastArgs:zDe,broadcastTo:W1,broadcast_util:fFe,browser:yLe,buffer:Ft,cast:Pe,ceil:Ple,clipByValue:_o,clone:eh,complex:fh,concat:Yr,concat1d:Ble,concat2d:zle,concat3d:Ule,concat4d:jle,conv1d:l9,conv2d:ph,conv2dTranspose:f9,conv3d:Wle,conv3dTranspose:qle,copyRegisteredKernels:DIe,cos:TF,cosh:d9,cosineWindow:L9,cumprod:GT,cumsum:h9,customGrad:Vl,denseBincount:b6,deprecationWarn:cNe,depthToSpace:Gle,depthwiseConv2d:vS,device_util:iNe,diag:lFe,dilation2d:Hle,disableDeprecationWarnings:lNe,dispose:Tt,disposeVariables:fNe,div:st,divNoNan:Xle,dot:Yle,dropout:Cce,einsum:N1,elu:wS,enableDebugMode:uNe,enableProdMode:aNe,enclosingPowerOfTwo:Sce,engine:gu,ensureShape:vFe,env:ce,equal:Mu,erf:p9,euclideanNorm:Zle,exp:To,expandDims:us,expm1:Jle,eye:m9,fft:WF,fill:nb,findBackend:yNe,findBackendFactory:xNe,floor:CS,floorDiv:o9,fused:sMe,gather:SS,gatherND:HOe,gather_util:xLe,getBackend:lle,getGradient:i6,getKernel:Pw,getKernelsForBackend:VT,grad:KFe,grads:QFe,greater:Uo,greaterEqual:ep,ifft:Xw,imag:IF,image:El,inTopKAsync:QOe,io:iLe,irfft:D9,isFinite:ece,isInf:tce,isNaN:nce,keep:Tu,kernel_impls:_Le,leakyRelu:NF,less:Vw,lessEqual:jm,linalg:Dce,linspace:GFe,localResponseNormalization:rce,log:ia,log1p:DF,logSigmoid:sce,logSoftmax:y9,logSumExp:RF,logicalAnd:ql,logicalNot:OF,logicalOr:x9,logicalXor:oce,losses:z9,lowerBound:f3e,matMul:Mt,math:aLe,max:Ma,maxPool:MF,maxPool3d:ace,maxPoolWithArgmax:g3e,maximum:Uf,mean:ar,memory:d6,meshgrid:x3e,min:Ww,minimum:om,mirrorPad:uce,mod:lce,moments:LF,movingAverage:zOe,mul:ee,multiRNNCell:S3e,multinomial:E3e,neg:Ln,nextFrame:eU,norm:$S,notEqual:sy,oneHot:qw,ones:Co,onesLike:sa,op:J,outerProduct:N3e,pad:tp,pad1d:R3e,pad2d:M3e,pad3d:P3e,pad4d:z3e,pool:cce,pow:Ef,prelu:BF,print:Sle,prod:fce,profile:dNe,raggedGather:X3e,raggedRange:K3e,raggedTensorToTensor:Z3e,rand:eRe,randomGamma:DRe,randomNormal:C9,randomStandardNormal:ORe,randomUniform:Wm,randomUniformInt:PRe,range:oy,ready:gNe,real:Gw,reciprocal:pce,registerBackend:t9,registerGradient:Xue,registerKernel:SF,relu:uc,relu6:S9,removeBackend:mNe,reshape:ie,reverse:Ba,reverse1d:qRe,reverse2d:HRe,reverse3d:YRe,reverse4d:QRe,rfft:VF,round:k9,rsqrt:E9,scalar:$t,scatterND:jOe,scatter_util:EOe,searchSorted:b9,selu:A9,separableConv2d:_9,serialization:B4e,setBackend:pNe,setPlatform:bNe,setdiff1dAsync:rOe,sigmoid:Il,sign:gce,signal:R4e,sin:T9,sinh:I9,slice:Kt,slice1d:zF,slice2d:N9,slice3d:UF,slice4d:Hw,slice_util:Yce,softmax:jF,softplus:rb,spaceToBatchND:PF,sparse:O4e,sparseToDense:qOe,spectral:F4e,split:Ws,sqrt:wi,square:kn,squaredDifference:F9,squeeze:Vm,stack:Lu,step:sb,stridedSlice:mce,string:M4e,sub:Xe,sum:Ke,sumOutType:kF,tan:yce,tanh:im,tensor:Jd,tensor1d:Li,tensor2d:lw,tensor3d:xce,tensor4d:COe,tensor5d:SOe,tensor6d:kOe,tensorScatterUpdate:_Oe,tensor_util:JIe,test_util:_Re,tidy:fe,tile:Ea,time:hNe,topk:bce,train:Hc,transpose:Vt,truncatedNormal:O9,unique:vce,unregisterGradient:NIe,unregisterKernel:IIe,unsortedSegmentSum:M9,unstack:gh,upcastType:Gs,upperBound:ROe,util:UIe,valueAndGrad:ZFe,valueAndGrads:JFe,variable:wce,variableGrads:ice,version_core:CLe,where:Wi,whereAsync:$ce,zeros:Nr,zerosLike:Xt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $fe={kernelName:hC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(e,sb(Pe(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ILe={kernelName:ax,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=kn(Pe(n,"float32")),i=wi(Xe($t(1),r));return Ln(st(e,i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NLe={kernelName:ux,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=wi(Xe(kn(Pe(n,"float32")),1));return st(e,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DLe={kernelName:Um,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=At(n.shape,r.shape);return{a:()=>{let a=e;const u=kr(n.shape,i);return u.length>0&&(a=Ke(a,u)),ie(a,n.shape)},b:()=>{let a=e;const u=kr(r.shape,i);return u.length>0&&(a=Ke(a,u)),ie(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FLe={kernelName:pC,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach((r,i)=>{n[i]=()=>e.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RLe={kernelName:gC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Xt(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OLe={kernelName:mC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Xt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MLe={kernelName:lx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>st(e,wi(Xe($t(1),kn(Pe(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LLe={kernelName:cx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=wi(Ee($t(1),kn(Pe(n,"float32"))));return st(e,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PLe={kernelName:hx,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=At(n.shape,r.shape);return{a:()=>{const a=Ee(kn(n),kn(r));let u=ee(e,st(r,a));const l=kr(n.shape,i);return l.length>0&&(u=Ke(u,l)),ie(u,n.shape)},b:()=>{const a=Ee(kn(n),kn(r));let u=Ln(ee(e,st(n,a)));const l=kr(r.shape,i);return l.length>0&&(u=Ke(u,l)),ie(u,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BLe={kernelName:fx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>st(e,Ee(kn(Pe(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zLe={kernelName:dx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>st(e,Xe($t(1),kn(Pe(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ULe(e,t,n,r,i,s){const o=W(e,"dy","avgPool3dGrad"),a=W(t,"input","avgPool3dGrad");let u=o,l=a,c=!1;a.rank===4&&(c=!0,u=ie(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),l=ie(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),U(u.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),U(l.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${l.rank}.`),Es("avgPool3dGrad",i,s);const f={dy:u,input:l},d={filterSize:n,strides:r,pad:i,dimRoundingMode:s},h=Z.runKernel($D,f,d);return c?ie(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const jLe=J({avgPool3dGrad_:ULe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WLe={kernelName:xC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:a}=n;return{x:()=>jLe(e,r,i,s,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VLe(e,t,n,r,i){const s=W(e,"dy","avgPoolGrad"),o=W(t,"input","avgPoolGrad");U(o.rank===s.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${s.rank})`);let a=o,u=s,l=!1;o.rank===3&&(l=!0,a=ie(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=ie(s,[1,s.shape[0],s.shape[1],s.shape[2]])),U(u.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${u.rank}.`),U(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const c={dy:u,input:a},f={filterSize:n,strides:r,pad:i},d=Z.runKernel(wD,c,f);return l?ie(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const qLe=J({avgPoolGrad_:VLe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GLe={kernelName:yC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:i,strides:s,pad:o}=n;return{x:()=>qLe(e,r,i,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HLe={kernelName:bC,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,i]=t,{transposeA:s,transposeB:o}=n;return!s&&!o?{a:()=>Mt(e,i,!1,!0),b:()=>Mt(r,e,!0,!1)}:!s&&o?{a:()=>Mt(e,i,!1,!1),b:()=>Mt(e,r,!0,!1)}:s&&!o?{a:()=>Mt(i,e,!1,!0),b:()=>Mt(r,e,!1,!1)}:{a:()=>Mt(i,e,!0,!0),b:()=>Mt(e,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XLe={kernelName:vC,gradFunc:(e,t,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>PF(e,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YLe={kernelName:Gue,gradFunc:(e,t,n)=>{const r=n,i=r.inputShape,s=r.shape,o=Array.from(s);for(let u=i.length-1;u>=0;u--)if(i[u]===s[u])o[u]=1;else if(i[u]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${s}].`);const a=[];for(let u=0;u<o.length;u++)o[u]>1&&a.push(u);return{x:()=>Ke(e,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KLe={kernelName:px,gradFunc:e=>({x:()=>e.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QLe={kernelName:gx,gradFunc:e=>({x:()=>Xt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZLe={kernelName:mx,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:i,clipValueMax:s}=n;return{x:()=>Wi(ql(ep(r,i),jm(r,s)),e,Xt(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JLe={kernelName:$C,inputsToSave:["x"],gradFunc:$fe.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ePe={kernelName:CC,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map(u=>u.shape),{axis:i}=n,s=Ot(i,t[0].shape)[0],o=r.map(u=>u[s]);return Ws(e,o,s).map(u=>()=>u)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tPe={kernelName:SC,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{dilations:s,strides:o,pad:a,dataFormat:u}=n;return U(hh(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>c9(r.shape,e,i,o,a,u),filter:()=>P9(r,e,i.shape,o,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nPe={kernelName:kC,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,{strides:s,pad:o,dataFormat:a,dimRoundingMode:u}=n;return{dy:()=>ph(e,i,s,o,a,1,u),filter:()=>P9(e,r,i.shape,s,o,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rPe(e,t,n,r,i){let s=e;e.rank===4&&(s=ie(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let o=t;o.rank===4&&(o=ie(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),U(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),U(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),U(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),U(s.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${n[3]}.`),U(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:s,dy:o},u={strides:r,pad:i,filterShape:n};return Z.runKernel(AD,a,u)}const iPe=J({conv3DBackpropFilter_:rPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sPe={kernelName:EC,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:s}=n;U(hh(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,a]=t;return{x:()=>Vle(o.shape,e,a,i,s),filter:()=>iPe(o,e,a.shape,i,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oPe={kernelName:yx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(Ln(T9(Pe(n,"float32"))),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aPe={kernelName:xx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(I9(Pe(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uPe={kernelName:AC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i,exclusive:s,reverse:o}=n;return{x:()=>{const a=nr([i],r.rank);let u=h9(e,i,s,!o);return a!=null&&(u=Vt(u,a)),u}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lPe={kernelName:_C,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:i,pad:s,dimRoundingMode:o}=n,a=r??[1,1];U(hh(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[u,l]=t;return U(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`),U(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${l.rank}.`),U(u.shape[3]===l.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`),U(Si(i,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${a}'.`),Es("depthwiseConv2d",s,o),{x:()=>Ace(u.shape,e,l,i,s,a,o),filter:()=>Ece(u,e,l.shape,i,s,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cPe={kernelName:TC,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,i]=t,s={x:r,filter:i,dy:e},o={x:r,filter:i,dy:e};return{x:()=>Z.runKernel(UT,s,n),filter:()=>Z.runKernel(jT,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fPe={kernelName:vx,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>Z.runKernel(PD,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dPe={kernelName:wx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=ee(To(Ln(kn(n))),2/Math.sqrt(Math.PI));return{x:()=>ee(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hPe={kernelName:$x,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(e,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pPe={kernelName:NC,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>ie(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gPe={kernelName:Cx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(e,To(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mPe={kernelName:Sx,gradFunc:e=>({x:()=>Xt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yPe={kernelName:kx,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=At(n.shape,r.shape);return{a:()=>{const a=st(e,Pe(r,"float32")),u=kr(n.shape,i);return u.length>0?ie(Ke(a,u),n.shape):a},b:()=>{let a=ee(e,Pe(n,"float32"));const u=kr(r.shape,i);u.length>0&&(a=ie(Ke(a,u),r.shape));const l=kn(r);return Ln(st(a,Pe(l,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xPe={kernelName:DC,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[i,s,o,a]=t,u=a??$t(1),l=kr(s.shape,i.shape),c=[];if(s.rank===1){for(let C=0;C<i.shape.length-1;++C)c.push(i.shape[C]);c.push(1)}const f=Xe(i,s),d=ee(e,u),h=E9(Ee(o,$t(r))),p=ee(ee(ee(h,h),h),$t(-.5));return{x:()=>s.rank===1?ie(ee(ee(e,Ea(ie(h,[1,1,1,s.shape[0]]),c)),u),i.shape):ie(ee(ee(e,h),u),i.shape),mean:()=>{let C=ee(ee(h,$t(-1)),d);return s.rank===1&&(C=Ke(C,l)),ie(C,s.shape)},variance:()=>{let C=ee(ee(p,f),d);return s.rank===1&&(C=Ke(C,l)),ie(C,s.shape)},scale:()=>{const C=ee(f,h);let S=ee(e,C);return s.rank===1&&(S=Ke(S,l)),ie(S,s.shape)},offset:()=>{let C=e;return s.rank===1&&(C=Ke(C,l)),ie(C,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bPe={kernelName:FC,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,i]=t,{axis:s,batchDims:o}=n,a=Ot(s,r.shape)[0],u=(l,c,f)=>()=>{const d=l.shape,h=c.size,p=d.slice(0,a),m=p.length,x=d.slice(s,d.length).slice(1),b=x.length,v=SZ(0,m),$=SZ(m+1,m+1+b),C=kZ([p,[h],x]),S=ie(f,C),A=ie(c,[h]),E=kZ([[m],v,$]),_=Vt(S,E);let D=M9(_,A,l.shape[a]);const N=Jh(E);return D=Vt(D,N),D};if(o===1){const l=r.shape[0],c=r.split(l,0);return{x:()=>Lu(c.map((h,p)=>u(h,i.slice(p,1),e.slice(p,1))())).reshape(r.shape),indices:()=>i}}else return{x:u(r,i,e),indices:()=>i}}};function SZ(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function kZ(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vPe={kernelName:Ex,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>Xt(n),b:()=>Xt(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wPe={kernelName:Ax,gradFunc:e=>({x:()=>Pe(e,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Pe={kernelName:_x,gradFunc:e=>({x:()=>Xt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CPe={kernelName:Tx,gradFunc:e=>({x:()=>Xt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SPe={kernelName:Ix,gradFunc:e=>({x:()=>Xt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kPe={kernelName:OC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:i}=n,s=Uo(r,0);return{x:()=>Wi(s,e,ee(e,i))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EPe={kernelName:Dx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>st(e,Ee(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const APe={kernelName:Nx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>st(e,Pe(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Pe={kernelName:Hue,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;return{logits:()=>{const o=To(r);return Xe(e,ee(Ke(e,i,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TPe(e,t,n,r=5,i=1,s=1,o=.5){const a={x:e,y:t,dy:n},u={depthRadius:r,bias:i,alpha:s,beta:o};return Z.runKernel(GD,a,u)}const IPe=J({localResponseNormalizationBackprop_:TPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NPe={kernelName:UC,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{depthRadius:s,bias:o,alpha:a,beta:u}=n;return{x:()=>IPe(r,i,e,s,o,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cfe(e,t,n,r){return t.rank<n.rank&&(t=ie(t,mr(t.shape,r))),e.rank<n.rank&&(e=ie(e,mr(e.shape,r))),{x:()=>ee(e,Pe(Mu(n,t),e.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EZ={kernelName:jC,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:i}=r,s=t[0],o=t[1],a=Ot(i,s.shape),u=Cfe(e,o,s,a);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DPe={kernelName:Fx,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>ee(e,Pe(ep(n,r),"float32")),b:()=>ee(e,Pe(Vw(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FPe(e,t,n,r,i,s,o){const a=W(e,"dy","maxPool3dGrad"),u=W(t,"input","maxPool3dGrad"),l=W(n,"output","maxPool3dGrad");let c=a,f=u,d=l,h=!1;u.rank===4&&(h=!0,c=ie(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),f=ie(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),d=ie(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),U(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),U(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),U(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),Es("maxPool3dGrad",s,o);const p={dy:c,input:f,output:d},m={filterSize:r,strides:i,pad:s,dimRoundingMode:o},x=Z.runKernel(XD,p,m);return h?ie(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}const RPe=J({maxPool3dGrad_:FPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OPe={kernelName:VC,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=n;return{x:()=>RPe(e,r,i,s,o,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MPe(e,t,n,r,i,s,o){const a=W(e,"dy","maxPoolGrad"),u=W(t,"input","maxPoolGrad"),l=W(n,"output","maxPoolGrad");U(u.rank===a.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${a.rank})`),U(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),U(u.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${u.rank}.`),Es("maxPoolGrad",s,o);const c={dy:a,input:u,output:l},f={filterSize:r,strides:i,pad:s,dimRoundingMode:o};return Z.runKernel(HD,c,f)}const LPe=J({maxPoolGrad_:MPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PPe={kernelName:WC,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,i]=t,{filterSize:s,strides:o,pad:a}=n;return{x:()=>LPe(e,r,i,s,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BPe={kernelName:qC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n,s=Ot(i,r.shape),a=ei(r.shape,s)[1],u=me(a);return{x:()=>{const c=r.shape.slice();s.forEach(h=>{c[h]=1});const f=ie(e,c);return st(ee(f,Co(r.shape,"float32")),u)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zPe={kernelName:GC,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:i}=r,[s,o]=t,a=Ot(i,s.shape),u=Cfe(e,o,s,a);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UPe={kernelName:Rx,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>ee(e,Pe(jm(n,r),"float32")),b:()=>ee(e,Pe(Uo(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jPe={kernelName:HC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,s=i.map(o=>o[0]);return{x:()=>Kt(e,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WPe={kernelName:Ox,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=At(n.shape,r.shape);return{a:()=>{const a=kr(n.shape,i);return a.length>0?ie(Ke(e,a),n.shape):e},b:()=>{const a=ee(e,Ln(CS(st(n,r)))),u=kr(r.shape,i);return u.length>0?ie(Ke(a,u),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VPe={kernelName:Mx,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=At(n.shape,r.shape);return{a:()=>{const a=ee(e,Pe(r,"float32")),u=kr(n.shape,i);return u.length>0?ie(Ke(a,u),n.shape):a},b:()=>{const a=ee(e,Pe(n,"float32")),u=kr(r.shape,i);return u.length>0?ie(Ke(a,u),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qPe={kernelName:XC,gradFunc:e=>({x:()=>Ln(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GPe={kernelName:QC,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>Nr(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HPe={kernelName:KC,gradFunc:e=>({x:()=>Xt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XPe={kernelName:ZC,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return gh(e,r).map(s=>()=>s)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AZ={kernelName:JC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:i}=n,s=i.map(o=>o[0]);return{x:()=>Kt(e,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YPe={kernelName:Lx,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,i]=t,s=n,o=r,a=At(s.shape,o.shape);return{a:()=>{const c=Pe(o,"float32");let f=ee(e,ee(c,Ef(s,Xe(c,$t(1)))));const d=kr(s.shape,a);return d.length>0&&(f=Ke(f,d)),ie(f,s.shape)},b:()=>{const c=Uo(s,0),f=Wi(c,ia(s),Xt(s));let d=ee(e,ee(i,f));const h=kr(o.shape,a);return h.length>0&&(d=Ke(d,h)),ie(d,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KPe={kernelName:eS,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,i=Uo(n,0);return{x:()=>Wi(i,e,ee(e,r)),alpha:()=>{let s=Wi(i,Xt(e),ee(e,n));const o=kr(r.shape,e.shape);return o.length>0&&(s=Ke(s,o)),ie(s,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QPe(e,t,n){const r=e.shape.slice();r[n]=1;const i=ie(t,r),s=GT(e,n,!0,!1),o=GT(e,n,!0,!0),a=ee(s,o);return ee(i,a)}function ZPe(e,t,n){const r=e.shape.length,i=r-n.length,s=nr(n,r);let o=e;s!=null&&(o=Vt(e,s));const a=o.shape.slice(),l=a.splice(r-n.length,n.length).reduce((d,h)=>d*h,1);a.push(l);const c=o.reshape(a);let f=QPe(c,t,i);if(f=f.reshape(o.shape),s!=null){const d=Jh(s);f=Vt(f,d)}return f}const JPe={kernelName:tS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:i}=n;let s=[];return i==null?s=r.shape.map((o,a)=>a):typeof i=="number"?s=[i]:s=i,{x:()=>ZPe(r,e,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eBe={kernelName:bx,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=At(n.shape,r.shape);return{a:()=>{const a=st(e,Pe(r,"float32")),u=kr(n.shape,i);return u.length>0?ie(Ke(a,u),n.shape):a},b:()=>{let a=ee(e,Pe(n,"float32"));const u=kr(r.shape,i);u.length>0&&(a=ie(Ke(a,u),r.shape));const l=kn(r);return Ln(st(a,Pe(l,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tBe={kernelName:Px,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>st(e,Ln(kn(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nBe={kernelName:zx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=ee(jm(n,6),sb(n));return{x:()=>ee(e,Pe(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rBe={kernelName:Bx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(e,Pe(sb(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iBe={kernelName:nS,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ie(e,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sBe={kernelName:iS,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>Z.runKernel(oF,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oBe={kernelName:rS,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,i={dy:e,images:r};return{images:()=>Z.runKernel(sF,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aBe={kernelName:sS,gradFunc:(e,t,n)=>{const{dims:r}=n,i=Ot(r,e.shape);return{x:()=>Ba(e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uBe={kernelName:Ux,gradFunc:e=>({x:()=>Xt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lBe={kernelName:jx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Ln(st(e,ee(Ef(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cBe={kernelName:oS,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>Pe(Xt(n),"float32"),t:()=>ee(e,Pe(n,e.dtype)),e:()=>ee(e,Pe(OF(n),e.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fBe={kernelName:Wx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const r=Uo(n,$t(0)),i=$t(i3),s=$t(s3),o=ee(e,s),a=ee(ee(e,i),To(Pe(n,"float32")));return Wi(r,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dBe={kernelName:Hx,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(e,ee(n,Xe($t(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hBe={kernelName:Gx,gradFunc:e=>({x:()=>Xt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pBe={kernelName:Vx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(TF(Pe(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gBe={kernelName:qx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(d9(Pe(n,"float32")),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mBe={kernelName:aS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:i,size:s}=n,o=r.shape,[a,u]=n3(r,i,s),l=[];for(let c=0;c<e.rank;c++)l.push([a[c],o[c]-a[c]-u[c]]);return{x:()=>tp(e,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yBe={kernelName:fS,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:i}=n,s=!0,o=ee(e,r);return{logits:()=>Xe(o,ee(Ke(o,[i],s),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xBe={kernelName:Xx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(e,Il(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Z={kernelName:lS,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>_F(e,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TZ={kernelName:cS,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>Yr(e,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bBe={kernelName:Yx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>st(e,ee(wi(Pe(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vBe={kernelName:gF,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(e,ee(Pe(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wBe={kernelName:Kx,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=$t(2);return{a:()=>ee(e,ee(i,Xe(n,r))),b:()=>ee(e,ee(i,Xe(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Be={kernelName:tb,gradFunc:e=>({x:()=>Xt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CBe={kernelName:Qx,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,i=At(n.shape,r.shape);return{a:()=>{let a=e;const u=kr(n.shape,i);return u.length>0&&(a=Ke(a,u)),ie(a,n.shape)},b:()=>{let a=e;const u=kr(r.shape,i);return u.length>0&&(a=Ke(a,u)),ie(Ln(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SBe={kernelName:uS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,i=r.shape.slice(),{axis:s}=n;Ot(s,r.shape).forEach(l=>{i[l]=1});const a=ie(e,i),u=ee(a,Co(r.shape,"float32"));return{x:()=>u}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kBe={kernelName:Zx,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>st(e,kn(TF(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EBe={kernelName:Jx,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>ee(Xe($t(1),kn(n)),e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ABe={kernelName:eb,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:i}=n;return{x:()=>{let o=Xt(r);if(r.rank===1)for(let a=0;a<i[0];++a)o=Ee(o,Kt(e,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<i[0];++a)for(let u=0;u<i[1];++u)o=Ee(o,Kt(e,[a*r.shape[0],u*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<i[0];++a)for(let u=0;u<i[1];++u)for(let l=0;l<i[2];++l)o=Ee(o,Kt(e,[a*r.shape[0],u*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<i[0];++a)for(let u=0;u<i[1];++u)for(let l=0;l<i[2];++l)for(let c=0;c<i[3];++c)o=Ee(o,Kt(e,[a*r.shape[0],u*r.shape[1],l*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Be={kernelName:Mg,gradFunc:(e,t,n)=>{const r=n,{perm:i}=r,s=Jh(i);return{x:()=>Vt(e,s)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TBe={kernelName:hS,gradFunc:(e,t,n)=>{const r=n,{axis:i}=r;return{value:()=>Lu(e,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IBe={kernelName:pS,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>NBe(e,n)}}};function NBe(e,t){const n=Uf(t,Xt(t)),r=SS(e,n);let i=ep(t,$t(0,"int32"));const s=r.rank-i.rank;for(let a=0;a<s;++a)i=us(i,a+1);i=ql(i,Co(r.shape,"bool"));const o=Xt(r);return Wi(i,r,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DBe={kernelName:gS,gradFunc:e=>({x:()=>Xt(e)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FBe=[$fe,ILe,NLe,DLe,FLe,RLe,OLe,MLe,LLe,PLe,BLe,zLe,WLe,GLe,HLe,XLe,YLe,KLe,QLe,ZLe,JLe,ePe,nPe,tPe,sPe,oPe,aPe,uPe,lPe,cPe,eBe,fPe,dPe,hPe,pPe,gPe,yPe,mPe,xPe,bPe,vPe,wPe,$Pe,CPe,SPe,kPe,EPe,APe,_Pe,NPe,EZ,EZ,DPe,OPe,PPe,BPe,zPe,UPe,jPe,WPe,VPe,qPe,GPe,HPe,XPe,AZ,AZ,YPe,KPe,JPe,tBe,nBe,rBe,iBe,sBe,oBe,aBe,uBe,lBe,cBe,fBe,dBe,hBe,pBe,gBe,mBe,yBe,xBe,_Z,_Z,TZ,TZ,bBe,wBe,vBe,$Be,CBe,SBe,kBe,EBe,ABe,_Be,TBe,IBe,DBe];for(const e of FBe)Xue(e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.abs=function(){return this.throwIfDisposed(),Tr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.acos=function(){return this.throwIfDisposed(),kle(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.acosh=function(){return this.throwIfDisposed(),Ele(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.add=function(e){return this.throwIfDisposed(),Ee(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.all=function(e,t){return this.throwIfDisposed(),a9(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.any=function(e,t){return this.throwIfDisposed(),qT(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.argMax=function(e){return this.throwIfDisposed(),iy(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.argMin=function(e){return this.throwIfDisposed(),Ale(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.asScalar=function(){return this.throwIfDisposed(),U(this.size===1,()=>"The array must have only 1 element."),ie(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.asType=function(e){return this.throwIfDisposed(),Pe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.as1D=function(){return this.throwIfDisposed(),ie(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.as2D=function(e,t){return this.throwIfDisposed(),ie(this,[e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),ie(this,[e,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),ie(this,[e,t,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),ie(this,[e,t,n,r,i])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.asin=function(){return this.throwIfDisposed(),_le(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.asinh=function(){return this.throwIfDisposed(),Tle(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.atan=function(){return this.throwIfDisposed(),Ile(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.atan2=function(e){return this.throwIfDisposed(),Nle(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.atanh=function(){return this.throwIfDisposed(),Dle(this)};ye().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),AF(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),_F(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.batchNorm=function(e,t,n,r,i){return this.throwIfDisposed(),bS(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.broadcastTo=function(e){return this.throwIfDisposed(),W1(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.cast=function(e){return this.throwIfDisposed(),Pe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.ceil=function(){return this.throwIfDisposed(),Ple(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),_o(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof nn&&(e=[e]),Yr([this,...e],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.conv1d=function(e,t,n,r,i,s){return this.throwIfDisposed(),l9(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),f9(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.conv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),ph(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.cos=function(){return this.throwIfDisposed(),TF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.cosh=function(){return this.throwIfDisposed(),d9(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),GT(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),h9(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Gle(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.depthwiseConv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),vS(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.dilation2d=function(e,t,n,r,i){return this.throwIfDisposed(),Hle(this,e,t,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.divNoNan=function(e){return this.throwIfDisposed(),Xle(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.div=function(e){return this.throwIfDisposed(),st(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.dot=function(e){return this.throwIfDisposed(),Yle(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.elu=function(){return this.throwIfDisposed(),wS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.equal=function(e){return this.throwIfDisposed(),Mu(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.erf=function(){return this.throwIfDisposed(),p9(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),Zle(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.exp=function(){return this.throwIfDisposed(),To(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.expandDims=function(e){return this.throwIfDisposed(),us(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.expm1=function(){return this.throwIfDisposed(),Jle(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.fft=function(){return this.throwIfDisposed(),WF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.flatten=function(){return this.throwIfDisposed(),ie(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.floor=function(){return this.throwIfDisposed(),CS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.floorDiv=function(e){return this.throwIfDisposed(),o9(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.gather=function(e,t,n){return this.throwIfDisposed(),SS(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.greaterEqual=function(e){return this.throwIfDisposed(),ep(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.greater=function(e){return this.throwIfDisposed(),Uo(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.ifft=function(){return this.throwIfDisposed(),Xw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.irfft=function(){return this.throwIfDisposed(),D9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.isFinite=function(){return this.throwIfDisposed(),ece(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.isInf=function(){return this.throwIfDisposed(),tce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.isNaN=function(){return this.throwIfDisposed(),nce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.leakyRelu=function(e){return this.throwIfDisposed(),NF(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.lessEqual=function(e){return this.throwIfDisposed(),jm(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.less=function(e){return this.throwIfDisposed(),Vw(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),rce(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.logSigmoid=function(){return this.throwIfDisposed(),sce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.logSoftmax=function(e){return this.throwIfDisposed(),y9(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),RF(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.log=function(){return this.throwIfDisposed(),ia(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.log1p=function(){return this.throwIfDisposed(),DF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.logicalAnd=function(e){return this.throwIfDisposed(),ql(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.logicalNot=function(){return this.throwIfDisposed(),OF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.logicalOr=function(e){return this.throwIfDisposed(),x9(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.logicalXor=function(e){return this.throwIfDisposed(),oce(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Mt(this,e,t,n)};ye().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),MF(this,e,t,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.max=function(e,t){return this.throwIfDisposed(),Ma(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.maximum=function(e){return this.throwIfDisposed(),Uf(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.mean=function(e,t){return this.throwIfDisposed(),ar(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.min=function(e,t){return this.throwIfDisposed(),Ww(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.minimum=function(e){return this.throwIfDisposed(),om(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),uce(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.mod=function(e){return this.throwIfDisposed(),lce(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.mul=function(e){return this.throwIfDisposed(),ee(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.neg=function(){return this.throwIfDisposed(),Ln(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.norm=function(e,t,n){return this.throwIfDisposed(),$S(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.notEqual=function(e){return this.throwIfDisposed(),sy(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),qw(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.onesLike=function(){return this.throwIfDisposed(),sa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.pad=function(e,t){return this.throwIfDisposed(),tp(this,e,t)};ye().prototype.pool=function(e,t,n,r,i,s){return this.throwIfDisposed(),cce(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.pow=function(e){return this.throwIfDisposed(),Ef(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.prelu=function(e){return this.throwIfDisposed(),BF(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.prod=function(e,t){return this.throwIfDisposed(),fce(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.reciprocal=function(){return this.throwIfDisposed(),pce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.relu=function(){return this.throwIfDisposed(),uc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.relu6=function(){return this.throwIfDisposed(),S9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.reshapeAs=function(e){return this.throwIfDisposed(),ie(this,e.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.reshape=function(e){return this.throwIfDisposed(),ie(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),Ice(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),Nce(this,e,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.reverse=function(e){return this.throwIfDisposed(),Ba(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.rfft=function(){return this.throwIfDisposed(),VF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.round=function(){return this.throwIfDisposed(),k9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.rsqrt=function(){return this.throwIfDisposed(),E9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.selu=function(){return this.throwIfDisposed(),A9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.separableConv2d=function(e,t,n,r,i,s){return this.throwIfDisposed(),_9(this,e,t,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.sigmoid=function(){return this.throwIfDisposed(),Il(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.sign=function(){return this.throwIfDisposed(),gce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.sin=function(){return this.throwIfDisposed(),T9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.sinh=function(){return this.throwIfDisposed(),I9(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.slice=function(e,t){return this.throwIfDisposed(),Kt(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.softmax=function(e){return this.throwIfDisposed(),jF(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.softplus=function(){return this.throwIfDisposed(),rb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),PF(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.split=function(e,t){return this.throwIfDisposed(),Ws(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.sqrt=function(){return this.throwIfDisposed(),wi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.square=function(){return this.throwIfDisposed(),kn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.squaredDifference=function(e){return this.throwIfDisposed(),F9(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.squeeze=function(e){return this.throwIfDisposed(),Vm(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof nn?[this,e]:[this,...e];return Lu(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.step=function(e){return this.throwIfDisposed(),sb(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.stridedSlice=function(e,t,n,r,i,s,o,a){return this.throwIfDisposed(),mce(this,e,t,n,r,i,s,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.sub=function(e){return this.throwIfDisposed(),Xe(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.sum=function(e,t){return this.throwIfDisposed(),Ke(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.tan=function(){return this.throwIfDisposed(),yce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.tanh=function(){return this.throwIfDisposed(),im(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.tile=function(e){return this.throwIfDisposed(),Ea(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.toBool=function(){return this.throwIfDisposed(),Pe(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.toFloat=function(){return this.throwIfDisposed(),Pe(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.toInt=function(){return this.throwIfDisposed(),Pe(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.topk=function(e,t){return this.throwIfDisposed(),bce(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.transpose=function(e){return this.throwIfDisposed(),Vt(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.unique=function(e){return this.throwIfDisposed(),vce(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),M9(this,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.unstack=function(e){return this.throwIfDisposed(),gh(this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.where=function(e,t){return this.throwIfDisposed(),Wi(e,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ye().prototype.zerosLike=function(){return this.throwIfDisposed(),Xt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ml extends Error{constructor(t){super(t),Object.setPrototypeOf(this,ml.prototype)}}class Aa extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Aa.prototype)}}class ne extends Error{constructor(t){super(t),Object.setPrototypeOf(this,ne.prototype)}}class Dt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Dt.prototype)}}class vU extends Error{constructor(t){super(t),Object.setPrototypeOf(this,vU.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Sfe{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let n;return this.cache.has(t)&&(n=this.cache.get(t),this.cache.delete(t),this.cache.set(t,n)),n}put(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(t,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let n=0;n<this.maxEntries-t;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function um(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{const n=new Array(t);return n.fill(e),n}}function yl(e,t){if(!e)throw new vU(t)}function IZ(e,t){let n=0;for(const r of e)r===t&&n++;return n}function Ms(e){return e.length===1?e[0]:e}function pn(e){return Array.isArray(e)?e:[e]}function Xc(e){const n=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function mg(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}let ba={};function wU(e){if(e==null)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function E6(e){if(!(e==null||typeof e!="object"))if(Array.isArray(e))e.forEach(t=>E6(t));else{const t=Object.keys(e);for(const n of t){const r=e[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?e[n]=r.value:E6(r))}}}function _S(e,t={},n={},r="object",i=!1){if(typeof e=="string"){const s=e;let o;if(s in n)o=n[s];else if(s in ba)o=ba[s];else if(o=t[s],o==null)throw new ne(`Unknown ${r}: ${e}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const s=e;if(s.className==null||s.config==null)throw new ne(`${r}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);const o=s.className;let a,u;if(o in n?[a,u]=n[o]:o in ba?[a,u]=ba.className:o in t&&([a,u]=t[o]),a==null)throw new ne(`Unknown ${r}: ${o}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(u!=null){const l={};for(const h of Object.keys(ba))l[h]=ba[h];for(const h of Object.keys(n))l[h]=n[h];const c=s.config;c.customObjects=l;const f=Object.assign({},ba);for(const h of Object.keys(n))ba[h]=n[h];E6(s.config);const d=u(a,s.config,n,i);return ba=Object.assign({},f),d}else{const l=Object.assign({},ba);for(const f of Object.keys(n))ba[f]=n[f];const c=new a(s.config);return ba=Object.assign({},l),c}}}function RBe(e,t){return e<t?-1:e>t?1:0}function hA(e,t){return-1*RBe(e,t)}function th(e){if(e==null)return e;const t=[];for(const n of e)t.indexOf(n)===-1&&t.push(n);return t}function OBe(e){if(e==null)throw new ne(`Invalid value in obj: ${JSON.stringify(e)}`);for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function Gm(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new ne(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function $U(e,t,n=0,r=1/0){return yl(n>=0),yl(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(i=>typeof i===t)}function Gr(e,t){Array.isArray(e)?(U(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((n,r)=>Gr(n,`element ${r+1} of ${t}`))):U(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${kfe(e)}.`)}function kfe(e){return e===null?"null":Array.isArray(e)?"["+e.map(t=>kfe(t)).join(",")+"]":typeof e=="string"?`"${e}"`:`${e}`}function MBe(e,t,n){let r=n!=null?n():ci(),i;return(...o)=>{const a=n!=null?n():ci();return a-r<t||(r=a,i=e(...o)),i}}function Efe(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let LBe=0;function Afe(){return LBe++}const pA={};function o3(e=""){return e in pA||(pA[e]=0),pA[e]+=1,e+pA[e].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const PBe=["channelsFirst","channelsLast"],BBe=["nearest","bilinear"],zBe=["valid","same","causal"],UBe=["max","avg"],jBe=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const s1=new Map;function xr(e){Gm(PBe,"DataFormat",e)}function WBe(e){Gm(BBe,"InterpolationFormat",e)}function ca(e){Gm(zBe,"PaddingMode",e)}function _fe(e){Gm(UBe,"PoolMode",e)}const cw=[],NZ="/";function Lg(e,t){cw.push(e);try{const n=t();return cw.pop(),n}catch(n){throw cw.pop(),n}}function VBe(){return cw.length===0?"":cw.join(NZ)+NZ}function Tfe(e){if(!Nfe(e))throw new Error("Not a valid tensor name: '"+e+"'");return VBe()+e}function Ife(e){if(!Nfe(e))throw new Error("Not a valid tensor name: '"+e+"'");s1.has(e)||s1.set(e,0);const t=s1.get(e);if(s1.set(e,s1.get(e)+1),t>0){const n=`${e}_${t}`;return s1.set(n,1),n}else return e}const qBe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Nfe(e){return!!e.match(qBe)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GBe(e){return e===parseInt(e.toString(),10)}function nh(e,t,n){t==null&&(t=0),n==null&&(n=e.length);let r=1;for(let i=t;i<n;++i)r*=e[i];return r}function ay(e){if(e.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function mh(e){if(e.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function Pu(e,t){if(t<e)throw new ne(`end (${t}) < begin (${e}) is forbidden.`);const n=[];for(let r=e;r<t;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let LL;function Dr(){return LL==null&&(LL=n9().epsilon()),LL}function Bu(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dl(e,t){return Pe(e,t)}function TS(e,t=-1){const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),ie(e,n)}function HBe(e,t){return fe(()=>{if(e.shape.length!==2)throw new ne(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);const n=TS(e,1);return A6(n,[1,t,1])})}function XBe(e){const t=[nh(e.shape)];return ie(e,t)}function YBe(e){if(e.rank<=1)throw new ne(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);const t=[e.shape[0],nh(e.shape,1)];return ie(e,t)}function Pg(e,t,n){return fe(()=>{switch(e.rank){case 1:return zF(e,t,n);case 2:return N9(e,[t,0],[n,e.shape[1]]);case 3:return UF(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return Hw(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Kt(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Kt(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new ne(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function PL(e,t,n){return fe(()=>{switch(e.rank){case 1:return zF(e,t,n);case 2:return N9(e,[0,t],[e.shape[0],n]);case 3:return UF(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return Hw(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new ne(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function gA(e,t,n,r){return fe(()=>{switch(e.rank){case 1:return zF(e,t,n);case 2:switch(r){case 1:return Pg(e,t,n);case 2:return PL(e,t,n);default:throw new ne(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Pg(e,t,n);case 2:return UF(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return PL(e,t,n);default:throw new ne(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Pg(e,t,n);case 2:return Hw(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return Hw(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return PL(e,t,n);default:throw new ne(`The axis is not within the rank of the tensor ${r}`)}default:throw new ne(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function CU(e,t=-1){let n;return t<0&&(n=e[0].rank,n!==0?t=n:t=0),t===e[0].rank&&(t=-1),Yr(e,t)}function DZ(e,t){switch(e.rank){case 1:return Ble([e,t]);case 2:return zle([e,t],0);case 3:return Ule([e,t],0);case 4:return jle([e,t],0);default:throw new ne(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function A6(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new ne(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return Ea(e,t)}function a3(e,t=0,n=1,r,i){return C9(e,t,n,r,i)}function Fl(e,t,n,r){if(e.rank<2||t.rank<2)throw new Dt(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){const i=e.shape.slice(-1)[0],s=t.shape.slice(-2)[0];if(i!==s)throw new Dt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return w6({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?_6(e.rank,r,Bu()):null,activation:n});{const i=e.shape.slice(),s=i.pop();e=ie(e,[-1,s]);const o=t.shape.slice(),a=o.pop(),u=o.pop(),l=[...o,a],c=Array.from({length:t.rank},(p,m)=>m===0?t.rank-2:m<=t.rank-2?m-1:m);t=ie(Vt(t,c),[u,-1]);const f=[...i,...l];return ie(w6({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?_6(e.rank,r,Bu()):null,activation:n}),f)}}function Dfe(e,t,n){return fe(()=>(Array.isArray(t)?t=Li(t,"int32"):t=Pe(t,"int32"),SS(e,t,n)))}function IS(e){return ee(e,e)}function _6(e,t,n){const r=t.shape;if(t.rank!==1&&t.rank!==e)throw new ne(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n==="channelsFirst")return r.length===1?ie(t,[1,r[0],1,1,1]):ie(t,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?ie(t,[1,1,1,1,r[0]]):ie(t,[1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?ie(t,[1,r[0],1,1]):ie(t,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?ie(t,[1,1,1,r[0]]):ie(t,[1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?ie(t,[1,r[0],1]):ie(t,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?ie(t,[1,1,r[0]]):ie(t,[1].concat(r))}else if(e<3)return t;throw new ne(`Unsupported input rank by biasAdd: ${t.rank}`)}function qu(e,t,n){return fe(()=>(n==null&&(n=Bu()),xr(n),Ee(e,_6(e.rank,t,n))))}function KBe(e,t=1){if(t!==1)throw new Dt(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return wS(e)}function QBe(e){return fe(()=>st(e,Ee(Tr(e),1)))}function Ffe(e,t,n,r){return fe(()=>Cce(e,t,n,r))}function ZBe(e){return fe(()=>{const t=Ee(.5,ee(.2,e));return _o(t,0,1)})}function NS(e,t,n=!1){return n?e():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const JBe=["fanIn","fanOut","fanAvg"],e5e=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t5e(e){Gm(JBe,"FanMode",e)}function n5e(e){Gm(e5e,"Distribution",e)}class Ya extends qm{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Rfe extends Ya{apply(t,n){return Nr(t,n)}}Rfe.className="Zeros";Ae(Rfe);class SU extends Ya{apply(t,n){return Co(t,n)}}SU.className="Ones";Ae(SU);class Ofe extends Ya{constructor(t){if(super(),typeof t!="object")throw new ne(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new ne(`config must have value set but got ${t}`);this.value=t.value}apply(t,n){return fe(()=>ee($t(this.value),Co(t,n)))}getConfig(){return{value:this.value}}}Ofe.className="Constant";Ae(Ofe);class Mfe extends Ya{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,n){return Wm(t,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}Mfe.className="RandomUniform";Ae(Mfe);class Lfe extends Ya{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Dt(`randomNormal does not support dType ${n}.`);return a3(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Lfe.className="RandomNormal";Ae(Lfe);class Pfe extends Ya{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Dt(`truncatedNormal does not support dType ${n}.`);return O9(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Pfe.className="TruncatedNormal";Ae(Pfe);let Bfe=class extends Ya{constructor(t){super(),this.gain=t.gain!=null?t.gain:1}apply(t,n){return fe(()=>{if(t.length!==2||t[0]!==t[1])throw new ne("Identity matrix initializer can only be used for 2D square matrices.");return ee(this.gain,m9(t[0]))})}getConfig(){return{gain:this.gain}}};Bfe.className="Identity";Ae(Bfe);function r5e(e,t="channelsLast"){let n,r;if(xr(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t==="channelsFirst"){const i=nh(e,2);n=e[1]*i,r=e[0]*i}else if(t==="channelsLast"){const i=nh(e,0,e.length-2);n=e[e.length-2]*i,r=e[e.length-1]*i}}else{const i=nh(e);n=Math.sqrt(i),r=Math.sqrt(i)}return[n,r]}class Io extends Ya{constructor(t){if(super(),t.scale<0)throw new ne(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,t5e(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,n5e(this.distribution),this.seed=t.seed}apply(t,n){const r=r5e(t),i=r[0],s=r[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,i):this.mode==="fanOut"?o/=Math.max(1,s):o/=Math.max(1,(i+s)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Dt(`${this.getClassName()} does not support dType ${n}.`);return O9(t,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return Wm(t,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Io.className="VarianceScaling";Ae(Io);class kU extends Io{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Io.className}}kU.className="GlorotUniform";Ae(kU);class EU extends Io{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Io.className}}EU.className="GlorotNormal";Ae(EU);class AU extends Io{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Io.className}}AU.className="HeNormal";Ae(AU);class _U extends Io{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Io.className}}_U.className="HeUniform";Ae(_U);class TU extends Io{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Io.className}}TU.className="LeCunNormal";Ae(TU);class IU extends Io{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Io.className}}IU.className="LeCunUniform";Ae(IU);class zfe extends Ya{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,n){return fe(()=>{if(t.length<2)throw new Dt("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=me(t.slice(0,-1)),i=t[t.length-1],s=r*i;s>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${s}) elements: Slowness may result.`);const o=[Math.max(i,r),Math.min(i,r)],a=a3(o,0,1,n,this.seed),u=Dce.qr(a,!1);let l=u[0];const f=u[1].flatten().stridedSlice([0],[Math.min(i,r)*Math.min(i,r)],[Math.min(i,r)+1]);return l=ee(l,f.sign()),r<i&&(l=l.transpose()),ee($t(this.gain),l.reshape(t))})}getConfig(){return{gain:this.gain,seed:this.seed}}}zfe.className="Orthogonal";Ae(zfe);const FZ={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function RZ(e,t={}){return _S(e,Zo.getMap().classNameMap,t,"initializer")}function Jn(e){return wU(e)}function qn(e){if(typeof e=="string"){const t=e in FZ?FZ[e]:e;if(t==="GlorotNormal")return new EU;if(t==="GlorotUniform")return new kU;if(t==="HeNormal")return new AU;if(t==="HeUniform")return new _U;if(t==="LeCunNormal")return new TU;if(t==="LeCunUniform")return new IU;{const n={};return n.className=t,n.config={},RZ(n)}}else return e instanceof Ya?e:RZ(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function T6(e){return Array.isArray(e)&&Array.isArray(e[0])}function HT(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function Ct(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new ne(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function en(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new ne(`Expected exactly 1 Shape; got ${e.length}`)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function XT(e){let t=0;for(const n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((r,i)=>r*i);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const OZ="Variable";class i5e{constructor(t,n="float32",r=OZ,i=!0,s=null){this.dtype=n??"float32",this.shape=t.shape,this.id=Afe(),r=r??OZ,this.originalName=Tfe(r),this.name=Ife(this.originalName),this.trainable_=i,this.constraint=s,this.val=wce(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),s5e(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function s5e(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function I6(e){return e.map(t=>t.read())}function NU(e){e.forEach(t=>{t[0].write(t[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Fr{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Gl{constructor(t,n,r,i,s,o,a){this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=i,this.callArgs=s,this.outputTensorIndex=a,this.id=Afe(),o!=null&&(this.originalName=Tfe(o),this.name=Ife(this.originalName)),this.rank=n.length}}let o5e=0,u3=class{constructor(t,n){this.callArgs=n,this.id=o5e++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const r of t.inboundLayers)r!=null&&r.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},a5e=0;class Lt extends qm{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=a5e++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){const r=this.getClassName();n=Xc(r)+"_"+o3(r)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let r;if(t.batchInputShape!=null)r=t.batchInputShape;else if(t.inputShape!=null){let s=null;t.batchSize!=null&&(s=t.batchSize),r=[s].concat(t.inputShape)}this.batchInputShape=r;let i=t.dtype;i==null&&(i=t.inputDType),i==null&&(i="float32"),this.dtype=i}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new Aa(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new ne(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return Ms(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return Ms(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ml(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new ml(`Layer ${this.name} is not connected, no input to return.`);return Ms(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ml(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new ml(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Ms(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const n=pn(t);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=pn(this.inputSpec);if(n.length!==r.length)throw new ne(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${t}`);for(let i=0;i<n.length;i++){const s=n[i],o=r[i];if(o==null)continue;const a=s.rank;if(o.ndim!=null&&a!==o.ndim)throw new ne(`Input ${i} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new ne(`Input ${i} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new ne(`Input ${i} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&s.dtype!==o.dtype)throw new ne(`Input ${i} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${s.dtype}.`);if(o.axes){const u=s.shape;for(const l in o.axes){const c=Number(l),f=o.axes[l],d=c>=0?u[c]:u[u.length+c];if(f!=null&&[f,null].indexOf(d)===-1)throw new ne(`Input ${i} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${f} but got shape ${u}.`)}}if(o.shape!=null)for(let u=0;u<o.shape.length;++u){const l=o.shape[u],c=s.shape[u];if(l!=null&&c!=null&&l!==c)throw new ne(`Input ${i} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${s.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();const r=pn(t),i=c5e(t),s=f5e(t);if(i===s)throw new ne("Arguments to apply() must be all SymbolicTensors or all Tensors");return Lg(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const o=[];for(const a of pn(t))o.push(a.shape);this.build(Ms(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&s&&(this._refCount=1)}if(this.assertInputCompatibility(t),s){let o=this.call(t,n);this.supportsMasking&&this.setMaskMetadata(t,o);const a=pn(o),u=[];for(let l of a)r.indexOf(l)!==-1&&(l=l.clone()),u.push(l);if(o=Ms(u),this.activityRegularizer!=null)throw new Dt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=u5e(t),a=this.computeOutputShape(o);let u;const l=l5e(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?u=a.map((c,f)=>new Gl(l,c,this,pn(t),n,this.name,f)):u=new Gl(l,a,this,pn(t),n,this.name),this.addInboundNode(t,u,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new Dt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return u}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,i)=>{r!=null&&t[i]!=null&&t[i]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ml(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);t.indexOf(r)===-1&&t.push(r)}if(t.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new ml(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Aa(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return XT(this.weights)}build(t){this.built=!0}getWeights(t=!1){return I6(t?this.trainableWeights:this.weights)}setWeights(t){fe(()=>{const n=this.weights;if(n.length!==t.length)throw new ne(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;const r=[],i=I6(n);for(let s=0;s<i.length;++s){const o=i[s],a=n[s],u=t[s];if(!Gt(o.shape,u.shape))throw new ne(`Layer weight shape ${o.shape} not compatible with provided weight shape ${u.shape}`);r.push([a,u])}NU(r)})}addWeight(t,n,r,i,s,o,a,u){if(this._addedWeightNames.indexOf(t)!==-1)throw new ne(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(i=u!=null?u():qn("zeros"));const l=i.apply(n,r),c=new i5e(l,r,t,o,a);return l.dispose(),s!=null&&this.addLoss(()=>s.apply(c.read())),o==null&&(o=!0),o?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=pn(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(t,n,r){if(!this.supportsMasking)return;const i=this.computeMask(t,r),s=pn(n),o=pn(i);if(s.length!==o.length)throw new Error(`${this.name} outputs ${s.length} tensors but ${s.length} masks for those tensors`);for(let a=0;a<s.length;a++)s[a].kerasMask=o[a]}addInboundNode(t,n,r,i,s,o,a=null){const u=pn(t);n=pn(n),r=pn(r),i=pn(i),s=HT(s),o=HT(o);const l=[],c=[],f=[];for(const d of u)l.push(d.sourceLayer),c.push(d.nodeIndex),f.push(d.tensorIndex);new u3({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:f,inputTensors:u,outputTensors:n,inputMasks:r,outputMasks:i,inputShapes:s,outputShapes:o},a);for(let d=0;d<n.length;d++)n[d].sourceLayer=this,n[d].nodeIndex=this.inboundNodes.length-1,n[d].tensorIndex=d}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function u5e(e){e=pn(e);const t=[];for(const n of e)t.push(n.shape);return Ms(t)}function l5e(e){return"float32"}function Ufe(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{const r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const i=[];for(let s=0;s<r.inboundLayers.length;s++){const o=r.inputTensors[s],a=r.inboundLayers[s],u=r.nodeIndices[s],l=Ufe(o,a,u);for(const c of l)i.indexOf(c)===-1&&i.push(c)}return i}}}function c5e(e){let t=!0;for(const n of pn(e))if(!(n instanceof Gl)){t=!1;break}return t}function f5e(e){let t=!0;for(const n of pn(e))if(n instanceof Gl){t=!1;break}return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class DS extends Lt{constructor(t){if(super({dtype:t.dtype,name:t.name!=null?t.name:o3("input").toString()}),t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new ne("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=t.batchInputShape;if(n==null){if(t.inputShape==null)throw new ne("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new ne("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=t.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const i=new Gl(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new u3({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(t,n){throw new ne(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}DS.className="InputLayer";Ae(DS);function d5e(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new ne("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n==null&&(n="float32"),new DS({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function h5e(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return Pe(t,e.dtype)}catch{throw new ne(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}class Pd{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof Pd)for(const n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(const n of t)this.add(n.key,n.value)}}add(t,n,r){if(this.id2Value[t.id]==null)this.id2Value[t.id]=h5e(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r);else throw new ne(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Gl){if(this.id2Value[t.id]==null)throw new ne(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const n=this.name2Id[t];if(n==null)throw new ne(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof Gl){if(this.id2Value[t.id]==null)throw new ne(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const n=this.name2Id[t];if(n==null)throw new ne(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Tt(this.id2Mask)}}const YT=new Sfe,KT=new Sfe;function p5e(e){YT!=null&&YT.setMaxEntries(e),KT!=null&&KT.setMaxEntries(e)}function F2(e,t,n,r){const i=n==null?!1:n.training,s=Array.isArray(e),o=s?e:[e],a=o.map(p=>p.name),u=[],l=t.names();for(const p of a)l.indexOf(p)!==-1?u.push(t.getValue(p)):u.push(null);const c=a.join(",")+"|"+t.names().sort().join(",");let f=YT.get(c),d;if(f==null){const p=g5e(o,t);f=p.sorted,d=p.recipientCounts,YT.put(c,f),KT.put(c,d)}d={},i||Object.assign(d,KT.get(c));const h=new Pd(t);for(let p=0;p<f.length;++p){const m=f[p],x=m.sourceLayer;if(x instanceof DS)continue;const b=[],v=[],$=[];let C=!1;for(const D of m.inputs){const N=h.getValue(D),T=h.getMask(D);b.push(N),v.push(T),T!=null&&(C=!0),i||(d[D.name]--,d[D.name]===0&&!t.hasKey(D)&&a.indexOf(D.name)===-1&&!N.isDisposed&&D.sourceLayer.stateful!==!0&&$.push(N))}C&&(n=n||{},n.mask=v[0]);const S=pn(x.apply(b,n));let A=null;x.supportsMasking&&(A=x.computeMask(b,v));const E=y5e(m),_=Array.isArray(E)?E:[E];for(let D=0;D<_.length;++D){h.hasKey(_[D])||h.add(_[D],S[D],Array.isArray(A)?A[0]:A);const N=a.indexOf(_[D].name);N!==-1&&(u[N]=S[D])}i||Tt($)}return h.disposeMasks(),s?u:u[0]}function g5e(e,t){U(e!=null&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(e.length===1){const i=MZ(e[0],t);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const s of e){const{sorted:o,recipientMap:a}=MZ(s,t);for(const u of o)i.has(u.name)||(n.push(u),i.add(u.name));for(const u in a)r[u]==null&&(r[u]=new Set),a[u].forEach(l=>r[u].add(l))}}return{sorted:n,recipientCounts:m5e(r)}}function m5e(e){const t={};for(const n in e)t[n]=e[n].size;return t}function MZ(e,t){const n=new Set,r=[],i={};for(const a of t.names())n.add(a);const s=[],o=[];for(s.push(e);s.length>0;){const a=s[s.length-1];if(n.has(a.name)){s.pop();continue}const u=o[o.length-1]===s.length-1;if(a.inputs.length===0||u)s.pop(),r.push(a),n.add(a.name),u&&o.pop();else{o.push(s.length-1);for(const l of a.inputs)i[l.name]==null&&(i[l.name]=new Set),i[l.name].add(a.name),!n.has(l.name)&&s.push(l)}}return{sorted:r,recipientMap:i}}function y5e(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let r=0;r<e.sourceLayer.inboundNodes.length;++r)for(const i of e.sourceLayer.inboundNodes[r].outputTensors)if(i.id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x5e=ce();x5e.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,p5e);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DU(e,t){return fe(()=>wi(Ke(ee(e,e),t,!0)))}class FS extends qm{getConfig(){return{}}}class jfe extends FS{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return fe(()=>{const n=DU(t,this.axis),r=_o(n,0,this.maxValue);return ee(t,st(r,Ee(Dr(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}jfe.className="MaxNorm";Ae(jfe);class Wfe extends FS{constructor(t){super(),this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return fe(()=>st(t,Ee(Dr(),DU(t,this.axis))))}getConfig(){return{axis:this.axis}}}Wfe.className="UnitNorm";Ae(Wfe);class Vfe extends FS{apply(t){return uc(t)}}Vfe.className="NonNeg";Ae(Vfe);class qfe extends FS{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return fe(()=>{const n=DU(t,this.axis),r=Ee(ee(this.rate,_o(n,this.minValue,this.maxValue)),ee(1-this.rate,n));return ee(t,st(r,Ee(Dr(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}qfe.className="MinMaxNorm";Ae(qfe);const LZ={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Rr(e){return wU(e)}function PZ(e,t={}){return _S(e,Zo.getMap().classNameMap,t,"constraint")}function Or(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in LZ?LZ[e]:e,config:{}};return PZ(n)}else return e instanceof FS?e:PZ(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function qp(e){if(e==null)return;const t=[],n=[],r=[];for(const i in e){const s=e[i];if(typeof s!="number"){const o=s;t.push(o.data()),n.push(i),r.push(o)}}if(t.length>0){const i=await Promise.all(t);for(let s=0;s<i.length;++s)e[n[s]]=i[s][0];Tt(r)}}function Gfe(e){if(e!=null)for(const t in e){const n=e[t];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var BZ;(function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"})(BZ||(BZ={}));const b5e=125;class Yw{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,n){}async onEpochEnd(t,n){}async onBatchBegin(t,n){}async onBatchEnd(t,n){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class v5e{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(const n of this.callbacks)n.setParams(t)}setModel(t){for(const n of this.callbacks)n.setModel(t)}async onEpochBegin(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(t,n)}async onEpochEnd(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(t,n)}async onBatchBegin(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(t,n)}async onBatchEnd(t,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(t,n)}async onTrainBegin(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainBegin(t)}async onTrainEnd(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainEnd(t)}}class w5e extends Yw{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const i in n){const s=n[i];if(typeof s=="number")this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+s*r;else{let o;i in this.totals?o=this.totals[i]:this.totals[i]=0;const a=fe(()=>Ee(this.totals[i],ee(s,r)));this.totals[i]=a,o!=null&&o.dispose()}}}async onEpochEnd(t,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:fe(()=>{const i=ee(st(1,this.seen),this.totals[r]);n[r]=i,this.totals[r].dispose(),Tu(n[r])}))}}class $5e extends Yw{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,n){n==null&&(n={}),this.epoch.push(t);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const t=[],n=[],r=[];for(const s in this.history){const o=this.history[s];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const u=o[a];t.push(u.data()),n.push(s),r.push(a)}}const i=await Promise.all(t);for(let s=0;s<i.length;++s)this.history[n[s]][r[s]].dispose(),this.history[n[s]][r[s]]=i[s][0]}}class C5e extends Yw{constructor(t,n){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||eU,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=b5e),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");BT(this.yieldEvery)&&(this.maybeWait=MBe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,n,r){const i=[];this.yield!=null&&(await qp(r),i.push(this.yield(t,n,r))),i.push(this.nextFrameFunc()),await Promise.all(i)}async onEpochBegin(t,n){this.currentEpoch=t,this.epochBegin!=null&&(await qp(n),await this.epochBegin(t,n))}async onEpochEnd(t,n){const r=[];this.epochEnd!=null&&(await qp(n),r.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(t,n){this.batchBegin!=null&&(await qp(n),await this.batchBegin(t,n))}async onBatchEnd(t,n){const r=[];this.batchEnd!=null&&(await qp(n),r.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):BT(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),await Promise.all(r)}async onTrainBegin(t){this.trainBegin!=null&&(await qp(t),await this.trainBegin(t))}async onTrainEnd(t){this.trainEnd!=null&&(await qp(t),await this.trainEnd(t))}}function Hfe(e,t){return e==null&&(e={}),e instanceof Yw?[e]:Array.isArray(e)&&e[0]instanceof Yw?e:pn(e).map(r=>new C5e(r,t))}class Sa{constructor(){}static registerCallbackConstructor(t,n){U(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),Sa.checkForDuplicate(n),Sa.constructors[t]==null&&(Sa.constructors[t]=[]),Sa.constructors[t].push(n)}static checkForDuplicate(t){for(const n in Sa.constructors)Sa.constructors[+n].forEach(i=>{if(i===t)throw new ne("Duplicate callback constructor.")})}static clear(){Sa.constructors={}}static createCallbacks(t){const n=[];for(const r in Sa.constructors){const i=+r;t>=i&&n.push(...Sa.constructors[i])}return n.map(r=>new r)}}Sa.constructors={};function Xfe(e,t,n,r,i,s,o,a,u){const l=new $5e,c=[new w5e,...Sa.createCallbacks(t)];e!=null&&c.push(...e),c.push(l);const f=new v5e(c);return f.setParams({epochs:n,initialEpoch:r,samples:i,steps:s,batchSize:o,verbose:t,doValidation:a,metrics:u}),{callbackList:f,history:l}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rl(e,t={},n=!1){return _S(e,Zo.getMap().classNameMap,t,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QT(e,t){return fe(()=>{e.dtype!=="float32"&&(e=Pe(e,"float32"));const n=Ke(IS(e),t,!0),r=nb(n.shape,Dr()),i=wi(Uf(n,r));return st(e,i)})}function l3(e,t){return fe(()=>ar(IS(Xe(t,e)),-1))}function FU(e,t){return fe(()=>ar(Tr(Xe(t,e)),-1))}function RU(e,t){return fe(()=>{const n=Xe(e,t),r=_o(Tr(e),Dr(),Number.MAX_VALUE),i=Tr(st(n,r));return ee(100,ar(i,-1))})}function S5e(e,t){return fe(()=>{const n=_o(t,Dr(),Number.MAX_VALUE),r=ia(Ee(1,n)),i=_o(e,Dr(),Number.MAX_VALUE),s=ia(Ee(1,i));return ar(IS(Xe(r,s)),-1)})}function k5e(e,t){return fe(()=>{const n=Uf(0,Xe(1,ee(e,t)));return ar(IS(n),-1)})}function E5e(e,t){return fe(()=>{const n=Uf(0,Xe(1,ee(e,t)));return ar(n,-1)})}function A5e(e,t){return fe(()=>{const n=Ke(ee(e,t),-1),r=Ma(ee(Xe(1,e),t),-1);return Uf(0,Ee(1,Xe(r,n)))})}function _5e(e,t){return fe(()=>{const n=Math.log(2),r=Xe(t,e),i=Xe(Ee(r,rb(ee(-2,r))),n);return ar(i,-1)})}function Kw(e,t,n=!1){return fe(()=>{if(n)t=jF(t);else{const r=Ke(t,t.shape.length-1,!0);t=st(t,r)}return t=_o(t,Dr(),1-Dr()),Ln(Ke(ee(Pe(e,"float32"),ia(t)),t.shape.length-1))})}function ZT(e,t,n=!1){return fe(()=>{const r=Pe(CS(XBe(e)),"int32");t=_o(t,Dr(),1-Dr());const i=t.shape,s=ie(qw(r,i[i.length-1]),i);return Kw(s,t,n)})}function T5e(e,t){if(!Gt(e.shape,t.shape))throw new ne(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return fe(()=>{const n=uc(t),r=Ln(Tr(t));return Ee(Xe(n,ee(t,e)),DF(To(r)))})}function c3(e,t){return fe(()=>{let n;return n=_o(t,Dr(),1-Dr()),n=ia(st(n,Xe(1,n))),ar(T5e(e,n),-1)})}function I5e(e,t){return fe(()=>{const n=_o(e,Dr(),1),r=_o(t,Dr(),1);return Ke(ee(e,ia(st(n,r))),-1)})}function N5e(e,t){return fe(()=>{const n=ia(Ee(Dr(),t));return ar(Xe(t,ee(e,n)),-1)})}function Yfe(e,t){return fe(()=>{const n=QT(e,-1),r=QT(t,-1),i=ee(n,r);return Ln(Ke(i,-1))})}const JT={meanSquaredError:l3,meanAbsoluteError:FU,meanAbsolutePercentageError:RU,meanSquaredLogarithmicError:S5e,squaredHinge:k5e,hinge:E5e,categoricalHinge:A5e,logcosh:_5e,categoricalCrossentropy:Kw,sparseCategoricalCrossentropy:ZT,binaryCrossentropy:c3,kullbackLeiblerDivergence:I5e,poisson:N5e,cosineProximity:Yfe};function BL(e){if(typeof e=="string"){if(e in JT)return JT[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new ne(t)}else return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Kfe(e,t){return fe(()=>{const n=ee(.5,sa(t)),r=Dl(Uo(t,n),e.dtype);return ar(Mu(e,r),-1)})}function Qfe(e,t){return fe(()=>Dl(Mu(iy(e,-1),iy(t,-1)),"float32"))}function D5e(e,t){return fe(()=>Pe(Ke(ql(Mu(e,1),Mu(t,1))),"float32"))}function F5e(e,t){return fe(()=>Pe(Ke(ql(Mu(e,0),Mu(t,1))),"float32"))}function R5e(e,t){return fe(()=>{const n=D5e(e,t),r=F5e(e,t),i=Ee(n,r);return Pe(Wi(Uo(i,0),st(n,i),0),"float32")})}function O5e(e,t){return c3(e,t)}function M5e(e,t){return e.rank===t.rank&&(e=Vm(e,[e.rank-1])),t=iy(t,-1),t.dtype!==e.dtype&&(t=Pe(t,e.dtype)),Pe(Mu(e,t),"float32")}const L5e=l3,P5e=l3,B5e=FU,z5e=FU,U5e=RU,j5e=RU,Zfe=Kw,W5e=Yfe,Jfe=ZT,eI={binaryAccuracy:Kfe,categoricalAccuracy:Qfe,precision:R5e,categoricalCrossentropy:Zfe,sparseCategoricalCrossentropy:Jfe,mse:L5e,MSE:P5e,mae:B5e,MAE:z5e,mape:U5e,MAPE:j5e,cosine:W5e};function V5e(e){if(typeof e=="string"&&e in eI)return eI[e];if(typeof e!="string"&&e!=null)return e;throw new ne(`Unknown metric ${e}`)}function mA(e){if(yl(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e=="string")return e;{let t;for(const n of Object.keys(JT))if(JT[n]===e){t=n;break}if(t!==void 0)return t;for(const n of Object.keys(eI))if(eI[n]===e){t=n;break}return t!==void 0?t:e.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function q5e(e){const t={Adagrad:()=>Hc.adagrad(.01),Adadelta:()=>Hc.adadelta(1,.95,Dr()),Adam:()=>Hc.adam(.001,.9,.999,Dr()),Adamax:()=>Hc.adamax(.002,.9,.999,Dr(),0),RMSProp:()=>Hc.rmsprop(.001,.9,0,Dr()),SGD:()=>Hc.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new ne(`Unknown Optimizer ${e}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zZ=1*1024*1024;function UZ(e,t,n=!1){if(e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!N6(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(e);r.length>zZ&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${zZ}.`)}}function N6(e){if(e===null)return!0;if(typeof e=="object")if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t)if(typeof n!="string"||!N6(e[n]))return!1;return!0}else if(Array.isArray(e)){for(const t of e)if(!N6(t))return!1;return!0}else return!1;else{const t=typeof e;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function G5e(e,t,n,r=console.log){const i=X5e(e),s=["Layer (type)","Input Shape","Output shape","Param #"];i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(t*c)));let o;if(!i){s.push("Receives inputs"),o=[];for(const c in e.nodesByDepth)o.push(...e.nodesByDepth[c])}r("_".repeat(t)),tI(s,n,r),r("=".repeat(t));const a=e.layers;for(let c=0;c<a.length;++c)i?Y5e(a[c],n,r):K5e(a[c],n,o,r),r((c===a.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const u=H5e(e),l=XT(e.nonTrainableWeights);r(`Total params: ${u+l}`),r(`Trainable params: ${u}`),r(`Non-trainable params: ${l}`),r("_".repeat(t))}function H5e(e){let t;return e.collectedTrainableWeights!=null?t=XT(e.collectedTrainableWeights):t=XT(e.trainableWeights),t}function X5e(e){let t=!0;const n=[],r=[];for(const i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(const i of n){if(i.length>1||i.length===1&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(const i of e.layers){let s=!1;for(const o of i.inboundNodes)if(r.indexOf(o)!==-1)if(s){t=!1;break}else s=!0;if(!t)break}return t}function tI(e,t,n=console.log){let r="";for(let i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=e[i],r=r.slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function Y5e(e,t,n){let r,i;try{i=e.inboundNodes.map(u=>JSON.stringify(u.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(e.outputShape)}catch{r="multiple"}const s=e.name,o=e.getClassName(),a=[`${s} (${o})`,i,r,e.countParams().toString()];tI(a,t,n)}function K5e(e,t,n,r){let i,s;try{s=e.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{s="multiple"}try{i=JSON.stringify(e.outputShape)}catch{i="multiple"}const o=[];for(const f of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(f)===-1))for(let d=0;d<f.inboundLayers.length;++d){const h=f.inboundLayers[d].name,p=f.nodeIndices[d],m=f.tensorIndices[d];o.push(`${h}[${p}][${m}]`)}const a=e.name,u=e.getClassName(),l=o.length===0?"":o[0],c=[`${a} (${u})`,s,i,e.countParams().toString(),l];tI(c,t,r);for(let f=1;f<o.length;++f)tI(["","","","",o[f]],t,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ede(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function nI(e,t){if(e===null)return null;if(typeof e=="string")return mg(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const s=e[i];ede(t,i,s)?n.push(s):n.push(nI(s,t))}return n}else{const n={};for(const r of Object.keys(e)){const i=e[r];if(r==="name"&&typeof i=="string")n[r]=i;else{const s=mg(r);n[s]=nI(i,s)}}return n}}function D6(e,t){if(e==null)return null;if(typeof e=="string")return Xc(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){const n=[],r=e.length;for(let i=0;i<r;++i){const s=e[i];ede(t,i,s)?n.push(s):n.push(D6(s,t))}return n}else{const n={};for(const r of Object.keys(e)){const i=e[r],s=Xc(r);(r==="name"||r==="className")&&typeof i=="string"?n[s]=i:n[s]=D6(i,r)}return n}}/** @license See the LICENSE file. */const tde="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Q5e=e=>{const t=Object.keys(e);if(t.length===0)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class pu extends Lt{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){const v=this.getClassName().toLowerCase();this.name=o3(v)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],th(this.inputs).length!==this.inputs.length)throw new ne(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(v=>v.name)}`);th(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(v=>v.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const $=v.sourceLayer,C=v.nodeIndex,S=v.tensorIndex;this.outputLayers.push($),this.outputLayersNodeIndices.push(C),this.outputLayersTensorIndices.push(S)}for(const v of this.inputs){const $=v.sourceLayer,C=v.nodeIndex,S=v.tensorIndex;yl(C===0,"input layer has >1 nodes"),yl(S===0,"input layer has >1 tensors"),this.inputLayers.push($),this.inputLayersNodeIndices.push(C),this.inputLayersTensorIndices.push(S)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const $=this.inputLayers[v];if(!($ instanceof DS))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${v} (0-based) originates from layer type ${$.getClassName()}.`);this.inputNames.push($.name),this.feedInputShapes.push($.batchInputShape),this.feedInputNames.push($.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map(v=>v.shape),this.internalOutputShapes=this.outputs.map(v=>v.shape);const n={},r={},i={},s={},o={},a=[],u=(v,$,C,S,A,E)=>{(S==null||A==null||E==null)&&(S=v.sourceLayer,A=v.nodeIndex,E=v.tensorIndex);const _=S.inboundNodes[A];if(C.indexOf(_)!==-1)throw new Aa(`The tensor ${v.name} at layer "${S.name}" is part of a cycle.`);if($.indexOf(_)!==-1)return;this.containerNodes.add(pu.nodeKey(S,A)),S.id in o||(o[S.id]=Object.keys(o).length),C.indexOf(_)===-1&&C.push(_);const D=_.inboundLayers.length;for(let N=0;N<D;N++){const T=_.inputTensors[N],L=_.inboundLayers[N],O=_.nodeIndices[N],M=_.tensorIndices[N];u(T,$,C,L,O,M)}for($.push(_);C.indexOf(_)>=0;)C.splice(C.indexOf(_),1);a.push(_)},l=[],c=[];for(const v of this.outputs)u(v,l,c);const f=a.slice().reverse();for(const v of f){r[v.id]=v,v.id in n||(n[v.id]=0);let $=n[v.id];const C=i[v.outboundLayer.id]==null?0:i[v.outboundLayer.id];$=Math.max($,C),i[v.outboundLayer.id]=$,s[v.outboundLayer.id]=v.outboundLayer,n[v.id]=$;for(let S=0;S<v.inboundLayers.length;S++){const A=v.inboundLayers[S],E=v.nodeIndices[S],_=A.inboundNodes[E],D=n[_.id]==null?0:n[_.id];n[_.id]=Math.max($+1,D),r[_.id]=_}}const d={};for(const v in n){const $=n[v];$ in d||(d[$]=[]),d[$].push(r[v])}const h={};for(const v in i){const $=i[v];$ in h||(h[$]=[]),h[$].push(s[v])}let p=Object.keys(h).map(v=>parseInt(v,10)).sort(hA);this.layers=[];for(const v of p){const $=h[v];$.sort((C,S)=>{const A=o[C.id],E=o[S.id];return A<E?-1:A>E?1:0});for(const C of $)C instanceof pu&&this.internalContainerRefs.push(C),this.layers.push(C)}this.layersByDepth=h,p=Object.keys(d).map(v=>parseInt(v,10)).sort(hA);const m=this.inputs.slice(),x=[];for(const v of p)for(const $ of d[v]){const C=$.outboundLayer;if(C!=null){for(const S of $.inputTensors)if(m.indexOf(S)===-1)throw new Aa(`Graph disconnected: cannot obtain value for tensor ${S} at layer "${C.name}". The following previous layers were accessed without issue: ${x}`);for(const S of $.outputTensors)m.push(S);x.push(C.name)}}this.nodesByDepth=d;const b=this.layers.map(v=>v.name);for(const v of b){const $=b.filter(C=>C===v).length;if($!==1)throw new Aa(`The name "${v}" is used ${$} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(b))}this.outboundNodes=[],this.inboundNodes=[],new u3({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(v=>null),outputMasks:this.outputs.map(v=>null),inputShapes:this.inputs.map(v=>v.shape),outputShapes:this.outputs.map(v=>v.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new ne("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){const r={};let i=0;const s=Q5e(t);s&&this.parseWeights(t);for(const a of this.layers)for(const[u,l]of a.weights.entries()){const c=s?`${l.name.split("/").slice(0,-1).join("/")+"/"}${u}`:l.originalName;if(r[c]!=null)throw new ne(`Duplicate weight name: ${c}`);r[c]=l,i++}const o=[];for(const a in t){let u=a;if(r[a]==null){const l=a.split("/");u=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(r[u]!=null)o.push([r[u],t[a]]);else if(n)throw new ne(`Provided weight data has no target variable: ${a}`);delete r[u]}if(n){const a=[];for(const u in r)a.push(u);if(a.length>0)throw new ne(`${a.length} of ${i} weights are not set: ${a}`)}NU(o)}parseWeights(t){for(const n in Object.keys(t)){const r=n.split("/"),i=["vars","layer_checkpoint_dependencies"],s=r.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!i.includes(o)).join("/");s!==n&&(t[s]=t[n],delete t[n])}}updatedConfig(){const t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${tde}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){const r=D6(this.updatedConfig());return n?JSON.stringify(r):r}call(t,n){return fe(()=>{t=pn(t);const r=new Pd;for(let i=0;i<this.inputs.length;++i)r.add(this.inputs[i],t[i]);return F2(this.outputs,r,n)})}computeMask(t,n){return fe(()=>{t=pn(t);let r;return n==null?r=um(null,t.length):r=pn(n),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){const n=HT(t);if(n.length!==this.inputLayers.length)throw new ne(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const u=this.inputLayers[a],l=n[a],c=u.name+"_0_0";r[c]=l}const i=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(hA);if(i.length>1)for(const a of i){const u=this.nodesByDepth[a];for(const l of u){const c=l.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(c.id)!==-1)continue;const f=[];for(let m=0;m<l.inboundLayers.length;m++){const x=l.inboundLayers[m],b=l.nodeIndices[m],v=l.tensorIndices[m],$=`${x.name}_${b}_${v}`,C=r[$];f.push(C)}const d=c.computeOutputShape(Ms(f)),h=HT(d),p=c.inboundNodes.indexOf(l);for(let m=0;m<h.length;m++){const x=`${c.name}_${p}_${m}`;r[x]=h[m]}}}const s=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const u=this.outputLayers[a],l=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],f=`${u.name}_${l}_${c}`;o.push(f)}for(let a=0;a<o.length;a++){const u=o[a];yl(u in r),s.push(r[u])}return Ms(s)}runInternalGraph(t,n){n==null&&(n=um(null,t.length));const r={};for(let u=0;u<this.inputs.length;++u){const l=this.inputs[u],c=t[u],f=n[u];r[l.id]=[c,f]}const i=Object.keys(this.nodesByDepth).map(u=>parseInt(u,10)).sort(hA);for(const u of i){const l=this.nodesByDepth[u];for(const c of l){const f=c.outboundLayer,d=c.inputTensors,h=c.outputTensors,p=new Array;for(const m of d)m.id in r&&p.push(r[m.id]);if(p.length===d.length){let m={},x,b,v,$;if(c.callArgs!=null&&(m=c.callArgs),p.length===1){const[C,S]=p[0];m.mask==null&&(m.mask=S),v=pn(f.call(C,m)),$=pn(f.computeMask(C,S)),x=[C],b=[S]}else x=p.map(C=>C[0]),b=p.map(C=>C[1]),m.mask==null&&(m.mask=b),v=pn(f.call(x,m)),$=pn(f.computeMask(x,b));if(f.activityRegularizer)throw new Dt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let C=0;C<h.length;++C){const S=h[C],A=v[C],E=$[C];r[S.id]=[A,E]}}}}const s=[],o=[],a=[];for(const u of this.outputs){yl(u.id in r,`Could not compute output ${u.name} : ${u.id}`);const[l,c]=r[u.id];a.push(l.shape),s.push(l),o.push(c)}return[s,o,a]}buildNodeConversionMap(t){const n={};let r;for(const i of this.layers){r=i instanceof pu?1:0;for(let s=0;s<i.inboundNodes.length;s++){const o=pu.nodeKey(i,s);this.containerNodes.has(o)&&(n[o]=r,r+=1)}}return n}getLayer(t,n){if(n!=null)return this.findLayer(n);if(t==null)throw new ne("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(const r of this.layers)if(r.name===t)return r;throw new ne(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new ne(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return fe(()=>{const t=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const i=pu.nodeKey(n,r);this.containerNodes.has(i)&&t.push(...n.calculateLosses())}return t})}getConfig(){const t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const a=o.getClassName(),u=o.getConfig(),l=[];for(let f=0;f<o.inboundNodes.length;f++){const d=o.inboundNodes[f],h=pu.nodeKey(o,f);let p={};if(this.containerNodes.has(h)){if(d.callArgs)try{JSON.stringify(d.callArgs),p=d.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(d.inboundLayers.length>0){const m=[];for(let x=0;x<d.inboundLayers.length;x++){const b=d.inboundLayers[x],v=d.nodeIndices[x],$=d.tensorIndices[x],C=pu.nodeKey(b,v);let S=n[C];S==null&&(S=0),m.push([b.name,S,$,p])}l.push(m)}}}const c={};c.name=o.name,c.className=a,c.config=u,c.inboundNodes=l,r.push(c)}t.layers=r;const i=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],u=this.inputLayersNodeIndices[o],l=pu.nodeKey(a,u);if(!this.containerNodes.has(l))continue;let c=n[l];c==null&&(c=0);const f=this.inputLayersTensorIndices[o];i.push([a.name,c,f])}t.inputLayers=i;const s=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],u=this.outputLayersNodeIndices[o],l=pu.nodeKey(a,u);if(!this.containerNodes.has(l))continue;let c=n[l];c==null&&(c=0);const f=this.outputLayersTensorIndices[o];s.push([a.name,c,f])}return t.outputLayers=s,t}static fromConfig(t,n,r={},i=!1){const s={},o={};function a(x,b){x.name in o?o[x.name].push(b):o[x.name]=[b]}function u(x,b){const v=[];let $;for(const C of b){const S=C[0],A=C[1],E=C[2];if($=C[3]==null?{}:C[3],!(S in s)){a(x,b);return}const _=s[S];if(_.inboundNodes.length<=A){a(x,b);return}const D=_.inboundNodes[A];v.push(D.outputTensors[E])}v.length>0&&x.apply(Ms(v),$)}function l(x){const b=x.name,v=Rl(x,n.customObjects!=null?n.customObjects:{});v.setFastWeightInitDuringBuild(i),s[b]=v,x.inboundNodes.forEach(C=>{if(!(C instanceof Array))throw new ne(`Corrupted configuration, expected array for nodeData: ${C}`);a(v,C)})}const c=n.name,f=n.layers;for(const x of f)l(x);for(;!OBe(o);)for(const x of f){const b=s[x.name];if(b.name in o){const v=o[b.name];delete o[b.name];for(const $ of v)u(b,$)}}const d=[],h=[],p=n.inputLayers;for(const x of p){const b=x[0],v=x[1],$=x[2];yl(b in s);const S=s[b].inboundNodes[v].outputTensors;d.push(S[$])}const m=n.outputLayers;for(const x of m){const b=x[0],v=x[1],$=x[2];yl(b in s);const S=s[b].inboundNodes[v].outputTensors;h.push(S[$])}return new t({inputs:d,outputs:h,name:c})}get stateful(){if(this._stateful)throw new ne("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){fe(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Z5e(e,t,n){const r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(i=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){const i=[];return t.forEach(s=>{s in e?i.push(e[s]):i.push(null)}),i}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function nde(e,t){return Z5e(e,t,"classWeight")}async function rde(e,t,n,r){if(n!=null){const i=fe(()=>{if(e.shape.length===1)return eh(e);if(e.shape.length===2){if(e.shape[1]>1)return iy(e,1);if(e.shape[1]===1)return ie(e,[e.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(await i.data());Tt(i);const o=[];return s.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),Li(o,"float32")}else return null}function J5e(e,t){return ee(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const e6e=32;function ide(e,t){let n,r;const i=t;n=i.xs,r=i.ys,U(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const s=jZ("input",e.inputNames,n),o=jZ("output",e.outputNames,r),a=s[0].shape[0];U(s.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),U(o.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let u=0;u<s.length;u++)U(s[u].shape[0]===a,()=>`Batch size mismatch: input ${e.inputNames[u]} has ${s[u].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`);for(let u=0;u<o.length;u++)U(o[u].shape[0]===a,()=>`Batch size mismatch: output ${e.outputNames[u]} has ${o[u].shape[0]}; expected  ${a} based on input ${e.inputNames[0]}.`);return{xs:s,ys:o}}function jZ(e,t,n){if(n instanceof nn)return[n];if(Array.isArray(n))return U(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{const r=[];for(const i of t){if(n[i]==null)throw new ne(`The feature data generated by the dataset lacks the required ${e} key '${i}'.`);r.push(n[i])}return r}}function t6e(e){if(e.length===3)throw new Dt("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}async function n6e(e,t,n){const r=n.batchesPerEpoch!=null;if(U(e.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),U(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),U(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),U(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),U(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const i=n.validationData!=null;let s,o;if(i)if(WZ(n.validationData))U(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const x=t6e(n.validationData);s=x.xs,o=x.ys}const a=e.makeTrainFunction(),u=e.getDedupedMetricsNames();let l;i?l=u.slice().concat(u.map(x=>"val_"+x)):l=u.slice();const c=Hfe(n.callbacks,n.yieldEvery),f=n.verbose==null?1:n.verbose,{callbackList:d,history:h}=Xfe(c,f,n.epochs,null,null,r6e(t,n),null,i,l);d.setModel(e),e.history=h,await d.onTrainBegin(),e.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await t.iterator();for(;p<n.epochs;){const x={};await d.onEpochBegin(p);let b=0,v=0;for(r||(m=await t.iterator());!r||b<n.batchesPerEpoch;){const $=await m.next();if(r&&$.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${b} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if($.value!=null){const{xs:C,ys:S}=ide(e,$.value),A={};A.batch=v,A.size=C[0].shape[0],await d.onBatchBegin(v,A);const E=[];if(n.classWeight!=null){const N=nde(n.classWeight,e.outputNames);for(let T=0;T<N.length;++T)E.push(await rde(S[T],null,N[T]))}const _=C.concat(S).concat(E),D=a(_);Tt(_);for(let N=0;N<u.length;++N){const T=u[N],L=D[N];A[T]=L,Tu(L)}await d.onBatchEnd(v,A),Gfe(A),v++,b++}if(r?b>=n.batchesPerEpoch:$.done){if(i){let C;WZ(n.validationData)?C=pn(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):C=pn(e.evaluate(s,o,{batchSize:n.validationBatchSize==null?e6e:n.validationBatchSize,verbose:0}));for(let S=0;S<e.metricsNames.length;++S)x[`val_${e.metricsNames[S]}`]=C[S]}break}if(e.stopTraining_)break}if(await d.onEpochEnd(p,x),p++,e.stopTraining_)break}return await d.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function r6e(e,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function WZ(e){return typeof e.iterator=="function"}function i6e(e){return typeof e.next=="function"}async function s6e(e,t,n){n=n||{};const r=n.batches!=null,i=e.testFunction;let s=[];if(n.verbose>0)throw new Dt("Verbose mode is not implemented yet.");U(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=i6e(t)?t:await t.iterator();let a=0,u=0;for(;!r||u<n.batches;){const l=await o.next();if(s=fe(()=>{if(l.value){const{xs:c,ys:f}=ide(e,l.value),d=c.concat(f),h=fe(()=>i(d));if(Tt(d),u===0)for(let m=0;m<h.length;++m)s.push($t(0));const p=d[0].shape[0];for(let m=0;m<h.length;++m){const x=h[m],b=s[m];s[m]=fe(()=>Ee(s[m],ee(p,x))),u>0&&Tt(b)}Tt(h),a+=p,++u}return s}),l.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let l=0;l<s.length;++l){const c=s[l];s[l]=st(s[l],a),Tt(c)}return Ms(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zL(e){U(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function Gv(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(r=>Pg(r,t,n-t)):Pg(e,t,n-t)}function F6(e,t){return fe(()=>e==null?null:Array.isArray(e)?e.map(n=>F6(n,t)):Dfe(e,t.dtype==="int32"?t:Pe(t,"int32")))}function UL(e,t){const n=[];let r=0,i=null;for(;r<e;)i=r+t,i>=e&&(i=e),n.push([r,i]),r=i;return n}function sde(e){const t=[];e instanceof nn&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(r.rank===1)t.push(TS(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function lu(e,t){if(e==null)return;const n=[];if(t instanceof nn)n.push(t.id);else if(Array.isArray(t))t.forEach(i=>n.push(i.id));else if(t!=null)for(const i in t){const s=t[i];n.push(s.id)}const r=[];if(e instanceof nn)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(i=>{n.indexOf(i.id)===-1&&r.push(i)});else if(e!=null)for(const i in e){const s=e[i];n.indexOf(s.id)===-1&&r.push(s)}r.forEach(i=>{i.isDisposed||i.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function o6e(e){return e instanceof nn}function R6(e){return Array.isArray(e)}function VZ(e){return!o6e(e)&&!R6(e)}function qZ(e,t,n,r=!0,i=""){if(t==null||t.length===0){if(e!=null){let o=!1;if(R6(e)&&e.length>0)o=!0;else if(VZ(e)){for(const a in e)if(e.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new ne(`Error when checking model ${i} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(o=>null);let s;if(VZ(e)){e=e,s=[];for(const o of t){if(e[o]==null)throw new ne(`No data provided for "${o}". Need data for each key in: ${t}`);s.push(e[o])}}else if(R6(e)){if(e=e,e.length!==t.length)throw new ne(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);s=e}else{if(e=e,t.length>1)throw new ne(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);s=[e]}if(s=sde(s),n!=null)for(let o=0;o<t.length;++o){if(n[o]==null)continue;const a=s[o];if(a.shape.length!==n[o].length)throw new ne(`Error when checking ${i}: expected ${t[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let u=0;u<n[o].length;++u){if(u===0&&!r)continue;const l=a.shape[u],c=n[o][u];if(c!=null&&c>=0&&l!==c)throw new ne(`${i} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${i} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return s}function a6e(e,t,n){const r=th(e.map(s=>s.shape[0]));r.sort();const i=th(t.map(s=>s.shape[0]));if(i.sort(),r.length>1)throw new ne(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(s=>s.shape))}`);if(i.length>1)throw new ne(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(r.length>0&&i.length>0&&!Gt(r,i))throw new ne(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}function u6e(e,t,n){const r=[l3,c3,Kw];for(let i=0;i<e.length;++i){const s=e[i],o=t[i],a=n[i];if(o!=null){if(o===Kw&&s.shape[s.shape.length-1]===1)throw new ne(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(o)!==-1){const u=s.shape.slice(1),l=a.slice(1);for(let c=0;c<u.length;++c){const f=u[c],d=l[c];if(d!=null&&f!==d)throw new ne(`A target Tensor with shape ${s.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function GZ(e,t,n,r=!0,i=""){let s;if(Array.isArray(e)){if(e.length!==t.length)throw new ne(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);s=e}else{if(t.length>1)throw new ne(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);s=[e]}if(n!=null)for(let o=0;o<t.length;++o){if(n[o]==null)continue;const a=s[o];if(a.shape.length!==n[o].length)throw new ne(`Error when checking ${i}: expected ${t[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let u=0;u<n[o].length;++u){if(u===0&&!r)continue;const l=a.shape[u],c=n[o][u];if(c!=null&&c!==l)throw new ne(`Error when checking ${i}: expected ${t[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function l6e(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(r=>[]);let n;if(typeof e=="string"||typeof e=="function")n=[e];else if(Array.isArray(e)||typeof e=="object")n=e;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(r=>n);{const r=[];for(const i of t){let s=n.hasOwnProperty(i)?n[i]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}const c6e="layers-model";class V1 extends pu{constructor(t){super(t),this.isTraining=!1}summary(t,n,r=console.log){if(!this.built)throw new ne("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");G5e(this,t,n,r)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=q5e(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof Wf))throw new ne("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const o in t.loss)if(this.outputNames.indexOf(o)===-1)throw new ne(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)t.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(BL(t.loss[o]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new ne(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);n=t.loss.map(a=>BL(a))}else{const o=BL(t.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],u=this.outputNames[o];this.feedOutputNames.push(u),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const r=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Lg("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const i=l6e(t.metrics,this.outputNames),s=(o,a,u)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([u,o])};Lg("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=i[o];(l=>{const c="";let f,d,h;for(const p of l){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const x=this.internalOutputShapes[o];x[x.length-1]===1||this.lossFunctions[o]===c3?["accuracy","acc"].indexOf(p)!==-1?d=Kfe:["crossentropy","ce"].indexOf(p)!==-1&&(d=O5e):this.lossFunctions[o]===ZT?["accuracy","acc"].indexOf(p)!==-1?d=M5e:["crossentropy","ce"].indexOf(p)!==-1&&(d=Jfe):["accuracy","acc"].indexOf(p)!==-1?d=Qfe:["crossentropy","ce"].indexOf(p)!==-1&&(d=Zfe);let b;["accuracy","acc"].indexOf(p)!==-1?b="acc":["crossentropy","ce"].indexOf(p)!==-1&&(b="ce"),h=d,f=c+b}else h=V5e(p),f=c+mA(p);let m;Lg(f,()=>{m=h}),s(o,f,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,n,r={}){const i=r.batchSize==null?32:r.batchSize;zL(i);const o=this.standardizeUserDataXY(t,n,!0,i);try{const a=o[0].concat(o[1]);this.makeTestFunction();const u=this.testFunction,l=this.testLoop(u,a,i,r.verbose,r.steps);return Ms(l)}finally{lu(o[0],t),lu(o[1],n)}}async evaluateDataset(t,n){return this.makeTestFunction(),s6e(this,t,n)}checkNumSamples(t,n,r,i="steps"){let s;if(r!=null){if(s=null,n!=null)throw new ne(`If ${i} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(t!=null)Array.isArray(t)?s=t[0].shape[0]:s=t.shape[0];else throw new ne(`Either the input data should have a defined shape, or ${i} shoud be specified.`);return s}execute(t,n){if(Array.isArray(n)&&n.length===0)throw new ne("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),i=r?n:[n],s=this.retrieveSymbolicTensors(i),o=new Pd;if(t instanceof nn&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new ne(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let u=0;u<this.inputs.length;++u)o.add(this.inputs[u],t[u])}else for(const u of this.inputs){const l=t[u.name];if(l==null)throw new ne(`No value is provided for the model's input ${u.name}`);o.add(u,l)}const a=F2(s,o);return r?a:a[0]}retrieveSymbolicTensors(t){const n=um(null,t.length);let r=t.length;for(const i of this.layers){const s=Array.isArray(i.output)?i.output:[i.output],o=s.map(a=>a.name);for(let a=0;a<t.length;++a){const u=o.indexOf(t[a]);if(u!==-1&&(n[a]=s[u],r--),r===0)break}if(r===0)break}if(r>0){const i=[];throw n.forEach((s,o)=>{s==null&&i.push(t[o])}),new ne(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(i)}`)}return n}predictLoop(t,n=32,r=!1){return fe(()=>{const i=this.checkNumSamples(t);if(r)throw new Dt("Verbose predictLoop() is not implemented yet.");const s=UL(i,n),o=this.outputs.map(a=>[]);for(let a=0;a<s.length;++a)fe(()=>{const l=s[a][0],c=s[a][1],f=Gv(t,l,c),d=[];if(Array.isArray(f))for(let p=0;p<f.length;++p)d.push({key:this.inputs[p],value:f[p]});else d.push({key:this.inputs[0],value:f});const h=new Pd(d);return F2(this.outputs,h)}).forEach((l,c)=>o[c].push(l));return Ms(o.map(a=>Yr(a,0)))})}predict(t,n={}){const r=sde(t);GZ(r,this.inputNames,this.feedInputShapes,!1);try{const i=n.batchSize==null?32:n.batchSize;return zL(i),this.predictLoop(r,i)}finally{lu(r,t)}}predictOnBatch(t){GZ(t,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)}standardizeUserDataXY(t,n,r=!0,i){if(this.optimizer_==null)throw new Aa("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const s=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===ZT?s.push(a.slice(0,a.length-1).concat([1])):s.push(a)}if(t=qZ(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=qZ(n,this.feedOutputNames,s,!1,"target"),a6e(t,n),u6e(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&i!=null&&i>0&&t[0].shape[0]%i!==0)throw new ne(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${i}. Found: ${t[0].shape[0]} sample(s).`);return[t,n]}async standardizeUserData(t,n,r,i,s=!0,o){const[a,u]=this.standardizeUserDataXY(t,n,s,o);if(r!=null)throw new Error("sample weight is not supported yet.");let l=null;if(i!=null){const c=nde(i,this.outputNames);l=[];for(let f=0;f<c.length;++f)l.push(await rde(u[f],null,c[f]))}return[a,u,l]}testLoop(t,n,r,i=0,s){return fe(()=>{const o=this.checkNumSamples(n,r,s,"steps"),a=[];if(i>0)throw new Dt("Verbose mode is not implemented yet.");if(s!=null)throw new Dt("steps mode in testLoop() is not implemented yet");{const u=UL(o,r),l=Li(Pu(0,o));for(let c=0;c<u.length;++c){const f=u[c][0],d=u[c][1],h=Pg(l,f,d-f),p=F6(n,h),m=t(p);if(c===0)for(let x=0;x<m.length;++x)a.push($t(0));for(let x=0;x<m.length;++x){const b=m[x];a[x]=Ee(a[x],ee(d-f,b))}}for(let c=0;c<a.length;++c)a[c]=st(a[c],o)}return a})}getDedupedMetricsNames(){const t=this.metricsNames,n=[];for(let r=0;r<t.length;++r){const i=t[r];let s=i;if(IZ(t,i)>1){const o=IZ(t.slice(0,r),i);s+=`_${o}`}n.push(s)}return n}makeTrainFunction(){return t=>{const n=[],r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const f=[];for(let m=0;m<this.inputs.length;++m)f.push({key:this.inputs[m],value:r[m]});const d=new Pd(f),h=F2(this.outputs,d,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const x=this.lossFunctions[m];let b=x(i[m],h[m]);s[m]!=null&&(b=J5e(b,s[m]));const v=ar(b);n.push(v),m===0?p=b:p=Ee(p,b)}for(let m=0;m<this.metricsTensors.length;++m){let x;if(this.outputs.length>1&&m<this.outputs.length)x=n[m];else{const b=this.metricsTensors[m][0],v=this.metricsTensors[m][1];x=ar(b(i[v],h[v]))}Tu(x),o.push(x)}return p=ar(p),this.calculateLosses().forEach(m=>{p=Ee(p,m)}),p},u=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(a,!0,u)].concat(o)}}makeTestFunction(){this.testFunction=t=>fe(()=>{const n=[];let r;const i=t.slice(0,this.inputs.length),s=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let l=0;l<this.inputs.length;++l)o.push({key:this.inputs[l],value:i[l]});const a=new Pd(o),u=F2(this.outputs,a);for(let l=0;l<this.lossFunctions.length;++l){const c=this.lossFunctions[l],f=ar(c(s[l],u[l]));l===0?r=f:r=Ee(r,f),n.push(r)}for(let l=0;l<this.metricsTensors.length;++l){const c=this.metricsTensors[l][0],f=this.metricsTensors[l][1],d=ar(c(s[f],u[f]));n.push(d)}return n})}async fit(t,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let i,s,o,a,u,l,c,f,d;try{const h=r.batchSize==null?32:r.batchSize;zL(h);const m=await this.standardizeUserData(t,n,r.sampleWeight,r.classWeight,!1,h);i=m[0],s=m[1],d=m[2];let x=!1,b;if(r.validationData!=null&&r.validationData.length>0){if(x=!0,r.validationData.length===2)u=r.validationData[0],l=r.validationData[1];else throw r.validationData.length===3?new Dt("validationData including sample weights is not supported yet."):new ne(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const N=await this.standardizeUserData(u,l,null,null,!0,h);c=N[0],f=N[1],b=c.concat(f)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){x=!0;const D=Math.floor(i[0].shape[0]*(1-r.validationSplit)),N=i[0].shape[0];c=Gv(i,D,N),o=i,i=Gv(i,0,D),f=Gv(s,D,N),a=s,s=Gv(s,0,D),b=c.concat(f)}else r.validationSteps!=null&&(x=!0);const v=i.concat(s).concat(d);this.checkTrainableWeightsConsistency();const $=this.makeTrainFunction(),C=this.getDedupedMetricsNames();let S,A;x?(this.makeTestFunction(),S=this.testFunction,A=C.slice().concat(C.map(D=>"val_"+D))):(S=null,b=[],A=C.slice());const E=Hfe(r.callbacks,r.yieldEvery);return await this.fitLoop($,v,C,h,r.epochs,r.verbose,E,S,b,r.shuffle,A,r.initialEpoch,null,null)}finally{this.isTraining=!1,lu(i,t),lu(s,n),lu(o,t),lu(a,n),lu(c,u),lu(f,l),d!=null&&Tt(d)}}async fitLoop(t,n,r,i,s,o,a,u,l,c,f,d,h,p){i==null&&(i=32),s==null&&(s=1),c==null&&(c=!0),d==null&&(d=0);let m=!1;if(u!=null&&l!=null&&(m=!0),p!=null&&(m=!0,h==null))throw new ne("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const x=this.checkNumSamples(n,i,h,"steps_per_epoch");let b;x!=null&&(b=Pu(0,x)),o==null&&(o=1);const{callbackList:v,history:$}=Xfe(a,o,s,d,x,h,i,m,f);v.setModel(this),this.history=$,await v.onTrainBegin(),this.stopTraining_=!1;for(let C=d;C<s;++C){await v.onEpochBegin(C);const S={};if(h!=null)throw new Dt("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Dt("batch shuffling is not implemneted yet");c&&G7(b);const A=Li(b),E=UL(x,i);for(let _=0;_<E.length;++_){const D={};if(await v.onBatchBegin(_,D),fe(()=>{const N=E[_][0],T=E[_][1],L=Pg(A,N,T-N);D.batch=_,D.size=T-N;const O=F6(n,L),M=t(O);for(let R=0;R<r.length;++R){const P=r[R],j=M[R];D[P]=j,Tu(j)}if(_===E.length-1&&m){const R=this.testLoop(u,l,i);for(let P=0;P<r.length;++P){const j=r[P],z=R[P];Tu(z),S["val_"+j]=z}}}),await v.onBatchEnd(_,D),Gfe(D),this.stopTraining_)break}A.dispose()}if(await v.onEpochEnd(C,S),this.stopTraining_)break}return await v.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,n){return n6e(this,t,n)}async trainOnBatch(t,n){const r=await this.standardizeUserData(t,n),i=r[0],s=r[1],a=this.makeTrainFunction()(i.concat(s)),u=[];for(const l of a){const c=await l.data();u.push(c[0])}return Tt(a),lu(r[0],t),lu(r[1],n),Ms(u)}getNamedWeights(t){const n=[],r=t!=null&&t.trainableOnly,i=r?this.trainableWeights:this.weights,s=this.getWeights(r);for(let o=0;o<i.length;++o)r&&!i[o].trainable||n.push({name:i[o].originalName,tensor:s[o]});return n}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=d6().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-d6().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=Xc(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(n=>Xc(n))}else{const n=Object.keys(this.loss);t={};const r=this.loss;for(const i of n)if(typeof r[i]=="string")t[i]=Xc(r[i]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Xc(mA(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>Xc(mA(t)));{const t={};for(const n in this.metrics)t[n]=Xc(mA(this.metrics[n]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=nI(t.optimizer_config),r=Rl(n);let i;if(typeof t.loss=="string")i=mg(t.loss);else if(Array.isArray(t.loss))i=t.loss.map(o=>mg(o));else if(t.loss!=null){i={};for(const o in t.loss)i[o]=mg(t.loss[o])}let s;if(Array.isArray(t.metrics))s=t.metrics.map(o=>mg(o));else if(t.metrics!=null){s={};for(const o in t.metrics)s[o]=mg(t.metrics[o])}this.compile({loss:i,metrics:s,optimizer:r})}async save(t,n){if(typeof t=="string"){const l=ple(t);if(l.length===0)throw new ne(`Cannot find any save handlers for URL '${t}'`);if(l.length>1)throw new ne(`Found more than one (${l.length}) save handlers for URL '${t}'`);t=l[0]}if(t.save==null)throw new ne("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await h6(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:c6e,generatedBy:`TensorFlow.js tfjs-layers v${tde}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const l="optimizer",{data:c,specs:f}=await h6(await this.optimizer.getWeights(),l);r.specs.push(...f),r.data=fle([r.data,c])}return this.userDefinedMetadata!=null&&(UZ(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,t.save(a)}setUserDefinedMetadata(t){UZ(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}V1.className="Model";Ae(V1);class ode extends V1{}ode.className="Functional";Ae(ode);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function f6e(e,t){if(t==null&&(t={}),typeof e=="string"){const n=gle(e,t);if(n.length===0)n.push(Mce(e,t));else if(n.length>1)throw new ne(`Found more than one (${n.length}) load handlers for URL '${e}'`);e=n[0]}return d6e(e,void 0,t)}async function d6e(e,t,n){if(n==null&&(n={}),e.load==null)throw new ne("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await e.load();let i=r.modelTopology;i.model_config!=null&&(i=i.model_config);const s=n.strict==null?!0:n.strict,o=r.weightData!=null&&r.weightSpecs!=null&&s,a=Rl(nI(i),t,o),u=r.trainingConfig;if(u!=null&&a.loadTrainingConfig(u),r.userDefinedMetadata!=null&&a.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new ne("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:l,optimizerWeights:c}=h6e(r.weightData,r.weightSpecs);a.loadWeights(l,s),a.optimizer!=null&&c.length>0&&await a.optimizer.setWeights(c),Tt(l),Tt(c.map(f=>f.tensor))}return a}function h6e(e,t){const n=r9(e,t),r={},i=[];return t.forEach(s=>{s.group==="optimizer"?i.push({name:s.name,tensor:n[s.name]}):r[s.name]=n[s.name]}),{modelWeights:r,optimizerWeights:i}}let f3=class O6 extends V1{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:o3("sequential_"),t.layers!=null)for(const n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new ne(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const n=t instanceof O6||t instanceof V1;let r;if(n){if(r=t,r.outputs.length!==1)throw new ne("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new ne("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new ne("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const i=d5e({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(t.inboundNodes.length!==1)throw new ne(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new ne("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=Ufe(this.outputs[0])}this.inboundNodes=[],new u3({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:um(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(i=>i.shape),outputShapes:this.outputs[0].shape})}else{const i=t.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(en(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new V1({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,r=console.log){this.built||this.build(),super.summary(t,n,r)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,r={}){if(!this.built)throw new Aa("The model needs to be compiled before being used.");return this.model.evaluate(t,n,r)}async evaluateDataset(t,n){if(!this.built)throw new Aa("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,n,r={}){if(!this.built)throw new Aa("The model needs to be compiled before being used.");return this.model.fit(t,n,r)}async fitDataset(t,n){if(!this.built)throw new Aa("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)}async trainOnBatch(t,n){return this.model.trainOnBatch(t,n)}static fromConfig(t,n,r={},i=!1){let s,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new ne("Legacy serialization format not supported yet.");s=n}else U(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),s=n.layers,delete n.layers,o=n;const a=new t(o);if(!(a instanceof O6))throw new Dt(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const u of s){const c=Rl(u,void 0,i);i&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a}set stopTraining(t){if(this.model==null)throw new ne("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new ne("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),t.push(r)}return{name:this.name,layers:t}}};f3.className="Sequential";Ae(f3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function p6e(e){return new f3(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Gi=class extends qm{getConfig(){return{}}};class ade extends Gi{apply(t,n=1){return KBe(t,n)}}ade.className="elu";Ae(ade);class ude extends Gi{apply(t){return A9(t)}}ude.className="selu";Ae(ude);class lde extends Gi{apply(t){return uc(t)}}lde.className="relu";Ae(lde);class cde extends Gi{apply(t){return fe(()=>om(6,uc(t)))}}cde.className="relu6";Ae(cde);let fde=class extends Gi{apply(t){return t}};fde.className="linear";Ae(fde);class dde extends Gi{apply(t){return Il(t)}}dde.className="sigmoid";Ae(dde);class hde extends Gi{apply(t){return ZBe(t)}}hde.className="hardSigmoid";Ae(hde);class pde extends Gi{apply(t){return rb(t)}}pde.className="softplus";Ae(pde);class gde extends Gi{apply(t){return QBe(t)}}gde.className="softsign";Ae(gde);class mde extends Gi{apply(t){return im(t)}}mde.className="tanh";Ae(mde);let OU=class extends Gi{apply(t,n=-1){return jF(t,n)}};OU.className="softmax";Ae(OU);class yde extends Gi{apply(t,n=-1){return y9(t,n)}}yde.className="logSoftmax";Ae(yde);class xde extends Gi{apply(t){return fe(()=>fe(()=>{const n=Math.sqrt(2),r=ee(.5,Ee(1,p9(st(t,n))));return ee(t,r)}))}}xde.className="gelu";Ae(xde);class bde extends Gi{apply(t){return fe(()=>ee(.5,ee(t,Ee(1,im(ee(wi(st(2,Math.PI)),Ee(t,ee(.044715,Ef(t,3)))))))))}}bde.className="gelu_new";Ae(bde);class vde extends Gi{apply(t){return fe(()=>ee(t,im(rb(t))))}}vde.className="mish";Ae(vde);class wde extends Gi{apply(t,n=1){return fe(()=>ee(Il(ee(t,n)),t))}}wde.className="swish";Ae(wde);function yh(e){return e.getClassName()}function jL(e,t={}){return _S(e,Zo.getMap().classNameMap,t,"activation")}function xh(e){if(e==null){const t={};return t.className="linear",t.config={},jL(t)}if(typeof e=="string"){const t={};return t.className=e,t.config={},jL(t)}else return e instanceof Gi?e:jL(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function g6e(e){if(e!=null&&typeof e!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}class $de extends qm{}class Cde extends $de{constructor(t){super(),g6e(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return fe(()=>{let n=Nr([1]);return this.hasL1&&(n=Ee(n,Ke(ee(this.l1,Tr(t))))),this.hasL2&&(n=Ee(n,Ke(ee(this.l2,IS(t))))),ie(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,n){return new t({l1:n.l1,l2:n.l2})}}Cde.className="L1L2";Ae(Cde);const HZ={l1l2:"L1L2"};function En(e){return wU(e)}function XZ(e,t={}){return _S(e,Zo.getMap().classNameMap,t,"regularizer")}function Gn(e){if(e==null)return null;if(typeof e=="string"){const n={className:e in HZ?HZ[e]:e,config:{}};return XZ(n)}else return e instanceof $de?e:XZ(e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Sde extends Lt{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,n){t=Ct(t);let r=uc(t);return this.maxValue!=null&&(r=_o(r,0,this.maxValue)),r}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},n=super.getConfig();return Object.assign(t,n),t}}Sde.className="ReLU";Ae(Sde);class kde extends Lt{constructor(t){super(t??{}),this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const r=Ct(t);return NF(r,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}kde.className="LeakyReLU";Ae(kde);class Ede extends Lt{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=qn(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Gn(t.alphaRegularizer),this.alphaConstraint=Or(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new ne(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=en(t);const n=t.slice(1);if(this.sharedAxes!=null)for(const i of this.sharedAxes)n[i-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let i=1;i<t.length;++i)r[i]=t[i];this.inputSpec=[new Fr({ndim:t.length,axes:r})],this.built=!0}call(t,n){return t=Ct(t),BF(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Jn(this.alphaInitializer),alphaRegularizer:En(this.alphaRegularizer),alphaConstraint:Rr(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(t,n),t}}Ede.className="PReLU";Ae(Ede);let Ade=class extends Lt{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new Dt(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const r=Ct(t);return wS(r)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}};Ade.className="ELU";Ae(Ade);class _de extends Lt{constructor(t){super(t??{}),this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,n){const r=Ct(t);return ee(r,Pe(Uo(r,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},n=super.getConfig();return Object.assign(t,n),t}}_de.className="ThresholdedReLU";Ae(_de);class Tde extends Lt{constructor(t){super(t??{}),this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new OU().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,n){return fe(()=>{let r=Ct(t);const i=n.mask;if(i!=null){const s=ee(Xe(Co(r.shape),Pe(i,r.dtype)),$t(-1e9));r=Ee(r,s)}return this.axis instanceof Array?this.axis.length>1?To(Xe(r,RF(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}Tde.className="Softmax";Ae(Tde);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function q1(e,t,n){if(typeof e=="number")return um(e,t);if(e.length!==t)throw new ne(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){const i=e[r];if(!GBe(i))throw new ne(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${i}`)}return e}function Iu(e,t,n,r,i=1){if(e==null)return e;const s=t+(t-1)*(i-1);let o;return n==="same"?o=e:o=e-s+1,Math.floor((o+r-1)/r)}function xl(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+mh([n-t,0]);else if(r==="same")e=e*t;else throw new ne(`Unsupport padding mode: ${r}.`);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function MU(e,t){return fe(()=>(xr(t),t==="channelsFirst"?Vt(e,[0,2,3,1]):e))}function Ide(e,t){return fe(()=>(xr(t),t==="channelsFirst"?Vt(e,[0,2,3,4,1]):e))}function m6e(e,t,n,r=1,i="valid",s,o=1){return fe(()=>{if(s==null&&(s=Bu()),xr(s),e.shape.length!==3)throw new ne(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new ne(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new ne(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(s==="channelsFirst"&&(e=Vt(e,[0,2,1])),i==="causal")throw new Dt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=l9(e,t,r,i==="same"?"same":"valid","NWC",o);return n!=null&&(a=qu(a,n)),a})}function YZ(e,t,n,r=[1,1],i="valid",s,o,a=null){return fe(()=>{if(s==null&&(s=Bu()),xr(s),e.rank!==3&&e.rank!==4)throw new ne(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new ne(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let u=MU(e,s);if(i==="causal")throw new Dt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=kce({x:u,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),s==="channelsFirst"&&(u=Vt(u,[0,3,1,2])),u})}function y6e(e,t,n,r=[1,1,1],i="valid",s,o){return fe(()=>{if(s==null&&(s=Bu()),xr(s),e.rank!==4&&e.rank!==5)throw new ne(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new ne(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let a=Ide(e,s);if(i==="causal")throw new Dt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=Wle(a,t,r,i==="same"?"same":"valid","NDHWC",o),n!=null&&(a=qu(a,n)),s==="channelsFirst"&&(a=Vt(a,[0,4,1,2,3])),a})}class d3 extends Lt{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",d3.verifyArgs(n),this.rank=t,Gr(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Dt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=q1(n.kernelSize,t,"kernelSize"),this.strides=q1(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,ca(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,xr(this.dataFormat),this.activation=xh(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=qn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Or(n.biasConstraint),this.biasRegularizer=Gn(n.biasRegularizer),this.activityRegularizer=Gn(n.activityRegularizer),this.dilationRate=q1(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new ne(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new ne(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new ne(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(yl("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!$U(t.kernelSize,"number",1,3))throw new ne(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:yh(this.activation),useBias:this.useBias,biasInitializer:Jn(this.biasInitializer),biasRegularizer:En(this.biasRegularizer),activityRegularizer:En(this.activityRegularizer),biasConstraint:Rr(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}class ab extends d3{constructor(t,n){super(t,n),this.kernel=null,ab.verifyArgs(n),this.filters=n.filters,Gr(this.filters,"filters"),this.kernelInitializer=qn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Or(n.kernelConstraint),this.kernelRegularizer=Gn(n.kernelRegularizer)}build(t){t=en(t);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new ne(`The channel dimension of the input should be defined. Found ${t[n]}`);const r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(t,n){return fe(()=>{t=Ct(t);let r;const i=this.bias==null?null:this.bias.read(),s=Efe(this.activation.getClassName());if(s!=null&&this.rank===2)r=YZ(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)r=m6e(t,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=YZ(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=y6e(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Dt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=en(t);const n=[],r=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let s=0;s<r.length;++s){const o=Iu(r[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);n.push(o)}let i=[t[0]];return this.dataFormat==="channelsLast"?(i=i.concat(n),i.push(this.filters)):(i.push(this.filters),i=i.concat(n)),i}getConfig(){const t={filters:this.filters,kernelInitializer:Jn(this.kernelInitializer),kernelRegularizer:En(this.kernelRegularizer),kernelConstraint:Rr(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new ne(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class RS extends ab{constructor(t){super(2,t),RS.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!$U(t.kernelSize,"number",1,2))throw new ne(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}RS.className="Conv2D";Ae(RS);class OS extends ab{constructor(t){super(3,t),OS.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new ne(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}OS.className="Conv3D";Ae(OS);class Nde extends RS{constructor(t){if(super(t),this.inputSpec=[new Fr({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new ne(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=en(t),t.length!==4)throw new ne("Input should have rank 4; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new ne("The channel dimension of the inputs should be defined. Found `None`.");const r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Fr({ndim:4,axes:{[n]:r}})],this.built=!0}call(t,n){return fe(()=>{let r=Ct(t);if(r.shape.length!==4)throw new ne(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,s=i[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const u=i[o],l=i[a],c=this.kernelSize[0],f=this.kernelSize[1],d=this.strides[0],h=this.strides[1],p=xl(u,d,c,this.padding),m=xl(l,h,f,this.padding),x=[s,p,m,this.filters];this.dataFormat!=="channelsLast"&&(r=Vt(r,[0,2,3,1]));let b=f9(r,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(b=Vt(b,[0,3,1,2])),this.bias!=null&&(b=qu(b,this.bias.read(),this.dataFormat)),this.activation!=null&&(b=this.activation.apply(b)),b})}computeOutputShape(t){t=en(t);const n=t.slice();let r,i,s;this.dataFormat==="channelsFirst"?(r=1,i=2,s=3):(r=3,i=1,s=2);const o=this.kernelSize[0],a=this.kernelSize[1],u=this.strides[0],l=this.strides[1];return n[r]=this.filters,n[i]=xl(n[i],u,o,this.padding),n[s]=xl(n[s],l,a,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}Nde.className="Conv2DTranspose";Ae(Nde);class Dde extends OS{constructor(t){if(super(t),this.inputSpec=[new Fr({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new ne(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=en(t),t.length!==5)throw new ne("Input should have rank 5; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new ne("The channel dimension of the inputs should be defined. Found `None`.");const r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Fr({ndim:5,axes:{[n]:r}})],this.built=!0}call(t,n){return fe(()=>{let r=Ct(t);if(r.shape.length!==5)throw new ne(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,s=i[0];let o,a,u;this.dataFormat==="channelsFirst"?(u=2,o=3,a=4):(u=1,o=2,a=3);const l=i[u],c=i[o],f=i[a],d=this.kernelSize[0],h=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],x=this.strides[1],b=this.strides[2],v=xl(l,m,d,this.padding),$=xl(c,x,h,this.padding),C=xl(f,b,p,this.padding),S=[s,v,$,C,this.filters];this.dataFormat!=="channelsLast"&&(r=Vt(r,[0,2,3,4,1]));let A=qle(r,this.kernel.read(),S,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(A=Vt(A,[0,4,1,2,3])),this.bias!==null&&(A=qu(A,this.bias.read(),this.dataFormat)),this.activation!==null&&(A=this.activation.apply(A)),A})}computeOutputShape(t){t=en(t);const n=t.slice();let r,i,s,o;this.dataFormat==="channelsFirst"?(r=1,i=2,s=3,o=4):(r=4,i=1,s=2,o=3);const a=this.kernelSize[0],u=this.kernelSize[1],l=this.kernelSize[2],c=this.strides[0],f=this.strides[1],d=this.strides[2];return n[r]=this.filters,n[i]=xl(n[i],c,a,this.padding),n[s]=xl(n[s],f,u,this.padding),n[o]=xl(n[o],d,l,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}Dde.className="Conv3DTranspose";Ae(Dde);class Fde extends ab{constructor(t,n){if(super(t,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new ne("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new ne("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new ne(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=qn(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Gn(n.depthwiseRegularizer),this.depthwiseConstraint=Or(n.depthwiseConstraint),this.pointwiseInitializer=qn(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Gn(n.pointwiseRegularizer),this.pointwiseConstraint=Or(n.pointwiseConstraint)}build(t){if(t=en(t),t.length<this.rank+2)throw new ne(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null||t[n]<0)throw new ne(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[n])}`);const r=t[n],i=this.kernelSize.concat([r,this.depthMultiplier]),s=[];for(let a=0;a<this.rank;++a)s.push(1);s.push(r*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Fr({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(t,n){return fe(()=>{t=Ct(t);let r;if(this.rank===1)throw new Dt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=Vt(t,[0,2,3,1])),r=_9(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=qu(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Vt(r,[0,3,1,2])),r})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Jn(this.depthwiseInitializer),t.pointwiseInitializer=Jn(this.pointwiseInitializer),t.depthwiseRegularizer=En(this.depthwiseRegularizer),t.pointwiseRegularizer=En(this.pointwiseRegularizer),t.depthwiseConstraint=Rr(this.depthwiseConstraint),t.pointwiseConstraint=Rr(this.pointwiseConstraint),t}}Fde.className="SeparableConv";class Rde extends Fde{constructor(t){super(2,t)}}Rde.className="SeparableConv2D";Ae(Rde);class h3 extends ab{constructor(t){super(1,t),h3.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!$U(t.kernelSize,"number",1,1))throw new ne(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}h3.className="Conv1D";Ae(h3);class Ode extends Lt{constructor(t){super(t),typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,n){return fe(()=>{if(t=Ct(t),this.dataFormat==="channelsLast"){const r=gA(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return gA(r,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=gA(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return gA(r,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}Ode.className="Cropping2D";Ae(Ode);class Mde extends Lt{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,xr(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,WBe(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const n=t[2]==null?null:this.size[0]*t[2],r=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,r]}else{const n=t[1]==null?null:this.size[0]*t[1],r=t[2]==null?null:this.size[1]*t[2];return[t[0],n,r,t[3]]}}call(t,n){return fe(()=>{let r=Ct(t);const i=r.shape;if(this.dataFormat==="channelsFirst"){r=Vt(r,[0,2,3,1]);const s=this.size[0]*i[2],o=this.size[1]*i[3],a=this.interpolation==="nearest"?El.resizeNearestNeighbor(r,[s,o]):El.resizeBilinear(r,[s,o]);return Vt(a,[0,3,1,2])}else{const s=this.size[0]*i[1],o=this.size[1]*i[2];return this.interpolation==="nearest"?El.resizeNearestNeighbor(r,[s,o]):El.resizeBilinear(r,[s,o])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}}Mde.className="UpSampling2D";Ae(Mde);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function x6e(e,t,n=[1,1],r="valid",i,s){return fe(()=>{i==null&&(i=Bu()),xr(i);let o=MU(e,i);if(e.rank!==4)throw new ne(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new ne(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return o=vS(o,t,n,r==="same"?"same":"valid","NHWC",s),i==="channelsFirst"&&(o=Vt(o,[0,3,1,2])),o})}class Lde extends d3{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=qn(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Or(t.depthwiseConstraint),this.depthwiseRegularizer=Gn(t.depthwiseRegularizer)}build(t){if(t=en(t),t.length<4)throw new ne(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new ne(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[n]}).`);const r=t[n],i=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return fe(()=>{t=Ct(t);let r=x6e(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=qu(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(t){t=en(t);const n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,s=Iu(n,this.kernelSize[0],this.padding,this.strides[0]),o=Iu(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],i,s,o]:[t[0],s,o,i]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Jn(this.depthwiseInitializer),t.depthwiseRegularizer=En(this.depthwiseRegularizer),t.depthwiseConstraint=Rr(this.depthwiseRegularizer),t}}Lde.className="DepthwiseConv2D";Ae(Lde);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pde(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new ne("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(s){return s==null||Array.isArray(s)?s:[s]}return t=i(t),n=i(n),{inputs:e,initialState:t,constants:n}}function Bde(e,t,n,r=!1,i,s,o=!1,a=!1){return fe(()=>{const u=t.shape.length;if(u<3)throw new ne(`Input should be at least 3D, but is ${u}D.`);const l=[1,0].concat(Pu(2,u));t=Vt(t,l),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&(i=Pe(Pe(i,"bool"),"float32"),i.rank===u-1&&(i=us(i,-1)),i=Vt(i,l)),r&&(t=Ba(t,0),i!=null&&(i=Ba(i,0)));const c=[];let f,d=n;const h=t.shape[0],p=gh(t);let m;i!=null&&(m=gh(i));for(let b=0;b<h;++b){const v=p[b],$=fe(()=>e(v,d));if(i==null)f=$[0],d=$[1];else{const C=fe(()=>{const S=m[b],A=Xe(sa(S),S),E=Ee(ee($[0],S),ee(d[0],A)),_=d.map((D,N)=>Ee(ee($[1][N],S),ee(D,A)));return{output:E,newStates:_}});f=C.output,d=C.newStates}a&&c.push(f)}let x;return a&&(x=Lu(c,1)),[f,x,d]})}class rp extends Lt{constructor(t){super(t);let n;if(t.cell==null)throw new ne("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new BU({cells:t.cell}):n=t.cell,n.stateSize==null)throw new ne("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new Fr({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Pu(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){T6(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let i;if(this.returnSequences?i=[t[0],t[1],r]:i=[t[0],r],this.returnState){const s=[];for(const o of n)s.push([t[0],o]);return[i].concat(s)}else return i}computeMask(t,n){return fe(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const i=this.states.map(s=>null);return[r].concat(i)}else return r})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<t;++r)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new Dt("Constants support is not implemented in RNN yet.");T6(t)&&(t=t[0]),t=t;const n=this.stateful?t[0]:null,r=t.slice(2);this.inputSpec[0]=new Fr({shape:[n,null,...r]});const i=[t[0]].concat(t.slice(2));this.cell.build(i);let s;if(Array.isArray(this.cell.stateSize)?s=this.cell.stateSize:s=[this.cell.stateSize],this.stateSpec!=null){if(!Gt(this.stateSpec.map(o=>o.shape[o.shape.length-1]),s))throw new ne(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=s.map(o=>new Fr({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){fe(()=>{if(!this.stateful)throw new ml("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new ne("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>Nr([r,i])):this.states_=[Nr([r,this.cell.stateSize])];else if(t==null)Tt(this.states_),this.keptStates!=null&&(Tt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>Nr([r,i])):this.states_[0]=Nr([r,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new ne(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):Tt(this.states_);for(let i=0;i<this.states_.length;++i){const s=t[i],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[i]:this.cell.stateSize,a=[r,o];if(!Gt(s.shape,a))throw new ne(`State ${i} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${s.shape}`);this.states_[i]=s}}this.states_=this.states_.map(i=>Tu(i.clone()))})}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const s=Pde(t,r,i,this.numConstants);t=s.inputs,r=s.initialState,i=s.constants;let o=[],a=[];if(r!=null){n.initialState=r,o=o.concat(r),this.stateSpec=[];for(const l of r)this.stateSpec.push(new Fr({shape:l.shape}));a=a.concat(this.stateSpec)}if(i!=null&&(n.constants=i,o=o.concat(i),this.numConstants=i.length),o[0]instanceof Gl){const l=[t].concat(o),c=this.inputSpec.concat(a),f=this.inputSpec;this.inputSpec=c;const d=super.apply(l,n);return this.inputSpec=f,d}else return super.apply(t,n)}call(t,n){return fe(()=>{const r=n==null?null:n.mask,i=n==null?null:n.training;let s=n==null?null:n.initialState;t=Ct(t),s==null&&(this.stateful?s=this.states_:s=this.getInitialState(t));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==o)throw new ne(`RNN Layer has ${o} state(s) but was passed ${s.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:i},l=Bde((p,m)=>{const x=this.cell.call([p].concat(m),a);return[x[0],x.slice(1)]},t,s,this.goBackwards,r,null,this.unroll,this.returnSequences),c=l[0],f=l[1],d=l[2];this.stateful&&this.resetStates(d,i);const h=this.returnSequences?f:c;return this.returnState?[h].concat(d):h})}getInitialState(t){return fe(()=>{let n=Nr(t.shape);return n=Ke(n,[1,2]),n=TS(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?A6(n,[1,r]):n):this.cell.stateSize>1?[A6(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===rp.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),t),n)}static fromConfig(t,n,r={}){const i=n.cell,s=Rl(i,r);return new t(Object.assign(n,{cell:s}))}}rp.className="RNN";Ae(rp);class p3 extends Lt{}class LU extends p3{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Gr(this.units,"units"),this.activation=xh(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=qn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=qn(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=qn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Gn(t.kernelRegularizer),this.recurrentRegularizer=Gn(t.recurrentRegularizer),this.biasRegularizer=Gn(t.biasRegularizer),this.kernelConstraint=Or(t.kernelConstraint),this.recurrentConstraint=Or(t.recurrentConstraint),this.biasConstraint=Or(t.biasConstraint),this.dropout=ay([1,mh([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=ay([1,mh([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=en(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return fe(()=>{if(t=t,t.length!==2)throw new ne(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let r=t[1];t=t[0];const i=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bh({ones:()=>sa(t),rate:this.dropout,training:i,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bh({ones:()=>sa(r),rate:this.recurrentDropout,training:i,dropoutFunc:this.dropoutFunc}));let s;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?s=Fl(ee(t,o),this.kernel.read()):s=Fl(t,this.kernel.read()),this.bias!=null&&(s=qu(s,this.bias.read())),a!=null&&(r=ee(r,a));let u=Ee(s,Fl(r,this.recurrentKernel.read()));return this.activation!=null&&(u=this.activation.apply(u)),[u,u]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:yh(this.activation),useBias:this.useBias,kernelInitializer:Jn(this.kernelInitializer),recurrentInitializer:Jn(this.recurrentInitializer),biasInitializer:Jn(this.biasInitializer),kernelRegularizer:En(this.kernelRegularizer),recurrentRegularizer:En(this.recurrentRegularizer),biasRegularizer:En(this.biasRegularizer),activityRegularizer:En(this.activityRegularizer),kernelConstraint:Rr(this.kernelConstraint),recurrentConstraint:Rr(this.recurrentConstraint),biasConstraint:Rr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),n)}}LU.className="SimpleRNNCell";Ae(LU);class zde extends rp{constructor(t){t.cell=new LU(t),super(t)}call(t,n){return fe(()=>{this.cell.dropoutMask!=null&&(Tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return new t(n)}}zde.className="SimpleRNN";Ae(zde);class PU extends p3{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new ne("GRUCell does not support reset_after parameter set to true.");this.units=t.units,Gr(this.units,"units"),this.activation=xh(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=xh(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=qn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=qn(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=qn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Gn(t.kernelRegularizer),this.recurrentRegularizer=Gn(t.recurrentRegularizer),this.biasRegularizer=Gn(t.biasRegularizer),this.kernelConstraint=Or(t.kernelConstraint),this.recurrentConstraint=Or(t.recurrentConstraint),this.biasConstraint=Or(t.biasConstraint),this.dropout=ay([1,mh([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=ay([1,mh([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=en(t);const n=t[t.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return fe(()=>{if(t=t,t.length!==2)throw new ne(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const r=n.training==null?!1:n.training;let i=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bh({ones:()=>sa(t),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bh({ones:()=>sa(i),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,o=this.recurrentDropoutMask;let a,u,l;0<this.dropout&&this.dropout<1&&(t=ee(t,s[0]));let c=Fl(t,this.kernel.read());this.useBias&&(c=qu(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=ee(i,o[0]));const f=this.recurrentKernel.read(),[d,h]=Ws(f,[2*this.units,this.units],f.rank-1),p=Fl(i,d),[m,x,b]=Ws(c,3,c.rank-1),[v,$]=Ws(p,2,p.rank-1);a=this.recurrentActivation.apply(Ee(m,v)),u=this.recurrentActivation.apply(Ee(x,$));const C=Fl(ee(u,i),h);l=this.activation.apply(Ee(b,C));const S=Ee(ee(a,i),ee(Ee(1,Ln(a)),l));return[S,S]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:yh(this.activation),recurrentActivation:yh(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Jn(this.kernelInitializer),recurrentInitializer:Jn(this.recurrentInitializer),biasInitializer:Jn(this.biasInitializer),kernelRegularizer:En(this.kernelRegularizer),recurrentRegularizer:En(this.recurrentRegularizer),biasRegularizer:En(this.biasRegularizer),activityRegularizer:En(this.activityRegularizer),kernelConstraint:Rr(this.kernelConstraint),recurrentConstraint:Rr(this.recurrentConstraint),biasConstraint:Rr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),n)}}PU.className="GRUCell";Ae(PU);class Ude extends rp{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new PU(t),super(t)}call(t,n){return fe(()=>{this.cell.dropoutMask!=null&&(Tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}Ude.className="GRU";Ae(Ude);class g3 extends p3{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Gr(this.units,"units"),this.activation=xh(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=xh(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=qn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=qn(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=qn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=Gn(t.kernelRegularizer),this.recurrentRegularizer=Gn(t.recurrentRegularizer),this.biasRegularizer=Gn(t.biasRegularizer),this.kernelConstraint=Or(t.kernelConstraint),this.recurrentConstraint=Or(t.recurrentConstraint),this.biasConstraint=Or(t.biasConstraint),this.dropout=ay([1,mh([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=ay([1,mh([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var n;t=en(t);const r=t[t.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let i;if(this.useBias){if(this.unitForgetBias){const s=this.biasInitializer,o=this.units;i=new(n=class extends Ya{apply(u,l){const c=s.apply([o]),f=new SU().apply([o]),d=s.apply([o*2]);return DZ(DZ(c,f),d)}},n.className="CustomInit",n)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,n){return fe(()=>{const r=n.training==null?!1:n.training;if(t=t,t.length!==3)throw new ne(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let i=t[1];const s=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bh({ones:()=>sa(t),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bh({ones:()=>sa(i),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let u,l,c,f;0<this.dropout&&this.dropout<1&&(t=ee(t,o[0]));let d=Fl(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=ee(i,a[0])),d=Ee(d,Fl(i,this.recurrentKernel.read())),this.useBias&&(d=qu(d,this.bias.read()));const[h,p,m,x]=Ws(d,4,d.rank-1);u=this.recurrentActivation.apply(h),l=this.recurrentActivation.apply(p),c=Ee(ee(l,s),ee(u,this.activation.apply(m))),f=this.recurrentActivation.apply(x);const b=ee(f,this.activation.apply(c));return[b,b,c]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:yh(this.activation),recurrentActivation:yh(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Jn(this.kernelInitializer),recurrentInitializer:Jn(this.recurrentInitializer),biasInitializer:Jn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:En(this.kernelRegularizer),recurrentRegularizer:En(this.recurrentRegularizer),biasRegularizer:En(this.biasRegularizer),activityRegularizer:En(this.activityRegularizer),kernelConstraint:Rr(this.kernelConstraint),recurrentConstraint:Rr(this.recurrentConstraint),biasConstraint:Rr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),n)}}g3.className="LSTMCell";Ae(g3);class jde extends rp{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new g3(t),super(t)}call(t,n){return fe(()=>{this.cell.dropoutMask!=null&&(Tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}jde.className="LSTM";Ae(jde);class BU extends p3{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?t.push(...n.stateSize):t.push(n.stateSize);return t}call(t,n){return fe(()=>{t=t;let r=t.slice(1);const i=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?i.push(r.splice(0,a.stateSize.length)):i.push(r.splice(0,1));i.reverse();const s=[];let o;for(let a=0;a<this.cells.length;++a){const u=this.cells[a];r=i[a],a===0?o=[t[0]].concat(r):o=[o[0]].concat(r),o=u.call(o,n),s.push(o.slice(1))}r=[];for(const a of s.slice().reverse())r.push(...a);return[o[0]].concat(r)})}build(t){T6(t)&&(t=t[0]),t=t;let n;this.cells.forEach((r,i)=>{Lg(`RNNCell_${i}`,()=>{r.build(t),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,t=[t[0],n]})}),this.built=!0}getConfig(){const t=super.getConfig(),n=s=>({className:s.getClassName(),config:s.getConfig()}),i={cells:this.cells.map(n)};return Object.assign(Object.assign({},t),i)}static fromConfig(t,n,r={}){const i=[];for(const s of n.cells)i.push(Rl(s,r));return new t({cells:i})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.cells)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(t)}return t}getWeights(){const t=[];for(const n of this.cells)t.push(...n.weights);return I6(t)}setWeights(t){const n=[];for(const r of this.cells){const i=r.weights.length,s=t.splice(i);for(let o=0;o<r.weights.length;++o)n.push([r.weights[o],s[o]])}NU(n)}}BU.className="StackedRNNCells";Ae(BU);function bh(e){const{ones:t,rate:n,training:r=!1,count:i=1,dropoutFunc:s}=e,o=()=>s!=null?s(t(),n):Ffe(t(),n),a=()=>NS(o,t,r);return!i||i<=1?Tu(a().clone()):Array(i).fill(void 0).map(a).map(l=>Tu(l.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var b6e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class Wde extends rp{constructor(t){if(t.unroll)throw new Dt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new Dt("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new Fr({ndim:5})]}call(t,n){return fe(()=>{if(this.cell.dropoutMask!=null&&(Tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new ne("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(t,{mask:r,training:i,initialState:s})})}computeOutputShape(t){let n=this.computeSingleOutputShape(t);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([t[0],...n.slice(-3)])]),n}getInitialState(t){return fe(()=>{const{stateSize:n}=this.cell,r=t.shape,i=this.computeSingleOutputShape(r),s=[i[0],...i.slice(2)],o=Nr(s);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(t,n=!1){fe(()=>{if(!this.stateful)throw new ml("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,i=this.computeSingleOutputShape(r),s=[i[0],...i.slice(2)];if(r[0]==null)throw new ne("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Nr(s)):this.states_=[Nr(s)];else if(t==null)Tt(this.states_),this.keptStates!=null&&(Tt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Nr(s)):this.states_[0]=Nr(s);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new ne(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n?this.keptStates.push(this.states_.slice()):Tt(this.states_);for(let a=0;a<this.states_.length;++a){const u=t[a],l=s;if(!Gt(u.shape,l))throw new ne(`State ${a} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${u.shape}`);this.states_[a]=u}}this.states_=this.states_.map(a=>Tu(a.clone()))})}computeSingleOutputShape(t){const{dataFormat:n,filters:r,kernelSize:i,padding:s,strides:o,dilationRate:a}=this.cell,u=n==="channelsFirst",l=t[u?3:2],c=t[u?4:3],f=Iu(l,i[0],s,o[0],a[0]),d=Iu(c,i[1],s,o[1],a[1]);return[...t.slice(0,2),...u?[r,f,d]:[f,d,r]]}}Wde.className="ConvRNN2D";class zU extends g3{constructor(t){const{filters:n,kernelSize:r,strides:i,padding:s,dataFormat:o,dilationRate:a}=t;super(Object.assign(Object.assign({},t),{units:n})),this.filters=n,Gr(this.filters,"filters"),this.kernelSize=q1(r,2,"kernelSize"),this.kernelSize.forEach(u=>Gr(u,"kernelSize")),this.strides=q1(i||1,2,"strides"),this.strides.forEach(u=>Gr(u,"strides")),this.padding=s||"valid",ca(this.padding),this.dataFormat=o||"channelsLast",xr(this.dataFormat),this.dilationRate=q1(a||1,2,"dilationRate"),this.dilationRate.forEach(u=>Gr(u,"dilationRate"))}build(t){var n;t=en(t);const r=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[r]==null)throw new ne(`The channel dimension of the input should be defined. Found ${t[r]}`);const i=t[r],s=4,o=this.kernelSize.concat([i,this.filters*s]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*s]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let u;if(this.unitForgetBias){const l=this.biasInitializer,c=this.filters;u=new(n=class extends Ya{apply(d,h){const p=l.apply([c]),m=Co([c]),x=l.apply([c*2]);return CU([p,m,x])}},n.className="CustomInit",n)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*s],null,u,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,n){return fe(()=>{if(t.length!==3)throw new ne(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const r=n.training||!1,i=t[0],s=t[1],o=t[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bh({ones:()=>sa(i),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const u=this.dropoutMask,l=(H,V,X)=>!V||!V[X]?H:ee(V[X],H);let c=l(i,u,0),f=l(i,u,1),d=l(i,u,2),h=l(i,u,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bh({ones:()=>sa(s),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=l(s,p,0),x=l(s,p,1),b=l(s,p,2),v=l(s,p,3);const $=3,[C,S,A,E]=Ws(this.kernel.read(),a,$),[_,D,N,T]=this.useBias?Ws(this.bias.read(),a):[null,null,null,null];c=this.inputConv(c,C,_,this.padding),f=this.inputConv(f,S,D,this.padding),d=this.inputConv(d,A,N,this.padding),h=this.inputConv(h,E,T,this.padding);const[L,O,M,R]=Ws(this.recurrentKernel.read(),a,$);m=this.recurrentConv(m,L),x=this.recurrentConv(x,O),b=this.recurrentConv(b,M),v=this.recurrentConv(v,R);const P=this.recurrentActivation.apply(Ee(c,m)),j=this.recurrentActivation.apply(Ee(f,x)),z=Ee(ee(j,o),ee(P,this.activation.apply(Ee(d,b)))),q=ee(this.recurrentActivation.apply(Ee(h,v)),this.activation.apply(z));return[q,q,z]})}getConfig(){const t=super.getConfig(),n=b6e(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(t,n,r,i){const s=ph(t,n,this.strides,i||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?qu(s,r,this.dataFormat):s}recurrentConv(t,n){return ph(t,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}zU.className="ConvLSTM2DCell";Ae(zU);class Vde extends Wde{constructor(t){const n=new zU(t);super(Object.assign(Object.assign({},t),{cell:n}))}static fromConfig(t,n){return new t(n)}}Vde.className="ConvLSTM2D";Ae(Vde);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class UU extends Lt{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const n=t.shape,r=[];for(let i=0;i<this.noiseShape.length;++i)r.push(this.noiseShape[i]==null?n[i]:this.noiseShape[i]);return r}call(t,n){return fe(()=>{this.invokeCallHook(t,n);const r=Ct(t);if(0<this.rate&&this.rate<1){const i=n.training==null?!1:n.training,s=this.getNoiseShape(r);return NS(()=>Ffe(r,this.rate,s,this.seed),()=>r,i)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(t,n),t}dispose(){return super.dispose()}}UU.className="Dropout";Ae(UU);class qde extends UU{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const n=t.shape;return[n[0],1,n[2]]}}qde.className="SpatialDropout1D";Ae(qde);class jU extends Lt{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let n=null;t.batchSize!=null&&(n=t.batchSize),this.batchInputShape=[n,t.inputDim]}this.units=t.units,Gr(this.units,"units"),this.activation=xh(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=qn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=qn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Or(t.kernelConstraint),this.biasConstraint=Or(t.biasConstraint),this.kernelRegularizer=Gn(t.kernelRegularizer),this.biasRegularizer=Gn(t.biasRegularizer),this.activityRegularizer=Gn(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=en(t);const n=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(t){t=en(t);const n=t.slice();return n[n.length-1]=this.units,n}call(t,n){return fe(()=>{this.invokeCallHook(t,n);const r=Ct(t),i=Efe(this.activation.getClassName());let s;return i!=null?s=Fl(r,this.kernel.read(),i,this.bias?this.bias.read():null):(s=Fl(r,this.kernel.read()),this.bias!=null&&(s=qu(s,this.bias.read())),this.activation!=null&&(s=this.activation.apply(s))),s})}getConfig(){const t={units:this.units,activation:yh(this.activation),useBias:this.useBias,kernelInitializer:Jn(this.kernelInitializer),biasInitializer:Jn(this.biasInitializer),kernelRegularizer:En(this.kernelRegularizer),biasRegularizer:En(this.biasRegularizer),activityRegularizer:En(this.activityRegularizer),kernelConstraint:Rr(this.kernelConstraint),biasConstraint:Rr(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}jU.className="Dense";Ae(jU);let Gde=class extends Lt{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=en(t);for(const n of t.slice(1))if(n==null)throw new ne(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],nh(t,1)]}call(t,n){return fe(()=>{this.invokeCallHook(t,n);let r=Ct(t);if(this.dataFormat==="channelsFirst"&&r.rank>1){const i=[0];for(let s=2;s<r.rank;++s)i.push(s);i.push(1),r=Vt(r,i)}return YBe(r)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(t,n),t}};Gde.className="Flatten";Ae(Gde);class Hde extends Lt{constructor(t){super(t),this.supportsMasking=!0,this.activation=xh(t.activation)}call(t,n){return fe(()=>{this.invokeCallHook(t,n);const r=Ct(t);return this.activation.apply(r)})}getConfig(){const t={activation:yh(this.activation)},n=super.getConfig();return Object.assign(t,n),t}}Hde.className="Activation";Ae(Hde);class Xde extends Lt{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,n){return fe(()=>(t=Ct(t),HBe(t,this.n)))}getConfig(){const t={n:this.n},n=super.getConfig();return Object.assign(t,n),t}}Xde.className="RepeatVector";Ae(Xde);class Yde extends Lt{constructor(t){super(t),this.targetShape=t.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,n){const r="Total size of new array must be unchanged.",i=n.slice();let s=1,o=null;for(let u=0;u<i.length;++u){const l=i[u];if(this.isUnknown(l))if(o===null)o=u;else throw new ne("Can only specifiy one unknown dimension.");else s*=l}const a=nh(t);if(o!==null){if(s===0||a%s!==0)throw new ne(r);i[o]=a/s}else if(a!==s)throw new ne(r);return i}computeOutputShape(t){let n=!1;for(let r=0;r<t.length;++r)if(this.isUnknown(t[r])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,n){return fe(()=>{this.invokeCallHook(t,n);const r=Ct(t),i=r.shape,s=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return ie(r,s)})}getConfig(){const t={targetShape:this.targetShape},n=super.getConfig();return Object.assign(t,n),t}}Yde.className="Reshape";Ae(Yde);class Kde extends Lt{constructor(t){if(super(t),t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const n=Pu(1,t.dims.length+1);if(!Gt(t.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Fr({ndim:this.dims.length+1})]}computeOutputShape(t){t=en(t);const n=t.slice();return this.dims.forEach((r,i)=>{n[i+1]=t[r]}),n}call(t,n){return Vt(Ct(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},n=super.getConfig();return Object.assign(t,n),t}}Kde.className="Permute";Ae(Kde);class Qde extends Lt{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,t),n}computeMask(t,n){const r=Ct(t);return qT(sy(r,this.maskValue),-1)}call(t,n){return fe(()=>{this.invokeCallHook(t,n);const r=Ct(t),o=qT(sy(r,this.maskValue),-1,!0);return ee(r,Pe(o,r.dtype))})}}Qde.className="Masking";Ae(Qde);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Zde extends Lt{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let n=null;t.batchSize!=null&&(n=t.batchSize),t.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(pn(t.inputLength))}this.inputDim=t.inputDim,Gr(this.inputDim,"inputDim"),this.outputDim=t.outputDim,Gr(this.outputDim,"outputDim"),this.embeddingsInitializer=qn(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Gn(t.embeddingsRegularizer),this.activityRegularizer=Gn(t.activityRegularizer),this.embeddingsConstraint=Or(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,n){return fe(()=>this.maskZero?(t=Ct(t),sy(t,Xt(t))):null)}computeOutputShape(t){if(t=en(t),this.inputLength==null)return[...t,this.outputDim];const n=pn(this.inputLength);if(n.length!==t.length-1)throw new ne(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let r=0;for(let i=0;i<n.length;++i){const s=n[i],o=t[i+1];if(s!=null&&o!=null&&s!==o)throw new ne(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);s==null&&(n[r]=o),r++}}return[t[0],...n,this.outputDim]}call(t,n){return fe(()=>{this.invokeCallHook(t,n);let r=Ct(t);r.dtype!=="int32"&&(r=Dl(r,"int32"));const i=Dfe(this.embeddings.read(),ie(r,[r.size]));return ie(i,en(this.computeOutputShape(r.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Jn(this.embeddingsInitializer),embeddingsRegularizer:En(this.embeddingsRegularizer),activityRegularizer:En(this.activityRegularizer),embeddingsConstraint:Rr(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(t,n),t}}Zde.className="Embedding";Ae(Zde);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Hm extends Lt{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new Dt}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;const r=t.slice(0,t.length-n.length);for(let i=0;i<n.length;++i){const s=t[t.length-n.length+i],o=n[i];if(s==null||o==null||s<0||o<0)r.push(null);else if(s===1)r.push(o);else if(o===1)r.push(s);else{if(s!==o)throw new ne("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));r.push(s)}}return r}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[en(t)]),t=t,t.length<2)throw new ne(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(const s of t)s!=null&&s[0]!==null&&n.push(s[0]);if(n=th(n),n.length>1)throw new ne(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let r=t[0]==null?null:t[0].slice(1);for(let s=1;s<t.length;++s){const o=t[s]==null?null:t[s].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const i=t.map(s=>s.length);t.indexOf(null)===-1&&th(i).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return fe(()=>{if(t=t,this.reshapeRequired){const r=[],i=t.map(s=>s.rank);if(i.indexOf(null)===-1){const s=mh(i);for(let o of t){const a=o.rank;for(let u=0;u<s-a;++u)o=TS(o,1);r.push(o)}return this.mergeFunction(r)}else{let s=!1;for(const u of t){const l=u.rank;if(l==null){const c=u.shape,f=c[0],d=c.slice(1).concat([f]);let h=ie(u,[f].concat(nh(c.slice(1))));h=Vt(h,[1,0]),h=ie(h,d),r.push(h),s=!0}else if(l>1){const c=Pu(1,l).concat([0]);r.push(Vt(u,c)),s=!0}else r.push(u)}let o=this.mergeFunction(r);const a=o.rank;if(s){if(a==null){const u=o.shape,l=u.length,c=u[l-1],f=[c].concat(u.slice(0,u.length-1));o=ie(Vt(ie(o,[-1,c]),[1,0]),f)}else if(a>1){const u=[a-1].concat(Pu(0,a-1));o=Vt(o,u)}}return o}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let i=1;i<t.length;++i){const s=t[i]==null?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,s)}let r=[];for(const i of t)i!=null&&i[0]!==null&&r.push(i[0]);return r=th(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(t,n){return fe(()=>{if(n==null)return null;if(!Array.isArray(n))throw new ne("`mask` should be an Array");if(!Array.isArray(t))throw new ne("`inputs` should be an Array");if(n.length!==t.length)throw new ne(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(i=>i==null))return null;n=n.map(i=>i==null?i:us(i,0));let r=n[0];for(let i=1;i<n.length-1;++i)r=ql(r,n[i]);return r})}}class Jde extends Hm{constructor(t){super(t)}mergeFunction(t){return fe(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=Ee(n,t[r]);return n})}}Jde.className="Add";Ae(Jde);class ehe extends Hm{constructor(t){super(t)}mergeFunction(t){return fe(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=ee(n,t[r]);return n})}}ehe.className="Multiply";Ae(ehe);class the extends Hm{constructor(t){super(t)}mergeFunction(t){return fe(()=>{let n=t[0].clone();for(let r=1;r<t.length;++r)n=Ee(n,t[r]);return ee(1/t.length,n)})}}the.className="Average";Ae(the);class nhe extends Hm{constructor(t){super(t)}mergeFunction(t){return fe(()=>{let n=t[0];for(let r=1;r<t.length;++r)n=Uf(n,t[r]);return n})}}nhe.className="Maximum";Ae(nhe);class rhe extends Hm{constructor(t){super(t)}mergeFunction(t){return fe(()=>{let n=t[0];for(let r=1;r<t.length;++r)n=om(n,t[r]);return n})}}rhe.className="Minimum";Ae(rhe);class ihe extends Hm{constructor(t){super(t),this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new ne("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let n=!0;for(const i of t)if(i!=null){n=!1;break}if(n)return;const r=[];for(let i=0;i<t.length;++i){const s=t[i].slice();s.splice(this.axis,1);let o=!1;for(const a of r)if(Gt(a,s)){o=!0;break}o||r.push(s)}if(r.length>1)throw new ne("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return fe(()=>CU(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new ne("A `Concatenate` layer should be called on a list of inputs.");const n=t,r=n[0].slice(),i=this.axis<0?r.length+this.axis:this.axis;for(const s of n.slice(1)){if(r[i]==null||s[i]==null){r[i]=null;break}r[i]+=s[i]}return r}computeMask(t,n){if(n==null)return null;if(!Array.isArray(n))throw new ne("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new ne("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new ne(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${t.length})`);return fe(()=>{let r=!0;if(n.forEach(o=>{if(o!=null){r=!1;return}}),r)return null;const i=[];for(let o=0;o<t.length;++o)n[o]==null?i.push(Pe(sa(t[o]),"bool")):n[o].rank<t[o].rank?i.push(us(n[o],-1)):i.push(n[o]);const s=Yr(i,this.axis);return a9(s,-1,!1)})}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}ihe.className="Concatenate";Ae(ihe);function Hv(e,t){for(;e<0;)e+=t;return e}function v6e(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Dt("batchDot is not implemented for tensors of 4D or higher rank yet");if(U(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),U(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new Dt("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);const s=n;return fe(()=>{let o;if(r>i){o=r-i;const u=[];for(let l=0;l<o;++l)u.push(1);t=ie(t,t.shape.concat(u))}else if(i>r){o=i-r;const u=[];for(let l=0;l<o;++l)u.push(1);e=ie(e,e.shape.concat(u))}else o=0;let a;if(e.shape.length===2&&t.shape.length===2)s[0]===s[1]?a=Ke(ee(e,t),s[0]):a=Ke(ee(Vt(e,[1,0]),t),s[1]);else{const u=s[0]!==e.shape.length-1,l=s[1]===t.shape.length-1;a=Mt(e,t,u,l)}if(o>0){let u;r>i?u=r+i-3:u=r-1;const l=[];for(let c=u;c<u+o;++c)l.push(c);a=Vm(a,l)}return a.shape.length===1&&(a=us(a,1)),a})}class she extends Hm{constructor(t){super(t),this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){U(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0],r=t[1];if(n.length>3||r.length>3)throw new Dt("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);if(n[i[0]]!==r[i[1]])throw new ne(`Dimension incompatibility: ${n[i[0]]} !== ${r[i[1]]}`)}mergeFunction(t){if(t.length!==2)throw new ne(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let n=t[0],r=t[1],i;return Array.isArray(this.axes)?i=this.axes.map((s,o)=>Hv(s,t[o].shape.length)):i=[Hv(this.axes,n.shape.length),Hv(this.axes,r.shape.length)],this.normalize&&(n=QT(n,i[0]),r=QT(r,i[1])),v6e(n,r,i)}interpretAxes(t,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[Hv(this.axes,t.length),Hv(this.axes,n.length)],r}computeOutputShape(t){U(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0].slice(),r=t[1].slice();if(n.length>3||r.length>3)throw new Dt("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);n.splice(i[0],1),r.splice(i[1],1),r.splice(0,1);const s=n.concat(r);return s.length===1&&s.push(1),s}computeMask(t,n){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(t,n),t}}she.className="Dot";Ae(she);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ohe extends Lt{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,t),n}call(t,n){return fe(()=>{this.invokeCallHook(t,n);const r=Ct(t);return NS(()=>Ee(a3(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}ohe.className="GaussianNoise";Ae(ohe);class ahe extends Lt{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return fe(()=>{this.invokeCallHook(t,n);const r=Ct(t);return this.rate>0&&this.rate<1?NS(()=>{const s=Math.sqrt(this.rate/(1-this.rate));return ee(r,a3(r.shape,1,s))},()=>r,n.training||!1):r})}}ahe.className="GaussianDropout";Ae(ahe);class uhe extends Lt{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||Ct(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return fe(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(t);return NS(()=>{const s=Ct(t),u=-1.6732632423543772*1.0507009873554805;let l=ep(Wm(r),this.rate);l=Dl(l,"float32");const c=((1-this.rate)*(1+this.rate*u**2))**-.5,f=-c*u*this.rate,d=Ee(ee(s,l),ee(Ee(l,-1),u));return Ee(ee(d,c),f)},()=>Ct(t),n.training||!1)}return t})}}uhe.className="AlphaDropout";Ae(uhe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qw(e,t,n,r,i,s=.001){let o;if(e.rank===2)o=Rle(e,t,n,r,i,s);else if(e.rank===3)o=Ole(e,t,n,r,i,s);else if(e.rank===4)o=Mle(e,t,n,r,i,s);else throw new Dt(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return o}function w6e(e,t,n,r,i=.001){return fe(()=>{const s=LF(e,r),o=s.mean,a=s.variance;return[Qw(e,o,a,n,t,i),o,a]})}function $6e(e,t,n,r,i=.001){return fe(()=>{const s=LF(e,r),o=s.mean,a=s.variance,u=[];for(const p of Pu(0,e.rank))r.indexOf(p)!==-1?u.push(1):u.push(e.shape[p]);const l=ie(o,u),c=ie(a,u),f=t==null?null:ie(t,u),d=n==null?null:ie(n,u);return[Qw(e,l,c,d,f,i),o,a]})}function C6e(e,t,n,r,i=.001){return Gt(r.slice().sort(),Pu(0,e.rank-1))?w6e(e,t,n,r,i):$6e(e,t,n,r,i)}class lhe extends Lt{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=qn(t.betaInitializer||"zeros"),this.gammaInitializer=qn(t.gammaInitializer||"ones"),this.movingMeanInitializer=qn(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=qn(t.movingVarianceInitializer||"ones"),this.betaConstraint=Or(t.betaConstraint),this.gammaConstraint=Or(t.gammaConstraint),this.betaRegularizer=Gn(t.betaRegularizer),this.gammaRegularizer=Gn(t.gammaRegularizer)}build(t){t=en(t);const n=this.axis>=0?this.axis:this.axis+t.length,r=t[n];if(r==null)throw new ne(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new Fr({ndim:t.length,axes:{[n]:r}})];const i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,n){return fe(()=>{const r=n.training==null?!1:n.training,i=Ct(t),s=i.shape,o=s.length,a=Pu(0,o),u=this.axis>=0?this.axis:this.axis+o;a.splice(u,1);const l=um(1,o);l[u]=s[u];const c=a.slice();c.sort();const f=!Gt(c,Pu(0,o).slice(0,o-1)),d=()=>{if(f){const v=ie(this.movingMean.read(),l),$=ie(this.movingVariance.read(),l),C=this.center?ie(this.beta.read(),l):null,S=this.scale?ie(this.gamma.read(),l):null;return Qw(i,v,$,C,S,this.epsilon)}else return Qw(i,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return d();const[h,p,m]=C6e(i,this.gamma.read(),this.beta.read(),a,this.epsilon),x=(v,$,C)=>{fe(()=>{const S=1-C,A=v.read(),E=ee(Xe(A,$),S);v.write(Xe(A,E))})};return(()=>{x(this.movingMean,p,this.momentum),x(this.movingVariance,m,this.momentum)})(),h})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Jn(this.betaInitializer),gammaInitializer:Jn(this.gammaInitializer),movingMeanInitializer:Jn(this.movingMeanInitializer),movingVarianceInitializer:Jn(this.movingVarianceInitializer),betaRegularizer:En(this.betaRegularizer),gammaRegularizer:En(this.gammaRegularizer),betaConstraint:Rr(this.betaConstraint),gammaConstraint:Rr(this.gammaConstraint)},n=super.getConfig();return Object.assign(t,n),t}}lhe.className="BatchNormalization";Ae(lhe);class che extends Lt{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=qn(t.betaInitializer||"zeros"),this.gammaInitializer=qn(t.gammaInitializer||"ones"),this.betaRegularizer=Gn(t.betaRegularizer),this.gammaRegularizer=Gn(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=en(t);const n=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let s=0;s<this.axis.length;++s)this.axis[s]<0&&(this.axis[s]+=n);for(const s of this.axis)if(s<0||s>=n)throw new Error(`Invalid axis: ${s}`);if(this.axis.length!==th(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(s=>t[s]),i=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,i):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,i):this.beta=null,this.built=!0}call(t,n){const r=Ct(t),i=r.shape,s=i.length;return fe(()=>{let{mean:a,variance:u}=LF(r,this.axis,!0);const l=um(1,s);for(const m of this.axis)l[m]=i[m];const c=m=>m!=null&&m.shape.length!==s?ie(m,l):m;let f=this.scale?c(this.gamma.read()):null,d=this.center?c(this.beta.read()):null;const h=[],p=[];for(let m=0;m<s;++m)this.axis.indexOf(m)!==-1?(h.push(i[m]),p.push(1)):(h.push(1),p.push(i[m]));return a=Ea(a,h),u=Ea(u,h),f!=null&&(f=Ea(f,p)),d!=null&&(d=Ea(d,p)),Qw(r,a,u,d,f,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Jn(this.betaInitializer),gammaInitializer:Jn(this.gammaInitializer),betaRegularizer:En(this.betaRegularizer),gammaRegularizer:En(this.gammaRegularizer)},n=super.getConfig();return Object.assign(t,n),t}}che.className="LayerNormalization";Ae(che);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function S6e(e,t,n){return fe(()=>{if(e.rank!==4)throw new ne(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new ne("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Bu()),n!=="channelsLast"&&n!=="channelsFirst")throw new ne(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],t[0],t[1]]:r=[[0,0],t[0],t[1],[0,0]],tp(e,r)})}class fhe extends Lt{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?Bu():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new ne(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let n,r;if(typeof t.padding[0]=="number")n=[t.padding[0],t.padding[0]],r=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new ne(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(n=t.padding[0],t.padding[1].length!==2)throw new ne(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);r=t.padding[1]}this.padding=[n,r]}this.inputSpec=[new Fr({ndim:4})]}computeOutputShape(t){t=en(t);let n,r;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?n=t[2]+this.padding[0][0]+this.padding[0][1]:n=null,t[3]!=null&&t[3]>=0?r=t[3]+this.padding[1][0]+this.padding[1][1]:r=null,[t[0],t[1],n,r]):(t[1]!=null&&t[1]>=0?n=t[1]+this.padding[0][0]+this.padding[0][1]:n=null,t[2]!=null&&t[2]>=0?r=t[2]+this.padding[1][0]+this.padding[1][1]:r=null,[t[0],n,r,t[3]])}call(t,n){return fe(()=>S6e(Ct(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}fhe.className="ZeroPadding2D";Ae(fhe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function m3(e,t,n,r,i,s){return fe(()=>{xr(i),_fe(s),ca(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=Bu()),s==null&&(s="max"),e=MU(e,i);let o;const a=r==="same"?"same":"valid";return s==="max"?o=MF(e,t,n,a):o=AF(e,t,n,a),i==="channelsFirst"&&(o=Vt(o,[0,3,1,2])),o})}function dhe(e,t,n,r,i,s){return fe(()=>{xr(i),_fe(s),ca(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Bu()),s==null&&(s="max"),e=Ide(e,i);let o;const a=r==="same"?"same":"valid";return s==="max"?o=ace(e,t,n,a):o=Fle(e,t,n,a),i==="channelsFirst"&&(o=Vt(o,[0,4,1,2,3])),o})}class hhe extends Lt{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new ne(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(Gr(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new ne(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);Gr(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,ca(this.padding),this.inputSpec=[new Fr({ndim:3})]}computeOutputShape(t){t=en(t);const n=Iu(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return fe(()=>{this.invokeCallHook(t,n),t=TS(Ct(t),2);const r=this.poolingFunction(Ct(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Vm(r,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}}class phe extends hhe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return xr(s),ca(i),m3(t,n,r,i,s,"max")}}phe.className="MaxPooling1D";Ae(phe);class ghe extends hhe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return xr(s),ca(i),m3(t,n,r,i,s,"avg")}}ghe.className="AveragePooling1D";Ae(ghe);class mhe extends Lt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new ne(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];Gr(this.poolSize,"poolSize"),Gr(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,xr(this.dataFormat),ca(this.padding),this.inputSpec=[new Fr({ndim:4})]}computeOutputShape(t){t=en(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=Iu(n,this.poolSize[0],this.padding,this.strides[0]),r=Iu(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r]:[t[0],n,r,t[3]]}call(t,n){return fe(()=>(this.invokeCallHook(t,n),this.poolingFunction(Ct(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class yhe extends mhe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return xr(s),ca(i),m3(t,n,r,i,s,"max")}}yhe.className="MaxPooling2D";Ae(yhe);class xhe extends mhe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return xr(s),ca(i),m3(t,n,r,i,s,"avg")}}xhe.className="AveragePooling2D";Ae(xhe);class bhe extends Lt{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new ne(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];Gr(this.poolSize,"poolSize"),Gr(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,xr(this.dataFormat),ca(this.padding),this.inputSpec=[new Fr({ndim:5})]}computeOutputShape(t){t=en(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],r=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=Iu(n,this.poolSize[0],this.padding,this.strides[0]),r=Iu(r,this.poolSize[1],this.padding,this.strides[1]),i=Iu(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,r,i]:[t[0],n,r,i,t[4]]}call(t,n){return fe(()=>(this.invokeCallHook(t,n),this.poolingFunction(Ct(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class vhe extends bhe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return xr(s),ca(i),dhe(t,n,r,i,s,"max")}}vhe.className="MaxPooling3D";Ae(vhe);class whe extends bhe{constructor(t){super(t)}poolingFunction(t,n,r,i,s){return xr(s),ca(i),dhe(t,n,r,i,s,"avg")}}whe.className="AveragePooling3D";Ae(whe);class $he extends Lt{constructor(t){super(t),this.inputSpec=[new Fr({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new Dt}}class Che extends $he{constructor(t){super(t||{})}call(t,n){return fe(()=>{const r=Ct(t);return ar(r,1)})}}Che.className="GlobalAveragePooling1D";Ae(Che);class She extends $he{constructor(t){super(t||{})}call(t,n){return fe(()=>{const r=Ct(t);return Ma(r,1)})}}She.className="GlobalMaxPooling1D";Ae(She);class khe extends Lt{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,xr(this.dataFormat),this.inputSpec=[new Fr({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new Dt}getConfig(){const t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class Ehe extends khe{call(t,n){return fe(()=>{const r=Ct(t);return this.dataFormat==="channelsLast"?ar(r,[1,2]):ar(r,[2,3])})}}Ehe.className="GlobalAveragePooling2D";Ae(Ehe);class Ahe extends khe{call(t,n){return fe(()=>{const r=Ct(t);return this.dataFormat==="channelsLast"?Ma(r,[1,2]):Ma(r,[2,3])})}}Ahe.className="GlobalMaxPooling2D";Ae(Ahe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _he extends Lt{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,r={}){const i=n.layer,s=Rl(i,r);delete n.layer;const o={layer:s};return Object.assign(o,n),new t(o)}}class The extends _he{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=en(t),t.length<3)throw new ne(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=en(t);const n=[t[0]].concat(t.slice(2)),r=this.layer.computeOutputShape(n),i=t[1];return[r[0],i].concat(r.slice(1))}call(t,n){return fe(()=>(t=Ct(t),Bde((o,a)=>[Ct(this.layer.call(o,n)),[]],t,[],!1,null,null,!1,!0)[1]))}}The.className="TimeDistributed";Ae(The);function k6e(e){Gm(jBe,"BidirectionalMergeMode",e)}const E6e="concat";class Ihe extends _he{constructor(t){super(t);const n=t.layer.getConfig(),r={};r.className=t.layer.getClassName(),r.config=n,this.forwardLayer=Rl(r),n.goBackwards=n.goBackwards!==!0;const i={};if(i.className=t.layer.getClassName(),i.config=n,this.backwardLayer=Rl(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?E6e:t.mergeMode,k6e(this.mergeMode),t.weights)throw new Dt("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const n=t.length,r=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,r)),this.backwardLayer.setWeights(t.slice(r))}computeOutputShape(t){let n=this.forwardLayer.computeOutputShape(t);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,i,s;return this.returnState&&(s=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):this.mergeMode==null?i=[r,r.slice()]:i=[r],this.returnState?this.mergeMode==null?i.concat(s).concat(s.slice()):[r].concat(s).concat(s.slice()):Ms(i)}apply(t,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const s=Pde(t,r,i,this.numConstants);if(t=s.inputs,r=s.initialState,i=s.constants,Array.isArray(t)&&(r=t.slice(1),t=t[0]),(r==null||r.length===0)&&i==null)return super.apply(t,n);const o=[],a=[];if(r!=null){const l=r.length;if(l%2>0)throw new ne("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,o.push(...r);const c=r.map(f=>new Fr({shape:f.shape}));this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),a.push(...c)}if(i!=null)throw new Dt("Support for constants in Bidirectional layers is not implemented yet.");const u=o[0]instanceof Gl;for(const l of o)if(l instanceof Gl!==u)throw new ne("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(u){const l=[t].concat(o),c=this.inputSpec.concat(a),f=this.inputSpec;this.inputSpec=c;const d=super.apply(l,n);return this.inputSpec=f,d}else return super.apply(t,n)}call(t,n){return fe(()=>{const r=n.initialState;let i,s;if(r==null)i=this.forwardLayer.call(t,n),s=this.backwardLayer.call(t,n);else{const u=r.slice(0,r.length/2),l=r.slice(r.length/2);i=this.forwardLayer.call(t,Object.assign(n,{initialState:u})),s=this.backwardLayer.call(t,Object.assign(n,{initialState:l}))}let o;this.returnState&&(Array.isArray(i)&&(o=i.slice(1).concat(s.slice(1))),i=i[0],s=s[0]),this.returnSequences&&(s=Ba(s,1));let a;return this.mergeMode==="concat"?a=CU([i,s]):this.mergeMode==="sum"?a=Ee(i,s):this.mergeMode==="ave"?a=ee(.5,Ee(i,s)):this.mergeMode==="mul"?a=ee(i,s):this.mergeMode==null&&(a=[i,s]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Lg(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),Lg(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const s=this.forwardLayer.states.map(o=>null);return Array.isArray(r)?r.concat(s).concat(s):[r].concat(s).concat(s)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,n){const r=Rl(n.layer);if(delete n.layer,n.numConstants!=null)throw new Dt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=n;return i.layer=r,new t(i)}}Ihe.className="Bidirectional";Ae(Ihe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Nhe extends Lt{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return fe(()=>(t=Ct(t),t.dtype!=="float32"&&(t=Dl(t,"float32")),Ee(ee(t,this.scale),this.offset)))}}Nhe.className="Rescaling";Ae(Nhe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:A6e,cropAndResize:_6e}=El;class Dhe extends Lt{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,n,r,i,s,o,a,u){return fe(()=>{let l,c=!1;const f=n/o,d=r/a,h=(i+n)/o,p=(s+r)/a,m=[f,d,h,p],x=[];t.rank===3?(c=!0,l=Lu([t])):l=t;for(let S=0;S<l.shape[0];S++)x.push(m);const b=Jd(x,[x.length,4]),v=oy(0,x.length,1,"int32"),C=_6e(l,b,v,[i,s],"nearest");return Dl(c?Ct(gh(C)):C,u)})}upsize(t,n,r,i){return fe(()=>{const s=A6e(t,[n,r]);return Dl(s,i)})}call(t,n){return fe(()=>{const r=Ct(t),i=r.dtype,s=r.shape,o=s[s.length-3],a=s[s.length-2];let u=0;o!==this.height&&(u=Math.floor((o-this.height)/2));let l=0;return a!==this.width&&(l=Math.floor((a-this.width)/2),l===0&&(l=1)),u>=0&&l>=0?this.centerCrop(r,u,l,this.height,this.width,o,a,i):this.upsize(t,this.height,this.width,i)})}getConfig(){const t={height:this.height,width:this.width},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=en(t);const n=t.length-3,r=t.length-2;return t[n]=this.height,t[r]=this.width,t}}Dhe.className="CenterCrop";Ae(Dhe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function T6e(e,t,n,r){let i=Ct(e);if(i.dtype!=="int32"&&(i=Dl(i,"int32")),t==="int")return i;const s=i.shape;if(i.rank===0&&(i=us(i,-1)),t==="oneHot"&&i.shape[i.shape.length-1]!==1&&(i=us(i,-1)),i.rank>2)throw new ne(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${s} which would result in output rank ${i.rank}.`);const o=["multiHot","oneHot"].includes(t),a=i;let u;if(typeof r<"u"&&t==="count"?u=b6(a,r,n,o):u=b6(a,[],n,o),t!=="tfIdf")return u;if(r)return ee(u,r);throw new ne("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Fhe extends Lt{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){return t=en(t),t==null?[this.numTokens]:this.outputMode==="oneHot"&&t[t.length-1]!==1?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,n){return fe(()=>{t=Ct(t),t.dtype!=="int32"&&(t=Dl(t,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new ne(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=Ct(n.countWeights)}const i=Ma(t),s=Ww(t),o=Uo(this.numTokens,i).bufferSync().get(0),a=ep(s,0).bufferSync().get(0);if(!(o&&a))throw new ne(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return T6e(t,this.outputMode,this.numTokens,r)})}}Fhe.className="CategoryEncoding";Ae(Fhe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const I6e=["bilinear","nearest"],KZ=new Set(I6e);class Rhe extends Lt{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation)if(KZ.has(t.interpolation))this.interpolation=t.interpolation;else throw new ne(`Invalid interpolation parameter: ${t.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!t.cropToAspectRatio}computeOutputShape(t){t=en(t);const n=t[2];return[this.height,this.width,n]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return fe(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return El.resizeBilinear(t,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return El.resizeNearestNeighbor(t,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...KZ]} are supported`)})}}Rhe.className="Resizing";Ae(Rhe);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ohe{constructor(t){this.seed=t}next(){if(this.seed!==void 0)return this.seed++}}Ohe.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Mhe extends Lt{constructor(t){super(t),this.randomGenerator=new Ohe(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(t,n),t}}Mhe.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const N6e=["bilinear","nearest"],QZ=new Set(N6e);class Lhe extends Mhe{constructor(t){super(t);const{factor:n,interpolation:r="bilinear"}=t;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new ne(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new ne(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new ne(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(QZ.has(r))this.interpolation=r;else throw new ne(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}computeOutputShape(t){t=en(t);const n=t[2];return[this.imgHeight,-1,n]}call(t,n){return fe(()=>{const r=Ct(t);this.imgHeight=r.shape[r.shape.length-3];const i=r.shape[r.shape.length-2];this.widthFactor=Wm([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let s=this.widthFactor.dataSync()[0]*i;s=Math.round(s);const o=[this.imgHeight,s];switch(this.interpolation){case"bilinear":return El.resizeBilinear(t,o);case"nearest":return El.resizeNearestNeighbor(t,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...QZ]} are supported`)}})}}Lhe.className="RandomWidth";Ae(Lhe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function D6e(e){return new jU(e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F6e=ce();F6e.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var ZZ;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(ZZ||(ZZ={}));var JZ;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(JZ||(JZ={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function R6e(e,t){return Phe(e,t)}function Phe(e,t,n=new Map,r=new Set){if(e==null)return null;if(typeof Blob=="function"&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);const i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse)if(y3(e)){const s=Array.isArray(e)?[]:{};r.add(e);for(const o in e){const a=e[o],u=Phe(a,t,n,r);s[o]=u}return r.delete(e),e.__proto__&&(s.__proto__=e.__proto__),s}else throw new Error(`Can't recurse into non-iterable type: ${e}`);else return n.set(e,i.value),i.value}function O6e(e,t=zhe){return Bhe(e,t)}function Bhe(e,t,n=new Set){const r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");const i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse)if(y3(r)){const s=Array.isArray(r)?[]:{};n.add(r);for(const o in r){const a=e.map(l=>l[o]),u=Bhe(a,t,n);s[o]=u}return n.delete(r),s}else throw new Error(`Can't recurse into non-iterable type: ${r}`);else return i.value}function zhe(e){return e===null?null:y3(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function y3(e){let t=!1;if(ce().get("IS_BROWSER"))t=e instanceof TextDecoder;else{const{StringDecoder:n}=require("string_decoder");t=e instanceof n}return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof nn)&&!(e instanceof Promise)&&!t)}function M6e(e){return e==null||L6e(e)||Array.isArray(e)||typeof e=="object"&&e instanceof nn||Ir(e)}function L6e(e){return e===null||typeof e!="object"&&typeof e!="function"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function P6e(e){return R6e(e,B6e)}function B6e(e){return e instanceof nn?{value:e.clone(),recurse:!1}:y3(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Uhe{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,n){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=n}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const n of t)this.push(n)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const n=this.wrap(this.begin+t),r=this.get(n);return this.set(n,this.pop()),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class x3 extends Uhe{constructor(){super(x3.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=this.capacity*2,n=new Array(t),r=this.length();for(let i=0;i<r;i++)n[i]=this.get(this.wrap(this.begin+i));this.data=n,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=r}}x3.INITIAL_CAPACITY=32;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function z6e(e){return new W6e(e)}function U6e(e){return new V6e(e)}function j6e(e,t){return new jhe(e,t)}class fa{async toArray(){const t=[];let n=await this.next();for(;!n.done;)t.push(n.value),n=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),n=[];let r=await t.next();for(;!r.done;)n.push(r.value),r=await t.next();return n}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let n=await this.next(),r=t(n.value);for(;!n.done&&r;)n=await this.next(),r=t(n.value)}handleErrors(t){return new Q6e(this,t)}filter(t){return new Y6e(this,t)}map(t){return new K6e(this,t)}mapAsync(t){return new eJ(this,t)}serialMapAsync(t){return new eJ(this,t).serial()}flatmap(t){return new J6e(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile(n=>n===!0)}rowMajorBatch(t,n=!0){return new X6e(this,t,n)}columnMajorBatch(t,n=!0,r=zhe){return this.rowMajorBatch(t,n).map(s=>O6e(s,r))}concatenate(t,n){return new jhe(z6e([this,t]),n)}take(t){return t<0||t==null?this:new H6e(this,t)}skip(t){return t<0||t==null?this:new G6e(this,t)}prefetch(t){return new Whe(this,t)}shuffle(t,n){return new eze(this,t,n)}serial(){return new q6e(this)}}class W6e extends fa{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:P6e(t),done:!1}}}class V6e extends fa{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message=`Error thrown while iterating through a dataset: ${t.message}`,t}}}class q6e extends fa{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class G6e extends fa{constructor(t,n){super(),this.upstream=t,this.maxCount=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;Tt(t.value)}return this.upstream.next()}}class H6e extends fa{constructor(t,n){super(),this.upstream=t,this.maxCount=n,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class X6e extends fa{constructor(t,n,r=!0){super(),this.upstream=t,this.batchSize=n,this.enableSmallLastBatch=r,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const n=await this.upstream.next();if(n.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(n.value)}return{value:t,done:!1}}}class Y6e extends fa{constructor(t,n){super(),this.upstream=t,this.predicate=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;Tt(t.value)}}}class K6e extends fa{constructor(t,n){super(),this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> Map`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const n=kf(t.value),r=this.transform(t.value),i=kf(r);for(const s of n)EF(s,i)||s.dispose();return{value:r,done:!1}}}class Q6e extends fa{constructor(t,n){super(),this.upstream=t,this.handler=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class eJ extends fa{constructor(t,n){super(),this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const n=kf(t.value),r=await this.transform(t.value),i=kf(r);for(const s of n)EF(s,i)||s.dispose();return{value:r,done:!1}}}class Z6e extends fa{constructor(){super(),this.outputQueue=new x3,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class J6e extends Z6e{constructor(t,n){super(),this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const t=await this.upstream.next();if(t.done)return!1;const n=kf(t.value),r=this.transform(t.value),i=kf(r);this.outputQueue.pushAll(r);for(const s of n)EF(s,i)||s.dispose();return!0}}class jhe extends fa{constructor(t,n){super(),this.baseErrorHandler=n,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,this.iterator==null){const r=await this.moreIterators.next();if(r.done)return{value:null,done:!0};this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const n=await this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(t)):n}}var tJ;(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(tJ||(tJ={}));class Whe extends fa{constructor(t,n){super(),this.upstream=t,this.bufferSize=n,this.buffer=new Uhe(n)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class eze extends Whe{constructor(t,n,r){super(t,n),this.upstream=t,this.windowSize=n,this.upstreamExhausted=!1,this.random=ib.alea(r||ci().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),n=await this.buffer.shuffleExcise(t);if(n.done)this.upstreamExhausted=!0;else return this.refill(),n}return{value:null,done:!0}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Vhe{constructor(){this.size=null}batch(t,n=!0){const r=this;U(t>0,()=>`batchSize needs to be positive, but it is
      ${t}`);let i;return this.size===1/0||this.size==null?i=this.size:n?i=Math.ceil(this.size/t):i=Math.floor(this.size/t),cl(async()=>(await r.iterator()).columnMajorBatch(t,n,tze),i)}concatenate(t){const n=this;let r;return this.size===1/0||t.size===1/0?r=1/0:this.size!=null&&t.size!=null?r=this.size+t.size:r=null,cl(async()=>(await n.iterator()).concatenate(await t.iterator()),r)}filter(t){const n=this;let r;return this.size===1/0?r=1/0:r=null,cl(async()=>(await n.iterator()).filter(i=>fe(()=>t(i))),r)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const n=this;return cl(async()=>(await n.iterator()).map(r=>fe(()=>t(r))),this.size)}mapAsync(t){const n=this;return cl(async()=>(await n.iterator()).mapAsync(t),this.size)}prefetch(t){if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const n=this;return cl(async()=>(await n.iterator()).prefetch(t),this.size)}repeat(t){const n=this;let r;return this.size!=null&&t>0?r=this.size*t:t===0?r=0:this.size!=null&&(t===void 0||t<0)?r=1/0:r=null,cl(async()=>{const i=U6e(async()=>({value:await n.iterator(),done:!1}));return j6e(i.take(t))},r)}skip(t){const n=this;let r;return this.size!=null&&t>=0&&this.size>=t?r=this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?r=0:r=null,cl(async()=>(await n.iterator()).skip(t),r)}shuffle(t,n,r=!0){if(t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const i=this,s=ib.alea(n||ci().toString());return cl(async()=>{let o=s.int32();return r&&(o+=s.int32()),(await i.iterator()).shuffle(t,o.toString())},this.size)}take(t){const n=this;let r;return this.size!=null&&this.size>t?r=t:this.size!=null&&this.size<=t?r=this.size:r=null,cl(async()=>(await n.iterator()).take(t),r)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}Vhe.MAX_BUFFER_SIZE=1e4;function cl(e,t=null){return new class extends Vhe{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function tze(e){if(e===null)return null;const t=e[0];return M6e(t)?{value:nze(e),recurse:!1}:{value:null,recurse:!0}}function nze(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof nn?Lu(e):Jd(e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qe(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&U(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rze=GF;class b3 extends gD{nextDataId(){return b3.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new q7(this,gu())}write(t,n,r){this.firstUse&&(this.firstUse=!1,ce().get("IS_NODE")&&Qo(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const i={id:this.nextDataId()};return this.data.set(i,{values:t,dtype:r,refCount:1}),i}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&kl(r[0])){const s=r.map(o=>Tl(o));i=this.write(s,t,n)}else i=this.write(r,t,n);return{dataId:i,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,r,i,s){this.data.set(t,{values:n,dtype:i,refCount:s})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:n,complexTensorInfos:r}=this.data.get(t);if(n==="complex64"){const i=this.readSync(r.real.dataId),s=this.readSync(r.imag.dataId);return Af(i,s)}return Wue(this.data.get(t).values,n)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const r=n.map(i=>Sf(i));return Ft(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ft(t.shape,t.dtype,n)}makeOutput(t,n,r){return gu().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(t);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const n=ci();return t(),{kernelMs:ci()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Qe([t],"where");const n=this.readSync(t.dataId);return rze(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}b3.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qhe(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const ize=e=>{const{x:t}=e.inputs,n=e.backend;Qe(t,"abs");let r=new Float32Array(me(t.shape));const i=n.data.get(t.dataId).values;return r=qhe(i),n.makeOutput(r,t.shape,t.dtype)},sze={kernelName:hC,backendName:"cpu",kernelFunc:ize};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function br(e){return(t,n,r,i,s)=>{const o=At(t,n),a=o.length,u=ut(o),l=me(o),c=Zr(s,l),f=t.length,d=n.length,h=ut(t),p=ut(n),m=sm(t,o),x=sm(n,o);if(m.length+x.length===0)for(let b=0;b<c.length;++b)c[b]=e(r[b%r.length],i[b%i.length]);else for(let b=0;b<c.length;++b){const v=zm(b,a,u),$=v.slice(-f);m.forEach(E=>$[E]=0);const C=_u($,f,h),S=v.slice(-d);x.forEach(E=>S[E]=0);const A=_u(S,d,p);c[b]=e(r[C],i[A])}return[c,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xo(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),u=n.data.get(a.dataId);return u.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",s),imag:n.makeTensorInfo(i.shape,"float32",o)},a}const oze={kernelName:kD,backendName:"cpu",kernelFunc:xo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rI(e,t,n="float32"){if(n==="complex64"){const i=rI(e,t,"float32"),s=rI(e,t,"float32");return xo({inputs:{real:i,imag:s},backend:e})}const r=vi(me(t),n);return e.makeTensorInfo(t,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hl(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const aze={kernelName:Ax,backendName:"cpu",kernelFunc:Hl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lm(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const uze={kernelName:iF,backendName:"cpu",kernelFunc:lm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(e,t,n,r){if(r==="int32"){const i=Int32Array.from(e);return[t,"int32",i]}if(r==="bool"){const i=Kh([0],n),[s,o]=br((a,u)=>a!==u?1:0)(t,[],e,i,"bool");return[o,"bool",s]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function vh(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return Hl({inputs:{x:i},backend:n});const c=rI(n,i.shape,i.dtype),f=vh({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),d=xo({inputs:{real:f,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),d}if(i.dtype==="complex64"){const c=lm({inputs:{input:i},backend:n}),f=vh({inputs:{x:c},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(c),f}if(!X7(i.dtype,s)){const c=Hl({inputs:{x:i},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:s}}const o=n.data.get(i.dataId).values,[a,u,l]=Ghe(o,i.shape,i.dtype,s);return n.makeTensorInfo(a,u,l)}const lze={kernelName:px,backendName:"cpu",kernelFunc:vh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pr(e,t,n,r){return n==null?({inputs:i,backend:s})=>{const{a:o,b:a}=i,u=s;Qe([o,a],e);const l=u.data.get(o.dataId).values,c=u.data.get(a.dataId).values,f=o.dtype==="string"?_f(l):l,d=o.dtype==="string"?_f(c):c,h=r||o.dtype,[p,m]=t(o.shape,a.shape,f,d,h);return u.makeTensorInfo(m,h,p)}:({inputs:i,backend:s})=>{const{a:o,b:a}=i,u=s;if(o.dtype==="complex64"||a.dtype==="complex64"){const l=vh({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),c=u.data.get(l.dataId),f=c.complexTensorInfos.real,d=c.complexTensorInfos.imag,h=u.data.get(f.dataId).values,p=u.data.get(d.dataId).values,m=vh({inputs:{x:a},backend:u,attrs:{dtype:"complex64"}}),x=u.data.get(m.dataId),b=x.complexTensorInfos.real,v=x.complexTensorInfos.imag,$=u.data.get(b.dataId).values,C=u.data.get(v.dataId).values,[S,A,E]=n(o.shape,a.shape,h,p,$,C),_=u.makeTensorInfo(E,"float32",S),D=u.makeTensorInfo(E,"float32",A),N=xo({inputs:{real:_,imag:D},backend:u});return u.disposeIntermediateTensorInfo(l),u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(_),u.disposeIntermediateTensorInfo(D),N}else{const l=u.data.get(o.dataId).values,c=u.data.get(a.dataId).values,f=r||o.dtype,[d,h]=t(o.shape,a.shape,l,c,f);return u.makeTensorInfo(h,f,d)}}}function WU(e){return(t,n,r,i,s,o)=>{const a=At(t,n),u=me(a),l=a.length,c=ut(a),f=Zr("float32",u),d=Zr("float32",u),h=sm(t,a),p=sm(n,a),m=Af(r,i),x=Af(s,o),b=t.length,v=ut(t),$=n.length,C=ut(n);if(h.length+p.length===0)for(let S=0;S<f.length;S++){const A=S%m.length,E=S%x.length,_=e(m[A*2],m[A*2+1],x[E*2],x[E*2+1]);f[S]=_.real,d[S]=_.imag}else for(let S=0;S<f.length;S++){const A=zm(S,l,c),E=A.slice(-b);h.forEach(L=>E[L]=0);const _=_u(E,b,v),D=A.slice(-$);p.forEach(L=>D[L]=0);const N=_u(D,$,C),T=e(m[_*2],m[_*2+1],x[N*2],x[N*2+1]);f[S]=T.real,d[S]=T.imag}return[f,d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hhe=br((e,t)=>e+t),cze=WU((e,t,n,r)=>({real:e+n,imag:t+r})),uy=Pr(Um,Hhe,cze),fze={kernelName:Um,backendName:"cpu",kernelFunc:uy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VU(e,t,n,r,i){const s=me(r),o=vi(i,n);for(let a=0;a<e.length;a++){const u=e[a];if(u<0)throw new Error("Input x must be non-negative!");u>=i||(s>0?o[u]+=t[a]:o[u]+=1)}return o}function Xhe(e,t,n,r=!1){const i=e.shape[0],s=e.shape[1],o=Ft([i,n],t.dtype);for(let a=0;a<i;a++)for(let u=0;u<s;u++){const l=e.get(a,u);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(r?o.set(1,a,l):t.size>0?o.set(o.get(a,l)+t.get(a,u),a,l):o.set(o.get(a,l)+1,a,l))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yhe=br((e,t)=>e&t),dze=Pr(wC,Yhe),hze={kernelName:wC,backendName:"cpu",kernelFunc:dze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lc(e){return(t,n,r)=>{const i=ur(n,t.length);for(let s=0;s<t.length;++s)i[s]=e(t[s],r);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bn(e,t,n){const r=lc(t);return ip(e,r,n)}function ip(e,t,n){return({inputs:r,attrs:i,backend:s})=>{const{x:o}=r;Qe(o,e);const a=s,u=a.data.get(o.dataId).values;let l;if(o.dtype==="string"){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");l=_f(u)}else l=u;const c=n||o.dtype,f=t(l,c,i);return a.makeTensorInfo(o.shape,c,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Khe=lc(e=>Math.ceil(e)),pze=ip(gx,Khe),gze={kernelName:gx,backendName:"cpu",kernelFunc:pze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qhe(e,t,n,r){const i=ur(n,me(t));if(r&&n!=="string"){let s=0;e.forEach(o=>{const a=me(o.shape);i.set(o.vals,s),s+=a})}else{let s=0;e.forEach(o=>{const a=n==="string"?_f(o.vals):o.vals;let u=0;for(let l=0;l<o.shape[0];++l){const c=l*t[1]+s;for(let f=0;f<o.shape[1];++f)i[c+f]=a[u++]}s+=o.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zhe=br((e,t)=>e===t?1:0),Jhe=Pr(IC,Zhe,null,"bool"),mze={kernelName:IC,backendName:"cpu",kernelFunc:Jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const epe=lc(e=>Math.exp(e)),tpe=ip($x,epe,"float32"),yze={kernelName:$x,backendName:"cpu",kernelFunc:tpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const npe=lc(e=>Math.expm1(e)),xze=ip(Cx,npe),bze={kernelName:Cx,backendName:"cpu",kernelFunc:xze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rpe=lc(e=>Math.floor(e)),vze=ip(Sx,rpe),wze={kernelName:Sx,backendName:"cpu",kernelFunc:vze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ipe=br((e,t)=>Math.floor(e/t)),$ze=Pr(kx,ipe,null,"int32"),Cze={kernelName:kx,backendName:"cpu",kernelFunc:$ze};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function spe(e,t,n,r,i,s,o,a,u){const l=Ft([r,s],n);for(let c=0;c<r;c++){const f=[];let d=0;for(let h=0;h<i;h++){const p=e[c*i+h];d+=p*o[h],f.push(p)}if(d<0||d>=u/s)throw new Error(`Invalid indices: ${f} does not index into ${a}`);for(let h=0;h<s;h++)l.values[c*s+h]=t.get(...t.indexToLoc(d*s+h))}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ope(e,t,n){const r=Ft(n,e.dtype);for(let i=0;i<r.size;++i){const o=r.indexToLoc(i).slice(),a=o[0],u=o[2],l=t.locToIndex([a,u]);o[2]=t.values[l];const c=e.locToIndex(o);0<=c&&c<e.values.length&&(r.values[i]=e.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ape=br((e,t)=>e>t?1:0),Sze=Pr(RC,ape,null,"bool"),kze={kernelName:RC,backendName:"cpu",kernelFunc:Sze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const upe=br((e,t)=>e>=t?1:0),Eze=Pr(Ex,upe,null,"bool"),Aze={kernelName:Ex,backendName:"cpu",kernelFunc:Eze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lpe=br((e,t)=>e<t?1:0),_ze=Pr(MC,lpe,null,"bool"),Tze={kernelName:MC,backendName:"cpu",kernelFunc:_ze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cpe=br((e,t)=>e<=t?1:0),Ize=Pr(LC,cpe,null,"bool"),Nze={kernelName:LC,backendName:"cpu",kernelFunc:Ize};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fpe(e,t,n){const r=(t-e)/(n-1),i=vi(n,"float32");i[0]=e;for(let s=1;s<i.length;s++)i[s]=i[s-1]+r;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dpe=lc(e=>Math.log(e)),Dze=ip(Nx,dpe),Fze={kernelName:Nx,backendName:"cpu",kernelFunc:Dze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hpe(e,t,n,r){const i=Zr(r,me(n));for(let s=0;s<i.length;++s){const o=s*t;let a=e[o];for(let u=0;u<t;++u){const l=e[o+u];(Number.isNaN(l)||l>a)&&(a=l)}i[s]=a}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ppe=br((e,t)=>Math.max(e,t)),Rze=Pr(Fx,ppe),Oze={kernelName:Fx,backendName:"cpu",kernelFunc:Rze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gpe=br((e,t)=>Math.min(e,t)),Mze=Pr(Rx,gpe),Lze={kernelName:Rx,backendName:"cpu",kernelFunc:Mze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qU=br((e,t)=>e*t),Pze=WU((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),v3=Pr(Mx,qU,Pze),Bze={kernelName:Mx,backendName:"cpu",kernelFunc:v3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mpe(e,t,n){const r=Pf(-1,n);return qU([],t,r,e,n)}function zze(e){const{inputs:t,backend:n}=e,{x:r}=t;Qe(r,"neg");const i=n.data.get(r.dataId).values,[s,o]=mpe(i,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,s)}const Uze={kernelName:XC,backendName:"cpu",kernelFunc:zze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ype=br((e,t)=>e!==t?1:0),jze=Pr(YC,ype,null,"bool"),Wze={kernelName:YC,backendName:"cpu",kernelFunc:jze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GU(e,t,n,r,i){const s=t.length,o=me(t),a=ut(t),u=ut(i),l=Zr(n,me(i));for(let c=0;c<o;++c){const f=zm(c,s,a),d=new Array(f.length);for(let p=0;p<d.length;p++)d[p]=f[r[p]];const h=_u(d,s,u);l[h]=e[c]}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xs(e){const{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:s}=n;Qe(i,"transpose");const o=i.shape.length,a=new Array(o);for(let f=0;f<a.length;f++)a[f]=i.shape[s[f]];const u=r.data.get(i.dataId).values,l=GU(u,i.shape,i.dtype,s,a);return{dataId:r.write(l,a,i.dtype),shape:a,dtype:i.dtype}}const Vze={kernelName:Mg,backendName:"cpu",kernelFunc:Xs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xpe(e,t,n,r){const[i,s]=ei(e,r),o=Gs(t,"int32"),a=vi(me(i),o),u=me(s);for(let l=0;l<a.length;++l){const c=l*u;let f=1;for(let d=0;d<u;++d)f*=n[c+d];a[l]=f}return{outVals:a,outShape:i,outDtype:o}}function qze(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;Qe(i,"prod");const a=i.shape.length,u=Ot(s,i.shape),l=nr(u,a);let c=u,f=i;const d=[];l!=null&&(f=Xs({inputs:{x:i},backend:n,attrs:{perm:l}}),d.push(f),c=yr(c.length,a));const h=n.data.get(f.dataId).values,{outVals:p,outShape:m,outDtype:x}=xpe(f.shape,f.dtype,h,c);let b=m;return o&&(b=mr(m,u)),d.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(b,x,p)}const Gze={kernelName:tS,backendName:"cpu",kernelFunc:qze};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hze(e,t,n){e.forEach((r,i)=>{if(r<0||r>=n){const s=zm(i,t.length,ut(t)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${n})`)}})}function Xze(e,t){for(let n=0;n<e.length;++n){const r=e[n],i=n===e.length-1?t:e[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function Yze(e,t,n,r){const i=[];let s=0;const o=t.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);Xze(n,r);let u=1;for(let l=0;l<t.length-1;++l){u*=t[l];const c=t[l+1];for(let f=1;f<u+1;++f)a[l].push(f*c)}for(let l=0;l<e.length;++l){let c=e[l],f=e[l]+1;for(let d=0;d<n.length;++d){const h=n[d],p=d+t.length-1;if(p>=0){const m=a[p],x=m[m.length-1]-h[c];for(let b=c;b<f;++b)a[p].push(h[b+1]+x)}c=h[c],f=h[f]}f!==c&&(i.push([c,f]),s+=f-c)}return{outSplits:a,valueSlices:i,numValues:s}}function Kze(e){const t=[];for(let n=0;n<e.length;++n){const r=e[n].length,i=ur("int32",r);t.push(i),e[n].forEach((s,o)=>i[o]=s)}return t}function nJ(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function Qze(e,t,n,r,i,s){const o=nJ(t,2)[1],a=nJ(s,2)[1];let u=0;for(const l of n)for(let c=l[0];c<l[1];++c){for(let f=0;f<r;++f)i[u*a+f]=e[c*o+f];++u}}function Zze(e,t,n,r,i){const s=t.slice();s[0]=i;const o=ur(n,me(s)),a=e.length,u=a===0?0:a/t[0];return Qze(e,t,r,u,o,s),[o,s]}function bpe(e,t,n,r,i,s,o,a){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const u=t[0][0]-1;if(Hze(s,o,u),r.length===0)throw new Error("params.rank must be nonzero");const l=r[0],{outSplits:c,valueSlices:f,numValues:d}=Yze(s,o,e,l),h=Kze(c),p=Zze(n,r,i,f,d);return[h,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rJ=2147483647;function vpe(e,t,n,r,i,s,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=t.length===0,u=i.length===0,l=o.length===0,c=[];a||c.push(t[0]),u||c.push(i[0]),l||c.push(o[0]);for(let x=1;x<c.length;++x)if(c[x]!==c[x-1])throw new Error("starts, limits, and deltas must have the same shape");const f=c.length===0?1:c[0],d=ur("int32",f+1);d[0]=0;for(let x=0;x<f;++x){const b=a?e[0]:e[x],v=u?r[0]:r[x],$=l?s[0]:s[x];if($===0)throw new Error("Requires delta != 0");let C;if($>0&&v<b||$<0&&v>b)C=0;else if(C=Math.ceil(Math.abs((v-b)/$)),C>rJ)throw new Error(`Requires ((limit - start) / delta) <= ${rJ}`);d[x+1]=d[x]+C}const h=d[f],p=ur(n,h);let m=0;for(let x=0;x<f;++x){const b=d[x+1]-d[x];let v=a?e[0]:e[x];const $=l?s[0]:s[x];for(let C=0;C<b;++C)p[m++]=v,v+=$}return[d,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var va=xu;class iI{constructor(t,n,r,i,s,o,a,u,l,c){this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=i,this.valuesDType=s,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=u,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=Zce(c),this.raggedRank=Jce(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===va.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===va.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case va.VALUE_ROWIDS:return iI.getMaxWidthValueRowID(n);case va.ROW_SPLITS:return iI.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${va[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const n=t.length;if(n===0||n===1)return 0;let r=0;for(let i=0;i<n-1;++i){const s=t[i+1]-t[i];s>r&&(r=s)}return r}static getMaxWidthValueRowID(t){const n=t.length;if(n===0)return 0;let r=0,i=t[0],s=0;for(let o=1;o<n;++o){const a=t[o];a!==i&&(i=a,s=Math.max(o-r,s),r=o)}return Math.max(n-r,s)}tensorShapeFromTensor(t,n,r=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return sJ(t,r)}calculateOutputSize(t){const n=this.valuesShape,r=this.defaultValueShape;efe(r,n);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=Qce(this.raggedRank,i,n);o[0]<0&&(o[0]=t);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(t,n,r){const i=Math.min(t,r),s=[];let o=0;for(let a=0;a<i;++a,o+=n)s.push(o);for(let a=i;a<t;++a)s.push(-1);return U(s.length===t,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(t,n,r,i){const s=t.length,o=[];for(let a=0;a<s-1;++a){const u=t[a+1]-t[a];let l=Math.min(i,u),c=n[a];c===-1&&(l=0);for(let f=0;f<l;++f)o.push(c),c+=r;for(let f=0;f<u-l;++f)o.push(-1)}if(s>0&&o.length!==t[s-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(t,n,r,i){const s=t.length,o=[];if(s===0)return[];let a=0,u=t[0];if(u>=n.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${n.length}`);let l=n[u];o.push(l);for(let c=1;c<s;++c){const f=t[c];if(f===u)l>=0&&(++a,a<i?l+=r:l=-1);else{if(a=0,u=f,f>=n.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${n.length}`);l=n[f]}o.push(l)}if(o.length!==t.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(t,n,r,i){const s=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case va.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,n,r,i);case va.ROW_SPLITS:if(s.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(s,n,r,i);default:throw new Error(`Unsupported partition type: ${va[o]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case va.FIRST_DIM_SIZE:return t[0];case va.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case va.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${va[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let u=i.length-2;u>=0;--u)i[u]=i[u+1]*r[u+1];const s=sJ(r,!1),o=ur(this.valuesDType,me(s));if(i[0]*r[0]>0){let u=this.calculateFirstParentOutputIndex(n,i[0],r[0]);for(let l=1;l<=this.raggedRank;++l)u=this.calculateOutputIndex(l-1,u,i[l],r[l]);this.setOutput(this.raggedRank,u,o,s)}return[s,o]}setOutput(t,n,r,i){if(r.length===0)return;const s=this.values,o=r;let a=i.slice();a=a.slice(t+1);const u=me(a),l=n.length;let c=this.defaultValue;if(c.length!==u&&c.length!==1){const p=this.defaultValueShape;fe(()=>{const m=ie(c,p);c=W1(m,a).dataSync()})}let f=0,d=0,h=0;for(let p=0;p<=l;++p){let m=p<l?n[p]:-1;if(m===h){++h;continue}if(d<h){const x=s.subarray(f*u),b=o.subarray(d*u),v=(h-d)*u;iJ(b,x,v)}if(p>=l){const x=r.length;m=Math.floor(x/u)}if(m>h)if(this.defaultValue.length===1)o.subarray(h*u,m*u).fill(this.defaultValue[0]),h=m;else for(;m>h;){const x=o.slice(h*u);iJ(x,c,u),++h}m<0?(f=p+1,d=h):(f=p,d=h,h=d+1)}}}function iJ(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function sJ(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function wpe(e,t,n,r,i,s,o,a,u,l){return new iI(e,t,n,r,i,s,o,a,u,l).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $pe(e,t,n,r){const i=e===t,s=e<t&&n<0,o=t<e&&n>1;if(i||s||o)return vi(0,r);const a=Math.abs(Math.ceil((t-e)/n)),u=vi(a,r);t<e&&n===1&&(n=-1),u[0]=e;for(let l=1;l<u.length;l++)u[l]=u[l-1]+n;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cpe=lc(e=>1/Math.sqrt(e)),Jze=ip(jx,Cpe),e8e={kernelName:jx,backendName:"cpu",kernelFunc:Jze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ag(e,t,n,r,i,s,o,a,u,l){const c=[r/i,i],f=e.values,d=t.values;if(r===0)return Ft(n,t.dtype);const h=u instanceof Sr?u:Ft(c,t.dtype);typeof u=="string"||typeof u=="number"?h.values.fill(u):typeof u=="boolean"&&h.values.fill(+u);for(let p=0;p<s;p++){const m=[];let x=0;for(let b=0;b<o;b++){const v=f[p*o+b];m.push(v),x+=v*a[b]}if(x<0||x>=r/i)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let b=0;b<i;b++)l?h.values[x*i+b]+=d[p*i+b]:h.values[x*i+b]=t.rank===0?d[0]:d[p*i+b]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t8e=lc(e=>1/(1+Math.exp(-e))),Spe=bn(Hx,e=>1/(1+Math.exp(-e))),n8e={kernelName:Hx,backendName:"cpu",kernelFunc:Spe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kpe(e,t,n,r,i){const s=Q9(r,t,n),o=me(n),a=ut(r);if(s){const f=Z9(t,a);return i==="string"?e.slice(f,f+o):e.subarray(f,f+o)}const u=i==="string"?_f(e):e,l=Ft(r,i,u),c=Ft(n,i);for(let f=0;f<c.size;++f){const d=c.indexToLoc(f),h=d.map((p,m)=>p+t[m]);c.set(l.get(...h),...d)}return i==="string"?vfe(c.values):c.values}function cm(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,size:o}=r;Qe(i,"slice");const[a,u]=n3(i,s,o);Y9(i,a,u);const l=n.data.get(i.dataId).values,c=kpe(l,a,u,i.shape,i.dtype);return n.makeTensorInfo(u,i.dtype,c)}const r8e={kernelName:aS,backendName:"cpu",kernelFunc:cm};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Epe(e,t,n,r,i,s,o){const a=t[0],u=s[0],l=new Array(u),c=new Array(a),f=t[1];if(u===0){if(a!==0)throw new Error(afe(a));const x=ur(n,0),b=ur(i,0);return[x,[0,f],b,l,c]}let d=!0,h=0;const p=new Array(u).fill(0);for(let x=0;x<a;++x){const b=e[x*f];if(b<0)throw new Error(ufe(x,b));if(b>=u)throw new Error(lfe(x,b,u));++p[b],d=d&&b>=h,h=b}let m=!0;for(let x=0;x<u;++x){const b=p[x]===0;l[x]=b,m=m&&!b,p[x]=Math.max(p[x],1),x>0&&(p[x]+=p[x-1])}if(m&&d){const x=e,b=r;for(let v=0;v<a;++v)c[v]=v;return[x,[a,f],b,l,c]}else{const x=p[u-1],b=ur(n,x*f),v=ur(i,x),$=new Array(u).fill(0);for(let C=0;C<a;++C){const S=e[C*f],A=$[S],E=(S===0?0:p[S-1])+A;$[S]++;for(let _=0;_<f;++_)b[E*f+_]=e[C*f+_];v[E]=r[C],c[C]=E}for(let C=0;C<u;++C)if($[C]===0){const A=C===0?0:p[C-1];b[A*f+0]=C;for(let E=1;E<f;++E)b[A*f+E]=0;v[A]=o}return[b,[x,f],v,l,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ape(e,t,n,r,i){const s=me(r),o=t[0],a=i.length,u=[];let l=1,c=-1;for(let x=0;x<a;++x){const b=i[x];if(b===-1){if(c!==-1)throw new Error(cfe(c,x));c=x,u.push(1)}else{if(b<0)throw new Error(ffe(x,b));l*=b,u.push(b)}}if(c!==-1){if(l<=0)throw new Error(dfe());const x=Math.trunc(s/l);if(l*x!==s)throw new Error(hfe(r,u));u[c]=x}if(me(u)!==s)throw new Error(pfe(r,u));const d=r.length,h=[];if(d>0){h[d-1]=1;for(let x=d-2;x>=0;--x)h[x]=h[x+1]*r[x+1]}const p=[];if(a>0){p[a-1]=1;for(let x=a-2;x>=0;--x)p[x]=p[x+1]*u[x+1]}const m=ur(n,o*a);for(let x=0;x<o;++x){let b=0;for(let v=0;v<d;++v)b+=e[x*d+v]*h[v];for(let v=0;v<a;++v)m[x*a+v]=Math.trunc(b/p[v]),b%=p[v]}return[m,[o,a],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HU(e,t,n,r,i,s=!1,o=0){const a=r.length,u=[t[0],e.length/t[0]],l=u[1],f=a>0?i[a-1]+1:0;if(f<0)throw new Error(k6());const d=t.slice();d[0]=f;const h=d.reduce(($,C)=>$*C,1),p=ur(n,h);if(a===0)return f>0&&p.fill(o),[p,d];if(f<=0)throw new Error(k6());let m=0,x=1,b=0,v=i[m];for(;;){let $=0;if(x<a){if($=i[x],v===$){++x;continue}if(v>=$)throw new Error(gfe())}if(v<0||v>=f)throw new Error(mfe(v,f));v>b&&p.fill(o,b*l,v*l);for(let C=m;C<x;++C){const S=r[C];if(S<0||S>=u[0])throw new Error(yfe(C,r[C],u[0]));for(let A=0;A<l;A++)p[v*l+A]+=e[S*l+A]}if(s)for(let C=0;C<l;C++)p[v*l+C]/=x-m;if(m=x,++x,b=v+1,v=$,x>a)break}return b<f&&p.fill(o,b*l,f*l),[p,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i8e=lc(e=>Math.sqrt(e)),s8e=bn(Yx,e=>Math.sqrt(e)),o8e={kernelName:Yx,backendName:"cpu",kernelFunc:s8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _pe=br((e,t)=>{const n=e-t;return n*n}),a8e=Pr(Kx,_pe),u8e={kernelName:Kx,backendName:"cpu",kernelFunc:a8e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tpe=lc((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?"g":""),i)}),l8e=ip(dS,Tpe),c8e={kernelName:dS,backendName:"cpu",kernelFunc:l8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ipe(e,t,n,r){const i=Ft(e,t.dtype);for(let s=0;s<i.size;s++){const o=i.indexToLoc(s),a=new Array(o.length);for(let u=0;u<a.length;u++)a[u]=o[u]*n[u]+r[u];i.set(t.get(...a),...o)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f8e{constructor(t,n,r,i,s,o){this.separator=Tl(t),this.nGramWidths=n,this.leftPad=Tl(r),this.rightPad=Tl(i),this.padWidth=s,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){const r=this.getPadWidth(n);return Math.max(0,t+2*r-n+1)}createNGrams(t,n,r,i,s,o){for(let a=0;a<s;++a){const u=this.getPadWidth(o),l=Math.max(0,u-a),c=Math.max(0,u-(s-(a+1))),f=o-(l+c),d=n+(l>0?0:a-u);let h=0;h+=l*this.leftPad.length;for(let v=0;v<f;++v)h+=t[d+v].length;h+=c*this.rightPad.length;const p=l+c+f-1;h+=p*this.separator.length,r[i+a]=new Uint8Array(h);const m=r[i+a];let x=0;const b=v=>v.forEach($=>m[x++]=$);for(let v=0;v<l;++v)b(this.leftPad),b(this.separator);for(let v=0;v<f-1;++v)b(t[d+v]),b(this.separator);if(f>0){b(t[d+f-1]);for(let v=0;v<c;++v)b(this.separator),b(this.rightPad)}else{for(let v=0;v<c-1;++v)b(this.rightPad),b(this.separator);b(this.rightPad)}}}compute(t,n){const r=t.length,i=n.length;if(i>0){let u=n[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let l=1;l<i;++l){let c=n[l]>=u;if(c=c&&n[l]<=r,!c)throw new Error(`Invalid split value ${n[l]}, must be in [${u}, ${r}]`);u=n[l]}if(u!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${u}`)}const s=i-1,o=ur("int32",i);if(r===0||i===0){const u=new Array(r);for(let l=0;l<=s;++l)o[l]=0;return[u,o]}o[0]=0;for(let u=1;u<=s;++u){const l=n[u]-n[u-1];let c=0;this.nGramWidths.forEach(f=>{c+=this.getNumNGrams(l,f)}),this.preserveShort&&l>0&&c===0&&(c=1),o[u]=o[u-1]+c}const a=new Array(o[s]);for(let u=0;u<s;++u){const l=n[u];let c=o[u];if(this.nGramWidths.forEach(f=>{const d=n[u+1]-n[u],h=this.getNumNGrams(d,f);this.createNGrams(t,l,a,c,h,f),c+=h}),this.preserveShort&&c===o[u]){const f=n[u+1]-n[u];if(f===0)continue;const d=f+2*this.padWidth;this.createNGrams(t,l,a,c,1,d)}}return[a,o]}}function Npe(e,t,n,r,i,s,o,a){return new f8e(n,r,i,s,o,a).compute(e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8e(e,t,n,r){if(!e.length)return;if(t.length===0){for(let s=0;s<e.length;++s)r.push(e.subarray(s,s+1));return}if(t.length===1){const s=t[0];let o=e.indexOf(s);for(;o!==-1;){const a=e.subarray(0,o);(!n||a.length!==0)&&r.push(a),e=e.subarray(o+1),o=e.indexOf(s)}(!n||e.length!==0)&&r.push(e);return}let i=0;for(let s=0;s<e.length+1;s++)if(s===e.length||t.indexOf(e[s])!==-1){const o=e.subarray(i,s);(!n||o.length!==0)&&r.push(o),i=s+1}}function Dpe(e,t,n){const r=e.length,i=[];let s=0,o=0;const a=new Array(r);for(let d=0;d<r;++d){const h=i.length;d8e(e[d],t,n,i);const p=i.length-h;a[d]=p,s+=p,o=Math.max(o,p)}const u=ur("int32",s*2),l=new Array(s),c=[r,o];let f=0;for(let d=0;d<r;++d)for(let h=0;h<a[d];++h)u[f*2]=d,u[f*2+1]=h,l[f]=i[f],++f;return[u,l,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fpe(e,t){const n=ur("int32",e.length);for(let r=0;r<e.length;++r)n[r]=ele(e[r]).modulo(t).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rpe=br((e,t)=>e-t),h8e=WU((e,t,n,r)=>({real:e-n,imag:t-r})),XU=Pr(Qx,Rpe,h8e),p8e={kernelName:Qx,backendName:"cpu",kernelFunc:XU};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ope(e,t){const n=new Array(e.rank);for(let i=0;i<n.length;i++)n[i]=e.shape[i]*t[i];const r=Ft(n,e.dtype);for(let i=0;i<r.values.length;++i){const s=r.indexToLoc(i),o=new Array(e.rank);for(let u=0;u<o.length;u++)o[u]=s[u]%e.shape[u];const a=e.locToIndex(o);r.values[i]=e.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R2=(e,t)=>{const n=t.value-e.value;return n===0?e.index-t.index:n};function Mpe(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,u=t-n+1,l=Math.log(a),c=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*c*(a-c)/a)*Math.sign(u-a/2),d=Math.max(n,Math.floor(t-u*c/a+f)),h=Math.min(r,Math.floor(t+(a-u)*c/a+f));Mpe(e,t,d,h)}const i=e[t];let s=n,o=r;for(ef(e,n,t),R2(e[r],i)>0&&ef(e,n,r);s<o;){for(ef(e,s,o),s++,o--;R2(e[s],i)<0;)s=s+1;for(;R2(e[o],i)>0;)o=o-1}R2(e[n],i)===0?ef(e,n,o):(o=o+1,ef(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}}function Lpe(e,t,n,r,i){const s=t[t.length-1],[o,a]=[e.length/s,s],u=Zr(n,o*r),l=Zr("int32",o*r);for(let f=0;f<o;f++){const d=f*a,h=e.subarray(d,d+a);let p=new Array(h.length);h.forEach((v,$)=>p[$]={value:v,index:$}),r<p.length&&(Mpe(p,r),p=p.slice(0,r)),i&&p.sort(R2);const m=f*r,x=u.subarray(m,m+r),b=l.subarray(m,m+r);for(let v=0;v<r;v++)x[v]=p[v].value,b[v]=p[v].index}const c=t.slice();return c[c.length-1]=r,[Ft(c,n,u),Ft(c,"int32",l)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ppe(e,t,n,r){const i=Ot(t,n)[0],s=[1,n[0],1];for(let p=0;p<i;p++)s[0]*=n[p];s[1]=n[i];for(let p=i+1;p<n.length;p++)s[2]*=n[p];const o=new Map,a=new Int32Array(n[i]),u=new Sr(s,r,e),l=[],c=s[0]===1&&s[2]===1;for(let p=0;p<n[i];p++){let m;if(c)m=e[p].toString();else{const b=[];for(let v=0;v<s[0];v++)for(let $=0;$<s[2];$++)b.push(u.get(v,p,$));m=b.join(",")}const x=o.get(m);if(x!=null)a[p]=x;else{const b=o.size;o.set(m,b),a[p]=b,l.push(p)}}const f=s.slice();f[1]=o.size;const d=new Sr(f,r);l.forEach((p,m)=>{for(let x=0;x<s[0];x++)for(let b=0;b<s[2];b++)d.set(u.get(x,p,b),x,m,b)});const h=n.slice();return h[i]=f[1],{outputValues:d.values,outputShape:h,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g8e=Object.freeze(Object.defineProperty({__proto__:null,addImpl:Hhe,bincountImpl:VU,bincountReduceImpl:Xhe,bitwiseAndImpl:Yhe,castImpl:Ghe,ceilImpl:Khe,concatImpl:Qhe,equalImpl:Zhe,expImpl:epe,expm1Impl:npe,floorDivImpl:ipe,floorImpl:rpe,gatherNdImpl:spe,gatherV2Impl:ope,greaterEqualImpl:upe,greaterImpl:ape,lessEqualImpl:cpe,lessImpl:lpe,linSpaceImpl:fpe,logImpl:dpe,maxImpl:hpe,maximumImpl:ppe,minimumImpl:gpe,multiplyImpl:qU,negImpl:mpe,notEqualImpl:ype,prodImpl:xpe,raggedGatherImpl:bpe,raggedRangeImpl:vpe,raggedTensorToTensorImpl:wpe,rangeImpl:$pe,rsqrtImpl:Cpe,scatterImpl:Ag,sigmoidImpl:t8e,simpleAbsImpl:qhe,sliceImpl:kpe,sparseFillEmptyRowsImpl:Epe,sparseReshapeImpl:Ape,sparseSegmentReductionImpl:HU,sqrtImpl:i8e,squaredDifferenceImpl:_pe,staticRegexReplaceImpl:Tpe,stridedSliceImpl:Ipe,stringNGramsImpl:Npe,stringSplitImpl:Dpe,stringToHashBucketFastImpl:Fpe,subImpl:Rpe,tileImpl:Ope,topKImpl:Lpe,transposeImpl:GU,uniqueImpl:Ppe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */t9("cpu",()=>new b3,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bpe=bn(vx,e=>e>=0?e:Math.exp(e)-1),m8e={kernelName:vx,backendName:"cpu",kernelFunc:Bpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:s}=r;Qe([i],"leakyRelu");const o=me(i.shape),a=n.data.get(i.dataId).values,u=Zr("float32",o);for(let l=0;l<a.length;l++)u[l]=a[l]<0?s*a[l]:a[l];return n.makeTensorInfo(i.shape,"float32",u)}const y8e={kernelName:OC,backendName:"cpu",kernelFunc:zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x8e=br((e,t)=>e<0?t*e:e);function Upe(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t;Qe([r,i],"prelu");const s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,[a,u]=x8e(r.shape,i.shape,s,o,"float32");return n.makeTensorInfo(u,"float32",a)}const b8e={kernelName:eS,backendName:"cpu",kernelFunc:Upe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jpe=bn(Bx,e=>Math.max(0,e)),v8e={kernelName:Bx,backendName:"cpu",kernelFunc:jpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wpe=bn(zx,e=>Math.min(Math.max(0,e),6)),w8e={kernelName:zx,backendName:"cpu",kernelFunc:Wpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sI(e,t,n,r,i){if(n==="linear")return Hl({inputs:{x:t},backend:e});if(n==="relu")return jpe({inputs:{x:t},backend:e});if(n==="elu")return Bpe({inputs:{x:t},backend:e});if(n==="relu6")return Wpe({inputs:{x:t},backend:e});if(n==="prelu")return Upe({inputs:{x:t,alpha:r},backend:e});if(n==="leakyrelu")return zpe({inputs:{x:t},backend:e,attrs:{alpha:i}});if(n==="sigmoid")return Spe({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fn(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:s}=r,o=me(i.shape),a=H7(s,o),u=me(a);U(o===u,()=>`The new shape (${a}) has ${u} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);const l=n.data.get(i.dataId);if(l.complexTensorInfos!=null){const c=l.complexTensorInfos.real,f=l.complexTensorInfos.imag;c.shape=a,f.shape=a}return{dataId:i.dataId,shape:a,dtype:i.dtype}}const $8e={kernelName:nS,backendName:"cpu",kernelFunc:Fn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpe(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s}=t,{transposeA:o,transposeB:a}=r;Qe([i,s],"matMul");const u=i.shape.length,l=s.shape.length,c=o?i.shape[u-2]:i.shape[u-1],f=a?s.shape[l-1]:s.shape[l-2],d=o?i.shape[u-1]:i.shape[u-2],h=a?s.shape[l-2]:s.shape[l-1],p=i.shape.slice(0,-2),m=s.shape.slice(0,-2),x=me(p),b=me(m),$=At(i.shape.slice(0,-2),s.shape.slice(0,-2)).concat([d,h]);U(c===f,()=>`Error in matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${i.shape} and ${s.shape} and transposeA=${o} and transposeB=${a} must match.`);const C=o?[x,c,d]:[x,d,c],S=a?[b,h,f]:[b,f,h],A=Fn({inputs:{x:i},backend:n,attrs:{shape:C}}),E=Fn({inputs:{x:s},backend:n,attrs:{shape:S}}),_=o?A.shape[1]:A.shape[2],D=o?A.shape[2]:A.shape[1],N=a?E.shape[1]:E.shape[2],T=Math.max(x,b),L=n.data.get(A.dataId).values,O=n.data.get(E.dataId).values,M=ut(A.shape),R=ut(E.shape),[P,j,z]=o?[M[0],1,M[1]]:[M[0],M[1],1],[q,H,V]=a?[1,R[1],R[0]]:[R[1],1,R[0]],X=D*N,re=Ft([T,D,N],A.dtype),le=re.values,ue=n.blockSize;for(let be=0;be<T;be++){const _e=be%x,Ne=be%b;for(let Y=0;Y<D;Y+=ue){const ae=Math.min(Y+ue,D);for(let he=0;he<N;he+=ue){const G=Math.min(he+ue,N);for(let je=0;je<_;je+=ue){const Ce=Math.min(je+ue,_);for(let We=Y;We<ae;We++)for(let Ve=he;Ve<G;Ve++){let gt=0;for(let ct=je;ct<Ce;ct++){const _s=L[_e*P+We*j+ct*z],On=O[ct*q+Ve*H+Ne*V];gt+=_s*On}le[be*X+(We*N+Ve)]+=gt}}}}}return n.disposeIntermediateTensorInfo(A),n.disposeIntermediateTensorInfo(E),n.makeTensorInfo($,re.dtype,re.values)}const C8e={kernelName:bC,backendName:"cpu",kernelFunc:Vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8e(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s,bias:o,preluActivationWeights:a}=t,{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:f}=r;let d,h,p;const m=[];d=Vpe({inputs:{a:i,b:s},attrs:{transposeA:u,transposeB:l},backend:n}),o&&(h=uy({inputs:{a:d,b:o},backend:n}),m.push(d),d=h),c&&(p=sI(n,d,c,a,f),m.push(d),d=p);for(const b of m)n.disposeIntermediateTensorInfo(b);return d}const k8e={kernelName:Rw,backendName:"cpu",kernelFunc:S8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8e=bn(ax,e=>Math.acos(e)),A8e={kernelName:ax,backendName:"cpu",kernelFunc:E8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _8e=bn(ux,e=>Math.acosh(e)),T8e={kernelName:ux,backendName:"cpu",kernelFunc:_8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8e(e){const{inputs:t,backend:n}=e,r=t;Qe(t,"addN");const i=r.map(a=>n.data.get(a.dataId).values),s=Ft(r[0].shape,r[0].dtype),o=s.values;for(let a=0;a<r.length;a++){const u=i[a];for(let l=0;l<o.length;l++)o[l]+=u[l]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}const N8e={kernelName:pC,backendName:"cpu",kernelFunc:I8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D8e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;Qe(i,"all");const a=Ot(s,i.shape);let u=a;const l=nr(u,i.shape.length);let c=i;l!=null&&(c=Xs({inputs:{x:i},backend:n,attrs:{perm:l}}),u=yr(u.length,i.shape.length)),ki("all",u,c.shape.length);const[f,d]=ei(c.shape,u),h=me(d),p=vi(me(f),c.dtype),m=n.data.get(c.dataId).values;for(let b=0;b<p.length;++b){const v=b*h;let $=m[v];for(let C=0;C<h;++C){const S=m[v+C];$=$&&S}p[b]=$}l!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(f,c.dtype,p);if(o){const b=mr(f,a),v=Fn({inputs:{x},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(x),v}return x}const F8e={kernelName:bD,backendName:"cpu",kernelFunc:D8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R8e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;Qe(i,"any");const a=Ot(s,i.shape);let u=a;const l=nr(u,i.shape.length);let c=i;l!=null&&(c=Xs({inputs:{x:i},backend:n,attrs:{perm:l}}),u=yr(u.length,i.shape.length)),ki("any",u,c.shape.length);const[f,d]=ei(c.shape,u),h=me(d),p=vi(me(f),c.dtype),m=n.data.get(c.dataId).values;for(let b=0;b<p.length;++b){const v=b*h;let $=m[v];for(let C=0;C<h;++C){const S=m[v+C];$=$||S}p[b]=$}l!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(f,c.dtype,p);if(o){const b=mr(f,a),v=Fn({inputs:{x},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(x),v}return x}const O8e={kernelName:vD,backendName:"cpu",kernelFunc:R8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M8e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;Qe(i,"argMax");let o=Ot(s,i.shape);const a=nr(o,i.shape.length);let u=i;const l=[];a!=null&&(u=Xs({inputs:{x:i},backend:n,attrs:{perm:a}}),l.push(u),o=yr(o.length,u.shape.length)),o=[o[0]],ki("argMax",o,u.shape.length);const[c,f]=ei(u.shape,o),d=me(c),h=vi(d,"int32"),p=me(f),m=n.data.get(u.dataId).values;for(let x=0;x<h.length;++x){const b=x*p;let v=m[b],$=0;for(let C=0;C<p;++C){const S=m[b+C];S>v&&(v=S,$=C)}h[x]=$}return l.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(c,"int32",h)}const L8e={kernelName:gC,backendName:"cpu",kernelFunc:M8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P8e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;Qe(i,"argMin");let o=Ot(s,i.shape);const a=nr(o,i.shape.length);let u=i;const l=[];a!=null&&(u=Xs({inputs:{x:i},backend:n,attrs:{perm:a}}),l.push(u),o=yr(o.length,u.shape.length)),o=[o[0]],ki("argMin",o,u.shape.length);const[c,f]=ei(u.shape,o),d=me(c),h=vi(d,"int32"),p=me(f),m=n.data.get(u.dataId).values;for(let x=0;x<h.length;++x){const b=x*p;let v=m[b],$=0;for(let C=0;C<p;++C){const S=m[b+C];S<v&&(v=S,$=C)}h[x]=$}return l.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(c,"int32",h)}const B8e={kernelName:mC,backendName:"cpu",kernelFunc:P8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z8e=bn(lx,e=>Math.asin(e)),U8e={kernelName:lx,backendName:"cpu",kernelFunc:z8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j8e=bn(cx,e=>Math.asinh(e)),W8e={kernelName:cx,backendName:"cpu",kernelFunc:j8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V8e=bn(fx,e=>Math.atan(e)),q8e={kernelName:fx,backendName:"cpu",kernelFunc:V8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G8e=br((e,t)=>Math.atan2(e,t)),H8e=Pr(hx,G8e),X8e={kernelName:hx,backendName:"cpu",kernelFunc:H8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y8e=bn(dx,e=>Math.atanh(e)),K8e={kernelName:dx,backendName:"cpu",kernelFunc:Y8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YU(e,t,n,r,i,s){const o=i.strideHeight,a=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterHeight,f=i.effectiveFilterWidth,d=i.padInfo.top,h=i.padInfo.left,p=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Ft(i.outShape,n),x=m.values,b=i.outShape[1]*i.outShape[2]*i.outShape[3],v=i.outShape[2]*i.outShape[3],$=i.outShape[3];for(let C=0;C<i.batchSize;++C){const S=C*b,A=C*r[0];for(let E=0;E<i.inChannels;++E)for(let _=0;_<i.outHeight;++_){const D=_*o-d,N=Math.max(0,D),T=Math.min(i.inHeight,c+D),L=S+_*v;for(let O=0;O<i.outWidth;++O){const M=O*a-h,R=Math.max(0,M),P=Math.min(i.inWidth,f+M);let j=p,z=0,q=0;for(let V=N;V<T;V+=u){const X=A+V*r[1];for(let re=R;re<P;re+=l){const le=X+re*r[2],ue=e[le+E];s==="max"&&ue>j?j=ue:s==="avg"&&(z+=ue,q++)}if(isNaN(j))break}const H=L+O*$+E;x[H]=s==="avg"?z/q:j}}}return m}function qpe(e,t,n,r,i=!1,s=!1){const o=Ft(r.outShape,"int32"),a=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,m=Ft(t,n,e);for(let x=0;x<r.batchSize;++x)for(let b=0;b<r.inChannels;++b)for(let v=0;v<r.outHeight;++v){const $=v*a-h;let C=$;for(;C<0;)C+=l;const S=Math.min(r.inHeight,f+$);for(let A=0;A<r.outWidth;++A){const E=A*u-p;let _=E;for(;_<0;)_+=c;const D=Math.min(r.inWidth,d+E);let N=Number.NEGATIVE_INFINITY,T=-1;for(let L=C;L<S;L+=l){const O=L-$;for(let M=_;M<D;M+=c){const R=M-E,P=m.get(x,L,M,b);P>N&&(N=P,i?T=s?((x*r.inHeight+L)*r.inWidth+M)*r.inChannels+b:(L*r.inWidth+M)*r.inChannels+b:T=O*d+R)}}o.set(T,x,v,A,b)}}return o}function Gpe(e,t,n,r,i,s){const o=i.strideDepth,a=i.strideHeight,u=i.strideWidth,l=i.dilationDepth,c=i.dilationHeight,f=i.dilationWidth,d=i.effectiveFilterDepth,h=i.effectiveFilterHeight,p=i.effectiveFilterWidth,m=i.padInfo.front,x=i.padInfo.top,b=i.padInfo.left,v=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,$=Ft(i.outShape,n),C=$.values,S=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],A=i.outShape[2]*i.outShape[3]*i.outShape[4],E=i.outShape[3]*i.outShape[4],_=i.outShape[4];for(let D=0;D<i.batchSize;++D){const N=D*S,T=D*r[0];for(let L=0;L<i.inChannels;++L)for(let O=0;O<i.outDepth;++O){const M=O*o-m;let R=M;for(;R<0;)R+=l;const P=Math.min(i.inDepth,d+M),j=N+O*A;for(let z=0;z<i.outHeight;++z){const q=z*a-x;let H=q;for(;H<0;)H+=c;const V=Math.min(i.inHeight,h+q),X=j+z*E;for(let re=0;re<i.outWidth;++re){const le=re*u-b;let ue=le;for(;ue<0;)ue+=f;const be=Math.min(i.inWidth,p+le),_e=X+re*_;let Ne=v,Y=0,ae=0;for(let G=R;G<P;G+=l){const je=T+G*r[1];for(let Ce=H;Ce<V;Ce+=c){const We=je+Ce*r[2];for(let Ve=ue;Ve<be;Ve+=f){const gt=We+Ve*r[3],ct=e[gt+L];if(s==="max"&&ct>Ne?Ne=ct:s==="avg"&&(Y+=ct,ae++),isNaN(Ne))break}if(isNaN(Ne))break}if(isNaN(Ne))break}const he=_e+L;C[he]=s==="avg"?Y/Math.max(ae,1):Ne}}}}return $}function Q8e(e,t){const n=Ft(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,s=t.strideWidth,o=t.dilationDepth,a=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,h=t.padInfo.top,p=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let x=0;x<t.inChannels;++x)for(let b=0;b<t.outDepth;++b){const v=b*r-d;let $=v;for(;$<0;)$+=o;const C=Math.min(t.inDepth,l+v);for(let S=0;S<t.outHeight;++S){const A=S*i-h;let E=A;for(;E<0;)E+=a;const _=Math.min(t.inHeight,c+A);for(let D=0;D<t.outWidth;++D){const N=D*s-p;let T=N;for(;T<0;)T+=u;const L=Math.min(t.inWidth,f+N);let O=Number.NEGATIVE_INFINITY,M=-1;for(let R=$;R<C;R+=o){const P=R-v;for(let j=E;j<_;j+=a){const z=j-A;for(let q=T;q<L;q+=u){const H=q-N,V=e.get(m,R,j,q,x);V>=O&&(O=V,M=P*c*f+z*c+H)}}}n.set(M,m,b,S,D,x)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Qe(i,"avgPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r,l=1;U(Si(o,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const c=Xa(i.shape,s,o,l,a,u);let f;if(c.filterWidth===1&&c.filterHeight===1&&Gt(c.inShape,c.outShape))f=Hl({inputs:{x:i},backend:n});else{const d=n.data.get(i.dataId).values,h=ut(i.shape),p=YU(d,i.shape,i.dtype,h,c,"avg");f=n.makeTensorInfo(c.outShape,i.dtype,p.values)}return f}const J8e={kernelName:yC,backendName:"cpu",kernelFunc:Z8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u,dataFormat:l}=r;Qe(i,"avgPool3d");const c=Bf(i.shape,s,o,1,a,u,l),f=n.data.get(i.dataId).values,d=Gpe(f,i.shape,i.dtype,ut(i.shape),c,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const t7e={kernelName:xC,backendName:"cpu",kernelFunc:e7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n7e(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,{filterSize:o,strides:a,pad:u,dimRoundingMode:l}=r;Qe([i,s],"avgPool3DGrad");const c=Bf(s.shape,o,a,1,u,l),f=c.strideDepth,d=c.strideHeight,h=c.strideWidth,p=c.filterDepth,m=c.filterHeight,x=c.filterWidth,b=c.dilationDepth,v=c.dilationHeight,$=c.dilationWidth,C=c.effectiveFilterDepth,S=c.effectiveFilterHeight,A=c.effectiveFilterWidth,E=C-1-c.padInfo.front,_=A-1-c.padInfo.left,D=S-1-c.padInfo.top,N=Ft(s.shape,"float32"),T=1/(p*m*x),L=n.bufferSync(i);for(let O=0;O<c.batchSize;++O)for(let M=0;M<c.inChannels;++M)for(let R=0;R<c.inDepth;++R)for(let P=0;P<c.inHeight;++P)for(let j=0;j<c.inWidth;++j){const z=R-E,q=P-D,H=j-_;let V=0;for(let X=0;X<C;X+=b){const re=(z+X)/f;if(!(re<0||re>=c.outDepth||Math.floor(re)!==re))for(let le=0;le<S;le+=v){const ue=(q+le)/d;if(!(ue<0||ue>=c.outHeight||Math.floor(ue)!==ue))for(let be=0;be<A;be+=$){const _e=(H+be)/h;if(_e<0||_e>=c.outWidth||Math.floor(_e)!==_e)continue;const Ne=L.get(O,re,ue,_e,M);V+=Ne}}}N.set(V*T,O,R,P,j,M)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const r7e={kernelName:$D,backendName:"cpu",kernelFunc:n7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7e(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s;Qe([i,s],"avgPoolGrad");const{filterSize:a,strides:u,pad:l}=r,c=Xa(o.shape,a,u,1,l),f=c.strideHeight,d=c.strideWidth,h=c.filterHeight,p=c.filterWidth,m=c.dilationHeight,x=c.dilationWidth,b=c.effectiveFilterHeight,v=c.effectiveFilterWidth,$=v-1-c.padInfo.left,C=b-1-c.padInfo.top,S=Ft(o.shape,"float32"),A=1/(h*p),E=n.data.get(i.dataId).values,_=Ft(i.shape,"float32",E);for(let D=0;D<c.batchSize;++D)for(let N=0;N<c.inChannels;++N)for(let T=0;T<c.inHeight;++T)for(let L=0;L<c.inWidth;++L){const O=T-C,M=L-$;let R=0;for(let P=0;P<b;P+=m){const j=(O+P)/f;if(!(j<0||j>=c.outHeight||Math.floor(j)!==j))for(let z=0;z<v;z+=x){const q=(M+z)/d;if(q<0||q>=c.outWidth||Math.floor(q)!==q)continue;const H=_.get(D,j,q,N);R+=H}}S.set(R*A,D,T,L,N)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const s7e={kernelName:wD,backendName:"cpu",kernelFunc:i7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,scale:s,offset:o,mean:a,variance:u}=t;U(a.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),U(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),U(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Qe([i,a,u,s,o],"batchNorm");let{varianceEpsilon:l}=r;l==null&&(l=.001);const c=n.data.get(i.dataId).values,f=n.data.get(a.dataId).values,d=n.data.get(u.dataId).values,h=s?n.data.get(s.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(c.length),x=p.length,b=h.length,v=d.length,$=f.length;let C=0,S=0,A=0,E=0;for(let _=0;_<c.length;++_)m[_]=p[C++]+(c[_]-f[S++])*h[A++]/Math.sqrt(d[E++]+l),C>=x&&(C=0),S>=$&&(S=0),A>=b&&(A=0),E>=v&&(E=0);return n.makeTensorInfo(i.shape,i.dtype,m)}const a7e={kernelName:DC,backendName:"cpu",kernelFunc:o7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,crops:o}=r;Qe([i],"batchToSpaceND");const a=s.reduce((b,v)=>b*v),u=kS(i.shape,s,a),l=ES(u.length,s.length),c=AS(i.shape,s,a),f=iU(o,s.length),d=sU(c,o,s.length),h=Fn({inputs:{x:i},backend:n,attrs:{shape:u}}),p=Xs({inputs:{x:h},backend:n,attrs:{perm:l}}),m=Fn({inputs:{x:p},backend:n,attrs:{shape:c}}),x=cm({inputs:{x:m},backend:n,attrs:{begin:f,size:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),x}const l7e={kernelName:vC,backendName:"cpu",kernelFunc:u7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o}=r,a=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,l=VU(a,u,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,l)}const f7e={kernelName:CD,backendName:"cpu",kernelFunc:c7e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7e(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,a=At(Array.from(s),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const h7e={kernelName:SD,backendName:"cpu",kernelFunc:d7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p7e=bn(mx,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),g7e={kernelName:mx,backendName:"cpu",kernelFunc:p7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m7e=e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array(me(t.shape)),i=n.data.get(t.dataId),s=i.complexTensorInfos.real,o=i.complexTensorInfos.imag,a=n.data.get(s.dataId).values,u=n.data.get(o.dataId).values;for(let l=0;l<a.length;l++){const c=a[l],f=u[l];r[l]=Math.hypot(c,f)}return n.makeOutput(r,t.shape,"float32")},y7e={kernelName:$C,backendName:"cpu",kernelFunc:m7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ly(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const x7e={kernelName:VD,backendName:"cpu",kernelFunc:ly};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cy(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,s=Ot(i,t[0].shape)[0],o=t.map(m=>m.shape);tU(o,s);let a=Nl(t.map(m=>m.shape),s);if(me(a)===0)return n.makeTensorInfo(a,t[0].dtype,[]);const u=t.filter(m=>me(m.shape)>0);if(u.length===1)return Hl({inputs:{x:u[0]},backend:n});if(u[0].dtype==="complex64"){const m=u.map(C=>lm({inputs:{input:C},backend:n})),x=u.map(C=>ly({inputs:{input:C},backend:n})),b=cy({inputs:m,backend:n,attrs:{axis:s}}),v=cy({inputs:x,backend:n,attrs:{axis:s}}),$=xo({inputs:{real:b,imag:v},backend:n});return m.forEach(C=>n.disposeIntermediateTensorInfo(C)),x.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),$}const l=u.map(m=>{const b=[-1,me(m.shape.slice(s))];return Fn({inputs:{x:m},backend:n,attrs:{shape:b}})}),c=l.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=Nl(l.map(m=>m.shape),1);const f=l[0].shape[0]===1,d=Qhe(c,a,t[0].dtype,f),h=Nl(u.map(m=>m.shape),s),p=n.makeTensorInfo(h,t[0].dtype,d);return l.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const b7e={kernelName:CC,backendName:"cpu",kernelFunc:cy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dataFormat:u,dilations:l,dimRoundingMode:c}=r;Qe([i,s],"conv2d");const f=zf(u),d=Jr(i.shape,s.shape,o,l,a,c,!1,f),h=d.filterHeight,p=d.filterWidth,m=d.dilationHeight,x=d.dilationWidth,b=d.padInfo.left,v=d.padInfo.top,$=d.dataFormat==="channelsLast",C=new Sr(d.outShape,i.dtype),S=ut(i.shape),A=ut(s.shape),E=S[0],_=$?S[1]:S[2],D=$?S[2]:1,N=$?1:S[1],T=C.strides[0],L=$?C.strides[1]:C.strides[2],O=$?C.strides[2]:1,M=$?1:C.strides[1],R=n.data.get(i.dataId).values,P=n.data.get(s.dataId).values,j=C.values;for(let z=0;z<d.batchSize;++z){const q=z*E,H=z*T;for(let V=0;V<d.outHeight;++V){const X=H+V*L,re=V*d.strideHeight-v;for(let le=0;le<h;++le){const ue=re+le*m;if(ue<0||ue>=d.inHeight)continue;const be=le*A[0],_e=q+ue*_;for(let Ne=0;Ne<d.outWidth;++Ne){const Y=X+Ne*O,ae=Ne*d.strideWidth-b;for(let he=0;he<p;++he){const G=ae+he*x;if(G<0||G>=d.inWidth)continue;const je=be+he*A[1],Ce=_e+G*D;let We=je;for(let Ve=0;Ve<d.inChannels;++Ve){const gt=R[Ce+Ve*N];for(let ct=0;ct<d.outChannels;++ct)j[Y+ct*M]+=gt*P[We+ct];We+=d.outChannels}}}}}}return n.makeTensorInfo(C.shape,C.dtype,j)}const v7e={kernelName:SC,backendName:"cpu",kernelFunc:Hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,dataFormat:u,dimRoundingMode:l,filterShape:c}=r;Qe([i,s],"conv2dBackpropFilter");const f=zf(u),d=Jr(i.shape,c,o,1,a,l,!1,f),{strideHeight:h,strideWidth:p,filterHeight:m,filterWidth:x}=d,b=d.dataFormat==="channelsLast",v=new Sr(d.filterShape,"float32"),$=d.padInfo.left,C=d.padInfo.top,S=n.data.get(i.dataId).values,A=n.data.get(s.dataId).values,E=new Sr(i.shape,i.dtype,S),_=new Sr(s.shape,s.dtype,A);for(let D=0;D<m;++D){const N=Math.max(0,Math.ceil((C-D)/h)),T=Math.min(d.outHeight,(d.inHeight+C-D)/h);for(let L=0;L<x;++L){const O=Math.max(0,Math.ceil(($-L)/p)),M=Math.min(d.outWidth,(d.inWidth+$-L)/p);for(let R=0;R<d.inChannels;++R)for(let P=0;P<d.outChannels;++P){let j=0;for(let z=0;z<d.batchSize;++z)for(let q=N;q<T;++q){const H=D+q*h-C;for(let V=O;V<M;++V){const X=L+V*p-$;b?j+=E.get(z,H,X,R)*_.get(z,q,V,P):j+=E.get(z,R,H,X)*_.get(z,P,q,V)}}v.set(j,D,L,R,P)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const $7e={kernelName:ED,backendName:"cpu",kernelFunc:w7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7e(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{inputShape:o,strides:a,pad:u,dataFormat:l,dimRoundingMode:c}=r;Qe([i,s],"conv2dBackpropInput");const f=ut(s.shape),d=ut(i.shape);let h=zf(l);const p=Jr(o,s.shape,a,1,u,c,!1,h),m=new Sr(p.inShape,"float32"),x=m.values,b=n.data.get(i.dataId).values,v=n.data.get(s.dataId).values,[$,C,S]=f,{batchSize:A,filterHeight:E,filterWidth:_,inChannels:D,inHeight:N,inWidth:T,outChannels:L,outHeight:O,outWidth:M,strideHeight:R,strideWidth:P}=p;h=p.dataFormat;const j=E-1-p.padInfo.top,z=_-1-p.padInfo.left,q=h==="channelsLast",H=m.strides[0],V=q?m.strides[1]:m.strides[2],X=q?m.strides[2]:1,re=q?1:m.strides[1],le=d[0],ue=q?d[1]:d[2],be=q?d[2]:1,_e=q?1:d[1];for(let Ne=0;Ne<A;++Ne)for(let Y=0;Y<D;++Y)for(let ae=0;ae<N;++ae){const he=ae-j,G=Math.max(0,Math.ceil(he/R)),je=Math.min(O,(E+he)/R);for(let Ce=0;Ce<T;++Ce){const We=Ce-z,Ve=Math.max(0,Math.ceil(We/P)),gt=Math.min(M,(_+We)/P);let ct=0;for(let On=G;On<je;++On){const Fi=On*R-he;for(let zr=Ve;zr<gt;++zr){const da=zr*P-We,si=le*Ne+ue*On+be*zr,ro=$*(E-1-Fi)+C*(_-1-da)+S*Y;for(let Wo=0;Wo<L;++Wo){const ot=b[si+_e*Wo],Ts=v[ro+Wo];ct+=ot*Ts}}}const _s=H*Ne+V*ae+X*Ce+re*Y;x[_s]=ct}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const S7e={kernelName:kC,backendName:"cpu",kernelFunc:C7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u}=r;Qe([i,s],"conv3d");const l=Zh(i.shape,s.shape,o,u,a),{filterDepth:c,filterHeight:f,filterWidth:d,dilationDepth:h,dilationHeight:p,dilationWidth:m,padInfo:x}=l,b=x.front,v=x.left,$=x.top,C=new Sr(l.outShape,i.dtype),S=n.data.get(i.dataId).values,A=n.data.get(s.dataId).values,E=C.values,_=ut(i.shape),D=ut(s.shape);for(let N=0;N<l.batchSize;++N){const T=N*_[0],L=N*C.strides[0];for(let O=0;O<l.outDepth;++O){const M=L+O*C.strides[1],R=O*l.strideDepth-b;for(let P=0;P<c;++P){const j=R+P*h;if(j<0||j>=l.inDepth)continue;const z=P*D[0],q=T+j*_[1];for(let H=0;H<l.outHeight;++H){const V=M+H*C.strides[2],X=H*l.strideHeight-$;for(let re=0;re<f;++re){const le=X+re*p;if(le<0||le>=l.inHeight)continue;const ue=z+re*D[1],be=q+le*_[2];for(let _e=0;_e<l.outWidth;++_e){const Ne=V+_e*l.outChannels,Y=_e*l.strideWidth-v;for(let ae=0;ae<d;++ae){const he=Y+ae*m;if(he<0||he>=l.inWidth)continue;const G=ue+ae*D[2],je=be+he*l.inChannels;let Ce=G;for(let We=0;We<l.inChannels;++We){const Ve=S[je+We];for(let gt=0;gt<l.outChannels;++gt)E[Ne+gt]+=Ve*A[Ce+gt];Ce+=l.outChannels}}}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const E7e={kernelName:EC,backendName:"cpu",kernelFunc:k7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,filterShape:u}=r;Qe([i,s],"conv3dBackpropFilterV2");const l=ut(i.shape),c=ut(s.shape),f=Zh(i.shape,u,o,1,a),d=f.strideDepth,h=f.strideHeight,p=f.strideWidth,m=f.filterDepth,x=f.filterHeight,b=f.filterWidth,v=new Sr(f.filterShape,"float32"),$=v.values,[C,S,A,E]=v.strides,_=n.data.get(s.dataId).values,[D,N,T,L]=c,O=n.data.get(i.dataId).values,[M,R,P,j]=l,z=f.padInfo.front,q=f.padInfo.left,H=f.padInfo.top;for(let V=0;V<m;++V){const X=Math.max(0,Math.ceil((z-V)/d)),re=Math.min(f.outDepth,(f.inDepth+z-V)/d),le=V*C;for(let ue=0;ue<x;++ue){const be=Math.max(0,Math.ceil((H-ue)/h)),_e=Math.min(f.outHeight,(f.inHeight+H-ue)/h),Ne=ue*S+le;for(let Y=0;Y<b;++Y){const ae=Math.max(0,Math.ceil((q-Y)/p)),he=Math.min(f.outWidth,(f.inWidth+q-Y)/p),G=Y*A+Ne;for(let je=0;je<f.inChannels;++je){const Ce=je*E+G;for(let We=0;We<f.outChannels;++We){let Ve=0;for(let gt=0;gt<f.batchSize;++gt){const ct=gt*M,_s=gt*D;for(let On=X;On<re;++On){const zr=(V+On*d-z)*R+ct,da=On*N+_s;for(let si=be;si<_e;++si){const Wo=(ue+si*h-H)*P+zr,ot=si*T+da;for(let Ts=ae;Ts<he;++Ts){const eu=(Y+Ts*p-q)*j+Wo,tu=Ts*L+ot;Ve+=O[eu+je]*_[tu+We]}}}}$[Ce+We]=Ve}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const _7e={kernelName:AD,backendName:"cpu",kernelFunc:A7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7e(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{pad:o,strides:a,inputShape:u}=r;Qe([i],"conv3dBackpropInputV2");const l=ut(i.shape),c=ut(s.shape),f=Zh(u,s.shape,a,1,o),d=new Sr(f.inShape,"float32"),h=d.values,[p,m,x,b]=d.strides,v=n.data.get(i.dataId).values,[$,C,S,A]=l,E=n.data.get(s.dataId).values,[_,D,N,T]=c,{batchSize:L,filterDepth:O,filterHeight:M,filterWidth:R,inChannels:P,inDepth:j,inHeight:z,inWidth:q,outChannels:H,outDepth:V,outHeight:X,outWidth:re,strideDepth:le,strideHeight:ue,strideWidth:be}=f,_e=O-1-f.padInfo.front,Ne=M-1-f.padInfo.top,Y=R-1-f.padInfo.left;for(let ae=0;ae<L;++ae)for(let he=0;he<P;++he)for(let G=0;G<j;++G){const je=G-_e,Ce=Math.max(0,Math.ceil(je/le)),We=Math.min(V,(O+je)/le);for(let Ve=0;Ve<z;++Ve){const gt=Ve-Ne,ct=Math.max(0,Math.ceil(gt/ue)),_s=Math.min(X,(M+gt)/ue);for(let On=0;On<q;++On){const Fi=On-Y,zr=Math.max(0,Math.ceil(Fi/be)),da=Math.min(re,(R+Fi)/be);let si=0;for(let ro=Ce;ro<We;++ro){const Wo=ro*le-je;for(let ot=ct;ot<_s;++ot){const Ts=ot*ue-gt;for(let sl=zr;sl<da;++sl){const eu=sl*be-Fi,tu=$*ae+C*ro+S*ot+A*sl,ev=_*(O-1-Wo)+D*(M-1-Ts)+N*(R-1-eu)+T*he;for(let Ic=0;Ic<H;++Ic){const F0=v[tu+Ic],tv=E[ev+Ic];si+=F0*tv}}}}h[p*ae+m*G+x*Ve+b*On+he]=si}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const I7e={kernelName:_D,backendName:"cpu",kernelFunc:T7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N7e=bn(yx,e=>Math.cos(e)),D7e={kernelName:yx,backendName:"cpu",kernelFunc:N7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F7e=bn(xx,e=>Math.cosh(e)),R7e={kernelName:xx,backendName:"cpu",kernelFunc:F7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O7e(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:s,boxInd:o}=t,{cropSize:a,method:u,extrapolationValue:l}=r,[c,f,d,h]=i.shape,p=s.shape[0],[m,x]=a,b=Ft([p,m,x,h],"float32"),v=n.data.get(s.dataId).values,$=n.data.get(o.dataId).values,C=n.data.get(i.dataId).values,S=ut(i.shape),A=ut(b.shape);for(let E=0;E<p;E++){const _=E*4,D=v[_],N=v[_+1],T=v[_+2],L=v[_+3],O=$[E];if(O>=c)continue;const M=m>1?(T-D)*(f-1)/(m-1):0,R=x>1?(L-N)*(d-1)/(x-1):0;for(let P=0;P<m;P++){const j=m>1?D*(f-1)+P*M:.5*(D+T)*(f-1);if(j<0||j>f-1){for(let z=0;z<x;z++)for(let q=0;q<h;q++){const H=q+z*A[2]+P*A[1]+E*A[0];b.values[H]=l}continue}if(u==="bilinear"){const z=Math.floor(j),q=Math.ceil(j),H=j-z;for(let V=0;V<x;V++){const X=x>1?N*(d-1)+V*R:.5*(N+L)*(d-1);if(X<0||X>d-1){for(let be=0;be<h;be++){const _e=be+V*A[2]+P*A[1]+E*A[0];b.values[_e]=l}continue}const re=Math.floor(X),le=Math.ceil(X),ue=X-re;for(let be=0;be<h;be++){let _e=be+re*S[2]+z*S[1]+O*S[0];const Ne=C[_e];_e=be+le*S[2]+z*S[1]+O*S[0];const Y=C[_e];_e=be+re*S[2]+q*S[1]+O*S[0];const ae=C[_e];_e=be+le*S[2]+q*S[1]+O*S[0];const he=C[_e],G=Ne+(Y-Ne)*ue,je=ae+(he-ae)*ue;_e=be+V*A[2]+P*A[1]+E*A[0],b.values[_e]=G+(je-G)*H}}}else for(let z=0;z<x;++z){const q=x>1?N*(d-1)+z*R:.5*(N+L)*(d-1);if(q<0||q>d-1){for(let X=0;X<h;X++){const re=X+z*A[2]+P*A[1]+E*A[0];b.values[re]=l}continue}const H=Math.round(q),V=Math.round(j);for(let X=0;X<h;X++){const re=X+H*S[2]+V*S[1]+O*S[0],le=X+z*A[2]+P*A[1]+E*A[0];b.values[le]=C[re]}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const M7e={kernelName:ID,backendName:"cpu",kernelFunc:O7e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;Qe(i,"cumprod");const u=nr([s],i.shape.length);let l=i;u!=null&&(l=Xs({inputs:{x:i},backend:n,attrs:{perm:u}}));const c=yr(1,i.shape.length)[0];if(c!==l.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${c}`);const f=Gs(l.dtype,"int32"),d=yD(me(l.shape),f),h=n.data.get(l.dataId).values,p=l.shape[l.shape.length-1],m=a?(b,v)=>b+p-v-1:(b,v)=>b+v;for(let b=0;b<h.length;b+=p)for(let v=0;v<p;v++){const $=m(b,v);if(v===0)d[$]=o?1:h[$];else{const C=m(b,v-1);d[$]=o?h[C]*d[C]:h[$]*d[C]}}const x=n.makeTensorInfo(l.shape,f,d);if(u!=null){const b=Jh(u),v=Xs({inputs:{x},backend:n,attrs:{perm:b}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(l),v}return x}const P7e={kernelName:TD,backendName:"cpu",kernelFunc:L7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;Qe(i,"cumsum");const u=nr([s],i.shape.length);let l=i;u!=null&&(l=Xs({inputs:{x:i},backend:n,attrs:{perm:u}}));const c=yr(1,i.shape.length)[0];if(c!==l.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${c}`);const f=Gs(l.dtype,"int32"),d=vi(me(l.shape),f),h=n.data.get(l.dataId).values,p=l.shape[l.shape.length-1],m=a?(b,v)=>b+p-v-1:(b,v)=>b+v;for(let b=0;b<h.length;b+=p)for(let v=0;v<p;v++){const $=m(b,v);if(v===0)d[$]=o?0:h[$];else{const C=m(b,v-1);d[$]=o?h[C]+d[C]:h[$]+d[C]}}const x=n.makeTensorInfo(l.shape,f,d);if(u!=null){const b=Jh(u),v=Xs({inputs:{x},backend:n,attrs:{perm:b}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(l),v}return x}const z7e={kernelName:AC,backendName:"cpu",kernelFunc:B7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o,binaryOutput:a}=r;if(i.shape.length===1){const u=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,c=VU(u,l,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,c)}else if(i.shape.length===2){const u=n.bufferSync(i),l=n.bufferSync(s),c=Xhe(u,l,o,a);return n.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const j7e={kernelName:ND,backendName:"cpu",kernelFunc:U7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:s,dataFormat:o}=r;U(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=i.shape[0],u=i.shape[1],l=i.shape[2],c=i.shape[3],f=u*s,d=l*s,h=c/(s*s),p=n.data.get(i.dataId).values,m=new Float32Array(a*f*d*h);let x=0;for(let b=0;b<a;++b)for(let v=0;v<f;++v){const $=Math.floor(v/s),C=v%s;for(let S=0;S<d;++S){const A=Math.floor(S/s),E=S%s,_=(C*s+E)*h;for(let D=0;D<h;++D){const T=D+_+c*(A+l*($+u*b));m[x++]=p[T]}}}return n.makeTensorInfo([a,f,d,h],i.dtype,m)}const V7e={kernelName:DD,backendName:"cpu",kernelFunc:W7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xpe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u,dimRoundingMode:l}=r;Qe([i,s],"depthwiseConv2DNative");const c=ut(i.shape),f=ut(s.shape);let d=u;d==null&&(d=[1,1]),U(Si(o,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`);const h=Jr(i.shape,s.shape,o,d,a,l,!0),{filterHeight:p,filterWidth:m,dilationHeight:x,dilationWidth:b,padInfo:v}=h,$=v.left,C=v.top,S=h.outChannels/h.inChannels,A=new Sr(h.outShape,i.dtype),E=n.data.get(i.dataId).values,_=n.data.get(s.dataId).values,D=A.values;for(let N=0;N<h.batchSize;++N){const T=N*c[0],L=N*A.strides[0];for(let O=0;O<h.outHeight;++O){const M=L+O*A.strides[1],R=O*h.strideHeight-C;for(let P=0;P<p;++P){const j=R+P*x;if(j<0||j>=h.inHeight)continue;const z=P*f[0],q=T+j*c[1];for(let H=0;H<h.outWidth;++H){const V=M+H*A.strides[2],X=H*h.strideWidth-$;for(let re=0;re<m;++re){const le=X+re*b;if(le<0||le>=h.inWidth)continue;const ue=z+re*f[1],be=q+le*h.inChannels;let _e=V,Ne=ue;for(let Y=0;Y<h.inChannels;++Y){const ae=E[be+Y];for(let he=0;he<S;++he)D[_e+he]+=ae*_[Ne+he];_e+=S,Ne+=S}}}}}}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const q7e={kernelName:_C,backendName:"cpu",kernelFunc:Xpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:l,filterShape:c}=r;Qe([i,s],"depthwiseConv2dNativeBackpropFilter");const f=Jr(i.shape,c,o,a,u,l,!0),{strideHeight:d,strideWidth:h,filterHeight:p,filterWidth:m}=f,x=new Sr(f.filterShape,"float32"),b=f.padInfo.left,v=f.padInfo.top,$=f.outChannels/f.inChannels,C=n.data.get(i.dataId).values,S=new Sr(i.shape,i.dtype,C),A=n.data.get(s.dataId).values,E=new Sr(s.shape,s.dtype,A);for(let _=0;_<p;++_){const D=Math.max(0,Math.ceil((v-_)/d)),N=Math.min(f.outHeight,(f.inHeight+v-_)/d);for(let T=0;T<m;++T){const L=Math.max(0,Math.ceil((b-T)/h)),O=Math.min(f.outWidth,(f.inWidth+b-T)/h);for(let M=0;M<f.outChannels;++M){const R=Math.trunc(M/$),P=M%$;let j=0;for(let z=0;z<f.batchSize;++z)for(let q=D;q<N;++q){const H=_+q*d-v;for(let V=L;V<O;++V){const X=T+V*h-b;j+=S.get(z,H,X,R)*E.get(z,q,V,M)}}x.set(j,_,T,R,P)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const H7e={kernelName:FD,backendName:"cpu",kernelFunc:G7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7e(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:l,inputShape:c}=r;Qe([i,s],"depthwiseConv2DNativeBackpropInput");const f=ut(i.shape),d=ut(s.shape),h=Jr(c,s.shape,o,a,u,l,!0),p=new Sr(h.inShape,"float32"),m=p.values,[x,b,v]=p.strides,$=n.data.get(i.dataId).values,[C,S,A]=f,E=n.data.get(s.dataId).values,[_,D,N]=d,{batchSize:T,filterHeight:L,filterWidth:O,inChannels:M,inHeight:R,inWidth:P,outChannels:j,outHeight:z,outWidth:q,strideHeight:H,strideWidth:V}=h,X=L-1-h.padInfo.top,re=O-1-h.padInfo.left,le=j/M;for(let ue=0;ue<T;++ue)for(let be=0;be<M;++be)for(let _e=0;_e<R;++_e){const Ne=_e-X,Y=Math.max(0,Math.ceil(Ne/H)),ae=Math.min(z,(L+Ne)/H);for(let he=0;he<P;++he){const G=he-re,je=Math.max(0,Math.ceil(G/V)),Ce=Math.min(q,(O+G)/V);let We=0;for(let Ve=Y;Ve<ae;++Ve){const gt=Ve*H-Ne;for(let ct=je;ct<Ce;++ct){const _s=ct*V-G,On=C*ue+S*Ve+A*ct,Fi=_*(L-1-gt)+D*(O-1-_s)+N*be;for(let zr=0;zr<le;++zr){const da=be*le+zr,si=$[On+da],ro=E[Fi+zr];We+=si*ro}}}m[x*ue+b*_e+v*he+be]=We}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Y7e={kernelName:RD,backendName:"cpu",kernelFunc:X7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K7e(e){const{inputs:t,backend:n}=e,{x:r}=t,i=me(r.shape),s=n.data.get(r.dataId).values,o=Ft([i,i],r.dtype),a=o.values;for(let l=0;l<s.length;l++)a[l*i+l]=s[l];const u=[...r.shape,...r.shape];return n.makeTensorInfo(u,o.dtype,o.values)}const Q7e={kernelName:OD,backendName:"cpu",kernelFunc:K7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z7e={kernelName:TC,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i}=e,{strides:s,pad:o,dilations:a}=n,u=t,l=u.data.get(r.dataId).values,c=r.shape.length,f=u.data.get(i.dataId).values,d=i.shape.length,{batchSize:h,inHeight:p,inWidth:m,inChannels:x,outHeight:b,outWidth:v,padInfo:$,strideHeight:C,strideWidth:S,filterHeight:A,filterWidth:E,dilationHeight:_,dilationWidth:D,outShape:N}=xS(r.shape,i.shape,s,o,"NHWC",a),T=me(N),L=N.length,O=ur(r.dtype,T);for(let R=0;R<h;++R)for(let P=0;P<b;++P){const j=P*C-$.top;for(let z=0;z<v;++z){const q=z*S-$.left;for(let H=0;H<x;++H){let V=Number.MIN_SAFE_INTEGER;for(let re=0;re<A;++re){const le=j+re*_;if(le>=0&&le<p)for(let ue=0;ue<E;++ue){const be=q+ue*D;if(be>=0&&be<m){const _e=_u([R,le,be,H],c,ut(r.shape)),Ne=_u([re,ue,H],d,ut(i.shape)),Y=l[_e]+f[Ne];Y>V&&(V=Y)}}}const X=_u([R,P,z,H],L,ut(N));O[X]=V}}}return{dataId:u.write(Kh(O,r.dtype),N,r.dtype),shape:N,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J7e={kernelName:jT,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:s}=e,{strides:o,pad:a,dilations:u}=n,l=t,c=Oa(r.shape,l.data.get(r.dataId).values),f=Oa(i.shape,l.data.get(i.dataId).values),{batchSize:d,inHeight:h,inWidth:p,inChannels:m,outHeight:x,outWidth:b,padInfo:v,strideHeight:$,strideWidth:C,filterHeight:S,filterWidth:A,dilationHeight:E,dilationWidth:_,outShape:D}=xS(r.shape,i.shape,o,a,"NHWC",u);U(s.rank===D.length,()=>`Error in ${jT}, dy must have the same rank as output ${D.length}, but got ${s.rank}`);const N=Oa(D,l.data.get(s.dataId).values),T=Y7(i.shape,i.dtype);for(let O=0;O<d;++O)for(let M=0;M<x;++M){const R=M*$-v.top;for(let P=0;P<b;++P){const j=P*C-v.left;for(let z=0;z<m;++z){let q=Number.MIN_SAFE_INTEGER,H=0,V=0;for(let X=0;X<S;++X){const re=R+X*E;if(re>=0&&re<h)for(let le=0;le<A;++le){const ue=j+le*_;if(ue>=0&&ue<p){const be=c[O][re][ue][z]+f[X][le][z];be>q&&(q=be,H=X,V=le)}}}T[H][V][z]+=N[O][M][P][z]}}}return{dataId:l.write(Kh(T,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e9e={kernelName:UT,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r,filter:i,dy:s}=e,{strides:o,pad:a,dilations:u}=n,l=t,c=Oa(r.shape,l.data.get(r.dataId).values),f=Oa(i.shape,l.data.get(i.dataId).values),{batchSize:d,inHeight:h,inWidth:p,inChannels:m,outHeight:x,outWidth:b,padInfo:v,strideHeight:$,strideWidth:C,filterHeight:S,filterWidth:A,dilationHeight:E,dilationWidth:_,outShape:D}=xS(r.shape,i.shape,o,a,"NHWC",u);U(s.rank===D.length,()=>`Error in ${UT}, dy must have the same rank as output ${D.length}, but got ${s.rank}`);const N=Oa(D,l.data.get(s.dataId).values),T=Y7(r.shape,r.dtype);for(let O=0;O<d;++O)for(let M=0;M<x;++M){const R=M*$-v.top;for(let P=0;P<b;++P){const j=P*C-v.left;for(let z=0;z<m;++z){let q=Number.MIN_SAFE_INTEGER,H=R<0?0:R,V=j<0?0:j;for(let X=0;X<S;++X){const re=R+X*E;if(re>=0&&re<h)for(let le=0;le<A;++le){const ue=j+le*_;if(ue>=0&&ue<p){const be=c[O][re][ue][z]+f[X][le][z];be>q&&(q=be,H=re,V=ue)}}}T[O][H][V][z]+=N[O][M][P][z]}}}return{dataId:l.write(Kh(T,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9e(e){const{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{canvas:s,options:o}=r,{contextOptions:a,imageOptions:u}=o||{},l=(u==null?void 0:u.alpha)||1,c=(a==null?void 0:a.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const f=s.getContext(c,(a==null?void 0:a.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${c} type.`);const[d,h]=i.shape.slice(0,2),p=i.shape.length===2?1:i.shape[2],m=n.data.get(i.dataId).values,x=i.dtype==="float32"?255:1,b=new Uint8ClampedArray(h*d*4);for(let $=0;$<d*h;++$){const C=[0,0,0,255*l];for(let A=0;A<p;A++){const E=m[$*p+A];if(i.dtype==="float32"){if(E<0||E>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${E}.`)}else if(i.dtype==="int32"&&(E<0||E>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${E}.`);p===1?(C[0]=E*x,C[1]=E*x,C[2]=E*x):C[A]=E*x}const S=$*4;b[S+0]=Math.round(C[0]),b[S+1]=Math.round(C[1]),b[S+2]=Math.round(C[2]),b[S+3]=Math.round(C[3])}s.width=h,s.height=d;const v=new ImageData(b,h,d);return f.putImageData(v,0,0),i}const n9e={kernelName:MD,backendName:"cpu",kernelFunc:t9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MS(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;Qe(i,"sum");let a;i.dtype==="bool"?a=vh({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):a=Hl({inputs:{x:i},backend:n});const u=a.shape.length,l=Ot(s,a.shape),c=nr(l,u);let f=l,d=a;c!=null&&(d=Xs({inputs:{x:a},backend:n,attrs:{perm:c}}),f=yr(f.length,u)),ki("sum",f,d.shape.length);const[h,p]=ei(d.shape,f),m=Gs(d.dtype,"int32");let x=rI(n,h,m);const b=me(p),v=n.data.get(x.dataId).values,$=n.data.get(d.dataId).values;for(let C=0;C<v.length;++C){const S=C*b;let A=0;for(let E=0;E<b;++E)A+=$[S+E];v[C]=A}if(o){const C=mr(x.shape,l),S=x;x=Fn({inputs:{x},backend:n,attrs:{shape:C}}),n.disposeIntermediateTensorInfo(S)}return n.disposeIntermediateTensorInfo(a),c!=null&&n.disposeIntermediateTensorInfo(d),x}const r9e={kernelName:uS,backendName:"cpu",kernelFunc:MS};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9e(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,s=t,{allDims:o,summedDims:a,idDims:u}=hU(i,s.length);gU(o.length,u,s);const{path:l,steps:c}=mU(a,u),f=c.length;let d=null,h=o.length;const p=[];for(let m=0;m<f;++m){for(const x of c[m]){const{permutationIndices:b,expandDims:v}=pU(h,u[x]);let $;yU(b)?$=s[x]:($=Xs({inputs:{x:s[x]},backend:n,attrs:{perm:b}}),p.push($));const C=$.shape.slice();for(let S=0;S<v.length;++S)C.splice(v[S],0,1);Gt($.shape,C)||($=Fn({inputs:{x:$},backend:n,attrs:{shape:C}}),p.push($)),d===null?d=$:(d=v3({inputs:{a:$,b:d},backend:n}),p.push(d))}m<f-1&&(l[m]>=0&&(d=MS({inputs:{x:d},backend:n,attrs:{axis:l[m]-(o.length-h),keepDims:!1}}),p.push(d)),h--)}for(const m of p)m!==d&&n.disposeIntermediateTensorInfo(m);return d}const s9e={kernelName:LD,backendName:"cpu",kernelFunc:i9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9e(e){const{inputs:t,backend:n}=e,{dy:r,y:i}=t;Qe([r,i],"eluGrad");const s=new Float32Array(me(i.shape)),o=n.data.get(i.dataId).values,a=n.data.get(r.dataId).values;for(let u=0;u<o.length;++u){const l=o[u];l>=0?s[u]=a[u]:s[u]=a[u]*(l+1)}return n.makeTensorInfo(i.shape,"float32",s)}const a9e={kernelName:PD,backendName:"cpu",kernelFunc:o9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u9e=oU,l9e=aU,c9e=uU,f9e=lU,d9e=cU,h9e=fU,p9e=bn(wx,e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+u9e*n);return t*(1-((((h9e*r+d9e)*r+f9e)*r+c9e)*r+l9e)*r*Math.exp(-n*n))}),g9e={kernelName:wx,backendName:"cpu",kernelFunc:p9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oI(e){const{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:s}=r,o=i.shape.length,a=i.shape.slice();let u=s;return s<0&&(U(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+s+1),a.splice(u,0,1),Fn({inputs:{x:i},backend:n,attrs:{shape:a}})}const m9e={kernelName:NC,backendName:"cpu",kernelFunc:oI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y9e=br((e,t)=>e/t),KU=Pr(bx,y9e),M6={kernelName:bx,backendName:"cpu",kernelFunc:KU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ype(e,t,n){const r=e.shape,i=r[0],s=r[1],o=n.data.get(e.dataId),a=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,l=[i,s],c=me(l),f=Zr("float32",c),d=Zr("float32",c);for(let x=0;x<i;x++){const b=cm({inputs:{x:a},backend:n,attrs:{begin:[x,0],size:[1,s]}}),v=cm({inputs:{x:u},backend:n,attrs:{begin:[x,0],size:[1,s]}}),$=xo({inputs:{real:b,imag:v},backend:n}),{real:C,imag:S}=x9e($,t,n),A=Af(C,S);for(let E=0;E<s;E++){const _=dU(A,E);f[x*s+E]=_.real,d[x*s+E]=_.imag}n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo($)}const h=n.makeTensorInfo(l,"float32",f),p=n.makeTensorInfo(l,"float32",d),m=xo({inputs:{real:h,imag:p},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),m}function x9e(e,t,n){const r=me(e.shape),i=n.data.get(e.dataId),s=n.data.get(i.complexTensorInfos.real.dataId).values,o=n.data.get(i.complexTensorInfos.imag.dataId).values;if(b9e(r)){const a=L6(s,o,r,t,n),u=[e.shape[0],e.shape[1]];if(t){const l=n.makeTensorInfo(u,"float32",a.real),c=n.makeTensorInfo(u,"float32",a.imag),f=n.makeTensorInfo([],"float32",Pf(r,"float32")),d=Hl({inputs:{x:f},backend:n}),h=M6.kernelFunc({inputs:{a:l,b:f},backend:n}),p=M6.kernelFunc({inputs:{a:c,b:d},backend:n}),m=n.data.get(h.dataId).values,x=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),{real:m,imag:x}}return a}else{const a=Af(s,o),u=v9e(a,r,t);return tfe(u)}}function b9e(e){return(e&e-1)===0}function L6(e,t,n,r,i){if(n===1)return{real:e,imag:t};const s=Af(e,t),o=n/2,a=nfe(s),u=a.real,l=a.imag,c=[u.length],f=i.makeTensorInfo(c,"float32",u),d=i.makeTensorInfo(c,"float32",l),h=xo({inputs:{real:f,imag:d},backend:i}),p=rfe(s),m=p.real,x=p.imag,b=[m.length],v=i.makeTensorInfo(b,"float32",m),$=i.makeTensorInfo(b,"float32",x),C=xo({inputs:{real:v,imag:$},backend:i}),S=L6(u,l,o,r,i),A=S.real,E=S.imag,_=[A.length],D=i.makeTensorInfo(_,"float32",A),N=i.makeTensorInfo(_,"float32",E),T=xo({inputs:{real:D,imag:N},backend:i}),L=L6(m,x,o,r,i),O=L.real,M=L.imag,R=[O.length],P=i.makeTensorInfo(R,"float32",O),j=i.makeTensorInfo(R,"float32",M),z=xo({inputs:{real:P,imag:j},backend:i}),q=sfe(n,r),H=[q.real.length],V=i.makeTensorInfo(H,"float32",q.real),X=i.makeTensorInfo(H,"float32",q.imag),re=xo({inputs:{real:V,imag:X},backend:i}),le=v3({inputs:{a:re,b:z},backend:i}),ue=uy({inputs:{a:T,b:le},backend:i}),be=XU({inputs:{a:T,b:le},backend:i}),_e=lm({inputs:{input:ue},backend:i}),Ne=lm({inputs:{input:be},backend:i}),Y=ly({inputs:{input:ue},backend:i}),ae=ly({inputs:{input:be},backend:i}),he=cy({inputs:[_e,Ne],backend:i,attrs:{axis:0}}),G=cy({inputs:[Y,ae],backend:i,attrs:{axis:0}}),je=i.data.get(he.dataId).values,Ce=i.data.get(G.dataId).values;return i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(v),i.disposeIntermediateTensorInfo($),i.disposeIntermediateTensorInfo(C),i.disposeIntermediateTensorInfo(D),i.disposeIntermediateTensorInfo(N),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo(P),i.disposeIntermediateTensorInfo(j),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(re),i.disposeIntermediateTensorInfo(le),i.disposeIntermediateTensorInfo(ue),i.disposeIntermediateTensorInfo(be),i.disposeIntermediateTensorInfo(_e),i.disposeIntermediateTensorInfo(Y),i.disposeIntermediateTensorInfo(Ne),i.disposeIntermediateTensorInfo(ae),i.disposeIntermediateTensorInfo(he),i.disposeIntermediateTensorInfo(G),{real:je,imag:Ce}}function v9e(e,t,n){const r=new Float32Array(t*2);for(let i=0;i<t;i++){let s=0,o=0;for(let a=0;a<t;a++){const u=ofe(i*a,t,n),l=dU(e,a);s+=l.real*u.real-l.imag*u.imag,o+=l.real*u.imag+l.imag*u.real}n&&(s/=t,o/=t),ife(r,s,o,i)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9e(e){const{inputs:t,backend:n}=e,{input:r}=t,i=me(r.shape),s=r.shape[r.shape.length-1],o=i/s,a=Fn({inputs:{x:r},backend:n,attrs:{shape:[o,s]}}),u=Ype(a,!1,n),l=Fn({inputs:{x:u},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),l}const $9e={kernelName:BD,backendName:"cpu",kernelFunc:w9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QU(e){const{backend:t,attrs:n}=e,{shape:r,value:i,dtype:s}=n,o=s||Bm(i),a=ur(o,me(r));return S9e(a,i,o),t.makeTensorInfo(r,o,a)}const C9e={kernelName:zD,backendName:"cpu",kernelFunc:QU};function S9e(e,t,n){e.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k9e={kernelName:UD,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,i=n,s=Zr(r.dtype,me(r.shape)),[o,a,u,l]=r.shape,c=i.data.get(r.dataId).values;for(let d=0;d<o;d++){const h=d*u*a*l;for(let p=0;p<a;p++){const m=p*(u*l);for(let x=0;x<u;x++){const b=x*l;for(let v=0;v<l;v++){const $=Math.round(u-x-1),C=h+m+b+v;let S=c[C];if($>=0&&$<u){const A=$*l,E=h+m+A+v;S=c[E]}s[C]=S}}}}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:l,dataFormat:c,dilations:f,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r;let m=Hpe({inputs:{x:i,filter:s},backend:n,attrs:{strides:u,pad:l,dataFormat:c,dilations:f,dimRoundingMode:d}});if(o){const x=m;if(c==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const b=Fn({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=uy({inputs:{a:m,b},backend:n}),n.disposeIntermediateTensorInfo(b)}else m=uy({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(x)}if(h){const x=m;if(c==="NCHW"&&h==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const b=Fn({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=sI(n,m,h,b,p),n.disposeIntermediateTensorInfo(b)}else m=sI(n,m,h,a,p);n.disposeIntermediateTensorInfo(x)}return m}const A9e={kernelName:Ow,backendName:"cpu",kernelFunc:E9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:l,dataFormat:c,dilations:f,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r;let m=Xpe({inputs:{x:i,filter:s},backend:n,attrs:{strides:u,pad:l,dataFormat:c,dilations:f,dimRoundingMode:d}});if(o){const x=m;m=uy({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(x)}if(h){const x=m;m=sI(n,m,h,a,p),n.disposeIntermediateTensorInfo(x)}return m}const T9e={kernelName:Mw,backendName:"cpu",kernelFunc:_9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I9e(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,s=me(r.shape),o=i.shape,a=o[o.length-1],[u,l,c,f]=t3(r,i);if(l===0)return n.makeTensorInfo(u,r.dtype,[]);const d=n.data.get(i.dataId).values,h=n.bufferSync(r),p=spe(d,h,r.dtype,l,a,c,f,r.shape,s);return n.makeTensorInfo(u,r.dtype,p.values)}const N9e={kernelName:jD,backendName:"cpu",kernelFunc:I9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9e(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:s}=t,{axis:o,batchDims:a}=r;Qe([i,s],"gatherV2");const u=Ot(o,i.shape)[0],l=n.data.get(s.dataId).values,c=i.shape[u];for(let C=0;C<l.length;++C){const S=l[C];U(S<=c-1&&S>=0,()=>`GatherV2: the index value ${S} is not in [0, ${c-1}]`)}let f=a;a==null&&(f=0);const d=me(s.shape),h=bU(i,s,u,f),p=Fn({inputs:{x:i},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),m=Fn({inputs:{x:s},backend:n,attrs:{shape:[h.batchSize,d/h.batchSize]}}),x=[h.batchSize,h.outerSize,d/h.batchSize,h.sliceSize],b=n.bufferSync(m),v=n.bufferSync(p),$=ope(v,b,x);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(h.outputShape,$.dtype,$.values)}const F9e={kernelName:FC,backendName:"cpu",kernelFunc:D9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9e(e){const{inputs:t,backend:n}=e,{input:r}=t,i=me(r.shape),s=r.shape[r.shape.length-1],o=i/s,a=Fn({inputs:{x:r},backend:n,attrs:{shape:[o,s]}}),u=Ype(a,!0,n),l=Fn({inputs:{x:u},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),l}const O9e={kernelName:WD,backendName:"cpu",kernelFunc:R9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M9e=bn(_x,e=>Number.isFinite(e)?1:0,"bool"),L9e={kernelName:_x,backendName:"cpu",kernelFunc:M9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P9e=bn(Tx,e=>Math.abs(e)===1/0?1:0,"bool"),B9e={kernelName:Tx,backendName:"cpu",kernelFunc:P9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z9e=bn(Ix,e=>Number.isNaN(e)?1:0,"bool"),U9e={kernelName:Ix,backendName:"cpu",kernelFunc:z9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j9e(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:s}=n,o=fpe(r,i,s);return t.makeTensorInfo([o.length],"float32",o)}const W9e={kernelName:qD,backendName:"cpu",kernelFunc:j9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V9e=bn(Dx,e=>Math.log1p(e)),q9e={kernelName:Dx,backendName:"cpu",kernelFunc:V9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G9e=br((e,t)=>e&&t),H9e=Pr(PC,G9e,null,"bool"),X9e={kernelName:PC,backendName:"cpu",kernelFunc:H9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y9e=bn(BC,e=>e?0:1,"bool"),K9e={kernelName:BC,backendName:"cpu",kernelFunc:Y9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q9e=br((e,t)=>e||t),Z9e=Pr(zC,Q9e,null,"bool"),J9e={kernelName:zC,backendName:"cpu",kernelFunc:Z9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:s,bias:o,alpha:a,beta:u}=r;Qe(i,"LRN");const l=i.shape[3],c=l-1,f=n.data.get(i.dataId).values,d=me(i.shape),h=new Float32Array(d);function p(m){const x=m%l;let b=m-x+Math.max(0,x-s);const v=m-x+Math.min(x+s,c);let $=0;for(;b<=v;b++){const C=f[b];$+=C*C}return $}for(let m=0;m<d;m++){const x=p(m),b=f[m]*Math.pow(o+a*x,-u);h[m]=b}return n.makeTensorInfo(i.shape,i.dtype,h)}const tUe={kernelName:UC,backendName:"cpu",kernelFunc:eUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,y:s,dy:o}=t,{depthRadius:a,bias:u,alpha:l,beta:c}=r;Qe(o,"LRNGrad");const f=me(o.shape),d=o.shape[3],h=n.data.get(o.dataId).values,p=n.data.get(i.dataId).values,m=n.data.get(s.dataId).values,x=new Float32Array(f),b=f;for(let v=0;v<b;v++){const $=v%d,C=v-$+Math.max(0,$-a),S=v-$+Math.min(d,$+a+1);let A=0;for(let E=C;E<S;E++)A+=Math.pow(p[E],2);A=l*A+u;for(let E=C;E<S;E++){let _=-2*l*c*p[E]*m[v]/A;v===E&&(_+=Math.pow(A,-c)),_*=h[v],x[E]+=_}}return n.makeTensorInfo(o.shape,i.dtype,x)}const rUe={kernelName:GD,backendName:"cpu",kernelFunc:nUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kpe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:s,keepDims:o}=r,a=n;let u=i.shape;const l=u.length,c=Ot(s,u);let f=c;const d=nr(f,l);let h=a.data.get(i.dataId).values;if(d!=null){const C=new Array(l);for(let S=0;S<C.length;S++)C[S]=u[d[S]];h=GU(h,u,i.dtype,d,C),f=yr(f.length,l),u=C}Qe(i,"max"),ki("max",f,l);const[p,m]=ei(u,f),x=me(m),b=hpe(h,x,p,i.dtype),v=a.write(b,p,i.dtype);let $=p;return o&&($=mr(p,c)),{dataId:v,shape:$,dtype:i.dtype}}const iUe={kernelName:jC,backendName:"cpu",kernelFunc:Kpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;Qe(i,"maxPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r,l=1;U(Si(o,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const c=Xa(i.shape,s,o,l,a,u);let f;if(c.filterWidth===1&&c.filterHeight===1&&Gt(c.inShape,c.outShape))f=Hl({inputs:{x:i},backend:n});else{const d=n.data.get(i.dataId).values,h=ut(i.shape),p=YU(d,i.shape,i.dtype,h,c,"max");f=n.makeTensorInfo(c.outShape,i.dtype,p.values)}return f}const oUe={kernelName:WC,backendName:"cpu",kernelFunc:sUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u,dataFormat:l}=r;Qe(i,"maxPool3d");const c=Bf(i.shape,s,o,1,a,u,l),f=n.data.get(i.dataId).values,d=Gpe(f,i.shape,i.dtype,ut(i.shape),c,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const uUe={kernelName:VC,backendName:"cpu",kernelFunc:aUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lUe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,{filterSize:o,strides:a,pad:u,dimRoundingMode:l}=r;Qe([i,s],"maxPool3DGrad");const c=Bf(s.shape,o,a,1,u,l),f=n.bufferSync(s),d=Q8e(f,c),h=c.strideDepth,p=c.strideHeight,m=c.strideWidth,x=c.dilationDepth,b=c.dilationHeight,v=c.dilationWidth,$=c.effectiveFilterDepth,C=c.effectiveFilterHeight,S=c.effectiveFilterWidth,A=$-1-c.padInfo.front,E=S-1-c.padInfo.left,_=C-1-c.padInfo.top,D=Ft(s.shape,"float32"),N=n.bufferSync(i);for(let T=0;T<c.batchSize;++T)for(let L=0;L<c.inChannels;++L)for(let O=0;O<c.inDepth;++O)for(let M=0;M<c.inHeight;++M)for(let R=0;R<c.inWidth;++R){const P=O-A,j=M-_,z=R-E;let q=0;for(let H=0;H<$;H+=x){const V=(P+H)/h;if(!(V<0||V>=c.outDepth||Math.floor(V)!==V))for(let X=0;X<C;X+=b){const re=(j+X)/p;if(!(re<0||re>=c.outHeight||Math.floor(re)!==re))for(let le=0;le<S;le+=v){const ue=(z+le)/m;if(ue<0||ue>=c.outWidth||Math.floor(ue)!==ue)continue;const be=$*C*S-1-d.get(T,V,re,ue,L),_e=H*C*S+X*S+le,Ne=be===_e?1:0;if(Ne===0)continue;const Y=N.get(T,V,re,ue,L);q+=Y*Ne}}}D.set(q,T,O,M,R,L)}return n.makeTensorInfo(D.shape,D.dtype,D.values)}const cUe={kernelName:XD,backendName:"cpu",kernelFunc:lUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fUe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s,output:o}=t,a=s;Qe([s,o],"maxPoolGrad");const{filterSize:u,strides:l,pad:c,dimRoundingMode:f}=r,d=Xa(a.shape,u,l,1,c,f),h=n.data.get(a.dataId).values,p=Ft(d.outShape,a.dtype,qpe(h,a.shape,a.dtype,d).values),m=d.strideHeight,x=d.strideWidth,b=d.dilationHeight,v=d.dilationWidth,$=d.effectiveFilterHeight,C=d.effectiveFilterWidth,S=C-1-d.padInfo.left,A=$-1-d.padInfo.top,E=Ft(a.shape,"float32"),_=n.data.get(i.dataId).values,D=Ft(i.shape,"float32",_);for(let N=0;N<d.batchSize;++N)for(let T=0;T<d.inChannels;++T)for(let L=0;L<d.inHeight;++L)for(let O=0;O<d.inWidth;++O){const M=L-A,R=O-S;let P=0;for(let j=0;j<$;j+=b){const z=(M+j)/m;if(!(z<0||z>=d.outHeight||Math.floor(z)!==z))for(let q=0;q<C;q+=v){const H=(R+q)/x;if(H<0||H>=d.outWidth||Math.floor(H)!==H)continue;const V=$*C-1-p.get(N,z,H,T),X=j*C+q,re=V===X?1:0;if(re===0)continue;const le=D.get(N,z,H,T);P+=le*re}}E.set(P,N,L,O,T)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const dUe={kernelName:HD,backendName:"cpu",kernelFunc:fUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hUe(e,t,n,r,i){const s=ut(t),o=YU(e,t,n,s,i,"max"),a=qpe(e,t,n,i,!0,r);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pUe={kernelName:YD,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:s,pad:o,includeBatchInIndex:a}=t,u=n;Qe(r,"MaxPoolWithArgmax");const l=u.data.get(r.dataId).values,c=Xa(r.shape,i,s,[1,1],o),[f,d]=hUe(l,r.shape,r.dtype,a,c),h=u.write(f,c.outShape,r.dtype),p=u.write(d,c.outShape,r.dtype);return[{dataId:h,shape:c.outShape,dtype:r.dtype},{dataId:p,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=Ot(s,i.shape),l=ei(i.shape,a)[1],c=me(l),f=[],d=n.makeTensorInfo([],"float32",new Float32Array([c]));f.push(d);const h=vh({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});f.push(h);const p=KU({inputs:{a:h,b:d},backend:n});f.push(p);const m=MS({inputs:{x:p},backend:n,attrs:{axis:s,keepDims:o}});return f.forEach(x=>n.disposeIntermediateTensorInfo(x)),m}const mUe={kernelName:qC,backendName:"cpu",kernelFunc:gUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;Qe(i,"min");const a=Ot(s,i.shape);let u=a;const l=nr(u,i.shape.length);let c=i;l!=null&&(c=Xs({inputs:{x:i},backend:n,attrs:{perm:l}}),u=yr(u.length,i.shape.length)),ki("min",u,c.shape.length);const[f,d]=ei(c.shape,u),h=me(d),p=vi(me(f),c.dtype),m=n.data.get(c.dataId).values;for(let b=0;b<p.length;++b){const v=b*h;let $=m[v];for(let C=0;C<h;++C){const S=m[v+C];(Number.isNaN(S)||S<$)&&($=S)}p[b]=$}l!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(f,c.dtype,p);if(o){const b=mr(f,a),v=Fn({inputs:{x},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(x),v}return x}const xUe={kernelName:GC,backendName:"cpu",kernelFunc:yUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,mode:o}=r;Qe(i,"mirrorPad");const a=s.map(($,C)=>$[0]+i.shape[C]+$[1]),u=s.map($=>$[0]),l=s.map(($,C)=>$[0]+i.shape[C]),c=o==="reflect"?0:1,f=n.data.get(i.dataId).values,d=i.shape.length,h=ut(i.shape),p=me(a),m=a.length,x=ut(a),b=Zr(i.dtype,p);for(let $=0;$<p;$++){let C=zm($,m,x);for(let A=0;A<m;A++)C[A]<u[A]?C[A]=u[A]*2-C[A]-c:C[A]>=l[A]&&(C[A]=(l[A]-1)*2-C[A]+c);C=C.map((A,E)=>A-u[E]);const S=_u(C,d,h);b[$]=f[S]}return{dataId:n.write(b,a,i.dtype),shape:a,dtype:i.dtype}}const vUe={kernelName:HC,backendName:"cpu",kernelFunc:bUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wUe=br((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),$Ue=Pr(Ox,wUe),CUe={kernelName:Ox,backendName:"cpu",kernelFunc:$Ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qpe(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:s}=r,o=i.shape.length;let a=s;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const u=Ot([a],i.shape),l=Kpe({inputs:{x:i},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),c=mr(l.shape,u),f=Fn({inputs:{x:l},backend:n,attrs:{shape:c}}),d=XU({inputs:{a:i,b:f},backend:n}),h=tpe({inputs:{x:d},backend:n}),p=MS({inputs:{x:h},backend:n,attrs:{axis:u,keepDims:!1}}),m=Fn({inputs:{x:p},backend:n,attrs:{shape:c}}),x=KU({inputs:{a:h,b:m},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),x}const SUe={kernelName:fS,backendName:"cpu",kernelFunc:Qpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kUe(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:s,seed:o,normalized:a}=r;Qe(i,"multinomial");const u=a?i:Qpe({inputs:{logits:i},backend:n,attrs:{dim:-1}}),l=u.shape[0],c=u.shape[1],f=n.data.get(u.dataId).values,d=[l,s],h=vi(me(d),"int32");for(let p=0;p<l;++p){const m=p*c,x=new Float32Array(c-1);x[0]=f[m];for(let $=1;$<x.length;++$)x[$]=x[$-1]+f[m+$];const b=ib.alea(o.toString()),v=p*s;for(let $=0;$<s;++$){const C=b();h[v+$]=x.length;for(let S=0;S<x.length;S++)if(C<x[S]){h[v+$]=S;break}}}return a||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(d,"int32",h)}const EUe={kernelName:KD,backendName:"cpu",kernelFunc:kUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AUe=QF;function _Ue(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u}=r;Qe(i,"NonMaxSuppression");const l=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,{selectedIndices:f}=AUe(l,c,o,a,u);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const TUe={kernelName:QD,backendName:"cpu",kernelFunc:_Ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IUe=ZF;function NUe(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,padToMaxOutputSize:l}=r;Qe(i,"NonMaxSuppressionPadded");const c=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,{selectedIndices:d,validOutputs:h}=IUe(c,f,o,a,u,l);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const DUe={kernelName:ZD,backendName:"cpu",kernelFunc:NUe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FUe=JF;function RUe(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,softNmsSigma:l}=r;Qe(i,"NonMaxSuppressionWithScore");const c=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,d=o,h=a,p=u,m=l,{selectedIndices:x,selectedScores:b}=FUe(c,f,d,h,p,m);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const OUe={kernelName:JD,backendName:"cpu",kernelFunc:RUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MUe(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:s,depth:o,onValue:a,offValue:u}=r;Qe(i,"oneHot");const l=me(i.shape),c=new Float32Array(l*o);c.fill(u);const f=n.data.get(i.dataId).values;for(let d=0;d<l;++d)f[d]>=0&&f[d]<o&&(c[d*o+f[d]]=a);return n.makeTensorInfo([...i.shape,o],s,c)}const LUe={kernelName:QC,backendName:"cpu",kernelFunc:MUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aI(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const i=lm({inputs:{input:r},backend:n}),s=aI({inputs:{x:i},backend:n}),o=ly({inputs:{input:r},backend:n}),a=aI({inputs:{x:o},backend:n}),u=xo({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),u}else return QU({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const PUe={kernelName:gS,backendName:"cpu",kernelFunc:aI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zpe(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const i=lm({inputs:{input:r},backend:n}),s=Zpe({inputs:{x:i},backend:n}),o=ly({inputs:{input:r},backend:n}),a=aI({inputs:{x:o},backend:n}),u=xo({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),u}else return QU({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const BUe={kernelName:KC,backendName:"cpu",kernelFunc:Zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jpe(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return oI({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const s=t[0].shape,o=t[0].dtype;t.forEach(c=>{Ci(s,c.shape,"All tensors passed to stack must have matching shapes"),U(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],u=t.map(c=>{const f=oI({inputs:{input:c},backend:n,attrs:{dim:i}});return a.push(f),f}),l=cy({inputs:u,backend:n,attrs:{axis:i}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),l}const zUe={kernelName:ZC,backendName:"cpu",kernelFunc:Jpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UUe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,constantValue:o}=r;Qe(i,"pad");const a=s.map((v,$)=>v[0]+i.shape[$]+v[1]),u=s.map(v=>v[0]),l=n.data.get(i.dataId).values,c=me(i.shape),f=i.shape.length,d=ut(i.shape),h=me(a),p=a.length,m=ut(a),x=Zr(i.dtype,h);o!==0&&x.fill(o);for(let v=0;v<c;v++){const C=zm(v,f,d).map((A,E)=>A+u[E]),S=_u(C,p,m);x[S]=l[v]}return{dataId:n.write(x,a,i.dtype),shape:a,dtype:i.dtype}}const ege={kernelName:JC,backendName:"cpu",kernelFunc:UUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jUe=br((e,t)=>Math.pow(e,t)),WUe=Pr(Lx,jUe),VUe={kernelName:Lx,backendName:"cpu",kernelFunc:WUe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qUe(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:s,indices:o}=t,a=i.map(x=>n.data.get(x.dataId).values),u=i.map(x=>x.shape),l=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values,[f,d,h]=bpe(a,u,l,s.shape,s.dtype,c,o.shape),p=f.map(x=>n.makeTensorInfo([x.length],"int32",x)),m=n.makeTensorInfo(h,s.dtype,d);return p.concat([m])}const GUe={kernelName:eF,backendName:"cpu",kernelFunc:qUe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HUe(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:s}=t,o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,[l,c]=vpe(o,r.shape,r.dtype,a,i.shape,u,s.shape),f=n.makeTensorInfo([l.length],"int32",l),d=n.makeTensorInfo([c.length],r.dtype,c);return[f,d]}const XUe={kernelName:tF,backendName:"cpu",kernelFunc:HUe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YUe(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:s,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:u}=r,l=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,f=n.data.get(o.dataId).values,d=a.map(x=>n.data.get(x.dataId).values),h=a.map(x=>x.shape),[p,m]=wpe(l,i.shape,c,s.shape,s.dtype,f,o.shape,d,h,u);return n.makeTensorInfo(p,s.dtype,m)}const KUe={kernelName:nF,backendName:"cpu",kernelFunc:YUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QUe(e){const{backend:t,attrs:n}=e,{start:r,stop:i,dtype:s,step:o}=n,a=$pe(r,i,o,s);return t.makeTensorInfo([a.length],s,a)}const ZUe={kernelName:rF,backendName:"cpu",kernelFunc:QUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JUe=bn(Px,e=>1/e),eje={kernelName:Px,backendName:"cpu",kernelFunc:JUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tje(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r;Qe(i,"resizeBilinear");const u=ut(i.shape),[l,c]=a,[f,d,h,p]=i.shape,m=n.data.get(i.dataId).values,x=new Float32Array(me([f,l,c,p])),b=[s&&l>1?d-1:d,s&&c>1?h-1:h],v=[s&&l>1?l-1:l,s&&c>1?c-1:c];let $=0;const C=b[0]/v[0],S=b[1]/v[1];for(let A=0;A<f;A++)for(let E=0;E<l;E++){let _;o?_=C*(E+.5)-.5:_=C*E;const D=Math.max(0,Math.floor(_)),N=_-D,T=Math.min(d-1,Math.ceil(_)),L=A*u[0]+D*u[1],O=A*u[0]+T*u[1];for(let M=0;M<c;M++){let R;o?R=S*(M+.5)-.5:R=S*M;const P=Math.max(0,Math.floor(R)),j=R-P,z=Math.min(h-1,Math.ceil(R)),q=L+P*u[2],H=O+P*u[2],V=L+z*u[2],X=O+z*u[2];for(let re=0;re<p;re++){const le=m[q+re],ue=m[H+re],be=m[V+re],_e=m[X+re],Ne=le+(be-le)*j,Y=ue+(_e-ue)*j,ae=Ne+(Y-Ne)*N;x[$++]=ae}}}return n.makeTensorInfo([f,l,c,p],"float32",x)}const nje={kernelName:iS,backendName:"cpu",kernelFunc:tje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rje(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r;Qe([s,i],"resizeBilinearGrad");const a=ut(i.shape),[u,l,c,f]=i.shape,[,d,h]=s.shape,p=new Float32Array(u*l*c*f),m=[o&&d>1?l-1:l,o&&h>1?c-1:c],x=[o&&d>1?d-1:d,o&&h>1?h-1:h],b=m[0]/x[0],v=m[1]/x[1],$=n.data.get(s.dataId).values;let C=0;for(let S=0;S<u;S++){const A=S*a[0];for(let E=0;E<d;E++){const _=E*b,D=Math.floor(_),N=Math.min(Math.ceil(_),l-1),T=A+D*a[1],L=A+N*a[1],O=_-D,M=1-O;for(let R=0;R<h;R++){const P=R*v,j=Math.floor(P),z=Math.min(Math.ceil(P),c-1),q=P-j,H=1-q,V=T+j*a[2],X=T+z*a[2],re=L+j*a[2],le=L+z*a[2],ue=M*H,be=M*q,_e=O*H,Ne=O*q;for(let Y=0;Y<f;Y++){const ae=$[C++];p[V+Y]+=ae*ue,p[X+Y]+=ae*be,p[re+Y]+=ae*_e,p[le+Y]+=ae*Ne}}}}return n.makeTensorInfo([u,c,l,f],"float32",p)}const ije={kernelName:oF,backendName:"cpu",kernelFunc:rje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sje(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r;Qe(i,"resizeNearestNeighbor");const u=ut(i.shape),[l,c]=a,[f,d,h,p]=i.shape,m=n.data.get(i.dataId).values,x=new Float32Array(f*l*c*p),b=[s&&l>1?d-1:d,s&&c>1?h-1:h],v=[s&&l>1?l-1:l,s&&c>1?c-1:c],$=b[0]/v[0],C=b[1]/v[1];let S=0;for(let A=0;A<f;A++){const E=A*u[0];for(let _=0;_<l;_++){const D=o?$*(_+.5):$*_;let N=Math.min(d-1,s?Math.round(D):Math.floor(D));o&&(N=Math.max(0,N));const T=E+N*u[1];for(let L=0;L<c;L++){const O=o?C*(L+.5):C*L;let M=Math.min(h-1,s?Math.round(O):Math.floor(O));o&&(M=Math.max(0,M));const R=T+M*u[2];for(let P=0;P<p;P++){const j=m[R+P];x[S++]=j}}}}return n.makeTensorInfo([f,l,c,p],i.dtype,x)}const oje={kernelName:rS,backendName:"cpu",kernelFunc:sje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aje(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r;Qe([s,i],"resizeNearestNeighborGrad");const a=ut(i.shape),u=ut(s.shape),[l,c,f,d]=i.shape,[,h,p]=s.shape,m=new Float32Array(l*c*f*d),x=n.data.get(s.dataId).values,b=[o&&h>1?c-1:c,o&&p>1?f-1:f],v=[o&&h>1?h-1:h,o&&p>1?p-1:p],$=b[0]/v[0],C=b[1]/v[1],S=1/$,A=1/C,E=Math.ceil(S)*2+2,_=Math.ceil(A)*2+2;for(let D=0;D<l;D++){const N=D*a[0];for(let T=0;T<c;T++){const L=N+T*a[1],O=Math.floor(T*S),M=Math.floor(O-E/2);for(let R=0;R<f;R++){const P=L+R*a[2],j=Math.floor(R*A),z=Math.floor(j-_/2);for(let q=0;q<d;q++){let H=0;for(let V=0;V<E;V++){const X=V+M;if(X<0||X>=h)continue;const re=N+X*u[1],le=X*$,ue=Math.min(c-1,o?Math.round(le):Math.floor(le));if(T===ue)for(let be=0;be<_;be++){const _e=be+z;if(_e<0||_e>=p)continue;const Ne=re+_e*u[2],Y=_e*C,ae=Math.min(f-1,o?Math.round(Y):Math.floor(Y));R===ae&&(H+=x[Ne+q])}}m[P+q]=H}}}}return n.makeTensorInfo(i.shape,i.dtype,m)}const uje={kernelName:sF,backendName:"cpu",kernelFunc:aje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lje(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:s}=r;Qe(i,"reverse");const o=i.shape.length,a=Ot(s,i.shape);if(o===0)return Hl({inputs:{x:i},backend:n});const u=new Sr(i.shape,i.dtype),l=n.bufferSync(i);for(let c=0;c<u.size;c++){const f=u.indexToLoc(c),d=f.slice();a.forEach(h=>d[h]=i.shape[h]-1-d[h]),u.set(l.get(...d),...f)}return n.makeTensorInfo(u.shape,u.dtype,u.values)}const cje={kernelName:sS,backendName:"cpu",kernelFunc:lje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fje={kernelName:CF,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:s,center:o}=t,a=n,u=Zr(r.dtype,me(r.shape)),[l,c,f,d]=r.shape,[h,p]=rU(o,c,f),m=255,x=Math.sin(i),b=Math.cos(i),v=a.data.get(r.dataId).values;for(let C=0;C<l;C++){const S=C*f*c*d;for(let A=0;A<c;A++){const E=A*(f*d);for(let _=0;_<f;_++){const D=_*d;for(let N=0;N<d;N++){const T=[l,A,_,N],L=T[2],O=T[1];let M=(L-h)*b-(O-p)*x,R=(L-h)*x+(O-p)*b;M=Math.round(M+h),R=Math.round(R+p);let P=s;if(typeof s!="number"&&(N===3?P=m:P=s[N]),M>=0&&M<f&&R>=0&&R<c){const z=R*(f*d),q=M*d,H=S+z+q+N;P=v[H]}const j=S+E+D+N;u[j]=P}}}}return{dataId:a.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dje=bn(Ux,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),hje={kernelName:Ux,backendName:"cpu",kernelFunc:dje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pje(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:s}=t,{shape:o}=r,{sliceRank:a,numUpdates:u,sliceSize:l,strides:c,outputSize:f}=np(s,i,o),d=!0,h=n.bufferSync(i),p=n.bufferSync(s),m=Ag(h,p,o,f,l,u,a,c,0,d);return n.makeTensorInfo(o,m.dtype,m.values)}const gje={kernelName:aF,backendName:"cpu",kernelFunc:pje};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mje(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<t?n=i+1:r=i;return r}function yje(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<=t?n=i+1:r=i;return r}function xje(e,t,n,r,i,s){const o=ur("int32",n*i);for(let a=0;a<n;++a){const u=e.slice(a*r,(a+1)*r),l=a*i;for(let c=0;c<i;++c)o[l+c]=s==="left"?mje(u,t[c+l]):yje(u,t[c+l])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bje(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:s}=t,{side:o}=r,a=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,l=xje(a,u,i.shape[0],i.shape[1],s.shape[1],o);return n.makeTensorInfo(s.shape,"int32",l)}const vje={kernelName:lF,backendName:"cpu",kernelFunc:bje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wje(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:s}=t;Qe([r,i,s],"select");const o=r.shape.length,a=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,c=Gs(i.dtype,s.dtype),f=vi(me(i.shape),c);let d=0;const h=o===0||o>1||i.shape.length===1?1:me(i.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<h;m++)a[p]===1?f[d++]=u[p]:f[d++]=l[p];return n.makeTensorInfo(i.shape,c,f)}const $je={kernelName:oS,backendName:"cpu",kernelFunc:wje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cje=i3,Sje=s3,kje=bn(Wx,e=>e>=0?Sje*e:Cje*(Math.exp(e)-1)),Eje={kernelName:Wx,backendName:"cpu",kernelFunc:kje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aje=bn(Gx,e=>e<0?-1:e>0?1:0),_je={kernelName:Gx,backendName:"cpu",kernelFunc:Aje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tje=bn(Vx,e=>Math.sin(e)),Ije={kernelName:Vx,backendName:"cpu",kernelFunc:Tje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nje=bn(qx,e=>Math.sinh(e)),Dje={kernelName:qx,backendName:"cpu",kernelFunc:Nje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fje=11920928955078125e-23,oJ=Math.log(Fje)+2,Rje=bn(Xx,e=>{const t=e>-oJ,n=e<oJ,r=Math.exp(e);let i;return n?i=r:t?i=e:i=Math.log(1+r),i}),Oje={kernelName:Xx,backendName:"cpu",kernelFunc:Rje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mje(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,paddings:o}=r;Qe([i],"spaceToBatchND");const a=me(s),u=[[0,0]];u.push(...o);for(let A=1+s.length;A<i.shape.length;++A)u.push([0,0]);const l=ege.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),c=kS(l.shape,s,a,!1),f=ES(c.length,s.length,!1),d=AS(l.shape,s,a,!1),m=Fn({inputs:{x:l},backend:n,attrs:{shape:c}}),v=Xs({inputs:{x:m},backend:n,attrs:{perm:f}}),S=Fn({inputs:{x:v},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),S}const Lje={kernelName:lS,backendName:"cpu",kernelFunc:Mje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pje(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:s,defaultValue:o}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values[0],[f,d,h,p,m]=Epe(a,r.shape,r.dtype,u,i.dtype,l,c);return[n.makeTensorInfo(d,r.dtype,f),n.makeTensorInfo([d[0]],i.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(x=>Number(x)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const Bje={kernelName:cF,backendName:"cpu",kernelFunc:Pje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zje(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:s}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(n.data.get(i.dataId).values),a=n.data.get(r.dataId).values,u=Array.from(n.data.get(s.dataId).values),[l,c,f]=Ape(a,r.shape,r.dtype,o,u);return[n.makeTensorInfo(c,r.dtype,l),n.makeTensorInfo([f.length],s.dtype,new Int32Array(f))]}const Uje={kernelName:fF,backendName:"cpu",kernelFunc:zje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jje(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,[l,c]=HU(o,r.shape,r.dtype,a,u,!0);return n.makeTensorInfo(c,r.dtype,l)}const Wje={kernelName:dF,backendName:"cpu",kernelFunc:jje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vje(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,[l,c]=HU(o,r.shape,r.dtype,a,u);return n.makeTensorInfo(c,r.dtype,l)}const qje={kernelName:hF,backendName:"cpu",kernelFunc:Vje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gje(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:o}=t,{outputShape:a}=r,{sliceRank:u,numUpdates:l,sliceSize:c,strides:f,outputSize:d}=np(s,i,a),h=!1,p=n.bufferSync(i);let m;switch(s.dtype){case"bool":{const x=n.bufferSync(s),b=!!n.data.get(o.dataId).values[0];m=Ag(p,x,a,d,c,l,u,f,b,h);break}case"float32":{const x=n.bufferSync(s),b=n.data.get(o.dataId).values[0];m=Ag(p,x,a,d,c,l,u,f,b,h);break}case"int32":{const x=n.bufferSync(s),b=n.data.get(o.dataId).values[0];m=Ag(p,x,a,d,c,l,u,f,b,h);break}case"string":{const x=n.bufferSync(s),b=Sf(n.data.get(o.dataId).values[0]);m=Ag(p,x,a,d,c,l,u,f,b,h);break}default:throw new Error(`Unsupported type ${s.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const Hje={kernelName:pF,backendName:"cpu",kernelFunc:Gje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xje(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:s,axis:o}=r,a=Ot(o,i.shape)[0],u=xU(i,s,a),l=new Array(i.shape.length).fill(0),c=i.shape.slice();return u.map(f=>{const d=[...c];d[a]=f;const h=cm({inputs:{x:i},backend:n,attrs:{begin:l,size:d}});return l[a]+=f,h})}const Yje={kernelName:cS,backendName:"cpu",kernelFunc:Xje};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kje={kernelName:gF,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{const{x:n}=e,r=t;Qe(n,"square");const i=r.data.get(n.dataId).values,s=new Float32Array(i.length);for(let a=0;a<i.length;++a){const u=i[a];s[a]=u*u}return{dataId:r.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qje=bn(tb,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),Zje={kernelName:tb,backendName:"cpu",kernelFunc:Qje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jje(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,end:o,strides:a,beginMask:u,endMask:l,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:d}=r;Qe(i,"stridedSlice");const{finalShapeSparse:h,finalShape:p,isIdentity:m,sliceDim0:x,isSimpleSlice:b,begin:v,end:$,strides:C}=J9(i.shape,s,o,a,u,l,c,f,d);let S;if(m)S=Fn({inputs:{x:i},backend:n,attrs:{shape:p}});else if(x||b){U(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const A=K9(v,$,C),E=cm({inputs:{x:i},backend:n,attrs:{begin:v,size:A}});S=Fn({inputs:{x:E},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(E)}else{const A=n.bufferSync(i),E=Ipe(h,A,C,v);S=n.makeTensorInfo(p,E.dtype,E.values)}return S}const eWe={kernelName:mF,backendName:"cpu",kernelFunc:Jje};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tWe(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:s,leftPad:o,rightPad:a,padWidth:u,preserveShortSequences:l}=r,{data:c,dataSplits:f}=t,d=n.data.get(c.dataId).values,h=n.data.get(f.dataId).values,[p,m]=Npe(d,h,i,s,o,a,u,l);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",m)]}const nWe={kernelName:yF,backendName:"cpu",kernelFunc:tWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rWe(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:s,delimiter:o}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(s.dataId).values,u=n.data.get(o.dataId).values[0],[l,c,f]=Dpe(a,u,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",l),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const iWe={kernelName:xF,backendName:"cpu",kernelFunc:rWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sWe(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(s.dataId).values,a=Fpe(o,i);return n.makeTensorInfo(s.shape,"int32",a)}const oWe={kernelName:bF,backendName:"cpu",kernelFunc:sWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aWe=bn(Zx,e=>Math.tan(e)),uWe={kernelName:Zx,backendName:"cpu",kernelFunc:aWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lWe=bn(Jx,e=>Math.tanh(e)),cWe={kernelName:Jx,backendName:"cpu",kernelFunc:lWe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fWe(e){const{inputs:t,backend:n}=e,{tensor:r,indices:i,updates:s}=t,{sliceRank:o,numUpdates:a,sliceSize:u,strides:l,outputSize:c}=np(s,i,r.shape),f=!1,d=n.bufferSync(i),h=n.bufferSync(s),p=n.bufferSync(r),m=Ag(d,h,r.shape,c,u,a,o,l,p,f);return n.makeTensorInfo(r.shape,m.dtype,m.values)}const dWe={kernelName:uF,backendName:"cpu",kernelFunc:fWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hWe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:s}=r;Qe(i,"tile");const o=Ope(n.bufferSync(i),s);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const pWe={kernelName:eb,backendName:"cpu",kernelFunc:hWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gWe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:s,sorted:o}=r;Qe(i,"topk");const a=n.data.get(i.dataId).values,[u,l]=Lpe(a,i.shape,i.dtype,s,o);return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}const mWe={kernelName:vF,backendName:"cpu",kernelFunc:gWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yWe(e){const{inputs:t,attrs:n,backend:r}=e,{image:i,transforms:s}=t,{interpolation:o,fillMode:a,fillValue:u,outputShape:l}=n,[c,f,d,h]=i.shape,[p,m]=l??[f,d],x=[c,p,m,h],b=ut(i.shape),v=b[0],$=b[1],C=b[2],S=ut(x),A=S[0],E=S[1],_=S[2],D=Zr(i.dtype,me(x));D.fill(u);const N=r.data.get(i.dataId).values,T=r.data.get(s.dataId).values;for(let O=0;O<c;++O){const M=s.shape[0]===1?T:T.subarray(O*8,O*8+8);for(let R=0;R<p;++R)for(let P=0;P<m;++P)for(let j=0;j<h;++j){let z;const q=M[6]*P+M[7]*R+1;if(q===0)continue;const H=(M[0]*P+M[1]*R+M[2])/q,V=(M[3]*P+M[4]*R+M[5])/q,X=aJ(H,d,a),re=aJ(V,f,a);switch(o){case"nearest":z=CWe(N,f,d,v,$,C,O,re,X,j,u);break;case"bilinear":z=SWe(N,f,d,v,$,C,O,re,X,j,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const le=O*A+R*E+P*_+j;D[le]=z}return r.makeTensorInfo(x,i.dtype,D)}return{dataId:r.write(D,x,i.dtype),shape:i.shape,dtype:i.dtype}}const xWe={kernelName:wF,backendName:"cpu",kernelFunc:yWe};function aJ(e,t,n){switch(n){case"reflect":return bWe(e,t);case"wrap":return vWe(e,t);case"nearest":return $We(e,t);case"constant":default:return wWe(e)}}function bWe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{const r=2*t;n-=r*Math.trunc(n/r),n>=t&&(n=r-n-1)}return lh(0,n,t-1)}function vWe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{const r=t-1;n-=t*Math.trunc(n/r)}return lh(0,n,t-1)}function wWe(e,t){return e}function $We(e,t){return lh(0,e,t-1)}function O2(e,t,n,r,i,s,o,a,u,l,c){const f=o*r+a*i+u*s+l;return 0<=a&&a<t&&0<=u&&u<n?e[f]:c}function CWe(e,t,n,r,i,s,o,a,u,l,c){const f=Math.round(a),d=Math.round(u);return O2(e,t,n,r,i,s,o,f,d,l,c)}function SWe(e,t,n,r,i,s,o,a,u,l,c){const f=Math.floor(a),d=Math.floor(u),h=f+1,p=d+1,m=(p-u)*O2(e,t,n,r,i,s,o,f,d,l,c)+(u-d)*O2(e,t,n,r,i,s,o,f,p,l,c),x=(p-u)*O2(e,t,n,r,i,s,o,h,d,l,c)+(u-d)*O2(e,t,n,r,i,s,o,h,p,l,c);return(h-a)*m+(a-f)*x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kWe(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:s}=t;Qe(s,"unique");const o=r.data.get(s.dataId).values,{outputValues:a,outputShape:u,indices:l}=Ppe(o,i,s.shape,s.dtype);return[r.makeTensorInfo(u,s.dtype,a),r.makeTensorInfo([l.length],"int32",l)]}const EWe={kernelName:$F,backendName:"cpu",kernelFunc:kWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AWe(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i.shape.length,a=i.shape[s],u=new Array(o-1);let l=0;for(let h=0;h<o;h++)h!==s&&(u[l++]=i.shape[h]);const c=new Array(o).fill(0),f=i.shape.slice();f[s]=1;const d=new Array(a);for(let h=0;h<d.length;h++){c[s]=h;const p=cm({inputs:{x:i},backend:n,attrs:{begin:c,size:f}});d[h]=Fn({inputs:{x:p},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(p)}return d}const _We={kernelName:hS,backendName:"cpu",kernelFunc:AWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TWe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:s}=t,{numSegments:o}=r;Qe(i,"unsortedSegmentSum");const a=i.shape.length,u=s.shape.length,l=[],c=[],f=a-u;let d=s;for(let p=0;p<f;++p){const m=oI({inputs:{input:d},backend:n,attrs:{dim:p+1}});d=m,c.push(m)}for(let p=0;p<o;++p){const m=Pf(p,"int32"),x=n.makeTensorInfo([],"int32",m),b=Jhe({inputs:{a:x,b:d},backend:n}),v=vh({inputs:{x:b},backend:n,attrs:{dtype:"float32"}}),$=v3({inputs:{a:v,b:i},backend:n}),C=MS({inputs:{x:$},backend:n,attrs:{axis:0,keepDims:!1}});l.push(C),c.push(x),c.push(b),c.push(v),c.push($),c.push(C)}const h=Jpe({inputs:l,backend:n,attrs:{axis:0}});return c.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const IWe={kernelName:pS,backendName:"cpu",kernelFunc:TWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NWe=[k8e,sze,A8e,T8e,fze,N8e,F8e,O8e,L8e,B8e,U8e,W8e,q8e,X8e,K8e,J8e,t7e,r7e,s7e,C8e,a7e,l7e,f7e,hze,h7e,lze,gze,g7e,oze,y7e,b7e,v7e,$7e,S7e,E7e,_7e,I7e,D7e,R7e,M7e,P7e,z7e,j7e,V7e,q7e,H7e,Y7e,Q7e,Z7e,J7e,e9e,n9e,s9e,m8e,a9e,mze,g9e,yze,m9e,bze,$9e,C9e,k9e,wze,Cze,A9e,T9e,N9e,F9e,kze,Aze,aze,O9e,x7e,L9e,B9e,U9e,y8e,Tze,Nze,W9e,Fze,q9e,X9e,K9e,J9e,tUe,rUe,iUe,Oze,oUe,uUe,cUe,dUe,pUe,mUe,xUe,Lze,vUe,CUe,EUe,Bze,Uze,TUe,DUe,OUe,Wze,LUe,BUe,zUe,ege,VUe,b8e,Gze,GUe,XUe,KUe,ZUe,uze,M6,eje,v8e,w8e,$8e,nje,ije,oje,uje,cje,fje,hje,e8e,gje,vje,$je,Eje,n8e,_je,Ije,Dje,r8e,SUe,Oje,Lje,Bje,Uje,Wje,qje,Hje,Yje,o8e,Kje,u8e,c8e,Zje,eWe,nWe,iWe,oWe,p8e,r9e,uWe,cWe,dWe,pWe,mWe,xWe,Vze,EWe,_We,IWe,PUe];for(const e of NWe)SF(e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yg={},yA={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function DWe(e,t){yg[e]=t}function zu(e,t){if(!(e in yg)||t!=null){const r=RWe(e,t);if(r!==null)yg[e]=r;else return console.log("Could not get context for WebGL version",e),null}const n=yg[e];return n==null||n.isContextLost()?(delete yg[e],zu(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),yg[e])}function FWe(e){if(!ce().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&e===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function RWe(e,t){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=t??FWe(e);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete yg[e]},!1),ce().getBool("SOFTWARE_WEBGL_ENABLED")&&(yA.failIfMajorPerformanceCaveat=!1),e===1?n.getContext("webgl",yA)||n.getContext("experimental-webgl",yA):n.getContext("webgl2",yA)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Zw;(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Zw||(Zw={}));var Jo;(function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"})(Jo||(Jo={}));var fi;(function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(fi||(fi={}));function LS(e,t){return[t,e]}function OWe(e,t){return e*t}function xA(e){const t=me(e),n=Math.ceil(t/4);return PT(n)}function ub(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function MWe(e,t){const[n,r]=ub(e,t);return n*r*4}function ZU(e,t){const n=e;let r,i,s,o,a,u,l,c,f,d;return ce().getNumber("WEBGL_VERSION")===2?(r=n.R32F,i=n.R16F,s=n.RGBA16F,o=n.RGBA32F,a=n.RED,l=4,c=1,f=n.HALF_FLOAT,d=n.FLOAT,u=n.RGBA8):(r=e.RGBA,i=e.RGBA,s=e.RGBA,o=n.RGBA,a=e.RGBA,l=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,d=e.FLOAT,u=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:u,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ge(e,t){const n=t();return ce().getBool("DEBUG")&&LWe(e),n}function LWe(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+UWe(e,t))}const PWe=596e-10,BWe=65504;function zWe(e){return!!(ce().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||PWe<Math.abs(e)&&Math.abs(e)<BWe)}function UWe(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function bA(e,t){return Vf(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function jWe(e,t){const n=Vf(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ge(e,()=>e.shaderSource(n,t)),Ge(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function WWe(e,t){const n=Vf(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ge(e,()=>e.shaderSource(n,t)),Ge(e,()=>e.compileShader(n)),ce().get("ENGINE_COMPILE_ONLY"))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw tge(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const VWe=/ERROR: [0-9]+:([0-9]+):/g;function tge(e,t){const n=VWe.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}const r=+n[1],i=e.split(`
`),s=i.length.toString().length+2,o=i.map((f,d)=>Og((d+1).toString(),s)+f);let a=0;for(let f=0;f<o.length;f++)a=Math.max(o[f].length,a);const u=o.slice(0,r-1),l=o.slice(r-1,r),c=o.slice(r);console.log(u.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${Og(l[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function qWe(e){return Vf(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function GWe(e,t){if(Ge(e,()=>e.linkProgram(t)),!ce().get("ENGINE_COMPILE_ONLY")&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function WL(e,t){if(Ge(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function HWe(e,t){const n=Vf(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Ge(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),Ge(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function XWe(e,t){const n=Vf(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return Ge(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),Ge(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function YWe(e){return Vf(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function KWe(e,t){const n=ce().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const r=`[${e}x${t}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){const r=`[${e}x${t}]`,i=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function QWe(e){return Vf(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function uJ(e,t,n,r,i,s,o){const a=e.getAttribLocation(t,n);return a===-1?!1:(Ge(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),Ge(e,()=>e.vertexAttribPointer(a,i,e.FLOAT,!1,s,o)),Ge(e,()=>e.enableVertexAttribArray(a)),!0)}function ZWe(e,t,n){rVe(e,n),Ge(e,()=>e.activeTexture(e.TEXTURE0+n)),Ge(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function JWe(e,t,n){return Vf(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function eVe(e,t,n){return e.getUniformLocation(t,n)}function tVe(e,t,n,r){Ge(e,()=>ZWe(e,t,r)),Ge(e,()=>e.uniform1i(n,r))}function VL(e,t,n){Ge(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),Ge(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function lJ(e,t){Ge(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),Ge(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function vA(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+nVe(e,t))}function nVe(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function Vf(e,t,n){const r=Ge(e,()=>t());if(r==null)throw new Error(n);return r}function rVe(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){const i=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${i}.`)}}function fy(e,t=2){return me(e.slice(0,e.length-t))}function dy(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function wA(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[fy(e),...dy(e)]),t}function iVe(e,t=!1){let n=ce().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=ce().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&ce().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n=n*2,r=r*2,e=e.map((a,u)=>u>=e.length-2?mD(e[u]):e[u]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=Lf(e).newShape);let i=me(e),s=null;e.length<=1&&i<=n?s=[1,i]:e.length===2&&e[0]<=n&&e[1]<=n?s=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?s=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?s=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?s=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(s=[e[0],e[1]*e[2]*e[3]]);const o=s!=null&&Math.max(...s)>r&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(s==null||o)if(t){const a=fy(e);let u=2,l=2;e.length&&([u,l]=dy(e)),i=a*(u/2)*(l/2),s=PT(i).map(c=>c*2)}else s=PT(i);return s}function $A(e){return e%2===0}function uI(e,t){if(e=e.slice(-2),t=t.slice(-2),Gt(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r||$A(n)&&$A(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&$A(e[0])&&$A(t[0])}let qL,GL;function sVe(e){if(qL==null){const t=zu(e);qL=t.getParameter(t.MAX_TEXTURE_SIZE)}return qL}function oVe(e){if(GL==null){const t=zu(e);GL=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,GL)}function aVe(e){if(e===0)return 0;let t;const n=zu(e);return _a(n,"EXT_disjoint_timer_query_webgl2")&&e===2?t=2:_a(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function _a(e,t){return e.getExtension(t)!=null}function cJ(e){try{if(zu(e)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function uVe(e){if(e===0)return!1;const t=zu(e);if(e===1){if(!_a(t,"OES_texture_float"))return!1}else if(!_a(t,"EXT_color_buffer_float"))return!1;return P6(t)}function lVe(e){if(e===0)return!1;const t=zu(e);if(e===1){if(!_a(t,"OES_texture_float")||!_a(t,"WEBGL_color_buffer_float"))return!1}else{if(_a(t,"EXT_color_buffer_float"))return P6(t);const r="EXT_color_buffer_half_float";if(_a(t,r)){const i=t.getExtension(r);return cVe(t,i)}return!1}return P6(t)}function P6(e){const t=ZU(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(s),o}function cVe(e,t){const n=ZU(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),a}function fVe(e){return e!==2?!1:zu(e).fenceSync!=null}function PS(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&U(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Je=ce();Je.registerFlag("HAS_WEBGL",()=>Je.getNumber("WEBGL_VERSION")>0);Je.registerFlag("WEBGL_VERSION",()=>cJ(2)?2:cJ(1)?1:0);Je.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Je.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Je.get("WEBGL_VERSION")===2);Je.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Je.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Je.registerFlag("WEBGL_PACK",()=>Je.getBool("HAS_WEBGL"));Je.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_PACK_CLIP",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_PACK_REDUCE",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_LAZILY_UNPACK",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_CONV_IM2COL",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Je.getBool("WEBGL_PACK"));Je.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>sVe(Je.getNumber("WEBGL_VERSION")));Je.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>oVe(Je.getNumber("WEBGL_VERSION")));Je.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const e=Je.getNumber("WEBGL_VERSION");return e===0?0:aVe(e)});Je.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Je.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!J7());Je.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>uVe(Je.getNumber("WEBGL_VERSION")));Je.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Je.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Je.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Je.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>lVe(Je.getNumber("WEBGL_VERSION")));Je.registerFlag("WEBGL_FENCE_API_ENABLED",()=>fVe(Je.getNumber("WEBGL_VERSION")));Je.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Je.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Je.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)});Je.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>J7()?1:-1,e=>{if(typeof e!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)});Je.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Je.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Je.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Je.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Je.registerFlag("WEBGL_EXP_CONV",()=>!1);Je.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Je.getBool("IS_TEST"));Je.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Je.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Je.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Je.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function As(){let e,t,n,r,i,s,o,a,u,l;return ce().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",s="outputColor",o="out vec4 outputColor;",a=ce().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",s="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:s,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:u,defineRound:l}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xm(e,t,n="index"){const r=ut(t);return r.map((i,s)=>{const o=`int ${e[s]} = ${n} / ${i}`,a=s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * ${i}`:`index -= ${e[s]} * ${i}`;return`${o}; ${a};`}).join("")}function w3(e,t,n="index"){const r=ut(t);return r.map((i,s)=>{const o=`int ${e[s]} = ${n} / outShapeStrides[${s}]`,a=s===r.length-1?`int ${e[s+1]} = ${n} - ${e[s]} * outShapeStrides[${s}]`:`index -= ${e[s]} * outShapeStrides[${s}]`;return`${o}; ${a};`}).join("")}function dVe(e,t){const n=e.length,r=e.map(s=>`${t}[${s}]`),i=new Array(n-1);i[n-2]=r[n-1];for(let s=n-3;s>=0;--s)i[s]=`(${i[s+1]} * ${r[s+1]})`;return i}function hVe(e,t,n="index"){const r=e.map((s,o)=>o),i=dVe(r,t);return i.map((s,o)=>{const a=`int ${e[o]} = ${n} / ${i[o]}`,u=o===i.length-1?`int ${e[o+1]} = ${n} - ${e[o]} * ${i[o]}`:`index -= ${e[o]} * ${i[o]}`;return`${a}; ${u};`}).join("")}function JU(e){const t=ut(e).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function ej(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const nge=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:rge}=wfe;function pVe(e,t,n){const r=[];if(e.forEach(h=>{const p=me(h.shapeInfo.logicalShape);if(h.shapeInfo.isUniform?r.push(`uniform float ${h.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${h.name};`),r.push(`uniform int offset${h.name};`)),n.enableShapeUniforms){const{uniformShape:m}=tj(n.packedInputs,h.shapeInfo.logicalShape,h.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${h.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${h.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${h.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${h.name}Shape;`);break}r.push(`uniform ivec2 ${h.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(h=>{r.push(`uniform ${h.type} ${h.name}${h.arrayIndex?`[${h.arrayIndex}]`:""};`)});const i=r.join(`
`),s=e.map(h=>gVe(h,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=t.texShape,a=As(),u=xVe(a);let l,c,f=wVe(a);return t.isPacked?(l=mVe(t.logicalShape,o,n.enableShapeUniforms),c=vVe(a)):(l=yVe(t.logicalShape,o,n.enableShapeUniforms),c=bVe(a)),n.packedInputs&&(f+=kVe),[f,u,c,i,l,s,n.userCode].join(`
`)}function lb(e,t=!1){const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return LVe(e,t);case 1:return BVe(e,t);case 2:return UVe(e,t);case 3:return WVe(e,t);case 4:return qVe(e,t);case 5:return GVe(e);case 6:return HVe(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function ige(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return MVe(e);case 1:return PVe(e,t);case 2:return zVe(e,t);case 3:return jVe(e,t);default:return VVe(e,t)}}function gVe(e,t,n=!1,r){let i="";n?i+=ige(e,r):i+=lb(e,r);const s=e.shapeInfo.logicalShape,o=t.logicalShape;return s.length<=o.length&&(n?i+=XVe(e,t):i+=YVe(e,t)),i}function mVe(e,t,n){switch(e.length){case 0:return sge();case 1:return EVe(e,t,n);case 2:return RVe(e,t,n);case 3:return _Ve(e,t,n);default:return IVe(e,t,n)}}function yVe(e,t,n){switch(e.length){case 0:return sge();case 1:return AVe(e,t,n);case 2:return OVe(e,t,n);case 3:return TVe(e,t,n);case 4:return NVe(e,t,n);case 5:return DVe(e,t);case 6:return FVe(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}function xVe(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function bVe(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function vVe(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function wVe(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${$Ve}
    ${CVe}
    ${SVe}
  `}const $Ve=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,CVe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,SVe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,kVe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function sge(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function EVe(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function AVe(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function _Ve(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),s=i*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function TVe(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${w3(["r","c","d"],e)}
    return ivec3(r, c, d);
  }
`;const r=Xm(["r","c","d"],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function IVe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),s=i*Math.ceil(e[e.length-2]/2);let o=s,a="",u="b, r, c";for(let l=2;l<e.length-1;l++)o*=e[e.length-l-1],a=`
      int b${l} = index / ${o};
      index -= b${l} * ${o};
    `+a,u=`b${l}, `+u;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${e.length}(${u});
    }
  `}function NVe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${w3(["r","c","d","d2"],e)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Xm(["r","c","d","d2"],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function DVe(e,t){const n=Xm(["r","c","d","d2","d3"],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function FVe(e,t){const n=Xm(["r","c","d","d2","d3","d4"],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function RVe(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Gt(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const i=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function OVe(e,t,n){return Gt(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function Ym(e){return`offset${e}`}function MVe(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=As();return`
    vec4 ${n}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function LVe(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[i,s]=e.shapeInfo.texShape;if(i===1&&s===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Ym(n);if(t)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,u]=e.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${u}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function PVe(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,s=As();if(t)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${s.texture2D}(${n}, uv);
    }
  `}function BVe(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${cb(e)}
      }
    `;const i=e.shapeInfo.texShape,s=i[0],o=i[1];if(o===1&&s===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Ym(n);return o===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${s}.0);
        return sampleTexture(${n}, uv);
      }
    `:s===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${s}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function zVe(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,o=s[0],a=s[1],u=As();if(s!=null&&Gt(n,s))return t?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${u.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${u.texture2D}(${r}, uv);
      }
    `;if(t)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `;const l=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${l[0]}, ${l[1]}, row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `}function UVe(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape;if(s!=null&&Gt(n,s)){if(t)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const d=s[0],h=s[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:a}=Lf(n),u=o;if(u.length<n.length){const d=fb(e,u),h=["row","col"];return`
      ${lb(d,t)}
      float ${i}(int row, int col) {
        return ${i}(${db(h,a)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${cb(e)}
      }
    `;const l=s[0],c=s[1],f=Ym(r);return c===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);
      return sampleTexture(${r}, uv);
    }
  `:l===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:t?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${f};
    vec2 uv = uvFromFlat(${l}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function jVe(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(n[0]===1){const d=n.slice(1),h=[1,2],p=fb(e,d),m=["b","row","col"];return`
        ${ige(p,t)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${db(m,h)});
        }
      `}const a=As();if(t)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const u=o[0],l=o[1],c=Math.ceil(n[2]/2),f=c*Math.ceil(n[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${u}, ${l}, ${f}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function WVe(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[1]*n[2],o=n[2],{newShape:a,keptDims:u}=Lf(n),l=a;if(l.length<n.length){const m=fb(e,l),x=["row","col","depth"];return`
        ${lb(m,t)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${db(x,u)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${o}, 1)));
        ${cb(e)}
      }
    `;const c=e.shapeInfo.texShape,f=c[0],d=c[1],h=e.shapeInfo.flatOffset;if(d===s&&h==null)return t?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${f}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(d===o&&h==null)return t?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=Ym(r);return t?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${f}, ${d}, index);
        return sampleTexture(${r}, uv);
      }
  `}function VVe(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=As();if(t)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);
    }
  `;const s=e.shapeInfo.logicalShape,o=s.length,a=e.shapeInfo.texShape,u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=u[0],c=u[1],f=Math.ceil(s[o-1]/2);let d=f*Math.ceil(s[o-2]/2),h="int b, int row, int col",p=`b * ${d} + (row / 2) * ${f} + (col / 2)`;for(let m=2;m<o-1;m++)h=`int b${m}, `+h,d*=s[o-m-1],p=`b${m} * ${d} + `+p;return`
    vec4 ${r}(${h}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${l});
      return ${i.texture2D}(${n}, uv);
    }
  `}function qVe(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[3],o=n[2]*s,a=n[1]*o,{newShape:u,keptDims:l}=Lf(n);if(u.length<n.length){const v=fb(e,u),$=["row","col","depth","depth2"];return`
      ${lb(v,t)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${db($,l)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${s}, 1)));
        ${cb(e)}
      }
    `;const c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,d=f[0],h=f[1],p=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,x=`int stride0 = ${r}Shape[1] * stride1;`;if(h===a&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(h===s&&c==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;const b=Ym(r);return t?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${b});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${d}, ${h}, index + ${b});
      return sampleTexture(${r}, uv);
    }
  `}function GVe(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],s=t[3]*i,o=t[2]*s,a=t[1]*o,{newShape:u,keptDims:l}=Lf(t);if(u.length<t.length){const m=fb(e,u),x=["row","col","depth","depth2","depth3"];return`
      ${lb(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${db(x,l)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${s}, ${i})) +
          depth3;
        ${cb(e)}
      }
    `;const c=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,d=f[0],h=f[1];if(h===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${s}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===i&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Ym(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${s} +
          depth2 * ${i} + depth3 + ${p};
      vec2 uv = uvFromFlat(${d}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function HVe(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:s}=Lf(t);if(i.length<t.length){const x=fb(e,i),b=["row","col","depth","depth2","depth3","depth4"];return`
      ${lb(x)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${db(b,s)});
      }
    `}const o=t[5],a=t[4]*o,u=t[3]*a,l=t[2]*u,c=t[1]*l;if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${l}, ${u}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${cb(e)}
      }
    `;const f=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1];if(p===c&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${l}, ${u}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Ym(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${l} + depth * ${u} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${m};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function cb(e){const t=e.name,n=me(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function XVe(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,a=rge(e.shapeInfo.logicalShape,t.logicalShape),u=Sn(o),l=o-s;let c;const f=["x","y","z","w","u","v"];s===0?c="":o<2&&a.length>=1?c="coords = 0;":c=a.map(v=>`coords.${f[v+l]} = 0;`).join(`
`);let d="";o<2&&s>0?d="coords":d=e.shapeInfo.logicalShape.map((v,$)=>`coords.${f[$+l]}`).join(", ");let h="return outputValue;";const m=me(e.shapeInfo.logicalShape)===1,b=me(t.logicalShape)===1;if(s===1&&!m&&!b)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!b)o===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(a.length){const v=s-2,$=s-1;a.indexOf(v)>-1&&a.indexOf($)>-1?h="return vec4(outputValue.x);":a.indexOf(v)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf($)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${u} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${d});
      ${h}
    }
  `}function YVe(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=t.texShape,o=e.shapeInfo.texShape,a=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&a===u&&e.shapeInfo.flatOffset==null&&Gt(o,s))return`
      float ${i}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const l=Sn(u),c=rge(e.shapeInfo.logicalShape,t.logicalShape),f=u-a;let d;const h=["x","y","z","w","u","v"];a===0?d="":u<2&&c.length>=1?d="coords = 0;":d=c.map(m=>`coords.${h[m+f]} = 0;`).join(`
`);let p="";return u<2&&a>0?p="coords":p=e.shapeInfo.logicalShape.map((m,x)=>`coords.${h[x+f]}`).join(", "),`
    float ${i}() {
      ${l} coords = getOutputCoords();
      ${d}
      return get${r}(${p});
    }
  `}function Sn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function tj(e,t,n){const{newShape:r,keptDims:i}=Lf(t),s=t.length,o=e&&s===3&&t[0]===1,a=o?t.slice(1):r,u=!e&&s>1&&!Gt(t,n)&&r.length<s||o;return{useSqueezeShape:u,uniformShape:u?a:t,keptDims:i}}function fb(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function db(e,t){return t.map(n=>e[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KVe(e,t,n,r){const i=n.map((c,f)=>{const d={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(d.flatOffset=c.texData.slice.flatOffset),{name:t.variableNames[f],shapeInfo:d}}),s=i.map(c=>c.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=pVe(i,o,t),u=WWe(e.gl,a),l=e.createProgram(u);return ce().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:a,webGLProgram:l,inShapeInfos:s,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(l),Object.assign({program:t,fragmentShader:u,source:a,webGLProgram:l,inShapeInfos:s,outShapeInfo:o},oge(e,t,l)))}function oge(e,t,n){const r=[],i=[];let s,o,a,u=null,l=null;l=e.getUniformLocation(n,"NAN",!1),ce().getNumber("WEBGL_VERSION")===1&&(u=e.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const f of t.variableNames){const d={name:f,uniform:e.getUniformLocation(n,f,c),offset:e.getUniformLocation(n,`offset${f}`,c)};t.enableShapeUniforms&&(d.shape=e.getUniformLocation(n,`${f}Shape`,c),d.texShape=e.getUniformLocation(n,`${f}TexShape`,c)),r.push(d)}if(t.enableShapeUniforms&&(s=e.getUniformLocation(n,"outShape",c),a=e.getUniformLocation(n,"outShapeStrides",c),o=e.getUniformLocation(n,"outTexShape",c)),t.customUniforms)for(const f of t.customUniforms)i.push(e.getUniformLocation(n,f.name,c));return{variablesLocations:r,customUniformLocations:i,infLoc:u,nanLoc:l,outShapeLocation:s,outShapeStridesLocation:a,outTexShapeLocation:o}}function fJ(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((n,r)=>{const i=n.logicalShape,s=t[r],o=s.shape;if(!Gt(i,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${o} must match`);if(n.isUniform&&s.isUniform)return;const a=n.texShape,u=s.isUniform?null:s.texData.texShape;if(!Gt(a,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${u} must match`)})}function QVe(e,t,n,r,i){t.program.enableShapeUniforms||(fJ(t.inShapeInfos,n),fJ([t.outShapeInfo],[r]));const s=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(s.texture,o[0],o[1]):e.setOutputMatrixTexture(s.texture,o[0],o[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),ce().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let u=0;u<n.length;++u){const l=n[u],{uniform:c,offset:f,shape:d,texShape:h}=t.variablesLocations[u];if(d){const{uniformShape:p}=tj(t.program.packedInputs,l.shape,l.texData.texShape);switch(p.length){case 1:e.gl.uniform1iv(d,new Int32Array(p));break;case 2:e.gl.uniform2iv(d,new Int32Array(p));break;case 3:e.gl.uniform3iv(d,new Int32Array(p));break;case 4:e.gl.uniform4iv(d,new Int32Array(p));break}}if(h&&e.gl.uniform2i(h,l.texData.texShape[0],l.texData.texShape[1]),c!=null){if(l.isUniform){if(me(l.shape)<2)e.gl.uniform1f(c,l.uniformValues[0]);else{let p=l.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),e.gl.uniform1fv(c,p)}continue}l.texData.slice!=null&&f!=null&&e.gl.uniform1i(f,l.texData.slice.flatOffset),e.setInputMatrixTexture(l.texData.texture.texture,c,u)}}const a=t.outShapeLocation;if(a)switch(r.shape.length){case 1:e.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(a,new Int32Array(r.shape));break}if(t.outShapeStridesLocation){const u=ut(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(u));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(u));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(u));break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let u=0;u<t.program.customUniforms.length;++u){const l=t.program.customUniforms[u],c=t.customUniformLocations[u],f=i[u];if(l.type==="float")e.gl.uniform1fv(c,f);else if(l.type==="vec2")e.gl.uniform2fv(c,f);else if(l.type==="vec3")e.gl.uniform3fv(c,f);else if(l.type==="vec4")e.gl.uniform4fv(c,f);else if(l.type==="int")e.gl.uniform1iv(c,f);else if(l.type==="ivec2")e.gl.uniform2iv(c,f);else if(l.type==="ivec3")e.gl.uniform3iv(c,f);else if(l.type==="ivec4")e.gl.uniform4iv(c,f);else throw Error(`uniform type ${l.type} is not supported yet.`)}e.executeProgram()}function ZVe(e,t,n){let r="";t.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!o.isUniform){const u=o.texData.texShape,{useSqueezeShape:l,uniformShape:c,keptDims:f}=tj(e.packedInputs,o.shape,u);let d="",h="",p="";if(c.length===1&&e.packedInputs){const S=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];d=`${S[0]>1}_${S[1]>1}`}else if(c.length===2&&!e.packedInputs)h=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!e.packedInputs){const S=ut(c);p=`${S[0]===u[1]}_${S[S.length-1]===u[1]}`}const m=o.shape.length,x=c.length===2&&Gt(o.shape,u),b=me(o.shape)===1,v=sm(o.shape,n.shape),$=!e.packedInputs&&m===n.shape.length&&Gt(u,n.texData.texShape),C=e.packedInputs||c.length>2?"":`${u[0]>1}_${u[1]>1}`;r+=`${m}_${$}_${l?f:""}_${c.length}_${b}_${v}_${x}_${d}_${h}_${p}_${C}_${a}`}else{const u=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${u}_${a}`}});const i=e.userCode;let s=e.constructor.name;return s+="_"+r+"_"+i+`${ce().getNumber("WEBGL_VERSION")}`,s}function Hi(e){return ce().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JVe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Zw.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=As();this.outputShape=t,this.enableShapeUniforms=Hi(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?w3(["r","c","d"],t):Xm(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eqe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Zw.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=As();this.outputShape=t,this.enableShapeUniforms=Hi(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?w3(["r","c","d"],t):Xm(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tqe{constructor(t){this.variableNames=["A"],this.outTexUsage=Jo.DOWNLOAD;const n=As();this.outputShape=t,this.userCode=`
      ${nge}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nqe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Jo.DOWNLOAD;const n=As();this.outputShape=t,this.userCode=`
      ${nge}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rqe={R:0,G:1,B:2,A:3};class dJ{constructor(t,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const i=As();this.outputShape=t,this.enableShapeUniforms=Hi(this.outputShape.length);let s="result";n&&(s="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++){const u=r[a];o+=`
          if(offset == ${a}) {
            result = values[${rqe[u]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?ej():JU(t)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${i.texture2D}(A, uv);
          ${o}
        }
        ${i.output} = vec4(${s}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iqe{constructor(t,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=As();this.outputShape=t,this.enableShapeUniforms=Hi(this.outputShape.length);let i="",s="result";n&&(s="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const u=o*2+a;i+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${u}] = values[0];
            } else if (offset == 1) {
              result[${u}] = values[1];
            } else if (offset == 2) {
              result[${u}] = values[2];
            } else {
              result[${u}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?ej():JU(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${i}

          ${r.output} = ${s};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sqe(e){const t=As(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return jWe(e,n)}function oqe(e){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return HWe(e,t)}function aqe(e){const t=new Uint16Array([0,1,2,2,1,3]);return XWe(e,t)}function BS(e,t,n,r,i,s){KWe(t,n);const o=YWe(e),a=e.TEXTURE_2D;return Ge(e,()=>e.bindTexture(a,o)),Ge(e,()=>e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),Ge(e,()=>e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),Ge(e,()=>e.texParameteri(a,e.TEXTURE_MIN_FILTER,e.NEAREST)),Ge(e,()=>e.texParameteri(a,e.TEXTURE_MAG_FILTER,e.NEAREST)),ce().getNumber("WEBGL_VERSION")===1?Ge(e,()=>e.texImage2D(a,0,r,t,n,0,i,s,null)):Ge(e,()=>e.texStorage2D(a,1,r,t,n)),Ge(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:o,texShape:[n,t]}}function age(e){return e.internalFormatFloat}function uqe(e,t,n,r){const[i,s]=LS(t,n);return BS(e,i,s,age(r),r.textureFormatFloat,e.FLOAT)}function uge(e){return e.internalFormatHalfFloat}function lqe(e,t,n,r){const[i,s]=LS(t,n);return BS(e,i,s,uge(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function lge(e){return e.downloadTextureFormat}function cqe(e,t,n,r){const[i,s]=LS(t,n);return BS(e,i,s,lge(r),e.RGBA,e.UNSIGNED_BYTE)}function cge(e){return e.internalFormatPackedFloat}function fqe(e,t,n,r){const[i,s]=ub(t,n);return BS(e,i,s,cge(r),e.RGBA,e.FLOAT)}function fge(e){return e.internalFormatPackedHalfFloat}function dqe(e,t,n,r){const[i,s]=ub(t,n);return BS(e,i,s,fge(r),e.RGBA,r.textureTypeHalfFloat)}function hqe(e,t,n){return Ge(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),uJ(e,t,"clipSpacePos",n,3,20,0)&&uJ(e,t,"uv",n,2,20,12)}function pqe(e,t,n,r,i,s){Ge(e,()=>e.bindTexture(e.TEXTURE_2D,t));let o,a,u;i instanceof Uint8Array?(o=new Uint8Array(n*r*4),a=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),a=e.FLOAT,u=s.internalFormatPackedFloat),o.set(i),ce().getNumber("WEBGL_VERSION")===2?Ge(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,a,o)):Ge(e,()=>e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,a,o)),Ge(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function gqe(e,t,n){Ge(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?ce().getNumber("WEBGL_VERSION")===2?Ge(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):Ge(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):ce().getNumber("WEBGL_VERSION")===2?Ge(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):Ge(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),Ge(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function mqe(e,t,n,r){const i=e.createBuffer();Ge(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i));const a=4*4*t*n;return Ge(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)),Ge(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),Ge(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),i}function yqe(e,t,n){const r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function xqe(e,t,n,r){const[i,s]=LS(t,n),o=4,a=new Uint8Array(OWe(t*n,o));return Ge(e,()=>e.readPixels(0,0,i,s,r.downloadTextureFormat,e.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function bqe(e,t,n,r,i,s,o,a){const u=e,l=new Float32Array(MWe(s,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function vqe(e,t,n){const r=new Float32Array(t*n*4);return Ge(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HL{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=ce().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,DWe(n,t)):this.gl=zu(n),t=this.gl,ce().getNumber("WEBGL_VERSION")===2){const s=t;this.createVertexArray=()=>Ge(s,()=>s.createVertexArray()),this.bindVertexArray=o=>Ge(s,()=>s.bindVertexArray(o)),this.deleteVertexArray=o=>Ge(s,()=>s.deleteVertexArray(o)),this.getVertexArray=()=>Ge(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(t!=null){const s=t.getExtension("OES_vertex_array_object");if(s==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ge(t,()=>s.createVertexArrayOES()),this.bindVertexArray=o=>Ge(t,()=>s.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Ge(t,()=>s.deleteVertexArrayOES(o)),this.getVertexArray=()=>Ge(t,()=>t.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ce().getNumber("WEBGL_VERSION")===1){const s="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=bA(this.gl,s),_a(this.gl,o))this.textureHalfFloatExtension=bA(this.gl,o);else if(ce().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),_a(this.gl,i))this.colorBufferHalfFloatExtension=bA(this.gl,i);else if(ce().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",_a(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(_a(this.gl,i))this.colorBufferHalfFloatExtension=this.gl.getExtension(i);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=oqe(this.gl),this.indexBuffer=aqe(this.gl),this.framebuffer=QWe(this.gl),this.textureConfig=ZU(this.gl,this.textureHalfFloatExtension)}get debug(){return ce().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Ge(t,()=>t.finish()),Ge(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Ge(t,()=>t.deleteFramebuffer(this.framebuffer)),Ge(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Ge(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Ge(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),uqe(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),lqe(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),cqe(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),gqe(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,r,i){this.throwIfDisposed(),pqe(this.gl,t,n,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),dqe(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),fqe(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(lJ(this.gl,this.framebuffer),this.outputTexture=null),Ge(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,r){return this.downloadMatrixDriver(t,()=>xqe(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,r,i,s,o){return bqe(this.gl,t,n,r,i,s,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return yqe(this.gl,t,n)}createBufferFromTexture(t,n,r){this.bindTextureToFrameBuffer(t);const i=mqe(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,r;if(ce().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=()=>{const o=i.clientWaitSync(s,0,0);return o===i.ALREADY_SIGNALED||o===i.CONDITION_SATISFIED},n=s}else ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(t,n,r){return this.downloadMatrixDriver(t,()=>vqe(this.gl,n,r))}createProgram(t){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=sqe(n));const r=qWe(n);Ge(n,()=>n.attachShader(r,this.vertexShader)),Ge(n,()=>n.attachShader(r,t)),GWe(n,r);const i=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&WL(n,i),i}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const n=this.gl;Ge(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),hqe(n,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&(Ge(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&WL(this.gl,this.program),Ge(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,r=!0){return this.throwIfDisposed(),r?JWe(this.gl,t,n):eVe(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),Ge(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),tVe(this.gl,t,n,r)}setOutputMatrixTexture(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)}setOutputPackedMatrixTexture(t,n,r){this.throwIfDisposed();const[i,s]=ub(n,r);this.setOutputMatrixTextureDriver(t,i,s)}setOutputMatrixWriteRegion(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)}setOutputPackedMatrixWriteRegion(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&WL(this.gl,this.program),vA(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ge(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ge(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=bA(this.gl,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(i.TIME_ELAPSED_EXT,s),s}const t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await r6(()=>this.disposed||this.isQueryAvailable(t,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),i=r.getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){const t=wqe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in ce().platform&&(r=ce().platform.setTimeoutCustom.bind(ce().platform)),r6(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),VL(this.gl,t,this.framebuffer),this.debug&&vA(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(VL(this.gl,this.outputTexture,this.framebuffer),this.debug&&vA(this.gl)):lJ(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(t,n,r){this.throwIfDisposed();const i=this.gl;VL(i,t,this.framebuffer),this.debug&&vA(i),this.outputTexture=t,Ge(i,()=>i.viewport(0,0,n,r)),Ge(i,()=>i.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(t,n,r,i){this.throwIfDisposed(),Ge(this.gl,()=>this.gl.scissor(t,n,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function wqe(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:$qe,bincountImpl:dge,bincountReduceImpl:Cqe,bitwiseAndImpl:Sqe,castImpl:kqe,ceilImpl:Eqe,concatImpl:Aqe,equalImpl:_qe,expImpl:Tqe,expm1Impl:Iqe,floorImpl:Nqe,gatherNdImpl:Dqe,gatherV2Impl:Fqe,greaterImpl:Rqe,greaterEqualImpl:Oqe,lessImpl:Mqe,lessEqualImpl:Lqe,linSpaceImpl:Pqe,logImpl:Bqe,maxImpl:zqe,maximumImpl:Uqe,minimumImpl:jqe,multiplyImpl:Wqe,negImpl:Vqe,notEqualImpl:qqe,prodImpl:Gqe,raggedGatherImpl:Hqe,raggedRangeImpl:Xqe,raggedTensorToTensorImpl:Yqe,rangeImpl:Kqe,rsqrtImpl:Qqe,scatterImpl:Zqe,sigmoidImpl:Jqe,simpleAbsImpl:hge,sliceImpl:eGe,sparseFillEmptyRowsImpl:tGe,sparseReshapeImpl:nGe,sparseSegmentReductionImpl:pge,sqrtImpl:rGe,staticRegexReplaceImpl:iGe,stridedSliceImpl:sGe,stringNGramsImpl:oGe,stringSplitImpl:aGe,stringToHashBucketFastImpl:uGe,subImpl:lGe,tileImpl:cGe,topKImpl:fGe,transposeImpl:nj,uniqueImpl:dGe}=g8e;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gge(e,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${e}.${n}`)}function cs(e,t){return t===1?[e]:gge(e,t)}function hGe(e,t){if(e===1)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pGe{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Hi(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=cs("rc",this.rank),r=Sn(this.rank),i=this.getOutOfBoundsCondition(n),s=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${i}) {
            setOutput(vec4(0));
          } else {
            ${s}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(t){const n=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let s=`${r===0?"r":"rp1"}, ${i===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)s=`${t[t.length-1-o]},`+s;n.push(s)}return n}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${t[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(t){if(this.rank===1)return"";const n=t.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],i=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${i};
    `}getOutput(t){const n=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mge{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Hi(this.outputShape.length);let r="";for(let i=0;i<4;i++){let s="thisRC = rc;";i%2===1&&(s+="thisRC.z += 1;"),i>1&&(s+="thisRC.y += 1;"),r+=`
        ${s}
        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${i}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${i>0?"}":""}
      `}this.userCode=`
      ${gGe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?ej():JU(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${r}

        setOutput(result);
      }
    `}}function gGe(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?hVe(["r","c","d"],"inputShape"):Xm(["r","c","d"],e)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mGe{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,n,r){const i=pJ(n,r),s=gJ(t,i,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const o=hJ(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const u=this.freeTextures[s].pop();return this.usedTextures[s].push(u),u}let a;return i===fi.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===fi.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===fi.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===fi.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===fi.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(t,n,r,i){if(this.freeTextures==null)return;const s=pJ(r,i),o=gJ(n,s,i);o in this.freeTextures||(this.freeTextures[o]=[]);const a=hJ(n,s,this.gpgpu.gl,this.gpgpu.textureConfig,i),u=ce().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");u!==-1&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const l=this.usedTextures[o],c=l&&l.indexOf(t);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function yGe(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function hJ(e,t,n,r,i){const s=xGe(t,r);let o;if(i){const[u,l]=ub(e[0],e[1]);o=u*l}else{const[u,l]=LS(e[0],e[1]);o=u*l}const a=yGe(n,s);return o*a}function xGe(e,t){switch(e){case fi.PACKED_2X2_FLOAT32:return cge(t);case fi.PACKED_2X2_FLOAT16:return fge(t);case fi.UNPACKED_FLOAT32:return age(t);case fi.UNPACKED_FLOAT16:return uge(t);case fi.PACKED_4X1_UNSIGNED_BYTE:return lge(t);default:throw new Error(`Unknown physical texture type ${e}`)}}function bGe(e){return ce().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?fi.PACKED_2X2_FLOAT32:fi.UNPACKED_FLOAT32:e?fi.PACKED_2X2_FLOAT16:fi.UNPACKED_FLOAT16}function pJ(e,t){if(e===Jo.UPLOAD)return fi.PACKED_2X2_FLOAT32;if(e===Jo.RENDER||e==null)return bGe(t);if(e===Jo.DOWNLOAD||e===Jo.PIXELS)return fi.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function gJ(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Al{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Hi(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ka="if (isnan(x)) return x;",vGe="return x;",mJ="return abs(x);",wGe="return (x >= 0.0) ? x : (exp(x) - 1.0);",$Ge=Ka+`
  return (x < 0.0) ? 0.0 : x;
`,CGe=Ka+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,_d="return x;",SGe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kGe="return x;",EGe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,AGe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_Ge=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,TGe="return 1.0 / (1.0 + exp(-1.0 * x));";class Bd{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Hi(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IGe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Hi(this.outputShape.length);const n=t.length,r=cs("rc",n),i=Sn(n),s=hGe(n,r),o=r.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${i} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NGe=GF,DGe=1e-7,FGe=1e-4,CA={};function RGe(e){return e in CA||(CA[e]={}),CA[e]}const OGe=ce().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),MGe=600;function LGe(){return ce().global.screen==null?1024:ce().global.screen.height*ce().global.screen.width*window.devicePixelRatio*MGe/1024/1024}class $3 extends gD{nextDataId(){return $3.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ce().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(t!=null){if(t instanceof HL)n=t;else{const r=zu(ce().getNumber("WEBGL_VERSION"),t);n=new HL(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=zu(ce().getNumber("WEBGL_VERSION"));n=new HL(r),this.binaryCache=RGe(ce().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new mGe(this.gpgpu),this.numMBBeforeWarning=LGe(),this.texData=new q7(this,gu())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,n,r,i,s,o){const a=this.makeTensorInfo(n,r),u=this.texData.get(a.dataId);u.isPacked=!1,u.texture={texture:t,texShape:[i,s]},u.texShape=[i,s];const l=wA(n),c=new dJ(l,!1,o),f=this.runWebGLProgram(c,[a],r,[[i,s]]);return f.shape=n,u.texture=null,this.disposeIntermediateTensorInfo(a),f.dataId}write(t,n,r){if((ce().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ce().getBool("DEBUG"))&&this.checkNumericalProblems(t),r==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.texData.set(i,{shape:n,dtype:r,values:t,usage:Jo.UPLOAD,refCount:1}),i}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){const n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.refCount--}}move(t,n,r,i,s){if(ce().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:r,dtype:i,values:n,usage:Jo.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const n=this.texData.get(t),{values:r,dtype:i,complexTensorInfos:s,slice:o,shape:a,isPacked:u}=n;if(o!=null){let d;u?d=new Bd(a,_d):d=new Al(a,_d);const h=this.runWebGLProgram(d,[{dataId:t,shape:a,dtype:i}],i),p=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),p}if(r!=null)return this.convertAndCacheOnCPU(t);if(i==="string")return r;const l=this.activeTimers!=null;let c;l&&(c=ci());let f;if(i==="complex64"){const d=this.readSync(s.real.dataId),h=this.readSync(s.imag.dataId);f=Af(d,h)}else f=this.getValuesFromTexture(t);return l&&(this.downloadWaitMs+=ci()-c),this.convertAndCacheOnCPU(t,f)}async read(t){if(this.pendingRead.has(t)){const p=this.pendingRead.get(t);return new Promise(m=>p.push(m))}const n=this.texData.get(t),{values:r,shape:i,slice:s,dtype:o,complexTensorInfos:a,isPacked:u}=n;if(s!=null){let p;u?p=new Bd(i,_d):p=new Al(i,_d);const m=this.runWebGLProgram(p,[{dataId:t,shape:i,dtype:o}],o),x=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),x}if(r!=null)return this.convertAndCacheOnCPU(t);if(ce().getBool("DEBUG")&&!ce().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ce().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l=null,c;if(o!=="complex64"&&ce().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(t);const p=this.texData.get(c.dataId);l=this.gpgpu.createBufferFromTexture(p.texture.texture,...xA(i))}this.pendingRead.set(t,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],x=p[1];f=Af(m,x)}else if(l==null)f=this.getValuesFromTexture(t);else{const p=me(i);f=this.gpgpu.downloadFloat32MatrixFromBuffer(l,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),l!=null){const p=this.gpgpu.gl;Ge(p,()=>p.deleteBuffer(l))}const d=this.convertAndCacheOnCPU(t,f),h=this.pendingRead.get(t);return this.pendingRead.delete(t),h.forEach(p=>p(d)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&gu().removeDataId(t,this),this.pendingDeletes--),d}readToGPU(t,n={}){const r=this.texData.get(t),{values:i,shape:s,slice:o,dtype:a,isPacked:u,texture:l}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let h;u?h=new Bd(s,_d):h=new Al(s,_d);const p=this.runWebGLProgram(h,[{dataId:t,shape:s,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(l==null)throw i!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(t,n.customTexShape),f=gu().makeTensorFromTensorInfo(c),d=this.texData.get(c.dataId);return Object.assign({tensorRef:f},d.texture)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const r=n.map(i=>Sf(i));return Ft(t.shape,t.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ft(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){const r=t[n];if(!zWe(r))throw ce().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:n,dtype:r,isPacked:i}=this.texData.get(t),s=me(n);if(ce().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(t),h=this.texData.get(d.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...xA(n)).subarray(0,s);return this.disposeIntermediateTensorInfo(d),p}const o=ce().getBool("WEBGL_PACK")&&i===!0,a=o?wA(n):n,u=o?new nqe(a):new tqe(a),l=this.runWebGLProgram(u,[{shape:a,dtype:r,dataId:t}],"float32"),c=this.texData.get(l.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(l),f}timerAvailable(){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const n=this.activeTimers,r=[];let i=!1;this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,t();const s=jl(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),o=jl(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=n,i&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const u=await Promise.all(s);a.kernelMs=Mue(u),a.getExtraProfileInfo=()=>u.map((l,c)=>({name:o[c],ms:l})).map(l=>`${l.name}: ${l.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ci(),endMs:null}}endTimer(t){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=ci(),t)}async getQueryTime(t){if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const n=t;return n.endMs-n.startMs}disposeData(t,n=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(n?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!n&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:r}=this.texData.get(t);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:n,dtype:r,texShape:i,usage:s,isPacked:o,slice:a}=this.texData.get(t),u=a&&a.origDataId||t,l=this.dataRefCount.get(u);l>1?this.dataRefCount.set(u,l-1):(this.dataRefCount.delete(u),n!=null&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,s,o)));const c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,n=OGe){return ce().getBool("WEBGL_CPU_FORWARD")&&t.every(r=>this.texData.get(r.dataId).texture==null&&me(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){Qo("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=t.dataSync();return NGe(t.shape,n)}packedUnaryOp(t,n,r){const i=new Bd(t.shape,n),s=this.compileAndRun(i,[t],r);return gu().makeTensorFromTensorInfo(s)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const i=hge(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,i)}if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,mJ,t.dtype);const n=new Al(t.shape,mJ),r=this.compileAndRun(n,[t]);return gu().makeTensorFromTensorInfo(r)}makeTensorInfo(t,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&kl(r[0])){const s=r.map(o=>Tl(o));i=this.write(s,t,n)}else i=this.write(r,t,n);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:n}}makeOutput(t,n,r){return gu().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,r),this)}unpackTensor(t){const n=new IGe(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){const n=new pGe(t.shape);return this.runWebGLProgram(n,[t],t.dtype,null,!0)}packedReshape(t,n){const r=[fy(t.shape),...dy(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},s=[fy(n),...dy(n)],o=new mge(s,r),a=!0,u=[r],l=this.runWebGLProgram(o,[i],t.dtype,u,a);return{dataId:l.dataId,shape:n,dtype:l.dtype}}decode(t,n){const r=this.texData.get(t),{isPacked:i,shape:s,dtype:o}=r;if(n!=null){const d=me(s),h=n[0]*n[1]*4;U(d<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=wA(s);let u;i?u=new eqe(a):u=new JVe(a);const l=!0,c=[n??xA(a)],f=this.runWebGLProgram(u,[{shape:a,dtype:o,dataId:t}],o,c,l,n);return{dtype:o,shape:s,dataId:f.dataId}}runWebGLProgram(t,n,r,i,s=!1,o){const a=this.makeTensorInfo(t.outputShape,r),u=this.texData.get(a.dataId);if(t.packedOutput&&(u.isPacked=!0),t.outPackingScheme===Zw.DENSE){const b=o??xA(t.outputShape);u.texShape=b.map(v=>v*2)}if(t.outTexUsage!=null&&(u.usage=t.outTexUsage),me(a.shape)===0)return u.values=Zr(a.dtype,0),a;const l=[],c=n.map(b=>{if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(b.dataId);if(v.texture==null){if(!t.packedInputs&&me(b.shape)<=ce().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:v.values};t.packedInputs&&(v.isPacked=!0,v.shape=b.shape)}if(this.uploadToGPU(b.dataId),!!v.isPacked!=!!t.packedInputs)b=v.isPacked?this.unpackTensor(b):this.packTensor(b),l.push(b),v=this.texData.get(b.dataId);else if(v.isPacked&&!uI(v.shape,b.shape)){const $=b,C=b.shape;b.shape=v.shape,b=this.packedReshape(b,C),l.push(b),v=this.texData.get(b.dataId),$.shape=C}return{shape:b.shape,texData:v,isUniform:!1}});this.uploadToGPU(a.dataId);const f={shape:a.shape,texData:u,isUniform:!1},d=ZVe(t,c,f),h=this.getAndSaveBinary(d,()=>KVe(this.gpgpu,t,c,f)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),ce().get("ENGINE_COMPILE_ONLY")||QVe(this.gpgpu,h,c,f,i),l.forEach(b=>this.disposeIntermediateTensorInfo(b)),p&&(m=this.endTimer(m),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(m)}));const x=ce().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){const b=ci();b-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=b)}if(!ce().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&s===!1){const b=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),b}return a}compileAndRun(t,n,r,i,s=!1){return r=r||n[0].dtype,this.runWebGLProgram(t,n,r,i,s)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ce().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=fe(()=>{if(!ce().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=ce().getBool("DEBUG");ce().set("DEBUG",!1);const n=this.abs($t(1e-8)).dataSync()[0];if(ce().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?DGe:FGe}uploadToGPU(t){const n=this.texData.get(t),{shape:r,dtype:i,values:s,texture:o,usage:a,isPacked:u}=n;if(o!=null)return;const l=this.activeTimers!=null;let c;l&&(c=ci());let f=n.texShape;if(f==null&&(f=iVe(r,u),n.texShape=f),s!=null){const d=wA(r);let h,p=f[1],m=f[0];const x=s instanceof Uint8Array||s instanceof Uint8ClampedArray;(u||!x)&&([p,m]=ub(f[0],f[1])),u?h=new iqe(d,x):h=new dJ(d,x);const b=x?[m,p]:f,v=this.makeTensorInfo(b,i),$=this.texData.get(v.dataId);x?$.usage=Jo.PIXELS:$.usage=Jo.UPLOAD,$.texShape=b,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),p,m,s);const C=[[m,p]],A=this.runWebGLProgram(h,[v],i,C,!0),E=this.texData.get(A.dataId);n.texShape=E.texShape,n.isPacked=E.isPacked,n.usage=E.usage,ce().get("ENGINE_COMPILE_ONLY")?this.disposeData(A.dataId):(n.texture=E.texture,n.values=null,this.texData.delete(A.dataId)),this.disposeIntermediateTensorInfo(v),l&&(this.uploadWaitMs+=ci()-c)}else{const d=this.acquireTexture(f,a,i,u);n.texture=d}}convertAndCacheOnCPU(t,n){const r=this.texData.get(t),{dtype:i}=r;return n!=null&&(r.values=PGe(n,i)),r.values}acquireTexture(t,n,r,i){if(this.numBytesInGPU+=this.computeBytes(t,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,i)}computeBytes(t,n){return t[0]*t[1]*Fw(n)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(n));return Promise.all(t)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(i=>{try{this.checkCompletion_(n),i(!0)}catch(s){throw s}});t.push(r)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await eU(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(tge(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:i,nanLoc:s,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:u}=oge(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=n,t.customUniformLocations=r,t.infLoc=i,t.nanLoc=s,t.outShapeLocation=o,t.outShapeStridesLocation=a,t.outTexShapeLocation=u}}createTensorFromGPUData(t,n,r){t.channels=t.channels||"RGBA";const{texture:i,height:s,width:o,channels:a}=t,u=gu().backend;if(!u.gpgpu.gl.isTexture(i))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=u.writeTexture(i,n,r,s,o,a);return gu().makeTensorFromDataId(l,n,r,u)}}$3.nextDataId=0;function PGe(e,t){if(t==="float32"||t==="complex64")return e;if(t==="int32"||t==="bool"){const n=t==="int32"?new Int32Array(e.length):new Uint8Array(e.length);for(let r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}else throw new Error(`Unknown dtype ${t}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */e9()&&t9("webgl",()=>new $3,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rj=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class fm{constructor(t,n,r){this.variableNames=["A","B"],this.outputShape=At(n,r),this.enableShapeUniforms=Hi(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Km=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class hb{constructor(t,n,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=At(n,r);const s=this.outputShape.length;this.enableShapeUniforms=Hi(s);let o="";if(i)if(s===0||me(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${Sn(s)} coords = getOutputCoords();
        `,s===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const u=cs("coords",s);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${u[s-2]} + 1) >= outShape[${s} - 2];
            bool nextColOutOfBounds =
              (${u[s-1]} + 1) >= outShape[${s} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${u[s-2]} + 1) >= ${this.outputShape[s-2]};
            bool nextColOutOfBounds =
              (${u[s-1]} + 1) >= ${this.outputShape[s-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function No(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const BGe={kernelName:Ax,backendName:"webgl",kernelFunc:No};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sp(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,s=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(s.dataId),a=No({inputs:{x:r},backend:n}),u=No({inputs:{x:i},backend:n});return o.complexTensorInfos={real:a,imag:u},s}const zGe={kernelName:kD,backendName:"webgl",kernelFunc:sp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yge="return (a < 0.) ? b * a : a;",xge=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function UGe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:s}=r,o=n.makeTensorInfo([],"float32",Pf(s,"float32")),a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hb(xge,i.shape,o.shape):new fm(yge,i.shape,o.shape),u=n.runWebGLProgram(a,[i,o],"float32");return n.disposeIntermediateTensorInfo(o),u}const jGe={kernelName:OC,backendName:"webgl",kernelFunc:UGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bge="return (a < 0.) ? b * a : a;",vge=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function WGe(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t,s=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hb(vge,r.shape,i.shape):new fm(bge,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],"float32")}const VGe={kernelName:eS,backendName:"webgl",kernelFunc:WGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pb="if (isnan(x)) return x;";function Yt({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:s})=>{const{x:o}=i,a=s,u=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const f=a.texData.get(o.dataId),d=n(f.values,u);return a.makeTensorInfo(o.shape,u,d)}const l=ce().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let c;return l?c=new Bd(o.shape,t):c=new Al(o.shape,e),a.runWebGLProgram(c,[o],u)}}function Ei({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:s}){return({inputs:o,backend:a})=>{const{a:u,b:l}=o,c=a;if(r&&u.dtype==="complex64"){const p=c.texData.get(u.dataId),m=c.texData.get(l.dataId),[x,b]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map($=>{const[C,S]=$,A={dataId:C.dataId,dtype:C.dtype,shape:u.shape},E={dataId:S.dataId,dtype:S.dtype,shape:l.shape},_=new fm(e,u.shape,l.shape);return c.runWebGLProgram(_,[A,E],Gs(C.dtype,S.dtype))}),v=sp({inputs:{real:x,imag:b},backend:c});return c.disposeIntermediateTensorInfo(x),c.disposeIntermediateTensorInfo(b),v}const f=s||Gs(u.dtype,l.dtype);if((u.dtype==="string"||l.dtype==="string"||c.shouldExecuteOnCPU([u,l]))&&i!=null){const p=c.texData.get(u.dataId).values,m=c.texData.get(l.dataId).values,x=u.dtype==="string"?_f(p):p,b=u.dtype==="string"?_f(m):m,[v,$]=i(u.shape,l.shape,x,b,f),C=c.makeTensorInfo($,f),S=c.texData.get(C.dataId);return S.values=v,C}const d=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let h;return d?h=new hb(t,u.shape,l.shape,n):h=new fm(e,u.shape,l.shape),c.runWebGLProgram(h,[u,l],f)}}function Jw(e,t=!1){if(e==="linear")return t?kGe:vGe;if(e==="relu")return t?AGe:$Ge;if(e==="elu")return t?EGe:wGe;if(e==="relu6")return t?_Ge:CGe;if(e==="prelu")return t?vge:bge;if(e==="leakyrelu")return t?xge:yge;if(e==="sigmoid")return t?TGe:SGe;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wge{constructor(t,n,r,i=!1,s=!1,o=!1,a=null,u=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Hi(this.outputShape.length);const c=i?t[1]:t[2],f=Math.ceil(c/2),d=i?"i * 2, rc.y":"rc.y, i * 2",h=s?"rc.z, i * 2":"i * 2, rc.z",p=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",b="";a&&(u?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:l?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:x=`vec4 activation(vec4 x) {
          ${a}
        }`,b="result = activation(result);");const v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let $="rc.x",C="rc.x";t[0]<n[0]?$=`imod(rc.x, ${t[0]})`:n[0]<t[0]&&(C=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${$};
        int batchB = ${C};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${h});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${b}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yJ={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class xJ{constructor(t,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=At(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bJ="return a * b;";function ij(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,s=Gs(r.dtype,i.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),u=n.texData.get(i.dataId),l=new xJ(yJ.REAL,r.shape,i.shape),c=new xJ(yJ.IMAG,r.shape,i.shape),f=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:i.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:i.shape}],d=n.runWebGLProgram(l,f,"float32"),h=n.runWebGLProgram(c,f,"float32"),p=sp({inputs:{real:d,imag:h},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),p}if(n.shouldExecuteOnCPU([r,i])){const a=n.texData.get(r.dataId),u=n.texData.get(i.dataId),[l,c]=Wqe(r.shape,i.shape,a.values,u.values,s),f=n.makeTensorInfo(c,s),d=n.texData.get(f.dataId);return d.values=l,f}let o;return ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new hb(bJ,r.shape,i.shape):o=new fm(bJ,r.shape,i.shape),n.runWebGLProgram(o,[r,i],s)}const qGe={kernelName:Mx,backendName:"webgl",kernelFunc:ij};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GGe(e,t,n){const r=[fy(e.shape),...dy(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},s=[fy(t),...dy(t)],o=new mge(s,r),a=!0,u=[r],l=n.runWebGLProgram(o,[i],e.dtype,u,a);return{dataId:l.dataId,shape:t,dtype:l.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ue(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:s}=r,o=n,a=me(i.shape),u=H7(s,a),l=me(u);U(a===l,()=>`The new shape (${u}) has ${l} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=o.texData.get(i.dataId);return c.isPacked&&!uI(i.shape,u)&&!(c.texture!==null&&uI(c.shape,u))?GGe(i,u,o):(o.incRef(i.dataId),{dataId:i.dataId,shape:u,dtype:i.dtype})}const HGe={kernelName:nS,backendName:"webgl",kernelFunc:Ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vJ{constructor(t,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:o}=t;this.outputShape=[i,o];const a=Math.floor(r/4)*4,u=r%4;let l="sumValue += dot(values, ones);";if(n!=null){const f=1/n;l=`sumValue += dot(values * ${Jg(f)?f.toPrecision(2):f}, ones);`}let c="";s%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${a};
        if (${u===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${u===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${u===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XGe{constructor(t,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:o}=t;this.outputShape=[i,o];let a="0.0",u="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",u="min"):n==="max"&&(a="-1.0 / 1e-20",u="max");let l=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?l="sumValue":n==="prod"?l="prodValue":n==="all"?l="allValue":n==="any"&&(l="anyValue");const c=Math.floor(r/4)*4,f=r%4;let d=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${u}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${u}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,h="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${f===2}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${f===3}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${l});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YGe(e){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const n=t.length?t[t.length-1].outSize:e[1],r=r3(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function Qm(e,t,n,r){const i=YGe(e.shape);let s=e;for(let o=0;o<i.length;o++){const{inSize:a,windowSize:u,outSize:l}=i[o];let c,f;n==="mean"?c=o===0?new vJ({windowSize:u,inSize:a,batchSize:e.shape[0],outSize:l},a):new vJ({windowSize:u,inSize:a,batchSize:e.shape[0],outSize:l}):c=new XGe({windowSize:u,inSize:a,batchSize:e.shape[0],outSize:l},n),f=s,s=r.runWebGLProgram(c,[s],t),f.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(f)}return s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KGe{constructor(t,n){this.variableNames=["A"];const r=new Array(t.length);for(let o=0;o<r.length;o++)r[o]=t[n[o]];this.outputShape=r,this.rank=r.length;const i=Sn(this.rank),s=QGe(n);this.userCode=`
    void main() {
      ${i} resRC = getOutputCoords();
      setOutput(getA(${s}));
    }
    `}}function QGe(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZGe{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(t.length);for(let c=0;c<r.length;c++)r[c]=t[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=Sn(this.rank),s=gge("rc",this.rank),o=new Array(this.rank);for(let c=0;c<n.length;c++)o[n[c]]=s[c];const a=`vec2(${o.slice(-2).join()})`,u=`++${s[this.rank-1]} < ${r[this.rank-1]}`,l=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${i} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${l};
      if(${u}) {
        result[1] = ${l};
      }
      --${s[this.rank-1]};
      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${l};
        if(${u}) {
          result[3] = ${l};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C3(e,t,n){const r=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ZGe(e.shape,t):new KGe(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JGe(e,t,n,r){const i=t,s=e.shape.length,o=Ot(i,e.shape);let a=o;const u=nr(a,s),l=u!=null;let c=e;l&&(c=C3(e,u,r),a=yr(a.length,s)),ki("sum",a,s);const[f,d]=ei(c.shape,a);let h=f;n&&(h=mr(f,o));const p=me(d),x=me(e.shape)/p,b=Ue({inputs:{x:c},attrs:{shape:[x,p]},backend:r}),v=kF(e.dtype),$=Qm(b,v,"sum",r),C=Ue({inputs:{x:$},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo($),l&&r.disposeIntermediateTensorInfo(c),C}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S3(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r;return JGe(i,s,o,n)}const eHe={kernelName:uS,backendName:"webgl",kernelFunc:S3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ks(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:s}=r,o=n,a=i.shape.length,u=new Array(a);for(let c=0;c<u.length;c++)u[c]=i.shape[s[c]];let l;if(o.shouldExecuteOnCPU([i])){const f=o.texData.get(i.dataId).values,d=nj(f,i.shape,i.dtype,s,u);l=o.makeTensorInfo(u,i.dtype);const h=o.texData.get(l.dataId);h.values=d}else l=C3(i,s,o);return l}const tHe={kernelName:Mg,backendName:"webgl",kernelFunc:ks};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ge=1e3;function lI({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:u=null}){const l=e.shape.length,c=t.shape.length,f=n?e.shape[l-2]:e.shape[l-1],d=r?t.shape[c-1]:t.shape[c-2],h=n?e.shape[l-1]:e.shape[l-2],p=r?t.shape[c-2]:t.shape[c-1],m=e.shape.slice(0,-2),x=t.shape.slice(0,-2),b=me(m),v=me(x),C=At(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([h,p]);U(f===d,()=>`Error in matMul: inner shapes (${f}) and (${d}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);const S=n?[b,f,h]:[b,h,f],A=r?[v,p,d]:[v,d,p],E=Ue({inputs:{x:e},backend:i,attrs:{shape:S}}),_=Ue({inputs:{x:t},backend:i,attrs:{shape:A}}),D=[E,_],N=Math.max(b,v),T=n?E.shape[1]:E.shape[2],L=s!=null,O=o!=null,M=u==="leakyrelu",R=u!=null?Jw(u,!0):null,P=L||O||M||R!=null;let j;if((h===1||p===1)&&T>$ge&&P===!1){let q=E,H=_;n&&(q=ks({inputs:{x:E},backend:i,attrs:{perm:[0,2,1]}}),D.push(q)),r&&(H=ks({inputs:{x:_},backend:i,attrs:{perm:[0,2,1]}}),D.push(H));const V=p!==1,X=p===1;let re=q;V&&(re=Ue({inputs:{x:q},backend:i,attrs:{shape:[N,T,1]}}),D.push(re));const le=p===1?2:1;let ue=H;X&&(ue=Ue({inputs:{x:H},backend:i,attrs:{shape:[N,1,T]}}),D.push(ue));const be=ij({inputs:{a:re,b:ue},backend:i});j=S3({inputs:{x:be},backend:i,attrs:{axis:le,keepDims:!0}}),D.push(be)}else{const q=Gs(e.dtype,t.dtype),H=new wge(S,A,[N,h,p],n,r,L,R,O,M),V=[E,_];if(s!=null&&V.push(s),O&&V.push(o),M){const X=i.makeTensorInfo([],"float32",Pf(a,"float32"));V.push(X),D.push(X)}j=i.runWebGLProgram(H,V,q)}const z=Ue({inputs:{x:j},backend:i,attrs:{shape:C}});D.push(j);for(const q of D)i.disposeIntermediateTensorInfo(q);return z}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nHe(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s,bias:o,preluActivationWeights:a}=t,{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:f}=r;return lI({a:i,b:s,transposeA:u,transposeB:l,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:f,activation:c})}const rHe={kernelName:Rw,backendName:"webgl",kernelFunc:nHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wJ="return abs(x);";function iHe(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const s=n.texData.get(r.dataId),o=hge(s.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let i;return ce().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Bd(r.shape,wJ):i=new Al(r.shape,wJ),n.runWebGLProgram(i,[r],r.dtype)}const sHe={kernelName:hC,backendName:"webgl",kernelFunc:iHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oHe=Ka+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,aHe=Yt({opSnippet:oHe}),uHe={kernelName:ax,backendName:"webgl",kernelFunc:aHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lHe=Ka+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,cHe=Yt({opSnippet:lHe}),fHe={kernelName:ux,backendName:"webgl",kernelFunc:cHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $J="return a + b;",dHe=Ei({opSnippet:$J,packedOpSnippet:$J,supportsComplex:!0,cpuKernelImpl:$qe}),hHe={kernelName:Um,backendName:"webgl",kernelFunc:dHe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pHe{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((s,o)=>`T${o}`);const r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gHe{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((s,o)=>`T${o}`);const r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iT(e){const{inputs:t,backend:n}=e,r=t;if(r.length===1)return No({inputs:{x:r[0]},backend:n});if(r.length>ce().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const u=Math.floor(r.length/2),l=iT({inputs:r.slice(0,u),backend:n}),c=iT({inputs:r.slice(u),backend:n});return iT({inputs:[l,c],backend:n})}const i=r.map(u=>u.dtype).reduce((u,l)=>Gs(u,l)),s=r.map(u=>u.shape),a=ce().getBool("WEBGL_PACK")?new gHe(r[0].shape,s):new pHe(r[0].shape,s);return n.runWebGLProgram(a,r,i)}const mHe={kernelName:pC,backendName:"webgl",kernelFunc:iT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yHe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=Ot(s,i.shape);let l=u;const c=nr(l,a);let f=i;c!=null&&(f=ks({inputs:{x:i},backend:n,attrs:{perm:c}}),l=yr(l.length,a)),ki("all",l,a);const[d,h]=ei(f.shape,l),p=me(h),m=Ue({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),x=Qm(m,m.dtype,"all",n);let b;if(o){const v=mr(d,u);b=Ue({inputs:{x},backend:n,attrs:{shape:v}})}else b=Ue({inputs:{x},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(f),b}const xHe={kernelName:bD,backendName:"webgl",kernelFunc:yHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bHe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=Ot(s,i.shape);let l=u;const c=nr(l,a);let f=i;c!=null&&(f=ks({inputs:{x:i},backend:n,attrs:{perm:c}}),l=yr(l.length,a)),ki("any",l,a);const[d,h]=ei(f.shape,l),p=me(h),m=Ue({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),x=Qm(m,m.dtype,"any",n);let b;if(o){const v=mr(d,u);b=Ue({inputs:{x},backend:n,attrs:{shape:v}})}else b=Ue({inputs:{x},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(f),b}const vHe={kernelName:vD,backendName:"webgl",kernelFunc:bHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wHe{constructor(t,n,r){this.variableNames=["A"];const{windowSize:i,batchSize:s,outSize:o}=t;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,o];const a=n==="max"?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${i};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${i}; i++) {
          int inIdx = ${u};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $He{constructor(t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,U(t.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const s=t[t.length-1],o=Math.ceil(s/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),i||this.variableNames.push("bestIndicesA");const a=this.outputShape,u=a.length,l=Sn(u),c=cs("coords",u);let f,d;if(o===1){d=u+1;const _=Sn(d);f=`
        ${_} sourceLocR = ${_}(${c.join()}, 0);
        ++${c[u-1]};
        ${_} sourceLocG = ${_}(${c.join()}, 0);
        ++${c[u-2]};
        ${_} sourceLocA = ${_}(${c.join()}, 0);
        --${c[u-1]};
        ${_} sourceLocB = ${_}(${c.join()}, 0);
        --${c[u-2]};`}else d=u,f=`
        ${l} sourceLocR = coords;
        ++${c[u-1]};
        ${l} sourceLocG = coords;
        ++${c[u-2]};
        ${l} sourceLocA = coords;
        --${c[u-1]};
        ${l} sourceLocB = coords;
        --${c[u-2]};`;const h=["x","y","z","w","u","v"].slice(0,d),p="."+h[d-1],m=h.map(_=>"int "+_),x=cs("sourceLocR",d-1).concat("inIdx.r"),b=cs("sourceLocG",d-1).concat("inIdx.g"),v=cs("sourceLocB",d-1).concat("inIdx.b"),$=cs("sourceLocA",d-1).concat("inIdx.a"),C=r==="max"?"greaterThan":"lessThan",S=i?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${$.join()})));`,A=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${b.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${$.join()}) : 0.)`,E=i?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${h.join()}),
                                          vec2(${h.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${h.join()}),
                               vec2(${h.slice(-2).join()}));
      }
      ${E}
      void main() {
        ${l} coords = getOutputCoords();
        bool hasNextCol = ${c[u-1]} < ${a[u-1]-1};
        bool hasNextRow = ${c[u-2]} < ${a[u-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${A};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${S}
          vec4 candidate = ${A};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${C}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cge(e,t,n,r=null){let i=t.shape[0],s=t.shape[1];r!=null&&(i=r.shape[0],s=r.shape[1]);const o=r3(s),a={windowSize:o,inSize:s,batchSize:i,outSize:Math.ceil(s/o)},u=new wHe(a,n,r==null),l=[t];r!=null&&l.push(r);const c=e.runWebGLProgram(u,l,"int32");if(c.shape[1]===1)return c;const f=Cge(e,t,n,c);return e.disposeIntermediateTensorInfo(c),f}function Sge(e,t,n,r=null){const i=r!=null?r.shape:t.shape,s=i[i.length-1],o=r3(s),a=new $He(i,o,n,r==null),u=r==null?[t]:[t,r],l=e.runWebGLProgram(a,u,"int32");if(l.shape.length===t.shape.length){const c=Sge(e,t,n,l);return e.disposeIntermediateTensorInfo(l),c}return l}function kge(e,t,n,r){const i=[n];if(ki("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!ce().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const s=[],o=e.texData.get(t.dataId),a=o!==null&&o.isPacked;let u=t;a&&(u=e.unpackTensor(t),s.push(u));const[l,c]=ei(u.shape,i),f=me(c),d=Ue({inputs:{x:u},backend:e,attrs:{shape:[-1,f]}});s.push(d);const h=Cge(e,d,r);s.push(h);const p=Ue({inputs:{x:h},backend:e,attrs:{shape:l}});return s.forEach(m=>e.disposeIntermediateTensorInfo(m)),p}return Sge(e,t,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CHe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;let o=Ot(s,i.shape);const a=nr(o,i.shape.length);let u=i;const l=[];a!=null&&(u=ks({inputs:{x:i},backend:n,attrs:{perm:a}}),l.push(u),o=yr(o.length,u.shape.length)),ki("argMax",[o[0]],u.shape.length);const c=kge(n,u,o[0],"max");return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const SHe={kernelName:gC,backendName:"webgl",kernelFunc:CHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kHe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s}=r;let o=Ot(s,i.shape);const a=nr(o,i.shape.length);let u=i;const l=[];a!=null&&(u=ks({inputs:{x:i},backend:n,attrs:{perm:a}}),l.push(u),o=yr(o.length,u.shape.length)),ki("argMin",[o[0]],u.shape.length);const c=kge(n,u,o[0],"min");return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const EHe={kernelName:mC,backendName:"webgl",kernelFunc:kHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AHe=Ka+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,_He=Yt({opSnippet:AHe}),THe={kernelName:lx,backendName:"webgl",kernelFunc:_He};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IHe=Ka+"return log(x + sqrt(x * x + 1.0));",NHe=Yt({opSnippet:IHe}),DHe={kernelName:cx,backendName:"webgl",kernelFunc:NHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FHe=Ka+`
  return atan(x);
`,RHe=Yt({opSnippet:FHe}),OHe={kernelName:fx,backendName:"webgl",kernelFunc:RHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MHe=rj+`
  return atan(a, b);
`,LHe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Km+`
  return result;
`,PHe=Ei({opSnippet:MHe,packedOpSnippet:LHe}),BHe={kernelName:hx,backendName:"webgl",kernelFunc:PHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zHe=Ka+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,UHe=Yt({opSnippet:zHe}),jHe={kernelName:dx,backendName:"webgl",kernelFunc:UHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e${constructor(t,n,r,i=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideHeight,u=t.strideWidth,l=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const m=n==="avg",x=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,b=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let v="0.0";if(m||(v="-1.0 / 1e-20"),r){const _=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${u});
        const ivec2 pads = ivec2(${h}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${_} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${i?s?x:b:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const S=Math.floor(o/4)*4,A=o%4,E=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${u});
      const ivec2 pads = ivec2(${h}, ${p});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${S}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${E}
          }

          int xC = xCCorner + ${S};
          if (${A===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${A===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${A===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${E}
          }
        }
        setOutput(${C});
      }
    `}}class sj{constructor(t,n,r,i=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideDepth,u=t.strideHeight,l=t.strideWidth,c=t.dilationDepth,f=t.dilationHeight,d=t.dilationWidth,h=t.effectiveFilterDepth,p=t.effectiveFilterHeight,m=t.effectiveFilterWidth,x=t.padInfo.front,b=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;const $=n==="avg";let C="0.0";if($||(C="-1.0 / 1e-20"),r){const N=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${u}, ${l});
        const ivec3 pads = ivec3(${x}, ${b}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${h};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${N} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${i?s?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const S="max";let A=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(A="avgValue / max(count, 1.0)");const E=Math.floor(o/4)*4,_=o%4,D=`
      if (${$}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${S}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${u}, ${l});
      const ivec3 pads = ivec3(${x}, ${b}, ${v});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${E}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${D}
            }

            int xC = xCCorner + ${E};
            if (${_===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${_===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${_===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${D}
            }
          }
        }
        setOutput(${A});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WHe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;PS(i,"avgPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r,l=1;U(Si(o,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const c=Xa(i.shape,s,o,l,a,u);if(c.filterWidth===1&&c.filterHeight===1&&Gt(c.inShape,c.outShape))return No({inputs:{x:i},backend:n});const f=new e$(c,"avg",!1);return n.runWebGLProgram(f,[i],"float32")}const VHe={kernelName:yC,backendName:"webgl",kernelFunc:WHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qHe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u,dataFormat:l}=r,c=[1,1,1],f=Bf(i.shape,s,o,c,a,u,l),d=new sj(f,"avg",!1);return n.runWebGLProgram(d,[i],"float32")}const GHe={kernelName:xC,backendName:"webgl",kernelFunc:qHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HHe{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,o=t.dilationHeight,a=t.dilationWidth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=u-1-t.padInfo.top,f=l-1-t.padInfo.left,d=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${f});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${u};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class XHe{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,s=t.strideDepth,o=t.strideHeight,a=t.strideWidth,u=t.dilationDepth,l=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=f-1-t.padInfo.front,m=d-1-t.padInfo.top,x=h-1-t.padInfo.left,b=1/(n*r*i);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${x});
      const float avgMultiplier = float(${b});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          float dyD = float(dyDCorner + wD) / ${s}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YHe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s,{filterSize:a,strides:u,pad:l,dimRoundingMode:c}=r,f=[1,1,1],d=Bf(o.shape,a,u,f,l,c),h=new XHe(d);return n.runWebGLProgram(h,[i],o.dtype)}const KHe={kernelName:$D,backendName:"webgl",kernelFunc:YHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QHe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s;PS([i,s],"avgPoolGrad");const{filterSize:a,strides:u,pad:l}=r,c=Xa(o.shape,a,u,1,l),f=new HHe(c);return n.runWebGLProgram(f,[i],o.dtype)}const ZHe={kernelName:wD,backendName:"webgl",kernelFunc:QHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JHe(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:s}=t,{transposeA:o,transposeB:a}=r;return lI({a:i,b:s,transposeA:o,transposeB:a,backend:n})}const eXe={kernelName:bC,backendName:"webgl",kernelFunc:JHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tXe{constructor(t,n,r,i,s,o){this.outputShape=[],this.variableNames=["x","mean","variance"],At(t,n),At(t,r);let a="0.0";i!=null&&(At(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="1.0";s!=null&&(At(t,s),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${u};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nXe{constructor(t,n,r,i,s,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],At(t,n),At(t,r);let a="vec4(0.0)";i!=null&&(At(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="vec4(1.0)";s!=null&&(At(t,s),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${u};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rXe=({inputs:e,backend:t,attrs:n})=>{const{x:r,mean:i,variance:s,offset:o,scale:a}=e;U(i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),U(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),U(a==null||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=n;u==null&&(u=.001);const l=[r,i,s];let c=null;o!=null&&(c=o.shape,l.push(o));let f=null;a!=null&&(f=a.shape,l.push(a));const d=ce().getBool("WEBGL_PACK_NORMALIZATION")?new nXe(r.shape,i.shape,s.shape,c,f,u):new tXe(r.shape,i.shape,s.shape,c,f,u);return t.runWebGLProgram(d,l,l[0].dtype)},iXe={kernelName:DC,backendName:"webgl",kernelFunc:rXe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sXe{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const n=Sn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=oXe(this.rank);let i;const s=t.map((o,a)=>`sourceLoc.${B6[a]} = start[${a}] + coords.${B6[a]};`);i=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${s.join(`
`)}
      `,this.userCode=`
      void main() {
        ${i}
        setOutput(getSource(${r}));
      }
    `}}const B6=["x","y","z","w","u","v"];function oXe(e){if(e===1)return"sourceLoc";if(e<=6)return B6.slice(0,e).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aXe{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=Sn(this.rank),r=cs("coords",this.rank),i=cs("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":`vec2(${i.slice(-2).join()})`,o=`getChannel(getSource(${i.join()}), ${s})`,a=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
        ++${i[this.rank-1]};
        result.y = ${o};
        --${i[this.rank-1]};
      }
    `,u=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${t[this.rank-2]}) {
        ++${i[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${t[this.rank-1]}) {
          ++${i[this.rank-1]};
          result.w = ${o};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((c,f)=>`start[${f}]`).join()});`:t.map((c,f)=>`${i[f]} = ${r[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${a}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uXe(e,t,n,r){const i=r.texData.get(e.dataId),s=r.makeTensorInfo(n,e.dtype),o=r.texData.get(s.dataId);Object.assign(o,i),o.refCount=1,o.shape=n,o.dtype=e.dtype;let a=Z9(t,ut(e.shape));i.slice&&(a+=i.slice.flatOffset),o.slice={flatOffset:a,origDataId:i.slice&&i.slice.origDataId||e.dataId};const u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),s}function gb(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,size:o}=r,[a,u]=n3(i,s,o);if(Y9(i,a,u),me(u)===0)return n.makeTensorInfo(u,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||i.dtype==="string"){const f=n.texData.get(i.dataId),d=eGe(f.values,a,u,i.shape,i.dtype);return n.makeTensorInfo(u,i.dtype,d)}const{isPacked:l}=n.texData.get(i.dataId),c=Q9(i.shape,a,u);if(l||!c){const f=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aXe(u):new sXe(u),d=[a];return n.runWebGLProgram(f,[i],i.dtype,d)}return n.uploadToGPU(i.dataId),uXe(i,a,u,n)}const lXe={kernelName:aS,backendName:"webgl",kernelFunc:gb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cXe=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,crops:o}=r;U(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=s.reduce((v,$)=>v*$),u=kS(i.shape,s,a),l=ES(u.length,s.length),c=AS(i.shape,s,a),f=iU(o,s.length),d=sU(c,o,s.length),h=[],p=Ue({inputs:{x:i},backend:n,attrs:{shape:u}}),m=ks({inputs:{x:p},backend:n,attrs:{perm:l}}),x=Ue({inputs:{x:m},backend:n,attrs:{shape:c}}),b=gb({inputs:{x},backend:n,attrs:{begin:f,size:d}});return h.push(p),h.push(m),h.push(x),h.forEach(v=>n.disposeIntermediateTensorInfo(v)),b},fXe={kernelName:vC,backendName:"webgl",kernelFunc:cXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dXe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o}=r,a=n.readSync(i.dataId),u=n.readSync(s.dataId),l=dge(a,u,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,l)}const hXe={kernelName:CD,backendName:"webgl",kernelFunc:dXe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pXe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,gXe=`
  return float(int(a.r) & int(b.r));
`;function mXe(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,s=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=ce().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||o===1){const u=n.texData.get(r.dataId).values,l=n.texData.get(i.dataId).values,[c,f]=Sqe(r.shape,i.shape,u,l,r.dtype),d=n.makeTensorInfo(f,r.dtype),h=n.texData.get(d.dataId);return h.values=c,d}let a;return s?a=new hb(pXe,r.shape,i.shape,!1):a=new fm(gXe,r.shape,i.shape),n.runWebGLProgram(a,[r,i],r.dtype)}const yXe={kernelName:wC,backendName:"webgl",kernelFunc:mXe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xXe(e){const{inputs:t,backend:n}=e,{s0:r,s1:i}=t,s=n.readSync(r.dataId),o=n.readSync(i.dataId),a=At(Array.from(s),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const bXe={kernelName:SD,backendName:"webgl",kernelFunc:xXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vXe="return float(a != b);",Ege=Ei({opSnippet:vXe,cpuKernelImpl:qqe,dtype:"bool"}),wXe={kernelName:YC,backendName:"webgl",kernelFunc:Ege};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zS(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return No({inputs:{x:i.complexTensorInfos.real},backend:n})}const $Xe={kernelName:iF,backendName:"webgl",kernelFunc:zS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CXe="return float(int(x));";function SXe(e,t){const n=new Al(e.shape,CXe),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z6(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return No({inputs:{x:i},backend:n});const o=Nr(i.shape),a=z6({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),u=sp({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),u}if(i.dtype==="complex64"){const o=zS({inputs:{input:i},backend:n}),a=z6({inputs:{x:o},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(o),a}if(!X7(i.dtype,s)){const o=No({inputs:{x:i},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:s}}if(n.shouldExecuteOnCPU([i])){const o=n.texData.get(i.dataId).values,[a,u,l]=kqe(o,i.shape,i.dtype,s);return n.makeTensorInfo(a,u,l)}if(s==="int32")return SXe(i,n);if(s==="bool"){const o=n.makeTensorInfo([],"bool",Zr("bool",1)),u=Ege({inputs:{a:i,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),u}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${s}`)}const kXe={kernelName:px,backendName:"webgl",kernelFunc:z6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CJ="return ceil(x);",EXe=Yt({opSnippet:CJ,packedOpSnippet:CJ,cpuKernelImpl:Eqe}),AXe={kernelName:gx,backendName:"webgl",kernelFunc:EXe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Xe{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TXe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IXe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:s,clipValueMax:o}=r;let a;ce().getBool("WEBGL_PACK_CLIP")?a=new TXe(i.shape):a=new _Xe(i.shape);const u=[[s],[o]];return n.runWebGLProgram(a,[i],i.dtype,u)}const NXe={kernelName:mx,backendName:"webgl",kernelFunc:IXe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DXe{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SJ(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function FXe(e){const{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),s=new DXe(r.shape),o=[SJ(r,i.complexTensorInfos.real),SJ(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(s,o,o[0].dtype)}const RXe={kernelName:$C,backendName:"webgl",kernelFunc:FXe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OXe{constructor(t){this.outputShape=[],this.outputShape=Nl(t,1),this.variableNames=t.map((o,a)=>`T${a}`);const n=new Array(t.length-1);n[0]=t[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+t[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const i=n.length,s=n[n.length-1];r.push(`else setOutput(getT${i}(yR, yC-${s}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MXe{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Nl(t,n);const r=this.outputShape,i=r.length,s=Sn(i),o=cs("coords",i),a=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((m,x)=>`T${x}`);const u=new Array(t.length-1);u[0]=t[0][n];for(let m=1;m<u.length;m++)u[m]=u[m-1]+t[m][n];const l=a[n],c=a.slice(-2),f=a.join();let d=`if (${l} < ${u[0]}) {
        return getChannel(
            getT0(${f}), vec2(${c.join()}));
        }`;for(let m=1;m<u.length;m++){const x=u[m-1];d+=`
        if (${l} < ${u[m]}  && ${l} >= ${u[m-1]}) {
          return getChannel(
            getT${m}(${SA(a,l,x)}),
            vec2(${SA(c,l,x)}));
        }`}const h=u.length,p=u[u.length-1];d+=`
        return getChannel(
          getT${h}(${SA(a,l,p)}),
          vec2(${SA(c,l,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${d}
      }

      void main() {
        ${s} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[i-1]} = ${o[i-1]} + 1;
        if (${o[i-1]} < ${r[i-1]}) {
          result.g = getValue(${o});
        }

        ${o[i-2]} = ${o[i-2]} + 1;
        if (${o[i-2]} < ${r[i-2]}) {
          result.a = getValue(${o});
        }

        ${o[i-1]} = ${o[i-1]} - 1;
        if (${o[i-2]} < ${r[i-2]} &&
            ${o[i-1]} < ${r[i-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function SA(e,t,n){const r=e.indexOf(t);return e.map((s,o)=>o===r?`${s} - ${n}`:s).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k3(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return No({inputs:{x:i.complexTensorInfos.imag},backend:n})}const LXe={kernelName:VD,backendName:"webgl",kernelFunc:k3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2(e,t,n){const r=e[0].dtype;if(r==="complex64"){const h=e.map(v=>zS({inputs:{input:v},backend:n})),p=e.map(v=>k3({inputs:{input:v},backend:n})),m=M2(h,t,n),x=M2(p,t,n),b=sp({inputs:{real:m,imag:x},backend:n});return h.forEach(v=>n.disposeIntermediateTensorInfo(v)),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),b}let i=n.shouldExecuteOnCPU(e);if(r==="string"&&(i=!0),i){const h=e.map(C=>{const A=[-1,me(C.shape.slice(t))];return Ue({inputs:{x:C},backend:n,attrs:{shape:A}})}),p=h.map(C=>({vals:n.readSync(C.dataId),shape:C.shape})),m=Nl(h.map(C=>C.shape),1),x=h[0].shape[0]===1,b=Aqe(p,m,r,x),v=Nl(e.map(C=>C.shape),t),$=n.makeTensorInfo(v,r,b);return h.forEach(C=>n.disposeIntermediateTensorInfo(C)),$}const s=e.filter(h=>me(h.shape)>0),o=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){const h=o?new Al(e[0].shape,_d):new Bd(e[0].shape,_d);return n.runWebGLProgram(h,e,r)}const a=ce().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>a){const h=[];for(let m=0;m<s.length;m+=a){const x=s.slice(m,m+a);h.push(M2(x,t,n))}const p=M2(h,t,n);for(const m of h)n.disposeIntermediateTensorInfo(m);return p}if(o){const h=new MXe(s.map(p=>p.shape),t);return n.runWebGLProgram(h,s,r)}const{tensors2D:u,outShape:l}=PXe(s,t,n),c=new OXe(u.map(h=>h.shape)),f=n.runWebGLProgram(c,u,r);u.forEach(h=>n.disposeIntermediateTensorInfo(h));const d=Ue({inputs:{x:f},attrs:{shape:l},backend:n});return n.disposeIntermediateTensorInfo(f),d}function PXe(e,t,n){const r=Nl(e.map(s=>s.shape),t);return{tensors2D:e.map(s=>Ue({inputs:{x:s},attrs:{shape:[-1,me(s.shape.slice(t))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Age(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,s=Ot(i,t[0].shape)[0],o=t.map(l=>l.shape);tU(o,s);const a=Nl(t.map(l=>l.shape),s);if(me(a)===0)return n.makeTensorInfo(a,t[0].dtype,[]);const u=t.filter(l=>me(l.shape)>0);return u.length===1?No({inputs:{x:u[0]},backend:n}):M2(u,s,n)}const BXe={kernelName:CC,backendName:"webgl",kernelFunc:Age};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ge{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const o=t.padInfo.top,a=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,f=t.dilationWidth,d=t.filterHeight,h=t.filterWidth,p=Math.floor(t.inChannels/4)*4,m=t.inChannels%4,x=t.dataFormat==="channelsLast",b=x?1:2,v=x?2:3,$=x?3:1;let C="",S="";r&&(i?C=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?C=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:C=`
          float activation(float x) {
            ${r}
          }
        `,S="result = activation(result);");const A=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${C}

      const ivec2 strides = ivec2(${u}, ${l});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${$}];

        ivec2 xRCCorner =
            ivec2(coords[${b}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${h}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${A}
        ${S}
        setOutput(result);
      }
    `}}class zXe{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.front,r=t.padInfo.top,i=t.padInfo.left,s=t.strideDepth,o=t.strideHeight,a=t.strideWidth,u=t.dilationDepth,l=t.dilationHeight,c=t.dilationWidth,f=t.filterDepth,d=t.filterHeight,h=t.filterWidth,p=Math.floor(t.inChannels/4)*4,m=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${s}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${i});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${u};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tge{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Hi(this.outputShape.length);const o=t.padInfo.left,a=t.strideWidth,u=t.dilationWidth,l=t.filterHeight,c=t.filterWidth,f=c;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<c;x++)d+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;d+=`
     for (int r = 0; r < ${l}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let x=0;x<c;x++)d+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(f+1)/2;x++){const b=x*2;if(d+=`
           xC = xCCorner + ${b*u};
           `,a===1){if(b<c&&(o%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }
               `,u===1&&b>0?d+=`
                 xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                   } else {
                     xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xC${b} = xTexelC${b};
                 `,b+1<c)){const v=o%2===0?mD(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                     xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${b+1}.zw = vec2(0.0);
                     }
                     xTexelC${b+1}Ready = 1;
                   }
                   `,u>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                     } else {
                      xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                     }
                     `:d+=`
                     xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                     `):v===1?d+=`
                     xC${b+1} = xTexelC${b};
                     `:d+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                       xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${b+1}.zw = vec2(0.0);
                       }
                       xTexelC${b+1}Ready = 1;
                     }

                     xC${b+1} = xTexelC${b+1};
                     `}}else b<c&&(o%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.0);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
               `,b+1<c&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(
                   xTexelC${b}.xy, xTexelC${b+1}.xy);
               `,b+1<c&&(d+=`
                   xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                 `)));b<c&&(d+=`
             wTexel = getW(r, ${b}, d1, d2);
             dotProd += xC${b}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${b}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,b+1<c&&(d+=`
               wTexel = getW(r, ${b+1}, d1, d2);
               dotProd += xC${b+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${b+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let h="",p="";r&&(i?h=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:s?h=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:h=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${h}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UXe{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Hi(this.outputShape.length);const{dataFormat:r}=n,i=As(),s=r==="channelsLast",o=s?1:2,a=s?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let l="";for(let c=0;c<=1;c++)for(let f=0;f<=1;f++)l+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${c};

          ${u}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${s}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${l}

        ${i.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cI(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function Ige({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:a=null}){const u=e.shape,l=r.texData.get(e.dataId),c=n.inChannels,f=u[0]*u[1]*u[2],d=n.outChannels,h=n.dataFormat==="channelsLast",p=!1,m=!1;let x;const b=[];if(s!=null){const C=cI(s.shape,h);C!=null&&(s=Ue({inputs:{x:s},backend:r,attrs:{shape:C}}),b.push(s))}if(i!=null){const C=cI(i.shape,h);C!=null&&(i=Ue({inputs:{x:i},backend:r,attrs:{shape:C}}),b.push(i))}if(!((f===1||d===1)&&c>$ge)&&l.isPacked&&h&&l.texture!=null&&u[2]%2!==0&&Gt(l.shape.slice(-3),u.slice(-3))){const C=u[0]*u[1]*(u[2]+1),S={dataId:e.dataId,shape:[1,C,n.inChannels],dtype:e.dtype},A=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,U(uI(l.shape,S.shape),()=>`packed reshape ${l.shape} to ${S.shape} isn't free`);const E=Ue({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});b.push(E);const _=lI({a:S,b:E,backend:r,transposeA:p,transposeB:m,bias:i,activation:a,preluActivationWeights:s,leakyreluAlpha:o}),D=r.texData.get(_.dataId);U(D.isPacked,()=>"batchMatMul result is expected to be packed"),l.shape=A,D.shape=n.outShape,x=No({inputs:{x:_},backend:r}),x.shape=n.outShape,b.push(_)}else{const C=n.outHeight*n.outWidth,S=Ue({inputs:{x:e},backend:r,attrs:{shape:h?[n.batchSize,C,n.inChannels]:[n.batchSize,n.inChannels,C]}}),A=Ue({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),E=lI({a:h?S:A,b:h?A:S,transposeA:!h,transposeB:m,backend:r,bias:i,activation:a,preluActivationWeights:s,leakyreluAlpha:o});x=Ue({inputs:{x:E},backend:r,attrs:{shape:n.outShape}}),b.push(S),b.push(A),b.push(E)}for(const C of b)r.disposeIntermediateTensorInfo(C);return x}function Nge({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:u,filterHeight:l,inChannels:c,outWidth:f,outHeight:d,dataFormat:h}=n,p=h==="channelsLast",m=u*l*c,x=d*f,b=[n.batchSize,m,x],v=!0,$=!1,C=[];if(s!=null){const z=cI(s.shape,p);z!=null&&(s=Ue({inputs:{x:s},backend:r,attrs:{shape:z}}),C.push(s))}if(i!=null){const z=cI(i.shape,p);z!=null&&(i=Ue({inputs:{x:i},backend:r,attrs:{shape:z}}),C.push(i))}const S=Ue({inputs:{x:t},backend:r,attrs:{shape:[1,m,me(t.shape)/m]}});C.push(S);const A=new UXe(b,n),E=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],_=r.runWebGLProgram(A,[e],"float32",E),D=Ue({inputs:{x:_},backend:r,attrs:{shape:b}});C.push(_),C.push(D);const N=i!=null,T=s!=null,L=a==="leakyrelu",O=a?Jw(a,!0):null,M=new wge(p?D.shape:S.shape,p?S.shape:D.shape,p?[n.batchSize,x,n.outChannels]:[n.batchSize,n.outChannels,x],v,$,N,O,T,L),R=p?[D,S]:[S,D];if(i&&R.push(i),T&&R.push(s),L){const z=r.makeTensorInfo([],"float32",Pf(o,"float32"));R.push(z),C.push(z)}const P=r.runWebGLProgram(M,R,"float32"),j=Ue({inputs:{x:P},backend:r,attrs:{shape:n.outShape}});C.push(P);for(const z of C)r.disposeIntermediateTensorInfo(z);return j}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jXe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dataFormat:u,dilations:l,dimRoundingMode:c}=r,f=zf(u),d=Jr(i.shape,s.shape,o,l,a,c,!1,f);let h;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))h=Ige({x:i,filter:s,convInfo:d,backend:n});else if(d.strideWidth<=2&&f==="channelsLast"&&ce().getBool("WEBGL_EXP_CONV")){const m=new Tge(d),x=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];h=n.runWebGLProgram(m,[i,s],"float32",x)}else if(ce().getBool("WEBGL_CONV_IM2COL"))h=Nge({x:i,filter:s,convInfo:d,backend:n});else{const m=new _ge(d);h=n.runWebGLProgram(m,[i,s],"float32")}const p=Ue({inputs:{x:h},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(h),p}const WXe={kernelName:SC,backendName:"webgl",kernelFunc:jXe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VXe{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,s=t.padInfo.left,o=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class qXe{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,o=t.dataFormat==="channelsLast",a=n-1-t.padInfo.top,u=r-1-t.padInfo.left,l=o?1:2,c=o?2:3,f=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${l}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class GXe{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,s=t.padInfo.front,o=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${s};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${i} - ${a};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class HXe{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterDepth,r=t.filterHeight,i=t.filterWidth,s=t.strideDepth,o=t.strideHeight,a=t.strideWidth,u=n-1-t.padInfo.front,l=r-1-t.padInfo.top,c=i-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${l}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${s}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${i}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${i} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XXe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,dataFormat:u,dimRoundingMode:l,filterShape:c}=r,f=zf(u),d=Jr(i.shape,c,o,1,a,l,!1,f),h=new VXe(d);return n.runWebGLProgram(h,[i,s],"float32")}const YXe={kernelName:ED,backendName:"webgl",kernelFunc:XXe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KXe{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=Hi(this.outputShape.length);const n=t.filterHeight,r=t.filterWidth,i=n-1-t.padInfo.top,s=r-1-t.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QXe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{inputShape:o,strides:a,pad:u,dataFormat:l,dimRoundingMode:c}=r,f=zf(l),d=Jr(o,s.shape,a,1,u,c,!1,f);if(ce().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&f==="channelsLast"){const h=[[d.strideHeight,d.strideWidth]],p=new KXe(d);return n.runWebGLProgram(p,[i,s],"float32",h)}else{const h=new qXe(d);return n.runWebGLProgram(h,[i,s],"float32")}}const ZXe={kernelName:kC,backendName:"webgl",kernelFunc:QXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JXe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u}=r,l=Zh(i.shape,s.shape,o,u,a),c=new zXe(l);return n.runWebGLProgram(c,[i,s],"float32")}const eYe={kernelName:EC,backendName:"webgl",kernelFunc:JXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,pad:a,filterShape:u}=r,l=Zh(i.shape,u,o,1,a),c=new GXe(l);return n.runWebGLProgram(c,[i,s],"float32")}const nYe={kernelName:AD,backendName:"webgl",kernelFunc:tYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rYe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{pad:o,strides:a,inputShape:u}=r,l=Zh(u,s.shape,a,1,o),c=new HXe(l);return n.runWebGLProgram(c,[i,s],"float32")}const iYe={kernelName:_D,backendName:"webgl",kernelFunc:rYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sYe=pb+`
  return cos(x);
`,oYe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Km}
  return result;
`,aYe=Yt({opSnippet:sYe,packedOpSnippet:oYe}),uYe={kernelName:yx,backendName:"webgl",kernelFunc:aYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lYe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,cYe=Yt({opSnippet:lYe}),fYe={kernelName:xx,backendName:"webgl",kernelFunc:cYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dYe{constructor(t,n,r,i,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,u,l]=t,[c]=n,[f,d]=r;this.outputShape=[c,f,d,l];const h=i==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${u-1}.0`],[x,b,v]=f>1?[`${(a-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[$,C,S]=d>1?[`${(u-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${$});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${b};
        float width_scale = ${C};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${s}));
          return;
        }
        float in_x = ${S};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${s}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${h} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hYe=e=>{const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:s,boxInd:o}=t,{cropSize:a,method:u,extrapolationValue:l}=r,c=new dYe(i.shape,s.shape,a,u,l);return n.runWebGLProgram(c,[i,s,o],"float32")},pYe={kernelName:ID,backendName:"webgl",kernelFunc:hYe};var t$;(function(e){e.Prod="*",e.Sum="+"})(t$||(t$={}));class kJ{constructor(t,n,r,i){this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,o=this.op===t$.Prod?"1.0":"0.0",a=r?o:`getX(${EJ(s,"coords",this.op)})`,u=this.outputShape[this.outputShape.length-1];let l="",c="";r?(l=i?`end != ${u-1}`:"end != 0",c=i?"end + 1":"end - 1"):(l=i?`end + pow2 < ${u}`:"end >= pow2",c=i?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Sn(s)} coords = getOutputCoords();
        int end = ${AJ(s,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${l}) {
          int idx = ${c};
          ${AJ(s,"coords",this.op)} = idx;
          val ${this.op}= getX(${EJ(s,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function EJ(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function AJ(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dge(e,t,n,r,i,s){const o=t.shape.length,a=nr([r],o);let u=t;a!=null&&(u=ks({inputs:{x:t},backend:n,attrs:{perm:a}}));const l=yr(1,o)[0];if(l!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);const c=u.shape[l];let f=No({inputs:{x:u},backend:n});for(let d=0;d<=Math.ceil(Math.log2(c))-1;d++){const h=new kJ(e,u.shape,!1,s),p=[[d]],m=f;f=n.runWebGLProgram(h,[f],f.dtype,p),n.disposeIntermediateTensorInfo(m)}if(i){const d=new kJ(e,u.shape,i,s),h=f;f=n.runWebGLProgram(d,[f],f.dtype),n.disposeIntermediateTensorInfo(h)}if(a!=null){const d=Jh(a),h=ks({inputs:{x:f},backend:n,attrs:{perm:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(u),h}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;return Dge(t$.Prod,i,n,s,o,a)}const mYe={kernelName:TD,backendName:"webgl",kernelFunc:gYe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;return Dge(t$.Sum,i,n,s,o,a)}const xYe={kernelName:AC,backendName:"webgl",kernelFunc:yYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,weights:s}=t,{size:o,binaryOutput:a}=r;if(i.shape.length===1){const u=n.readSync(i.dataId),l=n.readSync(s.dataId),c=dge(u,l,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,c)}else if(i.shape.length===2){const u=n.bufferSync(i),l=n.bufferSync(s),c=Cqe(u,l,o,a);return n.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const vYe={kernelName:ND,backendName:"webgl",kernelFunc:bYe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wYe{constructor(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ye(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:s,dataFormat:o}=r,a=i.shape[0],u=o==="NHWC"?i.shape[1]:i.shape[2],l=o==="NHWC"?i.shape[2]:i.shape[3],c=o==="NHWC"?i.shape[3]:i.shape[1],f=u*s,d=l*s,h=c/(s*s),p=o==="NHWC"?[a,f,d,h]:[a,h,f,d],m=new wYe(p,s,o);return n.runWebGLProgram(m,[i],i.dtype)}const CYe={kernelName:DD,backendName:"webgl",kernelFunc:$Ye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fge{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Hi(this.outputShape.length);const o=t.filterHeight,a=t.filterWidth,u=t.outChannels/t.inChannels;let l="",c="";r&&(i?l=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?l=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:l=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const f=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${l}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${u};
        int q = d2 - d1 * ${u};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rge{constructor(t,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Hi(this.outputShape.length);const o=t.outChannels/t.inChannels,a=t.padInfo.left,u=t.strideWidth,l=t.dilationWidth,c=t.filterHeight,f=t.filterWidth,d=f;let h=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<f;b++)h+=`
          vec4 xTexelC${b*2};
          int xTexelC${b*2}Ready;
          vec4 xTexelC${b*2+1};
          int xTexelC${b*2+1}Ready;
          vec4 xC${b};`;h+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let b=0;b<f;b++)h+=`
          xTexelC${b*2} = vec4(0.0);
          xTexelC${b*2}Ready = 0;
          xTexelC${b*2+1} = vec4(0.0);
          xTexelC${b*2+1}Ready = 0;
          xC${b} = vec4(0.0);`;h+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let b=0;b<(d+1)/2;b++){const v=b*2;if(h+=`
          xC = xCCorner + ${v*l};
          `,u===1){if(v<f&&(a%2===1?(h+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,l===1&&v>0?h+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:h+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):h+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<f)){const $=a%2===0?mD(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(h+=`
                  xCOffset = xC + imod(pads[1], 2) + ${$};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,l>1?h+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:h+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):$===1?h+=`
                    xC${v+1} = xTexelC${v};
                    `:h+=`
                    xCOffset = xC + ${$};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<f&&(a%2===1?(h+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<f&&(h+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(h+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<f&&(h+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<f&&(h+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<f&&(h+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}h+=`
    }
  `,h+=`
      }
    `;let p="",m="";r&&(i?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${h}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u,dimRoundingMode:l}=r;let c=u;c==null&&(c=[1,1]),U(Si(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const f=Jr(i.shape,s.shape,o,c,a,l,!0);let d;ce().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?d=new Rge(f):d=new Fge(f);const h=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return n.runWebGLProgram(d,[i,s],"float32",h)}const kYe={kernelName:_C,backendName:"webgl",kernelFunc:SYe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EYe{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,r=t.strideWidth,i=t.padInfo.top,s=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class AYe{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,r=t.filterWidth,i=t.strideHeight,s=t.strideWidth,o=n-1-t.padInfo.top,a=r-1-t.padInfo.left,u=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${u}; dm++) {
              int d2 = d1 * ${u} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ye(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,dy:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:l,filterShape:c}=r,f=Jr(i.shape,c,o,a,u,l,!0),d=new EYe(f);return n.runWebGLProgram(d,[i,s],"float32")}const TYe={kernelName:FD,backendName:"webgl",kernelFunc:_Ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IYe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:l,inputShape:c}=r,f=Jr(c,s.shape,o,a,u,l,!0),d=new AYe(f);return n.runWebGLProgram(d,[i,s],"float32")}const NYe={kernelName:RD,backendName:"webgl",kernelFunc:IYe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DYe{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FYe(e){const{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],s=me(r.shape),o=Ue({inputs:{x:r},backend:n,attrs:{shape:[s]}}),a=new DYe(s),u=n.runWebGLProgram(a,[o],o.dtype),l=Ue({inputs:{x:u},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),l}const RYe={kernelName:OD,backendName:"webgl",kernelFunc:FYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OYe{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:n,inWidth:r,padInfo:i,strideHeight:s,strideWidth:o,filterHeight:a,filterWidth:u,dilationHeight:l,dilationWidth:c}=t,{top:f,left:d}=i;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${o});
      const ivec2 pads = ivec2(${f}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${u}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MYe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u}=r,l=xS(i.shape,s.shape,o,a,"NHWC",u);let c;const f=new OYe(l);c=n.runWebGLProgram(f,[i,s],"float32");const d=Ue({inputs:{x:c},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(c),d}const LYe={kernelName:TC,backendName:"webgl",kernelFunc:MYe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PYe(e){const{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,s=t,{allDims:o,summedDims:a,idDims:u}=hU(i,s.length);gU(o.length,u,s);const{path:l,steps:c}=mU(a,u),f=c.length;let d=null,h=o.length;const p=[];for(let m=0;m<f;++m){for(const x of c[m]){const{permutationIndices:b,expandDims:v}=pU(h,u[x]);let $;yU(b)?$=s[x]:($=ks({inputs:{x:s[x]},backend:n,attrs:{perm:b}}),p.push($));const C=$.shape.slice();for(let S=0;S<v.length;++S)C.splice(v[S],0,1);Gt($.shape,C)||($=Ue({inputs:{x:$},backend:n,attrs:{shape:C}}),p.push($)),d===null?d=$:(d=ij({inputs:{a:$,b:d},backend:n}),p.push(d))}m<f-1&&(l[m]>=0&&(d=S3({inputs:{x:d},backend:n,attrs:{axis:l[m]-(o.length-h),keepDims:!1}}),p.push(d)),h--)}for(const m of p)m!==d&&n.disposeIntermediateTensorInfo(m);return d}const BYe={kernelName:LD,backendName:"webgl",kernelFunc:PYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zYe="return (x >= 0.0) ? x : (exp(x) - 1.0);",UYe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,jYe=Yt({opSnippet:zYe,packedOpSnippet:UYe}),WYe={kernelName:vx,backendName:"webgl",kernelFunc:jYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VYe="return (b >= 0.0) ? a : a * (b + 1.0);",qYe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,GYe=e=>{const{inputs:t,backend:n}=e,{dy:r,y:i}=t,s=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new hb(qYe,r.shape,i.shape):new fm(VYe,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],r.dtype)},HYe={kernelName:PD,backendName:"webgl",kernelFunc:GYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XYe=`
  return vec4(equal(a, b));
`,YYe="return float(a == b);",KYe=Ei({opSnippet:YYe,packedOpSnippet:XYe,dtype:"bool",cpuKernelImpl:_qe}),QYe={kernelName:IC,backendName:"webgl",kernelFunc:KYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZYe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${oU};
  float a1 = ${aU};
  float a2 = ${uU};
  float a3 = ${lU};
  float a4 = ${cU};
  float a5 = ${fU};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,JYe=Yt({opSnippet:ZYe}),eKe={kernelName:wx,backendName:"webgl",kernelFunc:JYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tKe=pb+`
  return exp(x);
`,nKe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Oge=Yt({opSnippet:tKe,packedOpSnippet:nKe,cpuKernelImpl:Tqe,dtype:"float32"}),rKe={kernelName:$x,backendName:"webgl",kernelFunc:Oge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(e){const{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:s}=t,o=s.shape.length,a=s.shape.slice();let u=i;return i<0&&(U(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+i+1),a.splice(u,0,1),Ue({inputs:{x:s},backend:r,attrs:{shape:a}})}const iKe={kernelName:NC,backendName:"webgl",kernelFunc:U6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _J="return exp(x) - 1.0;",sKe=Yt({opSnippet:_J,packedOpSnippet:_J,cpuKernelImpl:Iqe}),oKe={kernelName:Cx,backendName:"webgl",kernelFunc:sKe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TJ{constructor(t,n,r){this.variableNames=["real","imag"];const i=n[1];this.outputShape=n;const s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${i}.0`:"1.0";let a;if(t==="real")a="return real * expR - imag * expI;";else if(t==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${s};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mge(e,t,n){const r=n.texData.get(e.dataId),i=me(e.shape),s=e.shape[e.shape.length-1],o=i/s,a=Ue({inputs:{x:e},backend:n,attrs:{shape:[o,s]}}),u=a.shape,l=new TJ("real",u,t),c=new TJ("imag",u,t),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],d=n.runWebGLProgram(l,f,"float32"),h=n.runWebGLProgram(c,f,"float32"),p=sp({inputs:{real:d,imag:h},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h);const m=Ue({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aKe(e){const{inputs:t,backend:n}=e,{input:r}=t;return Mge(r,!1,n)}const uKe={kernelName:BD,backendName:"webgl",kernelFunc:aKe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lKe{constructor(t,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function US(e){const{backend:t,attrs:n}=e,{shape:r,value:i}=n;let{dtype:s}=n;if(s=s||Bm(i),s==="string"){const o=ur(s,me(r));return o.fill(i),t.makeTensorInfo(r,s,o)}else{const o=new lKe(r,i),a=[[i]];return t.runWebGLProgram(o,[],s,a)}}const cKe={kernelName:zD,backendName:"webgl",kernelFunc:US};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fKe{constructor(t){this.variableNames=["Image"],this.outputShape=[];const n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dKe={kernelName:UD,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{const{image:n}=e,r=t,i=new fKe(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IJ="return floor(x);",hKe=Yt({opSnippet:IJ,packedOpSnippet:IJ,cpuKernelImpl:Nqe}),pKe={kernelName:Sx,backendName:"webgl",kernelFunc:hKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gKe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,mKe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,yKe=Ei({opSnippet:gKe,packedOpSnippet:mKe,dtype:"int32"}),xKe={kernelName:kx,backendName:"webgl",kernelFunc:yKe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bKe{constructor(t){this.variableNames=["A"];const n=As(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vKe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=As(),[r,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${i}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wKe={kernelName:WT,backendName:"webgl",kernelFunc:$Ke};let o1,XL=ce().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function $Ke(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:i}=t;const{numChannels:s}=r,o=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[u,l]=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[l,u],f=[l,u,s];if(a||o){const m=ce().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(o1==null||m!==XL)&&(XL=m,o1=document.createElement("canvas").getContext("2d",{willReadFrequently:XL})),o1.canvas.width=u,o1.canvas.height=l,o1.drawImage(i,0,0,u,l),i=o1.canvas}const d=n.makeTensorInfo(c,"int32");n.texData.get(d.dataId).usage=Jo.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);const h=ce().getBool("WEBGL_PACK")?new vKe(f):new bKe(f),p=n.runWebGLProgram(h,[d],"int32");return n.disposeData(d.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CKe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:l,dataFormat:c,dilations:f,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r,m=zf(c),x=Jr(i.shape,s.shape,u,f,l,d,!1,m);let b;const v=[],$=o!=null,C=a!=null,S=h==="leakyrelu",A=()=>{const _=[i,s],D=(N,T)=>{if(T==="NCHW"&&N.shape.length===1&&N.shape[0]!==1){const L=Ue({inputs:{x:N},backend:n,attrs:{shape:[N.shape[0],1,1]}});return v.push(L),L}return N};if($&&_.push(D(o,c)),C&&_.push(D(a,c)),S){const N=n.makeTensorInfo([],"float32",Pf(p,"float32"));_.push(N),v.push(N)}return _};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))b=Ige({x:i,filter:s,convInfo:x,backend:n,bias:o,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else if(x.strideWidth<=2&&m==="channelsLast"&&ce().getBool("WEBGL_EXP_CONV")){const _=h?Jw(h,!0):null,D=new Tge(x,$,_,C,S),N=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],T=A();b=n.runWebGLProgram(D,T,"float32",N)}else if(ce().getBool("WEBGL_CONV_IM2COL"))b=Nge({x:i,filter:s,convInfo:x,backend:n,bias:o,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else{const _=h?Jw(h,!1):null,D=new _ge(x,$,_,C,S),N=A();b=n.runWebGLProgram(D,N,"float32")}const E=Ue({inputs:{x:b},backend:n,attrs:{shape:x.outShape}});return v.push(b),v.forEach(_=>n.disposeIntermediateTensorInfo(_)),E}const SKe={kernelName:Ow,backendName:"webgl",kernelFunc:CKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kKe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:l,dilations:c,dimRoundingMode:f,activation:d,leakyreluAlpha:h}=r,p=[];let m=c;m==null&&(m=[1,1]),U(Si(u,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${m}'`);const x=Jr(i.shape,s.shape,u,m,l,f,!0),b=ce().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,v=d?Jw(d,b):null,$=[i,s],C=o!=null,S=a!=null,A=d==="leakyrelu";if(C&&$.push(o),S&&$.push(a),A){const N=n.makeTensorInfo([],"float32",Pf(h,"float32"));$.push(N),p.push(N)}let E;b?E=new Rge(x,C,v,S,A):E=new Fge(x,C,v,S,A);const _=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],D=n.runWebGLProgram(E,$,"float32",_);return p.forEach(N=>n.disposeIntermediateTensorInfo(N)),D}const EKe={kernelName:Mw,backendName:"webgl",kernelFunc:kKe};class AKe{constructor(t,n,r,i){this.sliceDim=t,this.strides=n,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=r;const s=Sn(r.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${s} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ke(e){const{inputs:t,backend:n}=e,{params:r,indices:i}=t,s=i.shape,o=s[s.length-1],a=me(r.shape),[u,l,c,f]=t3(r,i),d=Ue({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),h=Ue({inputs:{x:r},backend:n,attrs:{shape:[me(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const b=n.readSync(i.dataId),v=n.bufferSync(r),$=Dqe(b,v,r.dtype,l,o,c,f,r.shape,a);return n.makeTensorInfo(u,r.dtype,$.values)}const p=new AKe(o,f,[l,c],r.shape),m=n.runWebGLProgram(p,[h,d],h.dtype),x=Ue({inputs:{x:m},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),x}const TKe={kernelName:jD,backendName:"webgl",kernelFunc:_Ke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IKe{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=Sn(this.rank),i=NKe(t);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${i}));
      }
    `}}function NKe(e,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<e.length;i++)i===2?r.push("index"):r.push(`${n[i]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lge(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,indices:s}=t,{axis:o,batchDims:a}=r,u=Ot(o,i.shape)[0];if(ce().get("DEBUG")){const v=n.readSync(s.dataId),$=i.shape[u];for(let C=0;C<v.length;++C){const S=v[C];U(S<=$-1&&S>=0,()=>`GatherV2: the index value ${S} is not in [0, ${$-1}]`)}}const l=bU(i,s,u,a),c=me(s.shape),f=[],d=Ue({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),h=Ue({inputs:{x:s},backend:n,attrs:{shape:[l.batchSize,c/l.batchSize]}});f.push(d),f.push(h);const p=[l.batchSize,l.outerSize,c/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([i,s])||i.dtype==="string"){const v=n.bufferSync(h),$=n.bufferSync(d),C=Fqe($,v,p);return f.forEach(S=>n.disposeIntermediateTensorInfo(S)),n.makeTensorInfo(l.outputShape,C.dtype,C.values)}const m=new IKe(d.shape,p),x=n.runWebGLProgram(m,[d,h],d.dtype);f.push(x);const b=Ue({inputs:{x},backend:n,attrs:{shape:l.outputShape}});return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const DKe={kernelName:FC,backendName:"webgl",kernelFunc:Lge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FKe="return float(a > b);",RKe=`
  return vec4(greaterThan(a, b));
`,OKe=Ei({opSnippet:FKe,packedOpSnippet:RKe,cpuKernelImpl:Rqe,dtype:"bool"}),MKe={kernelName:RC,backendName:"webgl",kernelFunc:OKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LKe="return float(a >= b);",PKe=`
  return vec4(greaterThanEqual(a, b));
`,BKe=Ei({opSnippet:LKe,packedOpSnippet:PKe,dtype:"bool",cpuKernelImpl:Oqe}),zKe={kernelName:Ex,backendName:"webgl",kernelFunc:BKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UKe(e){const{inputs:t,backend:n}=e,{input:r}=t;return Mge(r,!0,n)}const jKe={kernelName:WD,backendName:"webgl",kernelFunc:UKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WKe="return float(!isnan(x) && !isinf(x));",VKe=Yt({opSnippet:WKe,dtype:"bool"}),qKe={kernelName:_x,backendName:"webgl",kernelFunc:VKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GKe="return float(isinf(x));",HKe=Yt({opSnippet:GKe,dtype:"bool"}),XKe={kernelName:Tx,backendName:"webgl",kernelFunc:HKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YKe="return float(isnan(x));",KKe=Yt({opSnippet:YKe,dtype:"bool"}),QKe={kernelName:Ix,backendName:"webgl",kernelFunc:KKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZKe="return float(a < b);",JKe=`
  return vec4(lessThan(a, b));
`,eQe=Ei({opSnippet:ZKe,packedOpSnippet:JKe,cpuKernelImpl:Mqe,dtype:"bool"}),tQe={kernelName:MC,backendName:"webgl",kernelFunc:eQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nQe="return float(a <= b);",rQe=`
  return vec4(lessThanEqual(a, b));
`,iQe=Ei({opSnippet:nQe,packedOpSnippet:rQe,cpuKernelImpl:Lqe,dtype:"bool"}),sQe={kernelName:LC,backendName:"webgl",kernelFunc:iQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oQe(e){const{backend:t,attrs:n}=e,{start:r,stop:i,num:s}=n,o=Pqe(r,i,s);return t.makeTensorInfo([o.length],"float32",o)}const aQe={kernelName:qD,backendName:"webgl",kernelFunc:oQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uQe=pb+`
  return x < 0.0 ? 0./0. : log(x);
`,lQe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,cQe=Yt({opSnippet:uQe,packedOpSnippet:lQe,cpuKernelImpl:Bqe}),fQe={kernelName:Nx,backendName:"webgl",kernelFunc:cQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dQe=pb+`
  return log(1.0 + x);
`,hQe=Yt({opSnippet:dQe}),pQe={kernelName:Dx,backendName:"webgl",kernelFunc:hQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gQe="return float(a >= 1.0 && b >= 1.0);",mQe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,yQe=Ei({opSnippet:gQe,packedOpSnippet:mQe,dtype:"bool"}),xQe={kernelName:PC,backendName:"webgl",kernelFunc:yQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bQe="return float(!(x >= 1.0));",vQe=Yt({opSnippet:bQe}),wQe={kernelName:BC,backendName:"webgl",kernelFunc:vQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Qe="return float(a >= 1.0 || b >= 1.0);",CQe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,SQe=Ei({opSnippet:$Qe,packedOpSnippet:CQe,dtype:"bool"}),kQe={kernelName:zC,backendName:"webgl",kernelFunc:SQe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EQe{constructor(t,n,r,i,s){this.variableNames=["x"],this.outputShape=[];const o=n,a=t[3]-1;this.outputShape=t;let u;const l=`float(${r}) + float(${i}) * sum`;s===.5?u=`inversesqrt(${l})`:s===1?u=`1.0/(${l})`:u=`exp(log(${l}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${u};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AQe{constructor(t,n,r,i,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=t[3]-1;this.outputShape=t;let u;const l=`float(${r}) + float(${i}) * sum`;s===.5?u=`inversesqrt(${l})`:s===1?u=`1.0/(${l})`:u=`exp(log(${l}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Qe=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:s,bias:o,alpha:a,beta:u}=r,l=ce().getBool("WEBGL_PACK_NORMALIZATION")?new AQe(i.shape,s,o,a,u):new EQe(i.shape,s,o,a,u);return n.runWebGLProgram(l,[i],i.dtype)},TQe={kernelName:UC,backendName:"webgl",kernelFunc:_Qe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IQe{constructor(t,n,r,i,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=i,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${i}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${i})
                * float(${s})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${s});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NQe=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i,y:s,dy:o}=t,{depthRadius:a,bias:u,alpha:l,beta:c}=r,f=new IQe(i.shape,a,u,l,c);return n.runWebGLProgram(f,[i,s,o],i.dtype)},DQe={kernelName:GD,backendName:"webgl",kernelFunc:NQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FQe(e,t,n,r){const i=me(t),o=me(e.shape)/i,a=Ue({inputs:{x:e},attrs:{shape:[o,i]},backend:r}),u=Qm(a,e.dtype,"max",r),l=Ue({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(u),l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pge(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:s,keepDims:o}=r,a=i.shape.length,u=Ot(s,i.shape);let l=u;const c=nr(l,a),f=c!=null,d=n.shouldExecuteOnCPU([i]);let h=i;if(f){if(d){const $=n.texData.get(h.dataId).values,C=new Array(a);for(let E=0;E<C.length;E++)C[E]=i.shape[c[E]];const S=nj($,i.shape,i.dtype,c,C);h=n.makeTensorInfo(C,i.dtype);const A=n.texData.get(h.dataId);A.values=S}else h=C3(i,c,n);l=yr(l.length,a)}ki("max",l,a);const[p,m]=ei(h.shape,l);let x=p;o&&(x=mr(p,u));let b;if(d){const $=n.texData.get(h.dataId).values,C=zqe($,me(m),x,i.dtype);b=n.makeTensorInfo(x,i.dtype);const S=n.texData.get(b.dataId);S.values=C}else b=FQe(h,m,x,n);return f&&n.disposeIntermediateTensorInfo(h),b}const RQe={kernelName:jC,backendName:"webgl",kernelFunc:Pge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OQe=rj+`
  return max(a, b);
`,MQe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Km+`
  return result;
`,LQe=Ei({opSnippet:OQe,packedOpSnippet:MQe,cpuKernelImpl:Uqe}),PQe={kernelName:Fx,backendName:"webgl",kernelFunc:LQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BQe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;PS(i,"maxPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r,l=1;U(Si(o,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const c=Xa(i.shape,s,o,l,a,u);if(c.filterWidth===1&&c.filterHeight===1&&Gt(c.inShape,c.outShape))return No({inputs:{x:i},backend:n});const f=new e$(c,"max",!1);return n.runWebGLProgram(f,[i],i.dtype)}const zQe={kernelName:WC,backendName:"webgl",kernelFunc:BQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UQe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:s,strides:o,pad:a,dataFormat:u,dimRoundingMode:l}=r,c=[1,1,1],f=Bf(i.shape,s,o,c,a,l,u),d=new sj(f,"max",!1);return n.runWebGLProgram(d,[i],i.dtype)}const jQe={kernelName:VC,backendName:"webgl",kernelFunc:UQe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WQe{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideHeight,r=t.strideWidth,i=t.dilationHeight,s=t.effectiveFilterHeight,o=t.effectiveFilterWidth,a=s-1-t.padInfo.top,u=o-1-t.padInfo.left,l=s*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
          wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class VQe{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideDepth,r=t.strideHeight,i=t.strideWidth,s=t.dilationDepth,o=t.dilationHeight,a=t.dilationWidth,u=t.effectiveFilterDepth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,f=u-1-t.padInfo.front,d=l-1-t.padInfo.top,h=c-1-t.padInfo.left,p=u*l*c-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${d}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
           wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qQe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s}=t,o=s,{filterSize:a,strides:u,pad:l,dimRoundingMode:c}=r,f=[1,1,1],d=Bf(o.shape,a,u,f,l,c),h=new sj(d,"max",!0),p=n.runWebGLProgram(h,[o],o.dtype),m=new VQe(d),x=n.runWebGLProgram(m,[i,p],o.dtype);return n.disposeIntermediateTensorInfo(p),x}const GQe={kernelName:XD,backendName:"webgl",kernelFunc:qQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HQe(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,input:s,output:o}=t,a=s;PS([s,o],"maxPoolGrad");const{filterSize:u,strides:l,pad:c,dimRoundingMode:f}=r,d=Xa(a.shape,u,l,1,c,f),h=!0,p=new e$(d,"max",h),m=n.runWebGLProgram(p,[a],a.dtype),x=new WQe(d),b=n.runWebGLProgram(x,[i,m],a.dtype);return n.disposeIntermediateTensorInfo(m),b}const XQe={kernelName:HD,backendName:"webgl",kernelFunc:HQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YQe(e,t,n,r){let i=new e$(n,"max",!1);const s=r.runWebGLProgram(i,[e],"float32");i=new e$(n,"max",!0,!0,t);const o=r.runWebGLProgram(i,[e],"float32");return[s,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KQe={kernelName:YD,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{filterSize:i,strides:s,pad:o,includeBatchInIndex:a}=t,u=n;U(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const l=[1,1];U(Si(s,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${l}'`);const c=Xa(r.shape,i,s,l,o),[f,d]=YQe(r,a,c,u);return[f,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQe(e,t,n,r){const i=me(t),o=me(e.shape)/i,a=Ue({inputs:{x:e},attrs:{shape:[o,i]},backend:r}),u=Qm(a,"float32","mean",r),l=Ue({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(u),l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZQe={kernelName:qC,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{keepDims:i,axis:s}=t,o=n,a=r.shape.length,u=Ot(s,r.shape);let l=u;const c=nr(l,a),f=c!=null,d=o.shouldExecuteOnCPU([r]),h=[];let p=r;if(f){if(d){const C=o.texData.get(p.dataId).values,S=new Array(a);for(let _=0;_<S.length;_++)S[_]=r.shape[c[_]];const A=nj(C,r.shape,r.dtype,c,S);p=o.makeTensorInfo(S,r.dtype);const E=o.texData.get(p.dataId);E.values=A}else p=C3(r,c,o);h.push(p),l=yr(l.length,a)}ki("sum",l,a);const[m,x]=ei(p.shape,l);let b=m;i&&(b=mr(m,u));const v=QQe(p,x,b,o);for(const $ of h)o.disposeIntermediateTensorInfo($);return v}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JQe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=Ot(s,i.shape);let l=u;const c=nr(l,a);let f=i;c!=null&&(f=ks({inputs:{x:i},backend:n,attrs:{perm:c}}),l=yr(l.length,i.shape.length)),ki("min",l,a);const[d,h]=ei(f.shape,l),p=me(h),m=Ue({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),x=Qm(m,m.dtype,"min",n);let b;if(o){const v=mr(d,u);b=Ue({inputs:{x},backend:n,attrs:{shape:v}})}else b=Ue({inputs:{x},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(f),b}const eZe={kernelName:GC,backendName:"webgl",kernelFunc:JQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tZe=rj+`
  return min(a, b);
`,nZe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Km+`
  return result;
`,rZe=Ei({opSnippet:tZe,packedOpSnippet:nZe,cpuKernelImpl:jqe}),iZe={kernelName:Rx,backendName:"webgl",kernelFunc:rZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sZe{constructor(t,n,r){this.variableNames=["x"],this.outputShape=n.map((c,f)=>c[0]+t[f]+c[1]);const i=t.length,s=Sn(i),o=n.map(c=>c[0]).join(","),a=n.map((c,f)=>c[0]+t[f]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),l=r==="reflect"?0:1;if(i===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${o});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        for (int i = 0; i < ${i}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${s} coords = outC - start;
        setOutput(getX(${u}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oZe{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+t[m]+p[1]);const i=t.length,s=Sn(i),o=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+t[m]).join(","),u=cs("rc",i),l=cs("source",i),c=`${u[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${l.slice(-2).join()})`,d=r==="reflect"?0:1;let h="";if(i===1){const p=`
        ${s} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;h=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${l.join()}), ${f});
        ${u[i-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${l.join()}), ${f});
        }
      `}else{const p=`
        ${s} source = rc;
        ${s} lt = ${s}(lessThan(source, start));
        ${s} gte = ${s}(greaterThanEqual(source, end));
        ${s} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;h=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${l.join()}), ${f});
        ${u[i-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${l.join()}), ${f});
        }
        rc = outputLoc;
        ${u[i-2]} += 1;
        if(${u[i-2]} < ${this.outputShape[i-2]}) {
          ${p}
          result[2] = getChannel(getX(${l.join()}), ${f});
          ${u[i-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${l.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${s} start = ${s}(${o});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aZe=({inputs:e,backend:t,attrs:n})=>{const{x:r}=e,{paddings:i,mode:s}=n,o=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new oZe(r.shape,i,s):new sZe(r.shape,i,s);return t.runWebGLProgram(o,[r],r.dtype)},uZe={kernelName:HC,backendName:"webgl",kernelFunc:aZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lZe=`if (b == 0.0) return NAN;
  return mod(a, b);`,cZe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Km+`
  return result;
`,fZe=Ei({opSnippet:lZe,packedOpSnippet:cZe}),dZe={kernelName:Ox,backendName:"webgl",kernelFunc:fZe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hZe{constructor(t,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pZe=`
if (a == b) {
  return 1.0;
};
return a / b;`,gZe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,Bge=Ei({opSnippet:pZe,packedOpSnippet:gZe,checkOutOfBounds:!0}),mZe={kernelName:bx,backendName:"webgl",kernelFunc:Bge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NJ="return a - b;",zge=Ei({opSnippet:NJ,packedOpSnippet:NJ,supportsComplex:!0,cpuKernelImpl:lGe}),yZe={kernelName:Qx,backendName:"webgl",kernelFunc:zge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uge(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:s}=r,o=Ot([s],i.shape),a=Pge({inputs:{x:i},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),u=mr(a.shape,o),l=Ue({inputs:{x:a},backend:n,attrs:{shape:u}}),c=zge({inputs:{a:i,b:l},backend:n}),f=Oge({inputs:{x:c},backend:n}),d=S3({inputs:{x:f},backend:n,attrs:{axis:o,keepDims:!1}}),h=Ue({inputs:{x:d},backend:n,attrs:{shape:u}}),p=Bge({inputs:{a:f,b:h},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),p}const xZe={kernelName:fS,backendName:"webgl",kernelFunc:Uge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bZe(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:s,seed:o,normalized:a}=r,u=a?i:Uge({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),l=u.shape[0],c=u.shape[1],f=new hZe(l,c,s),d=[[o]],h=n.runWebGLProgram(f,[u],"int32",d);return a||n.disposeIntermediateTensorInfo(u),h}const vZe={kernelName:KD,backendName:"webgl",kernelFunc:bZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wZe=Ka+`
  return -x;
`,$Ze=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function CZe(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const s=n.texData.get(r.dataId),[o,a]=Vqe(s.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,o)}let i;return ce().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Bd(r.shape,$Ze):i=new Al(r.shape,wZe),n.runWebGLProgram(i,[r],r.dtype)}const SZe={kernelName:XC,backendName:"webgl",kernelFunc:CZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kZe=QF;function EZe(e){Qo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u}=r,l=n.readSync(i.dataId),c=n.readSync(s.dataId),{selectedIndices:f}=kZe(l,c,o,a,u);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const AZe={kernelName:QD,backendName:"webgl",kernelFunc:EZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ze=ZF;function TZe(e){Qo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,padToMaxOutputSize:l}=r,c=n.readSync(i.dataId),f=n.readSync(s.dataId),{selectedIndices:d,validOutputs:h}=_Ze(c,f,o,a,u,l);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const IZe={kernelName:ZD,backendName:"webgl",kernelFunc:TZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NZe=JF;function DZe(e){Qo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,softNmsSigma:l}=r,c=n.readSync(i.dataId),f=n.readSync(s.dataId),d=o,h=a,p=u,m=l,{selectedIndices:x,selectedScores:b}=NZe(c,f,d,h,p,m);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const FZe={kernelName:JD,backendName:"webgl",kernelFunc:DZe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RZe{constructor(t,n,r,i){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${i}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OZe=e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:s,depth:o,onValue:a,offValue:u}=r,l=me(i.shape),c=new RZe(l,o,a,u),f=Ue({inputs:{x:i},backend:n,attrs:{shape:[l]}}),d=n.runWebGLProgram(c,[f],s);n.disposeIntermediateTensorInfo(f);const h=[...i.shape,o],p=Ue({inputs:{x:d},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(d),p},MZe={kernelName:QC,backendName:"webgl",kernelFunc:OZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fI(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="complex64"){const i=zS({inputs:{input:r},backend:n}),s=fI({inputs:{x:i},backend:n}),o=k3({inputs:{input:r},backend:n}),a=fI({inputs:{x:o},backend:n}),u=sp({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),u}else return US({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const LZe={kernelName:gS,backendName:"webgl",kernelFunc:fI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jge(e){const{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const i=zS({inputs:{input:r},backend:n}),s=jge({inputs:{x:i},backend:n}),o=k3({inputs:{input:r},backend:n}),a=fI({inputs:{x:o},backend:n}),u=sp({inputs:{real:s,imag:a},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),u}else return US({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const PZe={kernelName:KC,backendName:"webgl",kernelFunc:jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BZe(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return U6({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const s=t[0].shape,o=t[0].dtype;t.forEach(c=>{Ci(s,c.shape,"All tensors passed to stack must have matching shapes"),U(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],u=t.map(c=>{const f=U6({inputs:{input:c},backend:n,attrs:{dim:i}});return a.push(f),f}),l=Age({inputs:u,backend:n,attrs:{axis:i}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),l}const zZe={kernelName:ZC,backendName:"webgl",kernelFunc:BZe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UZe{constructor(t,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((l,c)=>l[0]+t[c]+l[1]);const i=t.length,s=Sn(i),o=n.map(l=>l[0]).join(","),a=n.map((l,c)=>l[0]+t[c]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);if(i===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${o});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${s} coords = outC - start;
          setOutput(getX(${u}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jZe{constructor(t,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,x)=>m[0]+t[x]+m[1]);const i=t.length,s=Sn(i),o=n.map(m=>m[0]).join(","),a=n.map((m,x)=>m[0]+t[x]).join(","),u=cs("rc",i),l=cs("source",i),c=`${u[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${l.slice(-2).join()})`,d=[`${s} rc = outputLoc;`,`${u[i-1]} += 1;
       if(${c}) {
      `,i===1?"":`}
       rc = outputLoc;
       ${u[i-2]} += 1;
       if(${u[i-2]} < ${this.outputShape[i-2]}) {`,i===1?"":`  ${u[i-1]} += 1;
         if(${c}) {`],h=i===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,x=i===1?2:4;m<x;m++)p+=`
        ${d[m]}
        if (${h}) {
          result[${m}] = float(value);
        } else {
          ${s} source = rc - start;
          result[${m}] = getChannel(getX(${l.join()}), ${f});
        }
      `;p+=i===1?"} ":"}}",this.userCode=`
      const ${s} start = ${s}(${o});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wge=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:s,constantValue:o}=r;if(me(i.shape)===0){const l=s.map((c,f)=>c[0]+i.shape[f]+c[1]);return US({backend:n,attrs:{shape:l,value:o,dtype:i.dtype}})}const a=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jZe(i.shape,s,o):new UZe(i.shape,s,o),u=[[o]];return n.runWebGLProgram(a,[i],i.dtype,u)},WZe={kernelName:JC,backendName:"webgl",kernelFunc:Wge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VZe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,qZe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Km+`
  return result;
`,GZe=Ei({opSnippet:VZe,packedOpSnippet:qZe}),HZe={kernelName:Lx,backendName:"webgl",kernelFunc:GZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XZe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=[],l=Ot(s,i.shape);let c=l;const f=nr(c,a);let d=i;f!=null&&(d=ks({inputs:{x:i},backend:n,attrs:{perm:f}}),c=yr(c.length,a),u.push(d)),ki("prod",c,a);let h;if(n.shouldExecuteOnCPU([d])){const p=n.texData.get(d.dataId).values,{outVals:m,outShape:x,outDtype:b}=Gqe(d.shape,d.dtype,p,c);h=n.makeTensorInfo(x,b,m)}else{const[p,m]=ei(d.shape,c),x=me(m),b=Ue({inputs:{x:d},backend:n,attrs:{shape:[-1,x]}}),v=kF(i.dtype),$=Qm(b,v,"prod",n);h=Ue({inputs:{x:$},backend:n,attrs:{shape:p}}),u.push(b),u.push($)}if(o){u.push(h);const p=mr(h.shape,l);h=Ue({inputs:{x:h},backend:n,attrs:{shape:p}})}return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const YZe={kernelName:tS,backendName:"webgl",kernelFunc:XZe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KZe(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:s,indices:o}=t,{outputRaggedRank:a}=r,u=i.map(b=>n.readSync(b.dataId)),l=i.map(b=>b.shape),c=n.readSync(s.dataId),f=n.readSync(o.dataId),[d,h,p]=Hqe(u,l,c,s.shape,s.dtype,f,o.shape,a),m=d.map(b=>n.makeTensorInfo([b.length],"int32",b)),x=n.makeTensorInfo(p,s.dtype,h);return m.concat([x])}const QZe={kernelName:eF,backendName:"webgl",kernelFunc:KZe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZZe(e){const{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:s}=t,o=n.readSync(r.dataId),a=n.readSync(i.dataId),u=n.readSync(s.dataId),[l,c]=Xqe(o,r.shape,r.dtype,a,i.shape,u,s.shape),f=n.makeTensorInfo([l.length],"int32",l),d=n.makeTensorInfo([c.length],r.dtype,c);return[f,d]}const JZe={kernelName:tF,backendName:"webgl",kernelFunc:ZZe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eJe(e){const{inputs:t,backend:n,attrs:r}=e,{shape:i,values:s,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:u}=r,l=n.readSync(i.dataId),c=n.readSync(s.dataId),f=n.readSync(o.dataId),d=a.map(x=>n.readSync(x.dataId)),h=a.map(x=>x.shape),[p,m]=Yqe(l,i.shape,c,s.shape,s.dtype,f,o.shape,d,h,u);return n.makeTensorInfo(p,s.dtype,m)}const tJe={kernelName:nF,backendName:"webgl",kernelFunc:eJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vge=e=>{const{backend:t,attrs:n}=e,{start:r,stop:i,step:s,dtype:o}=n,a=Kqe(r,i,s,o);return t.makeTensorInfo([a.length],o,a)},nJe={kernelName:rF,backendName:"webgl",kernelFunc:Vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rJe="return 1.0 / x;",iJe=Yt({opSnippet:rJe}),sJe={kernelName:Px,backendName:"webgl",kernelFunc:iJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oJe=Ka+`
  return (x < 0.0) ? 0.0 : x;
`,aJe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,uJe=Yt({opSnippet:oJe,packedOpSnippet:aJe}),lJe={kernelName:Bx,backendName:"webgl",kernelFunc:uJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cJe=Ka+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,fJe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dJe=Yt({opSnippet:cJe,packedOpSnippet:fJe}),hJe={kernelName:zx,backendName:"webgl",kernelFunc:dJe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pJe{constructor(t,n,r,i,s){this.variableNames=["A"],this.outputShape=[];const[o,a,u,l]=t;this.outputShape=[o,n,r,l];const c=[i&&n>1?a-1:a,i&&r>1?u-1:u],f=[i&&n>1?n-1:n,i&&r>1?r-1:r];let d;s?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gJe{constructor(t,n,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,u,l]=t;this.outputShape=[o,n,r,l];const c=[i&&n>1?a-1:a,i&&r>1?u-1:u],f=[i&&n>1?n-1:n,i&&r>1?r-1:r];let d;s?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mJe(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r,[u,l]=a,c=ce().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new gJe(i.shape,u,l,s,o):new pJe(i.shape,u,l,s,o);return n.runWebGLProgram(c,[i],"float32")}const yJe={kernelName:iS,backendName:"webgl",kernelFunc:mJe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xJe{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,s]=n,[,o,a]=t,u=[r&&o>1?i-1:i,r&&a>1?s-1:s],l=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=u[0]/l[0],f=u[1]/l[1],d=1/c,h=1/f,p=Math.ceil(d)*2+2,m=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bJe(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r,a=new xJe(s.shape,i.shape,o);return n.runWebGLProgram(a,[s],s.dtype)}const vJe={kernelName:oF,backendName:"webgl",kernelFunc:bJe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wJe{constructor(t,n,r,i,s){this.variableNames=["A"],this.outputShape=[];const[o,a,u,l]=t;this.outputShape=[o,n,r,l];const c=[i&&n>1?a-1:a,i&&r>1?u-1:u],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],d=i?"0.5":"0.0";let h;s?h="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Je{constructor(t,n,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,u,l]=t;this.outputShape=[o,n,r,l];const c=[i&&n>1?a-1:a,i&&r>1?u-1:u],f=[i&&n>1?n-1:n,i&&r>1?r-1:r],d=i?"0.5":"0.0";let h;s?h="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CJe(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r,[u,l]=a,c=ce().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new $Je(i.shape,u,l,s,o):new wJe(i.shape,u,l,s,o);return n.runWebGLProgram(c,[i],i.dtype)}const SJe={kernelName:rS,backendName:"webgl",kernelFunc:CJe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kJe{constructor(t,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,s]=n,[,o,a]=t,u=[r&&o>1?i-1:i,r&&a>1?s-1:s],l=[r&&o>1?o-1:o,r&&a>1?a-1:a],c=u[0]/l[0],f=u[1]/l[1],d=1/c,h=1/f,p=Math.ceil(d)*2+2,m=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${u[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${u[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EJe(e){const{inputs:t,backend:n,attrs:r}=e,{images:i,dy:s}=t,{alignCorners:o}=r,a=new kJe(s.shape,i.shape,o);return n.runWebGLProgram(a,[s],s.dtype)}const AJe={kernelName:sF,backendName:"webgl",kernelFunc:EJe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Je{constructor(t,n){this.variableNames=["x"];const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=t,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const i=a=>n.indexOf(a)!==-1&&t[a]!==1?`${t[a]} - coords[${a}] - 1`:`coords[${a}]`,s=t.map((a,u)=>i(u)).join(","),o=Sn(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TJe{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=t;const i=cs("rc",r),s=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,a=Sn(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${u(i.slice())};
          if(${s}){
            result.g = ${l(i.slice())};
          }
          if(${o}) {
            result.b = ${c(i.slice())};
            if(${s}) {
              result.a = ${f(i.slice())};
            }
          }
          setOutput(result);
        }
    `;function u(p){return d(p)}function l(p){return p[r-1]="("+p[r-1]+" + 1)",d(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",d(p)}function f(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",d(p)}function d(p){const m=t.map((v,$)=>h($,p)),x=m.join(","),b=m.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${b}))`}function h(p,m){return n.indexOf(p)!==-1&&t[p]!==1?`${t[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJe(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:s}=r,o=i.shape.length,a=Ot(s,i.shape);if(o===0)return No({inputs:{x:i},backend:n});const u=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TJe(i.shape,a):new _Je(i.shape,a);return n.runWebGLProgram(u,[i],i.dtype)}const NJe={kernelName:sS,backendName:"webgl",kernelFunc:IJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DJe{constructor(t,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=t[1],i=t[2];this.outputShape=t;let s="";typeof n=="number"?s=`float outputValue = ${n.toFixed(2)};`:s=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${s}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FJe={kernelName:CF,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:r}=e,{radians:i,fillValue:s,center:o}=t,a=n,u=new DJe(r.shape,s),[l,c]=rU(o,r.shape[1],r.shape[2]),f=[[l,c,Math.sin(i),Math.cos(i)]];return a.runWebGLProgram(u,[r],r.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RJe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,OJe=Yt({opSnippet:RJe}),MJe={kernelName:Ux,backendName:"webgl",kernelFunc:OJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LJe="return inversesqrt(x);",PJe=Yt({opSnippet:LJe,cpuKernelImpl:Qqe}),BJe={kernelName:jx,backendName:"webgl",kernelFunc:PJe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oj{constructor(t,n,r,i,s,o,a=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const l=Sn(s.length),c=Sn(o.length);let f="";r===1?f="i":r===2&&(f="i, j");const d=`getIndices(${f})`;let h="";i===1?h="i":i===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let m="";u&&(m="coords[0], coords[1]");const x=`getDefaultValue(${m})`,b=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${b};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${x}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zJe{constructor(t,n,r,i,s,o,a=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const l=Sn(s.length),c=Sn(o.length);let f="";r===1?f="i":r===2&&(f="i, j");const d=`getIndices(${f})`;let h="";i===1?h="i":i===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let m="";u&&(m="coords[0], coords[1]");const x=`getDefaultValue(${m})`,b=n>1?"strides[j]":"strides",v=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${l} strides = ${l}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${t}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${b};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${v};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${x}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UJe(e){const{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:s}=t,{shape:o}=r,{sliceRank:a,numUpdates:u,sliceSize:l,strides:c,outputSize:f}=np(s,i,o),d=[f/l,l];if(f===0)return n.makeTensorInfo(o,i.dtype);const h=Ue({inputs:{x:i},backend:n,attrs:{shape:[u,a]}}),p=Ue({inputs:{x:s},backend:n,attrs:{shape:[u,l]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let x;ce().getBool("WEBGL_PACK")?x=new zJe(u,a,h.shape.length,p.shape.length,c,d):x=new oj(u,a,h.shape.length,p.shape.length,c,d);const b=n.runWebGLProgram(x,[p,h,m],p.dtype),v=Ue({inputs:{x:b},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(m),v}const jJe={kernelName:aF,backendName:"webgl",kernelFunc:UJe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WJe{constructor(t,n,r,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];const s="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=ce().getNumber("WEBGL_VERSION")===2?s:o,u=i==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${u} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VJe(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:s}=t,{side:o}=r,a=new WJe(i.shape[0],i.shape[1],s.shape[1],o),u=[[i.shape[1]]];return n.runWebGLProgram(a,[i,s],"int32",u)}const qJe={kernelName:lF,backendName:"webgl",kernelFunc:VJe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GJe{constructor(t,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let i,s;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)s="resRC",i="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],l=[];for(let c=0;c<n.length;c++)l.push(`${a[c]}`),c<t&&u.push(`${a[c]}`);i=u.join(),s=l.join()}const o=Sn(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${i});
        if (cVal >= 1.0) {
          setOutput(getA(${s}));
        } else {
          setOutput(getB(${s}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HJe(e){const{inputs:t,backend:n}=e,{condition:r,t:i,e:s}=t,o=new GJe(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(o,[r,i,s],Gs(i.dtype,s.dtype))}const XJe={kernelName:oS,backendName:"webgl",kernelFunc:HJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YJe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${i3};
  float scale = ${s3};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,KJe=Yt({opSnippet:YJe}),QJe={kernelName:Wx,backendName:"webgl",kernelFunc:KJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZJe=pb+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,JJe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,eet=Yt({opSnippet:ZJe,packedOpSnippet:JJe,cpuKernelImpl:Jqe}),tet={kernelName:Hx,backendName:"webgl",kernelFunc:eet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const net=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,ret=Yt({opSnippet:net}),iet={kernelName:Gx,backendName:"webgl",kernelFunc:ret};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const set=pb+`
  return sin(x);
`,oet=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Km}
  return result;
`,aet=Yt({opSnippet:set,packedOpSnippet:oet}),uet={kernelName:Vx,backendName:"webgl",kernelFunc:aet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cet=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,fet=Yt({opSnippet:cet}),det={kernelName:qx,backendName:"webgl",kernelFunc:fet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const het=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,pet=Yt({opSnippet:het}),get={kernelName:Xx,backendName:"webgl",kernelFunc:pet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const met=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:s,paddings:o}=r;U(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=s.reduce((b,v)=>b*v),u=[[0,0]];u.push(...o);for(let b=1+s.length;b<i.shape.length;++b)u.push([0,0]);const l=[],c=Wge({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),f=kS(c.shape,s,a,!1),d=ES(f.length,s.length,!1),h=AS(c.shape,s,a,!1),p=Ue({inputs:{x:c},backend:n,attrs:{shape:f}}),m=ks({inputs:{x:p},backend:n,attrs:{perm:d}}),x=Ue({inputs:{x:m},backend:n,attrs:{shape:h}});return l.push(c),l.push(p),l.push(m),l.forEach(b=>n.disposeIntermediateTensorInfo(b)),x},yet={kernelName:lS,backendName:"webgl",kernelFunc:met};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xet(e){const{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:s,defaultValue:o}=t;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(r.dataId),u=n.readSync(i.dataId),l=n.readSync(s.dataId),c=n.readSync(o.dataId)[0],[f,d,h,p,m]=tGe(a,r.shape,r.dtype,u,i.dtype,l,c);return[n.makeTensorInfo(d,r.dtype,f),n.makeTensorInfo([d[0]],i.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(x=>Number(x)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const bet={kernelName:cF,backendName:"webgl",kernelFunc:xet};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vet(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:s}=t;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(n.readSync(i.dataId)),a=n.readSync(r.dataId),u=Array.from(n.readSync(s.dataId)),[l,c,f]=nGe(a,r.shape,r.dtype,o,u);return[n.makeTensorInfo(c,r.dtype,l),n.makeTensorInfo([f.length],s.dtype,new Int32Array(f))]}const wet={kernelName:fF,backendName:"webgl",kernelFunc:vet};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $et(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);const o=n.readSync(r.dataId),a=n.readSync(i.dataId),u=n.readSync(s.dataId),[l,c]=pge(o,r.shape,r.dtype,a,u,!0);return n.makeTensorInfo(c,r.dtype,l)}const Cet={kernelName:dF,backendName:"webgl",kernelFunc:$et};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ket(e){const{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);const o=n.readSync(r.dataId),a=n.readSync(i.dataId),u=n.readSync(s.dataId),[l,c]=pge(o,r.shape,r.dtype,a,u);return n.makeTensorInfo(c,r.dtype,l)}const Eet={kernelName:hF,backendName:"webgl",kernelFunc:ket};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aet(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:s,defaultValue:o}=t,{outputShape:a}=r,{sliceRank:u,numUpdates:l,sliceSize:c,strides:f,outputSize:d}=np(s,i,a),h=!1;if(s.dtype==="string"){const b=n.bufferSync(i),v=n.bufferSync(s),$=Sf(n.readSync(o.dataId)[0]),C=Zqe(b,v,a,d,c,l,u,f,$,h);return n.makeTensorInfo(a,C.dtype,C.values)}const p=new oj(l,u,i.shape.length,s.shape.length,f,[d,1],h),m=n.runWebGLProgram(p,[s,i,o],s.dtype),x=Ue({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),x}const _et={kernelName:pF,backendName:"webgl",kernelFunc:Aet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tet(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:s,axis:o}=r,a=Ot(o,i.shape)[0],u=xU(i,s,a),l=i.shape.length,c=new Array(l).fill(0),f=i.shape.slice();return u.map(d=>{const h=[...f];h[a]=d;const p=gb({inputs:{x:i},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,p})}const Iet={kernelName:cS,backendName:"webgl",kernelFunc:Tet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DJ="return sqrt(x);",Net=Yt({opSnippet:DJ,packedOpSnippet:DJ,cpuKernelImpl:rGe}),Det={kernelName:Yx,backendName:"webgl",kernelFunc:Net};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fet="return x * x;",Ret=Yt({opSnippet:Fet}),Oet={kernelName:gF,backendName:"webgl",kernelFunc:Ret};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FJ="return (a - b) * (a - b);",Met=Ei({opSnippet:FJ,packedOpSnippet:FJ}),Let={kernelName:Kx,backendName:"webgl",kernelFunc:Met};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pet(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if(i.dtype!=="string")throw new Error("Input must be of datatype string");const s=n.readSync(i.dataId),o=_f(s),a=iGe(o,"string",r);return n.makeTensorInfo(i.shape,"string",a)}const Bet={kernelName:dS,backendName:"webgl",kernelFunc:Pet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zet({inputs:e,attrs:t,backend:n}){const{x:r}=e,i=Ka+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,s=new Al(r.shape,i);return n.runWebGLProgram(s,[r],r.dtype)}const Uet={kernelName:tb,backendName:"webgl",kernelFunc:zet};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jet{constructor(t,n,r){this.variableNames=["x"],this.outputShape=r;const i=r.length,s=Sn(r.length),o=Sn(r.length);let a="";if(i===1)a="coords * strides + begin";else{let u=0;a=r.map((l,c)=>(u++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${u-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${s} begin = ${s}(${t});
      ${s} strides = ${s}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wet(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:s,end:o,strides:a,beginMask:u,endMask:l,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:d}=r,{finalShapeSparse:h,finalShape:p,isIdentity:m,sliceDim0:x,isSimpleSlice:b,begin:v,end:$,strides:C}=J9(i.shape,s,o,a,u,l,c,f,d);let S;if(m)S=Ue({inputs:{x:i},backend:n,attrs:{shape:p}});else if(x||b){U(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const E=K9(v,$,C),_=gb({inputs:{x:i},backend:n,attrs:{begin:v,size:E}});S=Ue({inputs:{x:_},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(_)}else if(n.shouldExecuteOnCPU([i])){const _=n.readSync(i.dataId),D=Ft(i.shape,i.dtype,_),N=sGe(h,D,C,v);S=n.makeTensorInfo(p,i.dtype,N.values)}else{const _=new jet(v,C,h);S=n.runWebGLProgram(_,[i],i.dtype)}const A=Ue({inputs:{x:S},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(S),A}const Vet={kernelName:mF,backendName:"webgl",kernelFunc:Wet};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qet(e){const{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:s,leftPad:o,rightPad:a,padWidth:u,preserveShortSequences:l}=r,{data:c,dataSplits:f}=t,d=n.readSync(c.dataId),h=n.readSync(f.dataId),[p,m]=oGe(d,h,i,s,o,a,u,l);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",m)]}const Get={kernelName:yF,backendName:"webgl",kernelFunc:qet};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Het(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:s,delimiter:o}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(s.dataId),u=n.readSync(o.dataId)[0],[l,c,f]=aGe(a,u,i),d=c.length;return[n.makeTensorInfo([d,2],"int32",l),n.makeTensorInfo([d],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const Xet={kernelName:xF,backendName:"webgl",kernelFunc:Het};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yet(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:s}=t;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(s.dataId),a=uGe(o,i);return n.makeTensorInfo(s.shape,"int32",a)}const Ket={kernelName:bF,backendName:"webgl",kernelFunc:Yet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qet="return tan(x);",Zet=Yt({opSnippet:Qet}),Jet={kernelName:Zx,backendName:"webgl",kernelFunc:Zet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ett=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,ttt=Yt({opSnippet:ett}),ntt={kernelName:Jx,backendName:"webgl",kernelFunc:ttt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rtt(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:s,updates:o}=t,{sliceRank:a,numUpdates:u,sliceSize:l,strides:c,outputSize:f}=np(o,s,i.shape),d=[f/l,l];if(f===0)return n.makeTensorInfo(i.shape,s.dtype);const h=Ue({inputs:{x:s},backend:n,attrs:{shape:[u,a]}}),p=Ue({inputs:{x:o},backend:n,attrs:{shape:[u,l]}}),m=Ue({inputs:{x:i},backend:n,attrs:{shape:d}}),x=new oj(u,a,h.shape.length,p.shape.length,c,d,!1,!0),b=n.runWebGLProgram(x,[p,h,m],m.dtype),v=Ue({inputs:{x:b},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),v}const itt={kernelName:uF,backendName:"webgl",kernelFunc:rtt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class stt{constructor(t,n){this.variableNames=["A"];const r=new Array(t.length);for(let o=0;o<r.length;o++)r[o]=t[o]*n[o];this.outputShape=r,this.rank=r.length;const i=Sn(this.rank),s=ott(t);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        setOutput(getA(${s}));
      }
    `}}function ott(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<e.length;i++)r.push(`imod(${n[i]}, ${e[i]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qge(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:s}=r;if(i.dtype==="string"||i.shape.length>5){const u=n.readSync(i.dataId),l=i.dtype==="string"?u.map(d=>Sf(d)):u,c=Ft(i.shape,i.dtype,l),f=cGe(c,s);return n.makeTensorInfo(f.shape,f.dtype,f.values)}const o=new stt(i.shape,s);return n.runWebGLProgram(o,[i],i.dtype)}const att={kernelName:eb,backendName:"webgl",kernelFunc:qge};class utt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class ltt{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gp(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function RJ(e){let t=1;for(;t<e;)t*=2;return t}function ctt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:s,sorted:o}=r,a=ce().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=ce().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=i.shape,c=l[l.length-1];if(n.shouldExecuteOnCPU([i])||c<a||s>u){const N=n.readSync(i.dataId),[T,L]=fGe(N,l,i.dtype,s,o);return[n.makeTensorInfo(T.shape,T.dtype,T.values),n.makeTensorInfo(L.shape,L.dtype,L.values)]}if(s===0)return l[l.length-1]=0,[n.makeTensorInfo(l,i.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(c===1)return[i,US({attrs:{shape:l,dtype:"int32",value:0},backend:n})];const f=n.texData.get(i.dataId),d=f!==null&&f.isPacked,h=d?n.unpackTensor(i):i,m=me(l)/c,x=Ue({inputs:{x:h},attrs:{shape:[m,c]},backend:n});d&&Gp(n,h);const b=RJ(s),v=RJ(c);let $=null;const C=()=>$===null?[x,x]:[x,$],S=(N,T,L)=>{const O=C(),M=new utt(L),P=[[c],[$===null?1:0],[Number.NEGATIVE_INFINITY],[N],[T]],j=$;$=n.runWebGLProgram(M,O,"int32",P),Gp(n,j)};for(let N=1;N<b;N*=2){const T=N*2;for(let L=N;L>=1;L/=2)S(T,L,[m,v])}for(let N=v;N>b;N/=2){const T=C(),L=new ltt([m,N/2]),M=[[c],[$===null?1:0],[b]],R=$;$=n.runWebGLProgram(L,T,"int32",M),Gp(n,R);const P=b/2,j=P*2;for(let z=P;z>=1;z/=2)S(j,z,$.shape)}let A=$;$=gb({inputs:{x:$},backend:n,attrs:{begin:0,size:[m,s]}}),Gp(n,A);let E=Lge({inputs:{x,indices:$},backend:n,attrs:{axis:1,batchDims:1}});Gp(n,x);const _=l.slice(0,-1);_.push(s),A=$,$=Ue({inputs:{x:$},attrs:{shape:_},backend:n}),Gp(n,A);const D=E;return E=Ue({inputs:{x:E},attrs:{shape:_},backend:n}),Gp(n,D),[E,$]}const ftt={kernelName:vF,backendName:"webgl",kernelFunc:ctt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dtt{constructor(t,n,r,i,s,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=r==="nearest"?1:2;let u;switch(i){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${u} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${s});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${s});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${t}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function htt(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:s}=t,{interpolation:o,fillMode:a,fillValue:u,outputShape:l}=r,[c,f,d,h]=i.shape,[p,m]=l??[f,d],x=[c,p,m,h],b=new dtt(f,d,o,a,u,x);return n.runWebGLProgram(b,[i,s],"float32")}const ptt={kernelName:wF,backendName:"webgl",kernelFunc:htt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gtt(e){const{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:s}=t;PS(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(s.dataId),{outputValues:a,outputShape:u,indices:l}=dGe(o,i,s.shape,s.dtype);return[r.makeTensorInfo(u,s.dtype,a),r.makeTensorInfo([l.length],"int32",l)]}const mtt={kernelName:$F,backendName:"webgl",kernelFunc:gtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ytt(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i,a=o.shape.length,u=i.shape[s],l=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==s&&(l[c++]=o.shape[m]);const f=[],d=new Array(a).fill(0),h=o.shape.slice();h[s]=1;const p=new Array(u);for(let m=0;m<p.length;m++){d[s]=m;const x=gb({inputs:{x:o},backend:n,attrs:{begin:d,size:h}}),b=Ue({inputs:{x},backend:n,attrs:{shape:l}});p[m]=b,f.push(x)}return f.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const xtt={kernelName:hS,backendName:"webgl",kernelFunc:ytt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class btt{constructor(t,n){this.variableNames=["x","segmentIds"];const r=t.windowSize,i=t.batchSize,s=t.inSize,o=t.numSegments,a=o*Math.ceil(s/r);this.outputShape=[i,a];const u="0.0",l="sumValue",c=Math.floor(r/4)*4,f=r%4,d=`
        sumValue += dot(values, segFilter);
    `;let h="";s%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `);let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${u};

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${l});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vtt(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:s}=t,{numSegments:o}=r,a=i.shape.length,u=[];let l=0;const c=nr([l],a);let f=i;c!=null&&(f=ks({inputs:{x:i},backend:n,attrs:{perm:c}}),u.push(f),l=yr(1,a)[0]);const d=bfe(f.shape,l,o),h=me([f.shape[l]]),p=Ue({inputs:{x:f},backend:n,attrs:{shape:[-1,h]}});u.push(p);const m=kF(i.dtype),x=(C,S,A,E,_)=>{const D=C.shape[0],N=C.shape[1],T=xfe(N,_),L={windowSize:T,inSize:N,batchSize:D,numSegments:_},O=new btt(L,S),M=n.compileAndRun(O,[C,A],E);if(u.push(M),M.shape[1]===_)return M;const R=Vge({backend:n,attrs:{start:0,stop:_,step:1,dtype:"float32"}}),P=qge({inputs:{x:R},backend:n,attrs:{reps:[N/T]}});return u.push(R),u.push(P),x(M,S,P,E,_)},b=x(p,"unsortedSegmentSum",s,m,o),v=Ue({inputs:{x:b},backend:n,attrs:{shape:d}});let $=v;if(c!=null){u.push(v);const C=Jh(c);$=ks({inputs:{x:$},backend:n,attrs:{perm:C}})}return u.forEach(C=>n.disposeIntermediateTensorInfo(C)),$}const wtt={kernelName:pS,backendName:"webgl",kernelFunc:vtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $tt=[rHe,sHe,uHe,fHe,hHe,mHe,xHe,vHe,SHe,EHe,THe,DHe,OHe,BHe,jHe,VHe,GHe,KHe,ZHe,eXe,iXe,fXe,hXe,yXe,bXe,kXe,AXe,NXe,zGe,RXe,BXe,WXe,YXe,ZXe,eYe,nYe,iYe,uYe,fYe,pYe,mYe,xYe,vYe,CYe,kYe,TYe,NYe,RYe,LYe,BYe,WYe,HYe,QYe,eKe,rKe,iKe,oKe,uKe,cKe,dKe,pKe,xKe,wKe,SKe,EKe,TKe,DKe,MKe,zKe,BGe,jKe,LXe,qKe,XKe,QKe,jGe,tQe,sQe,aQe,fQe,pQe,xQe,wQe,kQe,TQe,DQe,RQe,PQe,zQe,jQe,GQe,XQe,KQe,ZQe,eZe,iZe,uZe,dZe,vZe,qGe,SZe,AZe,IZe,FZe,wXe,MZe,PZe,zZe,WZe,HZe,VGe,YZe,QZe,JZe,tJe,nJe,$Xe,mZe,sJe,lJe,hJe,HGe,yJe,vJe,SJe,AJe,NJe,FJe,MJe,BJe,jJe,qJe,XJe,QJe,tet,iet,uet,det,lXe,xZe,get,yet,bet,wet,Cet,Eet,_et,Iet,Det,Oet,Let,Bet,Uet,Vet,Get,Xet,Ket,yZe,eHe,Jet,ntt,itt,att,ftt,ptt,tHe,mtt,xtt,wtt,LZe];for(const e of $tt)SF(e);var YL={};const Gge=Lm(TLe);var a1={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var Ctt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Stt=Object.prototype.hasOwnProperty;function j6(e,t){return Stt.call(e,t)}function W6(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var i in e)j6(e,i)&&r.push(i);return r}function ea(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function V6(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function cg(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Hge(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function q6(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(q6(e[t]))return!0}else if(typeof e=="object"){for(var r=W6(e),i=r.length,s=0;s<i;s++)if(q6(e[r[s]]))return!0}}return!1}function OJ(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var Xge=function(e){Ctt(t,e);function t(n,r,i,s,o){var a=this.constructor,u=e.call(this,OJ(n,{name:r,index:i,operation:s,tree:o}))||this;return u.name=r,u.index=i,u.operation=s,u.tree=o,Object.setPrototypeOf(u,a.prototype),u.message=OJ(n,{name:r,index:i,operation:s,tree:o}),u}return t}(Error),dr=Xge,ktt=ea,R1={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=dI(n,this.path);r&&(r=ea(r));var i=Bg(n,{op:"remove",path:this.from}).removed;return Bg(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=dI(n,this.from);return Bg(n,{op:"add",path:this.path,value:ea(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:n$(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},Ett={add:function(e,t,n){return V6(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:R1.move,copy:R1.copy,test:R1.test,_get:R1._get};function dI(e,t){if(t=="")return e;var n={op:"_get",path:t};return Bg(e,n),n.value}function Bg(e,t,n,r,i,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):hI(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=dI(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=n$(e,t.value),o.test===!1)throw new dr("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new dr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}}else{r||(e=ea(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=hI;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=Hge(h)),i&&(h=="__proto__"||h=="prototype"&&c>0&&u[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!V6(h))throw new dr("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);V6(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new dr("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var o=Ett[t.op].call(t,l,h,e);if(o.test===!1)throw new dr("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=f){var o=R1[t.op].call(t,l,h,e);if(o.test===!1)throw new dr("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new dr("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function E3(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new dr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=ea(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=Bg(e,t[o],n,!0,i,o),e=s[o].newDocument;return s.newDocument=e,s}function Att(e,t,n){var r=Bg(e,t);if(r.test===!1)throw new dr("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function hI(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new dr("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(R1[e.op]){if(typeof e.path!="string")throw new dr("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new dr('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new dr("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new dr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&q6(e.value))throw new dr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new dr("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new dr("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},a=Yge([o],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new dr("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new dr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function Yge(e,t,n){try{if(!Array.isArray(e))throw new dr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)E3(ea(t),ea(e),n||!0);else{n=n||hI;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof dr)return i;throw i}}function n$(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,s,o;if(n&&r){if(s=e.length,s!=t.length)return!1;for(i=s;i--!==0;)if(!n$(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var a=Object.keys(e);if(s=a.length,s!==Object.keys(t).length)return!1;for(i=s;i--!==0;)if(!t.hasOwnProperty(a[i]))return!1;for(i=s;i--!==0;)if(o=a[i],!n$(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}const _tt=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:dr,_areEquals:n$,applyOperation:Bg,applyPatch:E3,applyReducer:Att,deepClone:ktt,getValueByPointer:dI,validate:Yge,validator:hI},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var aj=new WeakMap,Ttt=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),Itt=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function Ntt(e){return aj.get(e)}function Dtt(e,t){return e.observers.get(t)}function Ftt(e,t){e.observers.delete(t.callback)}function Rtt(e,t){t.unobserve()}function Ott(e,t){var n=[],r,i=Ntt(e);if(!i)i=new Ttt(e),aj.set(e,i);else{var s=Dtt(i,t);r=s&&s.observer}if(r)return r;if(r={},i.value=ea(e),t){r.callback=t,r.next=null;var o=function(){G6(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=n,r.object=e,r.unobserve=function(){G6(r),clearTimeout(r.next),Ftt(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},i.observers.set(t,new Itt(t,r)),r}function G6(e,t){t===void 0&&(t=!1);var n=aj.get(e.object);uj(n.value,e.object,e.patches,"",t),e.patches.length&&E3(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function uj(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=W6(t),o=W6(e),a=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(j6(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?uj(c,f,n,r+"/"+cg(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+cg(l),value:ea(c)}),n.push({op:"replace",path:r+"/"+cg(l),value:ea(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+cg(l),value:ea(c)}),n.push({op:"remove",path:r+"/"+cg(l)}),a=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!a&&s.length==o.length))for(var u=0;u<s.length;u++){var l=s[u];!j6(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+cg(l),value:ea(t[l])})}}}function Mtt(e,t,n){n===void 0&&(n=!1);var r=[];return uj(e,t,r,"",n),r}const Ltt=Object.freeze(Object.defineProperty({__proto__:null,compare:Mtt,generate:G6,observe:Ott,unobserve:Rtt},Symbol.toStringTag,{value:"Module"}));Object.assign({},_tt,Ltt,{JsonPatchError:Xge,deepClone:ea,escapePathComponent:cg,unescapePathComponent:Hge});var KL,MJ;function Ptt(){if(MJ)return KL;MJ=1;var e=/("(?:[^\\"]|\\.)*")|[:,]/g;return KL=function(n,r){var i,s,o;return r=r||{},i=JSON.stringify([1],void 0,r.indent===void 0?2:r.indent).slice(2,-3),s=i===""?1/0:r.maxLength===void 0?80:r.maxLength,o=r.replacer,function a(u,l,c){var f,d,h,p,m,x,b,v,$,C,S,A;if(u&&typeof u.toJSON=="function"&&(u=u.toJSON()),S=JSON.stringify(u,o),S===void 0)return S;if(b=s-l.length-c,S.length<=b&&($=S.replace(e,function(E,_){return _||E+" "}),$.length<=b))return $;if(o!=null&&(u=JSON.parse(S),o=void 0),typeof u=="object"&&u!==null){if(v=l+i,h=[],d=0,Array.isArray(u))for(C="[",f="]",b=u.length;d<b;d++)h.push(a(u[d],v,d===b-1?0:1)||"null");else for(C="{",f="}",x=Object.keys(u),b=x.length;d<b;d++)p=x[d],m=JSON.stringify(p)+": ",A=a(u[p],v,m.length+(d===b-1?0:1)),A!==void 0&&h.push(m+A);if(h.length>0)return[C,i+h.join(`,
`+v),f].join(`
`+l)}return S}(n,"",0)},KL}var Btt=Ptt();const QL=ox(Btt);var kA={exports:{}},ZL,LJ;function A3(){if(LJ)return ZL;LJ=1;const e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,i=t-6;return ZL={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},ZL}var JL,PJ;function _3(){if(PJ)return JL;PJ=1;var e={};return JL=typeof process=="object"&&e&&e.NODE_DEBUG&&/\bsemver\b/i.test(e.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{},JL}var BJ;function jS(){return BJ||(BJ=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=A3(),s=_3();t=e.exports={};const o=t.re=[],a=t.safeRe=[],u=t.src=[],l=t.t={};let c=0;const f="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",i],[f,r]],h=m=>{for(const[x,b]of d)m=m.split(`${x}*`).join(`${x}{0,${b}}`).split(`${x}+`).join(`${x}{1,${b}}`);return m},p=(m,x,b)=>{const v=h(x),$=c++;s(m,$,x),l[m]=$,u[$]=x,o[$]=new RegExp(x,b?"g":void 0),a[$]=new RegExp(v,b?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),p("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${f}+`),p("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),p("FULL",`^${u[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),p("LOOSE",`^${u[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),p("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),p("COERCE",`${u[l.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",u[l.COERCEPLAIN]+`(?:${u[l.PRERELEASE]})?(?:${u[l.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",u[l.COERCE],!0),p("COERCERTLFULL",u[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(kA,kA.exports)),kA.exports}var eP,zJ;function lj(){if(zJ)return eP;zJ=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return eP=r=>r?typeof r!="object"?e:r:t,eP}var tP,UJ;function Kge(){if(UJ)return tP;UJ=1;const e=/^[0-9]+$/,t=(r,i)=>{const s=e.test(r),o=e.test(i);return s&&o&&(r=+r,i=+i),r===i?0:s&&!o?-1:o&&!s?1:r<i?-1:1};return tP={compareIdentifiers:t,rcompareIdentifiers:(r,i)=>t(i,r)},tP}var nP,jJ;function eo(){if(jJ)return nP;jJ=1;const e=_3(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=A3(),{safeRe:r,t:i}=jS(),s=lj(),{compareIdentifiers:o}=Kge();class a{constructor(l,c){if(c=s(c),l instanceof a){if(l.loose===!!c.loose&&l.includePrerelease===!!c.includePrerelease)return l;l=l.version}else if(typeof l!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof l}".`);if(l.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",l,c),this.options=c,this.loose=!!c.loose,this.includePrerelease=!!c.includePrerelease;const f=l.trim().match(c.loose?r[i.LOOSE]:r[i.FULL]);if(!f)throw new TypeError(`Invalid Version: ${l}`);if(this.raw=l,this.major=+f[1],this.minor=+f[2],this.patch=+f[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");f[4]?this.prerelease=f[4].split(".").map(d=>{if(/^[0-9]+$/.test(d)){const h=+d;if(h>=0&&h<n)return h}return d}):this.prerelease=[],this.build=f[5]?f[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(l){if(e("SemVer.compare",this.version,this.options,l),!(l instanceof a)){if(typeof l=="string"&&l===this.version)return 0;l=new a(l,this.options)}return l.version===this.version?0:this.compareMain(l)||this.comparePre(l)}compareMain(l){return l instanceof a||(l=new a(l,this.options)),o(this.major,l.major)||o(this.minor,l.minor)||o(this.patch,l.patch)}comparePre(l){if(l instanceof a||(l=new a(l,this.options)),this.prerelease.length&&!l.prerelease.length)return-1;if(!this.prerelease.length&&l.prerelease.length)return 1;if(!this.prerelease.length&&!l.prerelease.length)return 0;let c=0;do{const f=this.prerelease[c],d=l.prerelease[c];if(e("prerelease compare",c,f,d),f===void 0&&d===void 0)return 0;if(d===void 0)return 1;if(f===void 0)return-1;if(f===d)continue;return o(f,d)}while(++c)}compareBuild(l){l instanceof a||(l=new a(l,this.options));let c=0;do{const f=this.build[c],d=l.build[c];if(e("build compare",c,f,d),f===void 0&&d===void 0)return 0;if(d===void 0)return 1;if(f===void 0)return-1;if(f===d)continue;return o(f,d)}while(++c)}inc(l,c,f){switch(l){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",c,f);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",c,f);break;case"prepatch":this.prerelease.length=0,this.inc("patch",c,f),this.inc("pre",c,f);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",c,f),this.inc("pre",c,f);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const d=Number(f)?1:0;if(!c&&f===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[d];else{let h=this.prerelease.length;for(;--h>=0;)typeof this.prerelease[h]=="number"&&(this.prerelease[h]++,h=-2);if(h===-1){if(c===this.prerelease.join(".")&&f===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(d)}}if(c){let h=[c,d];f===!1&&(h=[c]),o(this.prerelease[0],c)===0?isNaN(this.prerelease[1])&&(this.prerelease=h):this.prerelease=h}break}default:throw new Error(`invalid increment argument: ${l}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return nP=a,nP}var rP,WJ;function mb(){if(WJ)return rP;WJ=1;const e=eo();return rP=(n,r,i=!1)=>{if(n instanceof e)return n;try{return new e(n,r)}catch(s){if(!i)return null;throw s}},rP}var iP,VJ;function ztt(){if(VJ)return iP;VJ=1;const e=mb();return iP=(n,r)=>{const i=e(n,r);return i?i.version:null},iP}var sP,qJ;function Utt(){if(qJ)return sP;qJ=1;const e=mb();return sP=(n,r)=>{const i=e(n.trim().replace(/^[=v]+/,""),r);return i?i.version:null},sP}var oP,GJ;function jtt(){if(GJ)return oP;GJ=1;const e=eo();return oP=(n,r,i,s,o)=>{typeof i=="string"&&(o=s,s=i,i=void 0);try{return new e(n instanceof e?n.version:n,i).inc(r,s,o).version}catch{return null}},oP}var aP,HJ;function Wtt(){if(HJ)return aP;HJ=1;const e=mb();return aP=(n,r)=>{const i=e(n,null,!0),s=e(r,null,!0),o=i.compare(s);if(o===0)return null;const a=o>0,u=a?i:s,l=a?s:i,c=!!u.prerelease.length;if(!!l.prerelease.length&&!c)return!l.patch&&!l.minor?"major":u.patch?"patch":u.minor?"minor":"major";const d=c?"pre":"";return i.major!==s.major?d+"major":i.minor!==s.minor?d+"minor":i.patch!==s.patch?d+"patch":"prerelease"},aP}var uP,XJ;function Vtt(){if(XJ)return uP;XJ=1;const e=eo();return uP=(n,r)=>new e(n,r).major,uP}var lP,YJ;function qtt(){if(YJ)return lP;YJ=1;const e=eo();return lP=(n,r)=>new e(n,r).minor,lP}var cP,KJ;function Gtt(){if(KJ)return cP;KJ=1;const e=eo();return cP=(n,r)=>new e(n,r).patch,cP}var fP,QJ;function Htt(){if(QJ)return fP;QJ=1;const e=mb();return fP=(n,r)=>{const i=e(n,r);return i&&i.prerelease.length?i.prerelease:null},fP}var dP,ZJ;function Gu(){if(ZJ)return dP;ZJ=1;const e=eo();return dP=(n,r,i)=>new e(n,i).compare(new e(r,i)),dP}var hP,JJ;function Xtt(){if(JJ)return hP;JJ=1;const e=Gu();return hP=(n,r,i)=>e(r,n,i),hP}var pP,eee;function Ytt(){if(eee)return pP;eee=1;const e=Gu();return pP=(n,r)=>e(n,r,!0),pP}var gP,tee;function cj(){if(tee)return gP;tee=1;const e=eo();return gP=(n,r,i)=>{const s=new e(n,i),o=new e(r,i);return s.compare(o)||s.compareBuild(o)},gP}var mP,nee;function Ktt(){if(nee)return mP;nee=1;const e=cj();return mP=(n,r)=>n.sort((i,s)=>e(i,s,r)),mP}var yP,ree;function Qtt(){if(ree)return yP;ree=1;const e=cj();return yP=(n,r)=>n.sort((i,s)=>e(s,i,r)),yP}var xP,iee;function T3(){if(iee)return xP;iee=1;const e=Gu();return xP=(n,r,i)=>e(n,r,i)>0,xP}var bP,see;function fj(){if(see)return bP;see=1;const e=Gu();return bP=(n,r,i)=>e(n,r,i)<0,bP}var vP,oee;function Qge(){if(oee)return vP;oee=1;const e=Gu();return vP=(n,r,i)=>e(n,r,i)===0,vP}var wP,aee;function Zge(){if(aee)return wP;aee=1;const e=Gu();return wP=(n,r,i)=>e(n,r,i)!==0,wP}var $P,uee;function dj(){if(uee)return $P;uee=1;const e=Gu();return $P=(n,r,i)=>e(n,r,i)>=0,$P}var CP,lee;function hj(){if(lee)return CP;lee=1;const e=Gu();return CP=(n,r,i)=>e(n,r,i)<=0,CP}var SP,cee;function Jge(){if(cee)return SP;cee=1;const e=Qge(),t=Zge(),n=T3(),r=dj(),i=fj(),s=hj();return SP=(a,u,l,c)=>{switch(u){case"===":return typeof a=="object"&&(a=a.version),typeof l=="object"&&(l=l.version),a===l;case"!==":return typeof a=="object"&&(a=a.version),typeof l=="object"&&(l=l.version),a!==l;case"":case"=":case"==":return e(a,l,c);case"!=":return t(a,l,c);case">":return n(a,l,c);case">=":return r(a,l,c);case"<":return i(a,l,c);case"<=":return s(a,l,c);default:throw new TypeError(`Invalid operator: ${u}`)}},SP}var kP,fee;function Ztt(){if(fee)return kP;fee=1;const e=eo(),t=mb(),{safeRe:n,t:r}=jS();return kP=(s,o)=>{if(s instanceof e)return s;if(typeof s=="number"&&(s=String(s)),typeof s!="string")return null;o=o||{};let a=null;if(!o.rtl)a=s.match(o.includePrerelease?n[r.COERCEFULL]:n[r.COERCE]);else{const h=o.includePrerelease?n[r.COERCERTLFULL]:n[r.COERCERTL];let p;for(;(p=h.exec(s))&&(!a||a.index+a[0].length!==s.length);)(!a||p.index+p[0].length!==a.index+a[0].length)&&(a=p),h.lastIndex=p.index+p[1].length+p[2].length;h.lastIndex=-1}if(a===null)return null;const u=a[2],l=a[3]||"0",c=a[4]||"0",f=o.includePrerelease&&a[5]?`-${a[5]}`:"",d=o.includePrerelease&&a[6]?`+${a[6]}`:"";return t(`${u}.${l}.${c}${f}${d}`,o)},kP}var EP,dee;function Jtt(){if(dee)return EP;dee=1;class e{constructor(){this.max=1e3,this.map=new Map}get(n){const r=this.map.get(n);if(r!==void 0)return this.map.delete(n),this.map.set(n,r),r}delete(n){return this.map.delete(n)}set(n,r){if(!this.delete(n)&&r!==void 0){if(this.map.size>=this.max){const s=this.map.keys().next().value;this.delete(s)}this.map.set(n,r)}return this}}return EP=e,EP}var AP,hee;function Hu(){if(hee)return AP;hee=1;const e=/\s+/g;class t{constructor(R,P){if(P=i(P),R instanceof t)return R.loose===!!P.loose&&R.includePrerelease===!!P.includePrerelease?R:new t(R.raw,P);if(R instanceof s)return this.raw=R.value,this.set=[[R]],this.formatted=void 0,this;if(this.options=P,this.loose=!!P.loose,this.includePrerelease=!!P.includePrerelease,this.raw=R.trim().replace(e," "),this.set=this.raw.split("||").map(j=>this.parseRange(j.trim())).filter(j=>j.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const j=this.set[0];if(this.set=this.set.filter(z=>!m(z[0])),this.set.length===0)this.set=[j];else if(this.set.length>1){for(const z of this.set)if(z.length===1&&x(z[0])){this.set=[z];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let R=0;R<this.set.length;R++){R>0&&(this.formatted+="||");const P=this.set[R];for(let j=0;j<P.length;j++)j>0&&(this.formatted+=" "),this.formatted+=P[j].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(R){const j=((this.options.includePrerelease&&h)|(this.options.loose&&p))+":"+R,z=r.get(j);if(z)return z;const q=this.options.loose,H=q?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];R=R.replace(H,L(this.options.includePrerelease)),o("hyphen replace",R),R=R.replace(u[l.COMPARATORTRIM],c),o("comparator trim",R),R=R.replace(u[l.TILDETRIM],f),o("tilde trim",R),R=R.replace(u[l.CARETTRIM],d),o("caret trim",R);let V=R.split(" ").map(ue=>v(ue,this.options)).join(" ").split(/\s+/).map(ue=>T(ue,this.options));q&&(V=V.filter(ue=>(o("loose invalid filter",ue,this.options),!!ue.match(u[l.COMPARATORLOOSE])))),o("range list",V);const X=new Map,re=V.map(ue=>new s(ue,this.options));for(const ue of re){if(m(ue))return[ue];X.set(ue.value,ue)}X.size>1&&X.has("")&&X.delete("");const le=[...X.values()];return r.set(j,le),le}intersects(R,P){if(!(R instanceof t))throw new TypeError("a Range is required");return this.set.some(j=>b(j,P)&&R.set.some(z=>b(z,P)&&j.every(q=>z.every(H=>q.intersects(H,P)))))}test(R){if(!R)return!1;if(typeof R=="string")try{R=new a(R,this.options)}catch{return!1}for(let P=0;P<this.set.length;P++)if(O(this.set[P],R,this.options))return!0;return!1}}AP=t;const n=Jtt(),r=new n,i=lj(),s=I3(),o=_3(),a=eo(),{safeRe:u,t:l,comparatorTrimReplace:c,tildeTrimReplace:f,caretTrimReplace:d}=jS(),{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:p}=A3(),m=M=>M.value==="<0.0.0-0",x=M=>M.value==="",b=(M,R)=>{let P=!0;const j=M.slice();let z=j.pop();for(;P&&j.length;)P=j.every(q=>z.intersects(q,R)),z=j.pop();return P},v=(M,R)=>(o("comp",M,R),M=A(M,R),o("caret",M),M=C(M,R),o("tildes",M),M=_(M,R),o("xrange",M),M=N(M,R),o("stars",M),M),$=M=>!M||M.toLowerCase()==="x"||M==="*",C=(M,R)=>M.trim().split(/\s+/).map(P=>S(P,R)).join(" "),S=(M,R)=>{const P=R.loose?u[l.TILDELOOSE]:u[l.TILDE];return M.replace(P,(j,z,q,H,V)=>{o("tilde",M,j,z,q,H,V);let X;return $(z)?X="":$(q)?X=`>=${z}.0.0 <${+z+1}.0.0-0`:$(H)?X=`>=${z}.${q}.0 <${z}.${+q+1}.0-0`:V?(o("replaceTilde pr",V),X=`>=${z}.${q}.${H}-${V} <${z}.${+q+1}.0-0`):X=`>=${z}.${q}.${H} <${z}.${+q+1}.0-0`,o("tilde return",X),X})},A=(M,R)=>M.trim().split(/\s+/).map(P=>E(P,R)).join(" "),E=(M,R)=>{o("caret",M,R);const P=R.loose?u[l.CARETLOOSE]:u[l.CARET],j=R.includePrerelease?"-0":"";return M.replace(P,(z,q,H,V,X)=>{o("caret",M,z,q,H,V,X);let re;return $(q)?re="":$(H)?re=`>=${q}.0.0${j} <${+q+1}.0.0-0`:$(V)?q==="0"?re=`>=${q}.${H}.0${j} <${q}.${+H+1}.0-0`:re=`>=${q}.${H}.0${j} <${+q+1}.0.0-0`:X?(o("replaceCaret pr",X),q==="0"?H==="0"?re=`>=${q}.${H}.${V}-${X} <${q}.${H}.${+V+1}-0`:re=`>=${q}.${H}.${V}-${X} <${q}.${+H+1}.0-0`:re=`>=${q}.${H}.${V}-${X} <${+q+1}.0.0-0`):(o("no pr"),q==="0"?H==="0"?re=`>=${q}.${H}.${V}${j} <${q}.${H}.${+V+1}-0`:re=`>=${q}.${H}.${V}${j} <${q}.${+H+1}.0-0`:re=`>=${q}.${H}.${V} <${+q+1}.0.0-0`),o("caret return",re),re})},_=(M,R)=>(o("replaceXRanges",M,R),M.split(/\s+/).map(P=>D(P,R)).join(" ")),D=(M,R)=>{M=M.trim();const P=R.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return M.replace(P,(j,z,q,H,V,X)=>{o("xRange",M,j,z,q,H,V,X);const re=$(q),le=re||$(H),ue=le||$(V),be=ue;return z==="="&&be&&(z=""),X=R.includePrerelease?"-0":"",re?z===">"||z==="<"?j="<0.0.0-0":j="*":z&&be?(le&&(H=0),V=0,z===">"?(z=">=",le?(q=+q+1,H=0,V=0):(H=+H+1,V=0)):z==="<="&&(z="<",le?q=+q+1:H=+H+1),z==="<"&&(X="-0"),j=`${z+q}.${H}.${V}${X}`):le?j=`>=${q}.0.0${X} <${+q+1}.0.0-0`:ue&&(j=`>=${q}.${H}.0${X} <${q}.${+H+1}.0-0`),o("xRange return",j),j})},N=(M,R)=>(o("replaceStars",M,R),M.trim().replace(u[l.STAR],"")),T=(M,R)=>(o("replaceGTE0",M,R),M.trim().replace(u[R.includePrerelease?l.GTE0PRE:l.GTE0],"")),L=M=>(R,P,j,z,q,H,V,X,re,le,ue,be)=>($(j)?P="":$(z)?P=`>=${j}.0.0${M?"-0":""}`:$(q)?P=`>=${j}.${z}.0${M?"-0":""}`:H?P=`>=${P}`:P=`>=${P}${M?"-0":""}`,$(re)?X="":$(le)?X=`<${+re+1}.0.0-0`:$(ue)?X=`<${re}.${+le+1}.0-0`:be?X=`<=${re}.${le}.${ue}-${be}`:M?X=`<${re}.${le}.${+ue+1}-0`:X=`<=${X}`,`${P} ${X}`.trim()),O=(M,R,P)=>{for(let j=0;j<M.length;j++)if(!M[j].test(R))return!1;if(R.prerelease.length&&!P.includePrerelease){for(let j=0;j<M.length;j++)if(o(M[j].semver),M[j].semver!==s.ANY&&M[j].semver.prerelease.length>0){const z=M[j].semver;if(z.major===R.major&&z.minor===R.minor&&z.patch===R.patch)return!0}return!1}return!0};return AP}var _P,pee;function I3(){if(pee)return _P;pee=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),o("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(c){const f=this.options.loose?r[i.COMPARATORLOOSE]:r[i.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new a(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(o("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}return s(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||s(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||s(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}_P=t;const n=lj(),{safeRe:r,t:i}=jS(),s=Jge(),o=_3(),a=eo(),u=Hu();return _P}var TP,gee;function N3(){if(gee)return TP;gee=1;const e=Hu();return TP=(n,r,i)=>{try{r=new e(r,i)}catch{return!1}return r.test(n)},TP}var IP,mee;function ent(){if(mee)return IP;mee=1;const e=Hu();return IP=(n,r)=>new e(n,r).set.map(i=>i.map(s=>s.value).join(" ").trim().split(" ")),IP}var NP,yee;function tnt(){if(yee)return NP;yee=1;const e=eo(),t=Hu();return NP=(r,i,s)=>{let o=null,a=null,u=null;try{u=new t(i,s)}catch{return null}return r.forEach(l=>{u.test(l)&&(!o||a.compare(l)===-1)&&(o=l,a=new e(o,s))}),o},NP}var DP,xee;function nnt(){if(xee)return DP;xee=1;const e=eo(),t=Hu();return DP=(r,i,s)=>{let o=null,a=null,u=null;try{u=new t(i,s)}catch{return null}return r.forEach(l=>{u.test(l)&&(!o||a.compare(l)===1)&&(o=l,a=new e(o,s))}),o},DP}var FP,bee;function rnt(){if(bee)return FP;bee=1;const e=eo(),t=Hu(),n=T3();return FP=(i,s)=>{i=new t(i,s);let o=new e("0.0.0");if(i.test(o)||(o=new e("0.0.0-0"),i.test(o)))return o;o=null;for(let a=0;a<i.set.length;++a){const u=i.set[a];let l=null;u.forEach(c=>{const f=new e(c.semver.version);switch(c.operator){case">":f.prerelease.length===0?f.patch++:f.prerelease.push(0),f.raw=f.format();case"":case">=":(!l||n(f,l))&&(l=f);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${c.operator}`)}}),l&&(!o||n(o,l))&&(o=l)}return o&&i.test(o)?o:null},FP}var RP,vee;function int(){if(vee)return RP;vee=1;const e=Hu();return RP=(n,r)=>{try{return new e(n,r).range||"*"}catch{return null}},RP}var OP,wee;function pj(){if(wee)return OP;wee=1;const e=eo(),t=I3(),{ANY:n}=t,r=Hu(),i=N3(),s=T3(),o=fj(),a=hj(),u=dj();return OP=(c,f,d,h)=>{c=new e(c,h),f=new r(f,h);let p,m,x,b,v;switch(d){case">":p=s,m=a,x=o,b=">",v=">=";break;case"<":p=o,m=u,x=s,b="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(i(c,f,h))return!1;for(let $=0;$<f.set.length;++$){const C=f.set[$];let S=null,A=null;if(C.forEach(E=>{E.semver===n&&(E=new t(">=0.0.0")),S=S||E,A=A||E,p(E.semver,S.semver,h)?S=E:x(E.semver,A.semver,h)&&(A=E)}),S.operator===b||S.operator===v||(!A.operator||A.operator===b)&&m(c,A.semver))return!1;if(A.operator===v&&x(c,A.semver))return!1}return!0},OP}var MP,$ee;function snt(){if($ee)return MP;$ee=1;const e=pj();return MP=(n,r,i)=>e(n,r,">",i),MP}var LP,Cee;function ont(){if(Cee)return LP;Cee=1;const e=pj();return LP=(n,r,i)=>e(n,r,"<",i),LP}var PP,See;function ant(){if(See)return PP;See=1;const e=Hu();return PP=(n,r,i)=>(n=new e(n,i),r=new e(r,i),n.intersects(r,i)),PP}var BP,kee;function unt(){if(kee)return BP;kee=1;const e=N3(),t=Gu();return BP=(n,r,i)=>{const s=[];let o=null,a=null;const u=n.sort((d,h)=>t(d,h,i));for(const d of u)e(d,r,i)?(a=d,o||(o=d)):(a&&s.push([o,a]),a=null,o=null);o&&s.push([o,null]);const l=[];for(const[d,h]of s)d===h?l.push(d):!h&&d===u[0]?l.push("*"):h?d===u[0]?l.push(`<=${h}`):l.push(`${d} - ${h}`):l.push(`>=${d}`);const c=l.join(" || "),f=typeof r.raw=="string"?r.raw:String(r);return c.length<f.length?c:r},BP}var zP,Eee;function lnt(){if(Eee)return zP;Eee=1;const e=Hu(),t=I3(),{ANY:n}=t,r=N3(),i=Gu(),s=(f,d,h={})=>{if(f===d)return!0;f=new e(f,h),d=new e(d,h);let p=!1;e:for(const m of f.set){for(const x of d.set){const b=u(m,x,h);if(p=p||b!==null,b)continue e}if(p)return!1}return!0},o=[new t(">=0.0.0-0")],a=[new t(">=0.0.0")],u=(f,d,h)=>{if(f===d)return!0;if(f.length===1&&f[0].semver===n){if(d.length===1&&d[0].semver===n)return!0;h.includePrerelease?f=o:f=a}if(d.length===1&&d[0].semver===n){if(h.includePrerelease)return!0;d=a}const p=new Set;let m,x;for(const _ of f)_.operator===">"||_.operator===">="?m=l(m,_,h):_.operator==="<"||_.operator==="<="?x=c(x,_,h):p.add(_.semver);if(p.size>1)return null;let b;if(m&&x){if(b=i(m.semver,x.semver,h),b>0)return null;if(b===0&&(m.operator!==">="||x.operator!=="<="))return null}for(const _ of p){if(m&&!r(_,String(m),h)||x&&!r(_,String(x),h))return null;for(const D of d)if(!r(_,String(D),h))return!1;return!0}let v,$,C,S,A=x&&!h.includePrerelease&&x.semver.prerelease.length?x.semver:!1,E=m&&!h.includePrerelease&&m.semver.prerelease.length?m.semver:!1;A&&A.prerelease.length===1&&x.operator==="<"&&A.prerelease[0]===0&&(A=!1);for(const _ of d){if(S=S||_.operator===">"||_.operator===">=",C=C||_.operator==="<"||_.operator==="<=",m){if(E&&_.semver.prerelease&&_.semver.prerelease.length&&_.semver.major===E.major&&_.semver.minor===E.minor&&_.semver.patch===E.patch&&(E=!1),_.operator===">"||_.operator===">="){if(v=l(m,_,h),v===_&&v!==m)return!1}else if(m.operator===">="&&!r(m.semver,String(_),h))return!1}if(x){if(A&&_.semver.prerelease&&_.semver.prerelease.length&&_.semver.major===A.major&&_.semver.minor===A.minor&&_.semver.patch===A.patch&&(A=!1),_.operator==="<"||_.operator==="<="){if($=c(x,_,h),$===_&&$!==x)return!1}else if(x.operator==="<="&&!r(x.semver,String(_),h))return!1}if(!_.operator&&(x||m)&&b!==0)return!1}return!(m&&C&&!x&&b!==0||x&&S&&!m&&b!==0||E||A)},l=(f,d,h)=>{if(!f)return d;const p=i(f.semver,d.semver,h);return p>0?f:p<0||d.operator===">"&&f.operator===">="?d:f},c=(f,d,h)=>{if(!f)return d;const p=i(f.semver,d.semver,h);return p<0?f:p>0||d.operator==="<"&&f.operator==="<="?d:f};return zP=s,zP}var UP,Aee;function cnt(){if(Aee)return UP;Aee=1;const e=jS(),t=A3(),n=eo(),r=Kge(),i=mb(),s=ztt(),o=Utt(),a=jtt(),u=Wtt(),l=Vtt(),c=qtt(),f=Gtt(),d=Htt(),h=Gu(),p=Xtt(),m=Ytt(),x=cj(),b=Ktt(),v=Qtt(),$=T3(),C=fj(),S=Qge(),A=Zge(),E=dj(),_=hj(),D=Jge(),N=Ztt(),T=I3(),L=Hu(),O=N3(),M=ent(),R=tnt(),P=nnt(),j=rnt(),z=int(),q=pj(),H=snt(),V=ont(),X=ant(),re=unt(),le=lnt();return UP={parse:i,valid:s,clean:o,inc:a,diff:u,major:l,minor:c,patch:f,prerelease:d,compare:h,rcompare:p,compareLoose:m,compareBuild:x,sort:b,rsort:v,gt:$,lt:C,eq:S,neq:A,gte:E,lte:_,cmp:D,coerce:N,Comparator:T,Range:L,satisfies:O,toComparators:M,maxSatisfying:R,minSatisfying:P,minVersion:j,validRange:z,outside:q,gtr:H,ltr:V,intersects:X,simplifyRange:re,subset:le,SemVer:n,re:e.re,src:e.src,tokens:e.t,SEMVER_SPEC_VERSION:t.SEMVER_SPEC_VERSION,RELEASE_TYPES:t.RELEASE_TYPES,compareIdentifiers:r.compareIdentifiers,rcompareIdentifiers:r.rcompareIdentifiers},UP}var eme=cnt();function Qa(e,t,n){return e.fields=t||[],e.fname=n,e}function gr(e){return e==null?null:e.fname}function ms(e){return e==null?null:e.fields}function tme(e){return e.length===1?fnt(e[0]):dnt(e)}const fnt=e=>function(t){return t[e]},dnt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function ke(e){throw Error(e)}function D3(e){const t=[],n=e.length;let r=null,i=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=a+1,r=u):u==="."&&!i?a>o?l():o=a+1:u==="["?(a>o&&l(),i=o=a+1):u==="]"&&(i||ke("Access path missing open bracket: "+e),i>0&&l(),i=0,o=a+1)}return i&&ke("Access path missing closing bracket: "+e),r&&ke("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function wh(e,t,n){const r=D3(e);return e=r.length===1?r[0]:e,Qa((n&&n.get||tme)(r),[e],t||e)}const hnt=wh("id"),za=Qa(e=>e,[],"identity"),Rd=Qa(()=>0,[],"zero"),yb=Qa(()=>1,[],"one"),xb=Qa(()=>!0,[],"true"),kd=Qa(()=>!1,[],"false");function EA(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const nme=0,rme=1,ime=2,sme=3,ome=4;function pnt(e,t){let n=e||nme;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=rme&&EA(t||"error","ERROR",arguments),this},warn(){return n>=ime&&EA(t||"warn","WARN",arguments),this},info(){return n>=sme&&EA(t||"log","INFO",arguments),this},debug(){return n>=ome&&EA(t||"log","DEBUG",arguments),this}}}var Rt=Array.isArray;function Wt(e){return e===Object(e)}const _ee=e=>e!=="__proto__";function F3(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=gnt(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;R3(t,r,n[r],i)}return t},{})}function R3(e,t,n,r){if(!_ee(t))return;let i,s;if(Wt(n)&&!Rt(n)){s=Wt(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?R3(s,i,n[i]):_ee(i)&&(s[i]=n[i])}else e[t]=n}function gnt(e,t){if(e==null)return t;const n={},r=[];function i(s){n[s.name]||(n[s.name]=1,r.push(s))}return t.forEach(i),e.forEach(i),r}function An(e){return e[e.length-1]}function $h(e){return e==null||e===""?null:+e}const ame=e=>t=>e*Math.exp(t),ume=e=>t=>Math.log(e*t),lme=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),cme=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,pI=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function O3(e,t,n,r){const i=n(e[0]),s=n(An(e)),o=(s-i)*t;return[r(i-o),r(s-o)]}function mnt(e,t){return O3(e,t,$h,za)}function ynt(e,t){var n=Math.sign(e[0]);return O3(e,t,ume(n),ame(n))}function xnt(e,t,n){return O3(e,t,pI(n),pI(1/n))}function bnt(e,t,n){return O3(e,t,lme(n),cme(n))}function M3(e,t,n,r,i){const s=r(e[0]),o=r(An(e)),a=t!=null?r(t):(s+o)/2;return[i(a+(s-a)*n),i(a+(o-a)*n)]}function fme(e,t,n){return M3(e,t,n,$h,za)}function dme(e,t,n){const r=Math.sign(e[0]);return M3(e,t,n,ume(r),ame(r))}function H6(e,t,n,r){return M3(e,t,n,pI(r),pI(1/r))}function hme(e,t,n,r){return M3(e,t,n,lme(r),cme(r))}function vnt(e){return 1+~~(new Date(e).getMonth()/3)}function wnt(e){return 1+~~(new Date(e).getUTCMonth()/3)}function It(e){return e!=null?Rt(e)?e:[e]:[]}function $nt(e,t,n){let r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function xn(e){return typeof e=="function"}const Cnt="descending";function pme(e,t,n){n=n||{},t=It(t)||[];const r=[],i=[],s={},o=n.comparator||Snt;return It(e).forEach((a,u)=>{a!=null&&(r.push(t[u]===Cnt?-1:1),i.push(a=xn(a)?a:wh(a,null,n)),(ms(a)||[]).forEach(l=>s[l]=1))}),i.length===0?null:Qa(o(i,r),Object.keys(s))}const L3=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),Snt=(e,t)=>e.length===1?knt(e[0],t[0]):Ent(e,t,e.length),knt=(e,t)=>function(n,r){return L3(e(n),e(r))*t},Ent=(e,t,n)=>(t.push(0),function(r,i){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=L3(s(r),s(i));return o*t[a]});function Ua(e){return xn(e)?e:()=>e}function gme(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function qt(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function Ch(e,t){let n=0,r,i,s,o;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=o=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>o&&(o=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=o=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>o&&(o=i))}return[s,o]}function mme(e,t){const n=e.length;let r=-1,i,s,o,a,u;if(t==null){for(;++r<n;)if(s=e[r],s!=null&&s>=s){i=o=s;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)s=e[r],s!=null&&(i>s&&(i=s,a=r),o<s&&(o=s,u=r))}else{for(;++r<n;)if(s=t(e[r],r,e),s!=null&&s>=s){i=o=s;break}if(r===n)return[-1,-1];for(a=u=r;++r<n;)s=t(e[r],r,e),s!=null&&(i>s&&(i=s,a=r),o<s&&(o=s,u=r))}return[a,u]}const Ant=Object.prototype.hasOwnProperty;function Nt(e,t){return Ant.call(e,t)}const AA={};function bb(e){let t={},n;function r(s){return Nt(t,s)&&t[s]!==AA}const i={size:0,empty:0,object:t,has:r,get(s){return r(s)?t[s]:void 0},set(s,o){return r(s)||(++i.size,t[s]===AA&&--i.empty),t[s]=o,this},delete(s){return r(s)&&(--i.size,++i.empty,t[s]=AA),this},clear(){i.size=i.empty=0,i.object=t={}},test(s){return arguments.length?(n=s,i):n},clean(){const s={};let o=0;for(const a in t){const u=t[a];u!==AA&&(!n||!n(u))&&(s[a]=u,++o)}i.size=o,i.empty=0,i.object=t=s}};return e&&Object.keys(e).forEach(s=>{i.set(s,e[s])}),i}function _nt(e,t,n,r,i,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],u=An(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=o?r:c<=o?i:s}function ze(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),qt(r,n)}function Tnt(e,t,n,r){let i=t[0],s=t[t.length-1],o;return i>s&&(o=i,i=s,s=o),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function yme(e){return typeof e=="boolean"}function P3(e){return Object.prototype.toString.call(e)==="[object Date]"}function xme(e){return e&&xn(e[Symbol.iterator])}function dm(e){return typeof e=="number"}function Int(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Hn(e){return typeof e=="string"}function bme(e,t,n){e&&(e=t?It(e).map(a=>a.replace(/\\(.)/g,"$1")):It(e));const r=e&&e.length,i=n&&n.get||tme,s=a=>i(t?[a]:D3(a));let o;if(!r)o=function(){return""};else if(r===1){const a=s(e[0]);o=function(u){return""+a(u)}}else{const a=e.map(s);o=function(u){let l=""+a[0](u),c=0;for(;++c<r;)l+="|"+a[c](u);return l}}return Qa(o,e,"key")}function Nnt(e,t){const n=e[0],r=An(e),i=+t;return i?i===1?r:n+i*(r-n):n}const Dnt=1e4;function vme(e){e=+e||Dnt;let t,n,r;const i=()=>{t={},n={},r=0},s=(o,a)=>(++r>e&&(n=t,t={},r=1),t[o]=a);return i(),{clear:i,has:o=>Nt(t,o)||Nt(n,o),get:o=>Nt(t,o)?t[o]:Nt(n,o)?s(o,n[o]):void 0,set:(o,a)=>Nt(t,o)?t[o]=a:s(o,a)}}function wme(e,t,n,r){const i=t.length,s=n.length;if(!s)return t;if(!i)return n;const o=r||new t.constructor(i+s);let a=0,u=0,l=0;for(;a<i&&u<s;++l)o[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<i;++a,++l)o[l]=t[a];for(;u<s;++u,++l)o[l]=n[u];return o}function L2(e,t){let n="";for(;--t>=0;)n+=e;return n}function Fnt(e,t,n,r){const i=n||" ",s=e+"",o=t-s.length;return o<=0?s:r==="left"?L2(i,o)+s:r==="center"?L2(i,~~(o/2))+s+L2(i,Math.ceil(o/2)):s+L2(i,o)}function B3(e){return e&&An(e)-e[0]||0}function St(e){return Rt(e)?"["+e.map(St)+"]":Wt(e)||Hn(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function $me(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const Rnt=e=>dm(e)||P3(e)?e:Date.parse(e);function Cme(e,t){return t=t||Rnt,e==null||e===""?null:t(e)}function Sme(e){return e==null||e===""?null:e+""}function Tf(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function Ont(e,t,n,r){const i=r??"…",s=e+"",o=s.length,a=Math.max(0,t-i.length);return o<=t?s:n==="left"?i+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+i+s.slice(o-~~(a/2)):s.slice(0,a)+i}function Mnt(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const s=t(e[i]);s&&n(s,i,e)}}else e.forEach(n)}function vb(e,t,n){return e.fields=t||[],e.fname=n,e}function Lnt(e){return e.length===1?Pnt(e[0]):Bnt(e)}const Pnt=e=>function(t){return t[e]},Bnt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function ys(e){throw Error(e)}function znt(e){const t=[],n=e.length;let r=null,i=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=a+1,r=u):u==="."&&!i?a>o?l():o=a+1:u==="["?(a>o&&l(),i=o=a+1):u==="]"&&(i||ys("Access path missing open bracket: "+e),i>0&&l(),i=0,o=a+1)}return i&&ys("Access path missing closing bracket: "+e),r&&ys("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function kme(e,t,n){const r=znt(e);return e=r.length===1?r[0]:e,vb(Lnt(r),[e],e)}const z3=kme("id"),U3=vb(e=>e,[],"identity");vb(()=>0,[],"zero");vb(()=>1,[],"one");const X6=vb(()=>!0,[],"true");vb(()=>!1,[],"false");function Unt(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const jnt=0,Eme=1,Wnt=2,Vnt=3,qnt=4;function Gnt(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Unt,r=e||jnt;return{level(i){return arguments.length?(r=+i,this):r},error(){return r>=Eme&&n("error","ERROR",arguments),this},warn(){return r>=Wnt&&n("warn","WARN",arguments),this},info(){return r>=Vnt&&n("log","INFO",arguments),this},debug(){return r>=qnt&&n("log","DEBUG",arguments),this}}}var Xl=Array.isArray;function gj(e){return e===Object(e)}function Tee(e){return e==null||e===""?null:+e}function gI(e){return e!=null?Xl(e)?e:[e]:[]}function Nu(e){return typeof e=="function"}function mj(e){return Nu(e)?e:()=>e}function Hnt(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function wb(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}const Xnt=Object.prototype.hasOwnProperty;function yj(e,t){return Xnt.call(e,t)}function Ame(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),wb(r,n)}function Ynt(e){return Object.prototype.toString.call(e)==="[object Date]"}function Knt(e){return e&&Nu(e[Symbol.iterator])}function Qnt(e){return typeof e=="number"}function Y6(e){return typeof e=="string"}function xj(e){return Xl(e)?"["+e.map(xj)+"]":gj(e)||Y6(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Znt(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const Jnt=e=>Qnt(e)||Ynt(e)?e:Date.parse(e);function ert(e,t){return t=t||Jnt,e==null||e===""?null:t(e)}function trt(e){return e==null||e===""?null:e+""}function fg(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const s=t(e[i]);s&&n(s,i,e)}}else e.forEach(n)}var Iee={},jP={},WP=34,Xv=10,VP=13;function _me(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function nrt(e,t){var n=_me(e);return function(r,i){return t(n(r),i,e)}}function Nee(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function fo(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function rrt(e){return e<0?"-"+fo(-e,6):e>9999?"+"+fo(e,6):fo(e,4)}function irt(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":rrt(e.getUTCFullYear())+"-"+fo(e.getUTCMonth()+1,2)+"-"+fo(e.getUTCDate(),2)+(i?"T"+fo(t,2)+":"+fo(n,2)+":"+fo(r,2)+"."+fo(i,3)+"Z":r?"T"+fo(t,2)+":"+fo(n,2)+":"+fo(r,2)+"Z":n||t?"T"+fo(t,2)+":"+fo(n,2)+"Z":"")}function srt(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,m=i(f,function(x,b){if(h)return h(x,b-1);p=x,h=d?nrt(x,d):_me(x)});return m.columns=p||[],m}function i(f,d){var h=[],p=f.length,m=0,x=0,b,v=p<=0,$=!1;f.charCodeAt(p-1)===Xv&&--p,f.charCodeAt(p-1)===VP&&--p;function C(){if(v)return jP;if($)return $=!1,Iee;var A,E=m,_;if(f.charCodeAt(E)===WP){for(;m++<p&&f.charCodeAt(m)!==WP||f.charCodeAt(++m)===WP;);return(A=m)>=p?v=!0:(_=f.charCodeAt(m++))===Xv?$=!0:_===VP&&($=!0,f.charCodeAt(m)===Xv&&++m),f.slice(E+1,A-1).replace(/""/g,'"')}for(;m<p;){if((_=f.charCodeAt(A=m++))===Xv)$=!0;else if(_===VP)$=!0,f.charCodeAt(m)===Xv&&++m;else if(_!==n)continue;return f.slice(E,A)}return v=!0,f.slice(E,p)}for(;(b=C())!==jP;){for(var S=[];b!==Iee&&b!==jP;)S.push(b),b=C();d&&(S=d(S,x++))==null||h.push(S)}return h}function s(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function o(f,d){return d==null&&(d=Nee(f)),[d.map(c).join(e)].concat(s(f,d)).join(`
`)}function a(f,d){return d==null&&(d=Nee(f)),s(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?irt(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:o,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function ort(e){return e}function art(e){if(e==null)return ort;var t,n,r=e.scale[0],i=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*r+s,f[1]=(n+=a[1])*i+o;l<c;)f[l]=a[l],++l;return f}}function urt(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function Tme(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return Dee(e,n)})}:Dee(e,t)}function Dee(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,s=Ime(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function Ime(e,t){var n=art(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&urt(f,p)}function s(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=s(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(s);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function lrt(e,t){var n={},r={},i={},s=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var m=p===h?h:h.concat(p);r[m.start=h.start]=i[m.end=p.end]=m}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var x=p===h?h:p.concat(h);r[x.start=p.start]=i[x.end=h.end]=x}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),s.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||s.push([l])}),s}function Nme(e){return Ime(e,crt.apply(this,arguments))}function crt(e,t,n){var r,i,s;if(arguments.length>1)r=frt(e,t,n);else for(i=0,r=new Array(s=e.arcs.length);i<s;++i)r[i]=i;return{type:"MultiLineString",arcs:lrt(e,r)}}function frt(e,t,n){var r=[],i=[],s;function o(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:s})}function a(f){f.forEach(o)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}class mI extends Map{constructor(t,n=Rme){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(K6(this,t))}has(t){return super.has(K6(this,t))}set(t,n){return super.set(Dme(this,t),n)}delete(t){return super.delete(Fme(this,t))}}class yI extends Set{constructor(t,n=Rme){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(K6(this,t))}add(t){return super.add(Dme(this,t))}delete(t){return super.delete(Fme(this,t))}}function K6({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Dme({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Fme({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(n),e.delete(r)),n}function Rme(e){return e!==null&&typeof e=="object"?e.valueOf():e}const drt=Math.sqrt(50),hrt=Math.sqrt(10),prt=Math.sqrt(2);function Ome(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=drt?10:s>=hrt?5:s>=prt?2:1;let a,u,l;return i<0?(l=Math.pow(10,-i)/o,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*o,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?Ome(e,t,n*2):[a,u,l]}function Fee(e,t,n){return t=+t,e=+e,n=+n,Ome(e,t,n)[2]}function grt(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?Fee(t,e,n):Fee(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function mrt(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function xI(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function hy(e){return e=xI(Math.abs(e)),e?e[1]:NaN}function yrt(e,t){return function(n,r){for(var i=n.length,s=[],o=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),s.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function xrt(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var brt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r$(e){if(!(t=brt.exec(e)))throw new Error("invalid format: "+e);var t;return new bj({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}r$.prototype=bj.prototype;function bj(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}bj.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function vrt(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Mme;function wrt(e,t){var n=xI(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(Mme=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+xI(e,Math.max(0,t+s-1))[0]}function Ree(e,t){var n=xI(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Oee={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:mrt,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Ree(e*100,t),r:Ree,s:wrt,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Mee(e){return e}var Lee=Array.prototype.map,Pee=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Lme(e){var t=e.grouping===void 0||e.thousands===void 0?Mee:yrt(Lee.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Mee:xrt(Lee.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=r$(f);var d=f.fill,h=f.align,p=f.sign,m=f.symbol,x=f.zero,b=f.width,v=f.comma,$=f.precision,C=f.trim,S=f.type;S==="n"?(v=!0,S="g"):Oee[S]||($===void 0&&($=12),C=!0,S="g"),(x||d==="0"&&h==="=")&&(x=!0,d="0",h="=");var A=m==="$"?n:m==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",E=m==="$"?r:/[%p]/.test(S)?o:"",_=Oee[S],D=/[defgprs%]/.test(S);$=$===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,$)):Math.max(0,Math.min(20,$));function N(T){var L=A,O=E,M,R,P;if(S==="c")O=_(T)+O,T="";else{T=+T;var j=T<0||1/T<0;if(T=isNaN(T)?u:_(Math.abs(T),$),C&&(T=vrt(T)),j&&+T==0&&p!=="+"&&(j=!1),L=(j?p==="("?p:a:p==="-"||p==="("?"":p)+L,O=(S==="s"?Pee[8+Mme/3]:"")+O+(j&&p==="("?")":""),D){for(M=-1,R=T.length;++M<R;)if(P=T.charCodeAt(M),48>P||P>57){O=(P===46?i+T.slice(M+1):T.slice(M))+O,T=T.slice(0,M);break}}}v&&!x&&(T=t(T,1/0));var z=L.length+T.length+O.length,q=z<b?new Array(b-z+1).join(d):"";switch(v&&x&&(T=t(q+T,q.length?b-O.length:1/0),q=""),h){case"<":T=L+T+O+q;break;case"=":T=L+q+T+O;break;case"^":T=q.slice(0,z=q.length>>1)+L+T+O+q.slice(z);break;default:T=q+L+T+O;break}return s(T)}return N.toString=function(){return f+""},N}function c(f,d){var h=l((f=r$(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(hy(d)/3)))*3,m=Math.pow(10,-p),x=Pee[8+p/3];return function(b){return h(m*b)+x}}return{format:l,formatPrefix:c}}var _A,Pme,Bme;$rt({thousands:",",grouping:[3],currency:["$",""]});function $rt(e){return _A=Lme(e),Pme=_A.format,Bme=_A.formatPrefix,_A}function Crt(e){return Math.max(0,-hy(Math.abs(e)))}function Srt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(hy(t)/3)))*3-hy(Math.abs(e)))}function krt(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,hy(t)-hy(e))+1}const qP=new Date,GP=new Date;function ti(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,a)=>{const u=[];if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;let l;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},i.filter=s=>ti(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(i.count=(s,o)=>(qP.setTime(+s),GP.setTime(+o),e(qP),e(GP),Math.floor(n(qP,GP))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?o=>r(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const i$=ti(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);i$.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ti(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):i$);i$.range;const s$=1e3,Sh=s$*60,o$=Sh*60,a$=o$*24,zme=a$*7,vj=ti(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*s$)},(e,t)=>(t-e)/s$,e=>e.getUTCSeconds());vj.range;const Ume=ti(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*s$)},(e,t)=>{e.setTime(+e+t*Sh)},(e,t)=>(t-e)/Sh,e=>e.getMinutes());Ume.range;const jme=ti(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Sh)},(e,t)=>(t-e)/Sh,e=>e.getUTCMinutes());jme.range;const Wme=ti(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*s$-e.getMinutes()*Sh)},(e,t)=>{e.setTime(+e+t*o$)},(e,t)=>(t-e)/o$,e=>e.getHours());Wme.range;const Vme=ti(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*o$)},(e,t)=>(t-e)/o$,e=>e.getUTCHours());Vme.range;const G1=ti(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Sh)/a$,e=>e.getDate()-1);G1.range;const H1=ti(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/a$,e=>e.getUTCDate()-1);H1.range;const Ert=ti(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/a$,e=>Math.floor(e/a$));Ert.range;function Zm(e){return ti(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Sh)/zme)}const wj=Zm(0),bI=Zm(1),Art=Zm(2),_rt=Zm(3),py=Zm(4),Trt=Zm(5),Irt=Zm(6);wj.range;bI.range;Art.range;_rt.range;py.range;Trt.range;Irt.range;function Jm(e){return ti(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/zme)}const $j=Jm(0),vI=Jm(1),Nrt=Jm(2),Drt=Jm(3),gy=Jm(4),Frt=Jm(5),Rrt=Jm(6);$j.range;vI.range;Nrt.range;Drt.range;gy.range;Frt.range;Rrt.range;const Q6=ti(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Q6.range;const Z6=ti(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Z6.range;const kh=ti(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());kh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ti(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});kh.range;const Eh=ti(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Eh.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ti(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Eh.range;const u$="year",l$="quarter",c$="month",f$="week",d$="date",j3="day",Cj="dayofyear",h$="hours",p$="minutes",g$="seconds",W3="milliseconds",Ort=[u$,l$,c$,f$,d$,j3,Cj,h$,p$,g$,W3];Ort.reduce((e,t,n)=>(e[t]=1+n,e),{});const Mrt={[u$]:kh,[l$]:Q6.every(3),[c$]:Q6,[f$]:wj,[d$]:G1,[j3]:G1,[Cj]:G1,[h$]:Wme,[p$]:Ume,[g$]:vj,[W3]:i$},Lrt={[u$]:Eh,[l$]:Z6.every(3),[c$]:Z6,[f$]:$j,[d$]:H1,[j3]:H1,[Cj]:H1,[h$]:Vme,[p$]:jme,[g$]:vj,[W3]:i$};function Prt(e){return Mrt[e]}function Brt(e){return Lrt[e]}function HP(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function XP(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Yv(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function qme(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,o=e.shortDays,a=e.months,u=e.shortMonths,l=Kv(i),c=Qv(i),f=Kv(s),d=Qv(s),h=Kv(o),p=Qv(o),m=Kv(a),x=Qv(a),b=Kv(u),v=Qv(u),$={a:j,A:z,b:q,B:H,c:null,d:Vee,e:Vee,f:uit,g:xit,G:vit,H:sit,I:oit,j:ait,L:Gme,m:lit,M:cit,p:V,q:X,Q:Hee,s:Xee,S:fit,u:dit,U:hit,V:pit,w:git,W:mit,x:null,X:null,y:yit,Y:bit,Z:wit,"%":Gee},C={a:re,A:le,b:ue,B:be,c:null,d:qee,e:qee,f:kit,g:Oit,G:Lit,H:$it,I:Cit,j:Sit,L:Xme,m:Eit,M:Ait,p:_e,q:Ne,Q:Hee,s:Xee,S:_it,u:Tit,U:Iit,V:Nit,w:Dit,W:Fit,x:null,X:null,y:Rit,Y:Mit,Z:Pit,"%":Gee},S={a:N,A:T,b:L,B:O,c:M,d:jee,e:jee,f:tit,g:Uee,G:zee,H:Wee,I:Wee,j:Qrt,L:eit,m:Krt,M:Zrt,p:D,q:Yrt,Q:rit,s:iit,S:Jrt,u:Vrt,U:qrt,V:Grt,w:Wrt,W:Hrt,x:R,X:P,y:Uee,Y:zee,Z:Xrt,"%":nit};$.x=A(n,$),$.X=A(r,$),$.c=A(t,$),C.x=A(n,C),C.X=A(r,C),C.c=A(t,C);function A(Y,ae){return function(he){var G=[],je=-1,Ce=0,We=Y.length,Ve,gt,ct;for(he instanceof Date||(he=new Date(+he));++je<We;)Y.charCodeAt(je)===37&&(G.push(Y.slice(Ce,je)),(gt=Bee[Ve=Y.charAt(++je)])!=null?Ve=Y.charAt(++je):gt=Ve==="e"?" ":"0",(ct=ae[Ve])&&(Ve=ct(he,gt)),G.push(Ve),Ce=je+1);return G.push(Y.slice(Ce,je)),G.join("")}}function E(Y,ae){return function(he){var G=Yv(1900,void 0,1),je=_(G,Y,he+="",0),Ce,We;if(je!=he.length)return null;if("Q"in G)return new Date(G.Q);if("s"in G)return new Date(G.s*1e3+("L"in G?G.L:0));if(ae&&!("Z"in G)&&(G.Z=0),"p"in G&&(G.H=G.H%12+G.p*12),G.m===void 0&&(G.m="q"in G?G.q:0),"V"in G){if(G.V<1||G.V>53)return null;"w"in G||(G.w=1),"Z"in G?(Ce=XP(Yv(G.y,0,1)),We=Ce.getUTCDay(),Ce=We>4||We===0?vI.ceil(Ce):vI(Ce),Ce=H1.offset(Ce,(G.V-1)*7),G.y=Ce.getUTCFullYear(),G.m=Ce.getUTCMonth(),G.d=Ce.getUTCDate()+(G.w+6)%7):(Ce=HP(Yv(G.y,0,1)),We=Ce.getDay(),Ce=We>4||We===0?bI.ceil(Ce):bI(Ce),Ce=G1.offset(Ce,(G.V-1)*7),G.y=Ce.getFullYear(),G.m=Ce.getMonth(),G.d=Ce.getDate()+(G.w+6)%7)}else("W"in G||"U"in G)&&("w"in G||(G.w="u"in G?G.u%7:"W"in G?1:0),We="Z"in G?XP(Yv(G.y,0,1)).getUTCDay():HP(Yv(G.y,0,1)).getDay(),G.m=0,G.d="W"in G?(G.w+6)%7+G.W*7-(We+5)%7:G.w+G.U*7-(We+6)%7);return"Z"in G?(G.H+=G.Z/100|0,G.M+=G.Z%100,XP(G)):HP(G)}}function _(Y,ae,he,G){for(var je=0,Ce=ae.length,We=he.length,Ve,gt;je<Ce;){if(G>=We)return-1;if(Ve=ae.charCodeAt(je++),Ve===37){if(Ve=ae.charAt(je++),gt=S[Ve in Bee?ae.charAt(je++):Ve],!gt||(G=gt(Y,he,G))<0)return-1}else if(Ve!=he.charCodeAt(G++))return-1}return G}function D(Y,ae,he){var G=l.exec(ae.slice(he));return G?(Y.p=c.get(G[0].toLowerCase()),he+G[0].length):-1}function N(Y,ae,he){var G=h.exec(ae.slice(he));return G?(Y.w=p.get(G[0].toLowerCase()),he+G[0].length):-1}function T(Y,ae,he){var G=f.exec(ae.slice(he));return G?(Y.w=d.get(G[0].toLowerCase()),he+G[0].length):-1}function L(Y,ae,he){var G=b.exec(ae.slice(he));return G?(Y.m=v.get(G[0].toLowerCase()),he+G[0].length):-1}function O(Y,ae,he){var G=m.exec(ae.slice(he));return G?(Y.m=x.get(G[0].toLowerCase()),he+G[0].length):-1}function M(Y,ae,he){return _(Y,t,ae,he)}function R(Y,ae,he){return _(Y,n,ae,he)}function P(Y,ae,he){return _(Y,r,ae,he)}function j(Y){return o[Y.getDay()]}function z(Y){return s[Y.getDay()]}function q(Y){return u[Y.getMonth()]}function H(Y){return a[Y.getMonth()]}function V(Y){return i[+(Y.getHours()>=12)]}function X(Y){return 1+~~(Y.getMonth()/3)}function re(Y){return o[Y.getUTCDay()]}function le(Y){return s[Y.getUTCDay()]}function ue(Y){return u[Y.getUTCMonth()]}function be(Y){return a[Y.getUTCMonth()]}function _e(Y){return i[+(Y.getUTCHours()>=12)]}function Ne(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var ae=A(Y+="",$);return ae.toString=function(){return Y},ae},parse:function(Y){var ae=E(Y+="",!1);return ae.toString=function(){return Y},ae},utcFormat:function(Y){var ae=A(Y+="",C);return ae.toString=function(){return Y},ae},utcParse:function(Y){var ae=E(Y+="",!0);return ae.toString=function(){return Y},ae}}}var Bee={"-":"",_:" ",0:"0"},Ai=/^\s*\d+/,zrt=/^%/,Urt=/[\\^$*+?|[\]().{}]/g;function un(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function jrt(e){return e.replace(Urt,"\\$&")}function Kv(e){return new RegExp("^(?:"+e.map(jrt).join("|")+")","i")}function Qv(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Wrt(e,t,n){var r=Ai.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Vrt(e,t,n){var r=Ai.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function qrt(e,t,n){var r=Ai.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Grt(e,t,n){var r=Ai.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Hrt(e,t,n){var r=Ai.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function zee(e,t,n){var r=Ai.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Uee(e,t,n){var r=Ai.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Xrt(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Yrt(e,t,n){var r=Ai.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Krt(e,t,n){var r=Ai.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function jee(e,t,n){var r=Ai.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Qrt(e,t,n){var r=Ai.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Wee(e,t,n){var r=Ai.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Zrt(e,t,n){var r=Ai.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Jrt(e,t,n){var r=Ai.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function eit(e,t,n){var r=Ai.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function tit(e,t,n){var r=Ai.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function nit(e,t,n){var r=zrt.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function rit(e,t,n){var r=Ai.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function iit(e,t,n){var r=Ai.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Vee(e,t){return un(e.getDate(),t,2)}function sit(e,t){return un(e.getHours(),t,2)}function oit(e,t){return un(e.getHours()%12||12,t,2)}function ait(e,t){return un(1+G1.count(kh(e),e),t,3)}function Gme(e,t){return un(e.getMilliseconds(),t,3)}function uit(e,t){return Gme(e,t)+"000"}function lit(e,t){return un(e.getMonth()+1,t,2)}function cit(e,t){return un(e.getMinutes(),t,2)}function fit(e,t){return un(e.getSeconds(),t,2)}function dit(e){var t=e.getDay();return t===0?7:t}function hit(e,t){return un(wj.count(kh(e)-1,e),t,2)}function Hme(e){var t=e.getDay();return t>=4||t===0?py(e):py.ceil(e)}function pit(e,t){return e=Hme(e),un(py.count(kh(e),e)+(kh(e).getDay()===4),t,2)}function git(e){return e.getDay()}function mit(e,t){return un(bI.count(kh(e)-1,e),t,2)}function yit(e,t){return un(e.getFullYear()%100,t,2)}function xit(e,t){return e=Hme(e),un(e.getFullYear()%100,t,2)}function bit(e,t){return un(e.getFullYear()%1e4,t,4)}function vit(e,t){var n=e.getDay();return e=n>=4||n===0?py(e):py.ceil(e),un(e.getFullYear()%1e4,t,4)}function wit(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+un(t/60|0,"0",2)+un(t%60,"0",2)}function qee(e,t){return un(e.getUTCDate(),t,2)}function $it(e,t){return un(e.getUTCHours(),t,2)}function Cit(e,t){return un(e.getUTCHours()%12||12,t,2)}function Sit(e,t){return un(1+H1.count(Eh(e),e),t,3)}function Xme(e,t){return un(e.getUTCMilliseconds(),t,3)}function kit(e,t){return Xme(e,t)+"000"}function Eit(e,t){return un(e.getUTCMonth()+1,t,2)}function Ait(e,t){return un(e.getUTCMinutes(),t,2)}function _it(e,t){return un(e.getUTCSeconds(),t,2)}function Tit(e){var t=e.getUTCDay();return t===0?7:t}function Iit(e,t){return un($j.count(Eh(e)-1,e),t,2)}function Yme(e){var t=e.getUTCDay();return t>=4||t===0?gy(e):gy.ceil(e)}function Nit(e,t){return e=Yme(e),un(gy.count(Eh(e),e)+(Eh(e).getUTCDay()===4),t,2)}function Dit(e){return e.getUTCDay()}function Fit(e,t){return un(vI.count(Eh(e)-1,e),t,2)}function Rit(e,t){return un(e.getUTCFullYear()%100,t,2)}function Oit(e,t){return e=Yme(e),un(e.getUTCFullYear()%100,t,2)}function Mit(e,t){return un(e.getUTCFullYear()%1e4,t,4)}function Lit(e,t){var n=e.getUTCDay();return e=n>=4||n===0?gy(e):gy.ceil(e),un(e.getUTCFullYear()%1e4,t,4)}function Pit(){return"+0000"}function Gee(){return"%"}function Hee(e){return+e}function Xee(e){return Math.floor(+e/1e3)}var u1,Kme,Qme,Zme,Jme;Bit({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Bit(e){return u1=qme(e),Kme=u1.format,Qme=u1.parse,Zme=u1.utcFormat,Jme=u1.utcParse,u1}function P2(e){const t={};return n=>t[n]||(t[n]=e(n))}function zit(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=Uit(r,i);const o=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+o}}function Uit(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function e0e(e){const t=P2(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=r$(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return zit(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,o){o=r$(o??",f");const a=grt(r,i,s),u=Math.max(Math.abs(r),Math.abs(i));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=Srt(a,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=krt(a,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=Crt(a))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let J6;jit();function jit(){return J6=e0e({format:Pme,formatPrefix:Bme})}function Wit(e){return e0e(Lme(e))}function Yee(e){return arguments.length?J6=Wit(e):J6}function Kee(e,t,n){n=n||{},gj(n)||ys(`Invalid time multi-format specifier: ${n}`);const r=t(g$),i=t(p$),s=t(h$),o=t(d$),a=t(f$),u=t(c$),l=t(l$),c=t(u$),f=e(n[W3]||".%L"),d=e(n[g$]||":%S"),h=e(n[p$]||"%I:%M"),p=e(n[h$]||"%I %p"),m=e(n[d$]||n[j3]||"%a %d"),x=e(n[f$]||"%b %d"),b=e(n[c$]||"%B"),v=e(n[l$]||"%B"),$=e(n[u$]||"%Y");return C=>(r(C)<C?f:i(C)<C?d:s(C)<C?h:o(C)<C?p:u(C)<C?a(C)<C?m:x:c(C)<C?l(C)<C?b:v:$)(C)}function t0e(e){const t=P2(e.format),n=P2(e.utcFormat);return{timeFormat:r=>Y6(r)?t(r):Kee(t,Prt,r),utcFormat:r=>Y6(r)?n(r):Kee(n,Brt,r),timeParse:P2(e.parse),utcParse:P2(e.utcParse)}}let ez;Vit();function Vit(){return ez=t0e({format:Kme,parse:Qme,utcFormat:Zme,utcParse:Jme})}function qit(e){return t0e(qme(e))}function tz(e){return arguments.length?ez=qit(e):ez}const Qee=(e,t)=>wb({},e,t);function Git(e,t){const n=arguments.length;return n&&n!==2&&ys("defaultLocale expects either zero or two arguments."),n?Qee(Yee(e),tz(t)):Qee(Yee(),tz())}const Hit=/^(data:|([A-Za-z]+:)?\/\/)/,Xit=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Yit=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Zee="file://";function Kit(e,t){return n=>({options:n||{},sanitize:Zit,load:Qit,fileAccess:!!t,file:Jit(t),http:tst(e)})}async function Qit(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Zit(e,t){t=wb({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,o;const a=Xit.test(e.replace(Yit,""));(e==null||typeof e!="string"||!a)&&ys("Sanitize failure, invalid URI: "+xj(e));const u=Hit.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(i=e.startsWith(Zee))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(Zee.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function Jit(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):est}async function est(){ys("No file system access.")}function tst(e){return e?async function(t,n){const r=wb({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?Nu(s[i])?s[i]():s.text():ys(s.status+""+s.statusText)}:nst}async function nst(){ys("No HTTP fetch method available.")}const rst=e=>e!=null&&e===e,ist=e=>e==="true"||e==="false"||e===!0||e===!1,sst=e=>!Number.isNaN(Date.parse(e)),n0e=e=>!Number.isNaN(+e)&&!(e instanceof Date),ost=e=>n0e(e)&&Number.isInteger(+e),Jee={boolean:Znt,integer:Tee,number:Tee,date:ert,string:trt,unknown:U3},TA=[ist,ost,n0e,sst],ast=["boolean","integer","number","date"];function ust(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=TA.length,i=TA.map((s,o)=>o+1);for(let s=0,o=0,a,u;s<n;++s)for(u=t?e[s][t]:e[s],a=0;a<r;++a)if(i[a]&&rst(u)&&!TA[a](u)&&(i[a]=0,++o,o===TA.length))return"string";return ast[i.reduce((s,o)=>s===0?o:s,0)-1]}function lst(e,t){return t.reduce((n,r)=>(n[r]=ust(e,r),n),{})}function ete(e){const t=function(n,r){const i={delimiter:e};return Sj(n,r?wb(r,i):i)};return t.responseType="text",t}function Sj(e,t){return t.header&&(e=t.header.map(xj).join(t.delimiter)+`
`+e),srt(t.delimiter).parse(e+"")}Sj.responseType="text";function cst(e){return typeof Buffer=="function"&&Nu(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function kj(e,t){const n=t&&t.property?kme(t.property):U3;return gj(e)&&!cst(e)?fst(n(e),t):n(JSON.parse(e))}kj.responseType="json";function fst(e,t){return!Xl(e)&&Knt(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const dst={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function r0e(e,t){let n,r,i,s;return e=kj(e,t),t&&t.feature?(n=Tme,i=t.feature):t&&t.mesh?(n=Nme,i=t.mesh,s=dst[t.filter]):ys("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,s):ys("Invalid TopoJSON object: "+i),r&&r.features||[r]}r0e.responseType="json";const YP={dsv:Sj,csv:ete(","),tsv:ete("	"),json:kj,topojson:r0e};function i0e(e,t){return arguments.length>1?(YP[e]=t,this):yj(YP,e)?YP[e]:null}function hst(e){const t=i0e(e);return t&&t.responseType||"text"}function pst(e,t,n,r){t=t||{};const i=i0e(t.type||"json");return i||ys("Unknown data format type: "+t.type),e=i(e,t),t.parse&&gst(e,t.parse,n,r),yj(e,"columns")&&delete e.columns,e}function gst(e,t,n,r){if(!e.length)return;const i=tz();n=n||i.timeParse,r=r||i.utcParse;let s=e.columns||Object.keys(e[0]),o,a,u,l,c,f;t==="auto"&&(t=lst(e,s)),s=Object.keys(t);const d=s.map(h=>{const p=t[h];let m,x;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return m=p.split(/:(.+)?/,2),x=m[1],(x[0]==="'"&&x[x.length-1]==="'"||x[0]==='"'&&x[x.length-1]==='"')&&(x=x.slice(1,-1)),(m[0]==="utc"?r:n)(x);if(!Jee[p])throw Error("Illegal format pattern: "+h+":"+p);return Jee[p]});for(u=0,c=e.length,f=s.length;u<c;++u)for(o=e[u],l=0;l<f;++l)a=s[l],o[a]=d[l](o[a])}const mst=Kit(typeof fetch<"u"&&fetch,null);function V3(e){const t=e||U3,n=[],r={};return n.add=i=>{const s=t(i);return r[s]||(r[s]=1,n.push(i)),n},n.remove=i=>{const s=t(i);if(r[s]){r[s]=0;const o=n.indexOf(i);o>=0&&n.splice(o,1)}return n},n}async function sT(e,t){try{await t(e)}catch(n){e.error(n)}}const s0e=Symbol("vega_id");let yst=1;function q3(e){return!!(e&&dt(e))}function dt(e){return e[s0e]}function o0e(e,t){return e[s0e]=t,e}function dn(e){const t=e===Object(e)?e:{data:e};return dt(t)?t:o0e(t,yst++)}function Ej(e){return G3(e,dn({}))}function G3(e,t){for(const n in e)t[n]=e[n];return t}function a0e(e,t){return o0e(t,dt(e))}function e0(e,t){return e?t?(n,r)=>e(n,r)||dt(t(n))-dt(t(r)):(n,r)=>e(n,r)||dt(n)-dt(r):null}function u0e(e){return e&&e.constructor===t0}function t0(){const e=[],t=[],n=[],r=[],i=[];let s=null,o=!1;return{constructor:t0,insert(a){const u=gI(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=Nu(a)?r:t,l=gI(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:mj(l)};return Nu(a)?(c.filter=a,i.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return Nu(a)?i.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,u){const l={},c={};let f,d,h,p,m,x;for(f=0,d=u.length;f<d;++f)l[dt(u[f])]=1;for(f=0,d=t.length;f<d;++f)m=t[f],l[dt(m)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach(v=>{p(v)&&(l[dt(v)]=-1)});for(f=0,d=e.length;f<d;++f)m=e[f],x=dt(m),l[x]?l[x]=1:a.add.push(dn(e[f]));for(f=0,d=u.length;f<d;++f)m=u[f],l[dt(m)]<0&&a.rem.push(m);function b(v,$,C){C?v[$]=C(v):a.encode=$,o||(c[dt(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],m=h.tuple,p=h.field,x=l[dt(m)],x>0&&(b(m,p,h.value),a.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach(v=>{p(v)&&l[dt(v)]>0&&b(v,h.field,h.value)}),a.modifies(h.field);if(o)a.mod=t.length||r.length?u.filter(v=>l[dt(v)]>0):u.slice();else for(x in c)a.mod.push(c[x]);return(s||s==null&&(t.length||r.length))&&a.clean(!0),a}}}const oT="_:mod:_";function H3(){Object.defineProperty(this,oT,{writable:!0,value:{}})}H3.prototype={set(e,t,n,r){const i=this,s=i[e],o=i[oT];return t!=null&&t>=0?(s[t]!==n||r)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||r)&&(i[e]=n,o[e]=Xl(n)?1+n.length:-1),i},modified(e,t){const n=this[oT];if(arguments.length){if(Xl(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[oT]={},this}};let xst=0;const bst="pulse",vst=new H3,wst=1,$st=2;function Nn(e,t,n,r){this.id=++xst,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function tte(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Nn.prototype={targets(){return this._targets||(this._targets=V3(z3))},set(e){return this.value!==e?(this.value=e,1):0},skip:tte(wst),modified:tte($st),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new H3,i=this._argops=this._argops||[],s=[];let o,a,u,l;const c=(f,d,h)=>{h instanceof Nn?(h!==this&&(t&&h.targets().add(this),s.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(o in e)if(a=e[o],o===bst)gI(a).forEach(f=>{f instanceof Nn?f!==this&&(f.targets().add(this),s.push(f)):ys("Pulse parameters must be operator instances.")}),this.source=a;else if(Xl(a))for(r.set(o,-1,Array(u=a.length)),l=0;l<u;++l)c(o,l,a[l]);else c(o,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),s},marshall(e){const t=this._argval||vst,n=this._argops;let r,i,s,o;if(n){const a=n.length;for(i=0;i<a;++i)r=n[i],s=r.op,o=s.modified()&&s.stamp===e,t.set(r.name,r.index,s.value,o);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function Cst(e,t,n,r){let i=1,s;return e instanceof Nn?s=e:e&&e.prototype instanceof Nn?s=new e:Nu(e)?s=new Nn(null,e):(i=0,s=new Nn(e,t)),this.rank(s),i&&(r=n,n=t),n&&this.connect(s,s.parameters(n,r)),this.touch(s),s}function Sst(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let kst=0;function X3(e,t,n){this.id=++kst,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Ed(e,t,n){return new X3(e,t,n)}X3.prototype={_filter:X6,_apply:U3,targets(){return this._targets||(this._targets=V3(z3))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Ed(e);return this.targets().add(t),t},apply(e){const t=Ed(null,e);return this.targets().add(t),t},merge(){const e=Ed();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Ed();return this.targets().add(Ed(null,null,Hnt(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(Ed(null,null,()=>n=!0)),t.targets().add(Ed(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=X6,this._targets=null}};function Est(e,t,n,r){const i=this,s=Ed(n,r),o=function(l){l.dataflow=i;try{s.receive(l)}catch(c){i.error(c)}finally{i.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=gI(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,o);return s}function Ast(e,t){const n=this.locale();return pst(e,t,n.timeParse,n.utcParse)}function _st(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function Tst(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:hst(t&&t.type)});try{i=n.parse(i,t)}catch(s){r=-2,n.warn("Data ingestion failed",e,s)}}catch(s){r=-1,n.warn("Loading failed",e,s)}return{data:i,status:r}}async function Ist(e,t,n){const r=this,i=r._pending||Nst(r);i.requests+=1;const s=await r.request(t,n);return r.pulse(e,r.changeset().remove(X6).insert(s.data||[])),i.done(),s}function Nst(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const Dst={skip:!0};function Fst(e,t,n,r,i){return(e instanceof Nn?Ost:Rst)(this,e,t,n,r,i),this}function Rst(e,t,n,r,i,s){const o=wb({},s,Dst);let a,u;Nu(n)||(n=mj(n)),r===void 0?a=l=>e.touch(n(l)):Nu(r)?(u=new Nn(null,r,i,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;u0e(f)?e.pulse(c,f,s):e.update(c,f,o)}):a=l=>e.update(n(l),r,o),t.apply(a)}function Ost(e,t,n,r,i,s){if(r===void 0)t.targets().add(n);else{const o=s||{},a=new Nn(null,Mst(n,r),i,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function Mst(e,t){return t=Nu(t)?t:mj(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function Lst(e){e.rank=++this._rank}function Pst(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&ys("Cycle detected in dataflow graph.")}const wI={},gl=1,Td=2,Gc=4,Bst=gl|Td,nte=gl|Gc,l1=gl|Td|Gc,rte=8,Zv=16,ite=32,ste=64;function rh(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function KP(e,t){const n=[];return fg(e,t,r=>n.push(r)),n}function ote(e,t){const n={};return e.visit(t,r=>{n[dt(r)]=1}),r=>n[dt(r)]?null:r}function IA(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}rh.prototype={StopPropagation:wI,ADD:gl,REM:Td,MOD:Gc,ADD_REM:Bst,ADD_MOD:nte,ALL:l1,REFLOW:rte,SOURCE:Zv,NO_SOURCE:ite,NO_FIELDS:ste,fork(e){return new rh(this.dataflow).init(this,e)},clone(){const e=this.fork(l1);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(l1|Zv)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new rh(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&ste)&&(n.fields=e.fields),t&gl?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Td?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Gc?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&ite?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||l1;return t&gl&&this.add.length||t&Td&&this.rem.length||t&Gc&&this.mod.length},reflow(e){if(e)return this.fork(l1).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Gc,ote(this,gl))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return Xl(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?Xl(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&gl&&(n.addF=IA(n.addF,t)),e&Td&&(n.remF=IA(n.remF,t)),e&Gc&&(n.modF=IA(n.modF,t)),e&Zv&&(n.srcF=IA(n.srcF,t)),n},materialize(e){e=e||l1;const t=this;return e&gl&&t.addF&&(t.add=KP(t.add,t.addF),t.addF=null),e&Td&&t.remF&&(t.rem=KP(t.rem,t.remF),t.remF=null),e&Gc&&t.modF&&(t.mod=KP(t.mod,t.modF),t.modF=null),e&Zv&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&Zv)return fg(n.source,n.srcF,r),n;e&gl&&fg(n.add,n.addF,r),e&Td&&fg(n.rem,n.remF,r),e&Gc&&fg(n.mod,n.modF,r);const i=n.source;if(e&rte&&i){const s=n.add.length+n.mod.length;s===i.length||(s?fg(i,ote(n,nte),r):fg(i,n.srcF,r))}return n}};function Aj(e,t,n,r){const i=this;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(const o of n)if(o.stamp===t){if(o.fields){const a=i.fields||(i.fields={});for(const u in o.fields)a[u]=1}o.changed(i.ADD)&&(s|=i.ADD),o.changed(i.REM)&&(s|=i.REM),o.changed(i.MOD)&&(s|=i.MOD)}this.changes=s}Ame(Aj,rh,{fork(e){const t=new rh(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?Xl(e)?e.some(r=>n[r]):n[e]:0},filter(){ys("MultiPulse does not support filtering.")},materialize(){ys("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let s=0;if(e&n.SOURCE)for(;s<i;++s)r[s].visit(e,t);else for(;s<i;++s)r[s].stamp===n.stamp&&r[s].visit(e,t);return n}});async function zst(e,t,n){const r=this,i=[];if(r._pulse)return l0e(r);if(r._pending&&await r._pending,t&&await sT(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const s=++r._clock;r._pulse=new rh(r,s,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=V3(z3);let o=0,a,u,l;try{for(;r._heap.size()>0;){if(a=r._heap.pop(),a.rank!==a.qrank){r._enqueue(a,!0);continue}u=a.run(r._getPulse(a,e)),u.then?u=await u:u.async&&(i.push(u.async),u=wI),u!==wI&&a._targets&&a._targets.forEach(c=>r._enqueue(c)),++o}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${s}: ${o} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await sT(r,c[f].callback)}return n&&await sT(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function Ust(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function jst(e,t,n){return this._pulse?l0e(this):(this.evaluate(e,t,n),this)}function Wst(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function l0e(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function Vst(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function qst(e,t){const n=e.source,r=this._clock;return n&&Xl(n)?new Aj(this,r,n.map(i=>i.pulse),t):this._input[e.id]||Gst(this._pulse,n&&n.pulse)}function Gst(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==wI&&(e.source=t.source),e)}const _j={skip:!1,force:!1};function Hst(e,t){const n=t||_j;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function Xst(e,t,n){const r=n||_j;return(e.set(t)||r.force)&&this.touch(e,r),this}function Yst(e,t,n){this.touch(e,n||_j);const r=new rh(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function Kst(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),c0e(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,Qst(t,0,e)):r=n,r}}}function c0e(e,t,n,r){let i,s;const o=e[n];for(;n>t;){if(s=n-1>>1,i=e[s],r(o,i)<0){e[n]=i,n=s;continue}break}return e[n]=o}function Qst(e,t,n){const r=t,i=e.length,s=e[t];let o=(t<<1)+1,a;for(;o<i;)a=o+1,a<i&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=s,c0e(e,r,t,n)}function X1(){this.logger(Gnt()),this.logLevel(Eme),this._clock=0,this._rank=0,this._locale=Git();try{this._loader=mst()}catch{}this._touched=V3(z3),this._input={},this._pulse=null,this._heap=Kst((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Jv(e){return function(){return this._log[e].apply(this,arguments)}}X1.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Jv("error"),warn:Jv("warn"),info:Jv("info"),debug:Jv("debug"),logLevel:Jv("level"),cleanThreshold:1e4,add:Cst,connect:Sst,rank:Lst,rerank:Pst,pulse:Yst,touch:Hst,update:Xst,changeset:t0,ingest:_st,parse:Ast,preload:Ist,request:Tst,events:Est,on:Fst,evaluate:zst,run:jst,runAsync:Ust,runAfter:Wst,_enqueue:Vst,_getPulse:qst};function xe(e,t){Nn.call(this,e,null,t)}Ame(xe,Nn,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const my={};function f0e(e){const t=d0e(e);return t&&t.Definition||null}function d0e(e){return e=e&&e.toLowerCase(),yj(my,e)?my[e]:null}function $b(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function WS(e){let t=e,n=e;e.length===1&&(t=(o,a)=>e(o)-a,n=Zst(e));function r(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)<0?u=c+1:l=c}return u}function i(o,a,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],a)>0?l=c:u=c+1}return u}function s(o,a,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,a,u,l-1);return c>u&&t(o[c-1],a)>-t(o[c],a)?c-1:c}return{left:r,center:s,right:i}}function Zst(e){return(t,n)=>$b(e(t),n)}function h0e(e){return e===null?NaN:+e}function*Jst(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const p0e=WS($b),Ah=p0e.right,eot=p0e.left;WS(h0e).center;function tot(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,s+=r*(o-i));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,s+=r*(a-i))}if(n>1)return s/(n-1)}function not(e,t){const n=tot(e,t);return n&&Math.sqrt(n)}class Vs{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[r++]=a),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}function rot(e,t){return Array.from(t,n=>e[n])}var nz=Math.sqrt(50),rz=Math.sqrt(10),iz=Math.sqrt(2);function sz(e,t,n){var r,i=-1,s,o,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(s=e,e=t,t=s),(a=g0e(e,t,n))===0||!isFinite(a))return[];if(a>0){let u=Math.round(e/a),l=Math.round(t/a);for(u*a<e&&++u,l*a>t&&--l,o=new Array(s=l-u+1);++i<s;)o[i]=(u+i)*a}else{a=-a;let u=Math.round(e*a),l=Math.round(t*a);for(u/a<e&&++u,l/a>t&&--l,o=new Array(s=l-u+1);++i<s;)o[i]=(u+i)/a}return r&&o.reverse(),o}function g0e(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=nz?10:s>=rz?5:s>=iz?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=nz?10:s>=rz?5:s>=iz?2:1)}function _h(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=nz?i*=10:s>=rz?i*=5:s>=iz&&(i*=2),t<e?-i:i}function zg(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function oz(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function m0e(e,t,n=0,r=e.length-1,i=$b){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));m0e(e,t,h,p,i)}const s=e[t];let o=n,a=r;for(e2(e,n,t),i(e[r],s)>0&&e2(e,n,r);o<a;){for(e2(e,o,a),++o,--a;i(e[o],s)<0;)++o;for(;i(e[a],s)>0;)--a}i(e[n],s)===0?e2(e,n,a):(++a,e2(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function e2(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function az(e,t,n){if(e=Float64Array.from(Jst(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return oz(e);if(t>=1)return zg(e);var r,i=(r-1)*t,s=Math.floor(i),o=zg(m0e(e,s).subarray(0,s+1)),a=oz(e.subarray(s+1));return o+(a-o)*(i-s)}}function y0e(e,t,n=h0e){if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(i-s)}}function iot(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function x0e(e,t){return az(e,.5,t)}function*sot(e){for(const t of e)yield*t}function b0e(e){return Array.from(sot(e))}function ta(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function v0e(e,t){let n=0;for(let r of e)(r=+r)&&(n+=r);return n}function*w0e(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function Tj(e,t,n){const r=Float64Array.from(w0e(e,n));return r.sort($b),t.map(i=>y0e(r,i))}function Ij(e,t){return Tj(e,[.25,.5,.75],t)}function Nj(e,t){const n=e.length,r=not(e,t),i=Ij(e,t),s=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function $0e(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let s=e.extent[0],o=e.extent[1],a,u,l,c,f,d;const h=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=i.length;f<d;++f)c=a/i[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const p=c>=0?0:~~(-c/r)+1,m=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/a+m)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var Uu=Math.random;function oot(e){Uu=e}function C0e(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(w0e(e,r)),s=i.length,o=t;let a,u,l,c;for(l=0,c=Array(o);l<o;++l){for(a=0,u=0;u<s;++u)a+=i[~~(Uu()*s)];c[l]=a/s}return c.sort($b),[az(c,n/2),az(c,1-n/2)]}function S0e(e,t,n,r){r=r||(d=>d);const i=e.length,s=new Float64Array(i);let o=0,a=1,u=r(e[0]),l=u,c=u+t,f;for(;a<i;++a){if(f=r(e[a]),f>=c){for(l=(u+l)/2;o<a;++o)s[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<a;++o)s[o]=l;return n?aot(s,t+t/4):s}function aot(e,t){const n=e.length;let r=0,i=1,s,o;for(;e[r]===e[i];)++i;for(;i<n;){for(s=i+1;e[i]===e[s];)++s;if(e[i]-e[i-1]<t){for(o=i+(r+s-i-i>>1);o<i;)e[o++]=e[i];for(;o>i;)e[o--]=e[r]}r=i,i=s}return e}function uot(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function lot(e,t){t==null&&(t=e,e=0);let n,r,i;const s={min(o){return arguments.length?(n=o||0,i=r-n,s):n},max(o){return arguments.length?(r=o||0,i=r-n,s):r},sample(){return n+Math.floor(i*Uu())},pdf(o){return o===Math.floor(o)&&o>=n&&o<r?1/i:0},cdf(o){const a=Math.floor(o);return a<n?0:a>=r?1:(a-n+1)/i},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*i):NaN}};return s.min(e).max(t)}const k0e=Math.sqrt(2*Math.PI),cot=Math.SQRT2;let t2=NaN;function Y3(e,t){e=e||0,t=t??1;let n=0,r=0,i,s;if(t2===t2)n=t2,t2=NaN;else{do n=Uu()*2-1,r=Uu()*2-1,i=n*n+r*r;while(i===0||i>1);s=Math.sqrt(-2*Math.log(i)/i),n*=s,t2=r*s}return e+n*t}function Dj(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*k0e)}function K3(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let s;if(i>37)s=0;else{const o=Math.exp(-i*i/2);let a;i<7.07106781186547?(a=.0352624965998911*i+.700383064443688,a=a*i+6.37396220353165,a=a*i+33.912866078383,a=a*i+112.079291497871,a=a*i+221.213596169931,a=a*i+220.206867912376,s=o*a,a=.0883883476483184*i+1.75566716318264,a=a*i+16.064177579207,a=a*i+86.7807322029461,a=a*i+296.564248779674,a=a*i+637.333633378831,a=a*i+793.826512519948,a=a*i+440.413735824752,s=s/a):(a=i+.65,a=i+4/a,a=i+3/a,a=i+2/a,a=i+1/a,s=o/a/2.506628274631)}return r>0?1-s:s}function Q3(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*cot*fot(2*e-1)}function fot(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function Fj(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s??1,i):r},sample:()=>Y3(n,r),pdf:s=>Dj(s,n,r),cdf:s=>K3(s,n,r),icdf:s=>Q3(s,n,r)};return i.mean(e).stdev(t)}function Rj(e,t){const n=Fj();let r=0;const i={data(s){return arguments.length?(e=s,r=s?s.length:0,i.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=Nj(e)),i):t},sample(){return e[~~(Uu()*r)]+t*n.sample()},pdf(s){let o=0,a=0;for(;a<r;++a)o+=n.pdf((s-e[a])/t);return o/t/r},cdf(s){let o=0,a=0;for(;a<r;++a)o+=n.cdf((s-e[a])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function Oj(e,t){return e=e||0,t=t??1,Math.exp(e+Y3()*t)}function Mj(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*k0e*e)}function Lj(e,t,n){return K3(Math.log(e),t,n)}function Pj(e,t,n){return Math.exp(Q3(e,t,n))}function E0e(e,t){let n,r;const i={mean(s){return arguments.length?(n=s||0,i):n},stdev(s){return arguments.length?(r=s??1,i):r},sample:()=>Oj(n,r),pdf:s=>Mj(s,n,r),cdf:s=>Lj(s,n,r),icdf:s=>Pj(s,n,r)};return i.mean(e).stdev(t)}function A0e(e,t){let n=0,r;function i(o){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)a[l]/=u;return a}const s={weights(o){return arguments.length?(r=i(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=Uu();let a=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(o<u){a=e[l];break}return a.sample()},pdf(o){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].pdf(o);return a},cdf(o){let a=0,u=0;for(;u<n;++u)a+=r[u]*e[u].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function Bj(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Uu()}function zj(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function Uj(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function jj(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function _0e(e,t){let n,r;const i={min(s){return arguments.length?(n=s||0,i):n},max(s){return arguments.length?(r=s??1,i):r},sample:()=>Bj(n,r),pdf:s=>zj(s,n,r),cdf:s=>Uj(s,n,r),icdf:s=>jj(s,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function VS(e,t,n,r){const i=r-e*e,s=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-s*e,s]}function Z3(e,t,n,r){e=e.filter(h=>{let p=t(h),m=n(h);return p!=null&&(p=+p)>=p&&m!=null&&(m=+m)>=m}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,s=new Float64Array(i),o=new Float64Array(i);let a=0,u=0,l=0,c,f,d;for(d of e)s[a]=c=+t(d),o[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<i;++a)s[a]-=u,o[a]-=l;return[s,o,u,l]}function qS(e,t,n,r){let i=-1,s,o;for(const a of e)s=t(a),o=n(a),s!=null&&(s=+s)>=s&&o!=null&&(o=+o)>=o&&r(s,o,++i)}function Cb(e,t,n,r,i){let s=0,o=0;return qS(e,t,n,(a,u)=>{const l=u-i(a),c=u-r;s+=l*l,o+=c*c}),1-s/o}function Wj(e,t,n){let r=0,i=0,s=0,o=0,a=0;qS(e,t,n,(c,f)=>{++a,r+=(c-r)/a,i+=(f-i)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=VS(r,i,s,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Cb(e,t,n,i,l)}}function T0e(e,t,n){let r=0,i=0,s=0,o=0,a=0;qS(e,t,n,(c,f)=>{++a,c=Math.log(c),r+=(c-r)/a,i+=(f-i)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=VS(r,i,s,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Cb(e,t,n,i,l)}}function I0e(e,t,n){const[r,i,s,o]=Z3(e,t,n);let a=0,u=0,l=0,c=0,f=0,d,h,p;qS(e,t,n,(v,$)=>{d=r[f++],h=Math.log($),p=d*$,a+=($*h-a)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[m,x]=VS(u/o,a/o,l/o,c/o),b=v=>Math.exp(m+x*(v-s));return{coef:[Math.exp(m-x*s),x],predict:b,rSquared:Cb(e,t,n,o,b)}}function N0e(e,t,n){let r=0,i=0,s=0,o=0,a=0,u=0;qS(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,s+=(h*p-s)/u,o+=(h*h-o)/u,a+=(d-a)/u});const l=VS(r,i,s,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Cb(e,t,n,a,c)}}function Vj(e,t,n){const[r,i,s,o]=Z3(e,t,n),a=r.length;let u=0,l=0,c=0,f=0,d=0,h,p,m,x;for(h=0;h<a;)p=r[h],m=i[h++],x=p*p,u+=(x-u)/h,l+=(x*p-l)/h,c+=(x*x-c)/h,f+=(p*m-f)/h,d+=(x*m-d)/h;const b=c-u*u,v=u*b-l*l,$=(d*u-f*l)/v,C=(f*b-d*l)/v,S=-$*u,A=E=>(E=E-s,$*E*E+C*E+S+o);return{coef:[S-C*s+$*s*s+o,C-2*$*s,$],predict:A,rSquared:Cb(e,t,n,o,A)}}function D0e(e,t,n,r){if(r===1)return Wj(e,t,n);if(r===2)return Vj(e,t,n);const[i,s,o,a]=Z3(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,m,x;for(d=0;d<f;++d){for(p=0,m=0;p<u;++p)m+=Math.pow(i[p],d)*s[p];for(l.push(m),x=new Float64Array(f),h=0;h<f;++h){for(p=0,m=0;p<u;++p)m+=Math.pow(i[p],d+h);x[h]=m}c.push(x)}c.push(l);const b=hot(c),v=$=>{$-=o;let C=a+b[0]+b[1]*$+b[2]*$*$;for(d=3;d<f;++d)C+=b[d]*Math.pow($,d);return C};return{coef:dot(f,b,-o,a),predict:v,rSquared:Cb(e,t,n,a,v)}}function dot(e,t,n,r){const i=Array(e);let s,o,a,u;for(s=0;s<e;++s)i[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],u=1,i[s]+=a,o=1;o<=s;++o)u*=(s+1-o)/o,i[s-o]+=a*Math.pow(n,o)*u;return i[0]+=r,i}function hot(e){const t=e.length-1,n=[];let r,i,s,o,a;for(r=0;r<t;++r){for(o=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][o])&&(o=i);for(s=r;s<t+1;++s)a=e[s][r],e[s][r]=e[s][o],e[s][o]=a;for(i=r+1;i<t;++i)for(s=t;s>=r;s--)e[s][i]-=e[s][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(a=0,s=i+1;s<t;++s)a+=e[s][i]*n[s];n[i]=(e[t][i]-a)/e[i][i]}return n}const ate=2,ute=1e-12;function F0e(e,t,n,r){const[i,s,o,a]=Z3(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=ate;){const p=[0,l-1];for(let x=0;x<u;++x){const b=i[x],v=p[0],$=p[1],C=b-i[v]>i[$]-b?v:$;let S=0,A=0,E=0,_=0,D=0;const N=1/Math.abs(i[C]-b||1);for(let O=v;O<=$;++O){const M=i[O],R=s[O],P=pot(Math.abs(b-M)*N)*d[O],j=M*P;S+=P,A+=j,E+=R*P,_+=R*j,D+=M*j}const[T,L]=VS(A/S,E/S,_/S,D/S);c[x]=T+L*b,f[x]=Math.abs(s[x]-c[x]),got(i,x+1,p)}if(h===ate)break;const m=x0e(f);if(Math.abs(m)<ute)break;for(let x=0,b,v;x<u;++x)b=f[x]/(6*m),d[x]=b>=1?ute:(v=1-b*b)*v}return mot(i,c,o,a)}function pot(e){return(e=1-e*e*e)*e*e}function got(e,t,n){const r=e[t];let i=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>i&&e[s]-r<=r-e[i];)n[0]=++i,n[1]=s,++s}function mot(e,t,n,r){const i=e.length,s=[];let o=0,a=0,u=[],l;for(;o<i;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++a:(a=0,u[1]+=r,u=[l,t[o]],s.push(u));return u[1]+=r,s}const yot=.5*Math.PI/180;function J3(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=m=>[m,e(m)],s=t[0],o=t[1],a=o-s,u=a/r,l=[i(s)],c=[];if(n===r){for(let m=1;m<r;++m)l.push(i(s+m/n*a));return l.push(i(o)),l}else{c.push(i(o));for(let m=n;--m>0;)c.push(i(s+m/n*a))}let f=l[0],d=c[c.length-1];const h=1/a,p=xot(f[1],c);for(;d;){const m=i((f[0]+d[0])/2);m[0]-f[0]>=u&&bot(f,m,d,h,p)>yot?c.push(m):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function xot(e,t){let n=e,r=e;const i=t.length;for(let s=0;s<i;++s){const o=t[s][1];o<n&&(n=o),o>r&&(r=o)}return 1/(r-n)}function bot(e,t,n,r,i){const s=Math.atan2(i*(n[1]-e[1]),r*(n[0]-e[0])),o=Math.atan2(i*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(s-o)}var QP=new Date,ZP=new Date;function _i(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=function(s){return e(s=new Date(+s)),s},i.ceil=function(s){return e(s=new Date(s-1)),t(s,1),e(s),s},i.round=function(s){var o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=function(s,o){return t(s=new Date(+s),o==null?1:Math.floor(o)),s},i.range=function(s,o,a){var u=[],l;if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},i.filter=function(s){return _i(function(o){if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););})},n&&(i.count=function(s,o){return QP.setTime(+s),ZP.setTime(+o),e(QP),e(ZP),Math.floor(n(QP,ZP))},i.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?function(o){return r(o)%s===0}:function(o){return i.count(0,o)%s===0}):i}),i}var yy=_i(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});yy.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?_i(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):yy};yy.range;const sf=1e3,Ta=sf*60,of=Ta*60,hm=of*24,qj=hm*7,lte=hm*30,JP=hm*365;var af=_i(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*sf)},function(e,t){return(t-e)/sf},function(e){return e.getUTCSeconds()});af.range;var eR=_i(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*sf)},function(e,t){e.setTime(+e+t*Ta)},function(e,t){return(t-e)/Ta},function(e){return e.getMinutes()});eR.range;var tR=_i(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*sf-e.getMinutes()*Ta)},function(e,t){e.setTime(+e+t*of)},function(e,t){return(t-e)/of},function(e){return e.getHours()});tR.range;var yf=_i(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ta)/hm,e=>e.getDate()-1);yf.range;function n0(e){return _i(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ta)/qj})}var Sb=n0(0),$I=n0(1),vot=n0(2),wot=n0(3),xy=n0(4),$ot=n0(5),Cot=n0(6);Sb.range;$I.range;vot.range;wot.range;xy.range;$ot.range;Cot.range;var m$=_i(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()});m$.range;var Yl=_i(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Yl.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:_i(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};Yl.range;var nR=_i(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Ta)},function(e,t){return(t-e)/Ta},function(e){return e.getUTCMinutes()});nR.range;var rR=_i(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*of)},function(e,t){return(t-e)/of},function(e){return e.getUTCHours()});rR.range;var xf=_i(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/hm},function(e){return e.getUTCDate()-1});xf.range;function r0(e){return _i(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/qj})}var kb=r0(0),CI=r0(1),Sot=r0(2),kot=r0(3),by=r0(4),Eot=r0(5),Aot=r0(6);kb.range;CI.range;Sot.range;kot.range;by.range;Eot.range;Aot.range;var y$=_i(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()});y$.range;var Kl=_i(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Kl.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:_i(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};Kl.range;function R0e(e,t,n,r,i,s){const o=[[af,1,sf],[af,5,5*sf],[af,15,15*sf],[af,30,30*sf],[s,1,Ta],[s,5,5*Ta],[s,15,15*Ta],[s,30,30*Ta],[i,1,of],[i,3,3*of],[i,6,6*of],[i,12,12*of],[r,1,hm],[r,2,2*hm],[n,1,qj],[t,1,lte],[t,3,3*lte],[e,1,JP]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=WS(([,,x])=>x).right(o,d);if(h===o.length)return e.every(_h(l/JP,c/JP,f));if(h===0)return yy.every(Math.max(_h(l,c,f),1));const[p,m]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(m)}return[a,u]}const[_ot,Tot]=R0e(Kl,y$,kb,xf,rR,nR),[Iot,Not]=R0e(Yl,m$,Sb,yf,tR,eR),Vi="year",Do="quarter",xs="month",Hr="week",Fo="date",fs="day",Ql="dayofyear",oa="hours",aa="minutes",ja="seconds",ju="milliseconds",Gj=[Vi,Do,xs,Hr,Fo,fs,Ql,oa,aa,ja,ju],eB=Gj.reduce((e,t,n)=>(e[t]=1+n,e),{});function Hj(e){const t=It(e).slice(),n={};return t.length||ke("Missing time unit."),t.forEach(i=>{Nt(eB,i)?n[i]=1:ke("Invalid time unit: ".concat(i,"."))}),(n[Hr]||n[fs]?1:0)+(n[Do]||n[xs]||n[Fo]?1:0)+(n[Ql]?1:0)>1&&ke("Incompatible time units: ".concat(e)),t.sort((i,s)=>eB[i]-eB[s]),t}const Dot={[Vi]:"%Y ",[Do]:"Q%q ",[xs]:"%b ",[Fo]:"%d ",[Hr]:"W%U ",[fs]:"%a ",[Ql]:"%j ",[oa]:"%H:00",[aa]:"00:%M",[ja]:":%S",[ju]:".%L",["".concat(Vi,"-").concat(xs)]:"%Y-%m ",["".concat(Vi,"-").concat(xs,"-").concat(Fo)]:"%Y-%m-%d ",["".concat(oa,"-").concat(aa)]:"%H:%M"};function O0e(e,t){const n=qt({},Dot,t),r=Hj(e),i=r.length;let s="",o=0,a,u;for(o=0;o<i;)for(a=r.length;a>o;--a)if(u=r.slice(o,a).join("-"),n[u]!=null){s+=n[u],o=a;break}return s.trim()}const xg=new Date;function Xj(e){return xg.setFullYear(e),xg.setMonth(0),xg.setDate(1),xg.setHours(0,0,0,0),xg}function M0e(e){return P0e(new Date(e))}function L0e(e){return uz(new Date(e))}function P0e(e){return yf.count(Xj(e.getFullYear())-1,e)}function uz(e){return Sb.count(Xj(e.getFullYear())-1,e)}function lz(e){return Xj(e).getDay()}function Fot(e,t,n,r,i,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,r,i,s,o);return a.setFullYear(e),a}return new Date(e,t,n,r,i,s,o)}function B0e(e){return U0e(new Date(e))}function z0e(e){return cz(new Date(e))}function U0e(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return xf.count(t-1,e)}function cz(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return kb.count(t-1,e)}function fz(e){return xg.setTime(Date.UTC(e,0,1)),xg.getUTCDay()}function Rot(e,t,n,r,i,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,r,i,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,r,i,s,o))}function j0e(e,t,n,r,i){const s=t||1,o=An(e),a=(b,v,$)=>($=$||b,Oot(n[$],r[$],b===o&&s,v)),u=new Date,l=Tf(e),c=l[Vi]?a(Vi):Ua(2012),f=l[xs]?a(xs):l[Do]?a(Do):Rd,d=l[Hr]&&l[fs]?a(fs,1,Hr+fs):l[Hr]?a(Hr,1):l[fs]?a(fs,1):l[Fo]?a(Fo,1):l[Ql]?a(Ql,1):yb,h=l[oa]?a(oa):Rd,p=l[aa]?a(aa):Rd,m=l[ja]?a(ja):Rd,x=l[ju]?a(ju):Rd;return function(b){u.setTime(+b);const v=c(u);return i(v,f(u),d(u,v),h(u),p(u),m(u),x(u))}}function Oot(e,t,n,r){const i=n<=1?e:r?(s,o)=>r+n*Math.floor((e(s,o)-r)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(i(s,o),o):i}function vy(e,t,n){return t+e*7-(n+6)%7}const Mot={[Vi]:e=>e.getFullYear(),[Do]:e=>Math.floor(e.getMonth()/3),[xs]:e=>e.getMonth(),[Fo]:e=>e.getDate(),[oa]:e=>e.getHours(),[aa]:e=>e.getMinutes(),[ja]:e=>e.getSeconds(),[ju]:e=>e.getMilliseconds(),[Ql]:e=>P0e(e),[Hr]:e=>uz(e),[Hr+fs]:(e,t)=>vy(uz(e),e.getDay(),lz(t)),[fs]:(e,t)=>vy(1,e.getDay(),lz(t))},Lot={[Do]:e=>3*e,[Hr]:(e,t)=>vy(e,0,lz(t))};function W0e(e,t){return j0e(e,t||1,Mot,Lot,Fot)}const Pot={[Vi]:e=>e.getUTCFullYear(),[Do]:e=>Math.floor(e.getUTCMonth()/3),[xs]:e=>e.getUTCMonth(),[Fo]:e=>e.getUTCDate(),[oa]:e=>e.getUTCHours(),[aa]:e=>e.getUTCMinutes(),[ja]:e=>e.getUTCSeconds(),[ju]:e=>e.getUTCMilliseconds(),[Ql]:e=>U0e(e),[Hr]:e=>cz(e),[fs]:(e,t)=>vy(1,e.getUTCDay(),fz(t)),[Hr+fs]:(e,t)=>vy(cz(e),e.getUTCDay(),fz(t))},Bot={[Do]:e=>3*e,[Hr]:(e,t)=>vy(e,0,fz(t))};function V0e(e,t){return j0e(e,t||1,Pot,Bot,Rot)}const zot={[Vi]:Yl,[Do]:m$.every(3),[xs]:m$,[Hr]:Sb,[Fo]:yf,[fs]:yf,[Ql]:yf,[oa]:tR,[aa]:eR,[ja]:af,[ju]:yy},Uot={[Vi]:Kl,[Do]:y$.every(3),[xs]:y$,[Hr]:kb,[Fo]:xf,[fs]:xf,[Ql]:xf,[oa]:rR,[aa]:nR,[ja]:af,[ju]:yy};function Eb(e){return zot[e]}function Ab(e){return Uot[e]}function q0e(e,t,n){return e?e.offset(t,n):void 0}function G0e(e,t,n){return q0e(Eb(e),t,n)}function H0e(e,t,n){return q0e(Ab(e),t,n)}function X0e(e,t,n,r){return e?e.range(t,n,r):void 0}function Y0e(e,t,n,r){return X0e(Eb(e),t,n,r)}function K0e(e,t,n,r){return X0e(Ab(e),t,n,r)}const B2=1e3,z2=B2*60,U2=z2*60,iR=U2*24,jot=iR*7,cte=iR*30,dz=iR*365,Q0e=[Vi,xs,Fo,oa,aa,ja,ju],j2=Q0e.slice(0,-1),W2=j2.slice(0,-1),V2=W2.slice(0,-1),Wot=V2.slice(0,-1),Vot=[Vi,Hr],fte=[Vi,xs],Z0e=[Vi],n2=[[j2,1,B2],[j2,5,5*B2],[j2,15,15*B2],[j2,30,30*B2],[W2,1,z2],[W2,5,5*z2],[W2,15,15*z2],[W2,30,30*z2],[V2,1,U2],[V2,3,3*U2],[V2,6,6*U2],[V2,12,12*U2],[Wot,1,iR],[Vot,1,jot],[fte,1,cte],[fte,3,3*cte],[Z0e,1,dz]];function J0e(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(B3(t))/n;let i=WS(a=>a[2]).right(n2,r),s,o;return i===n2.length?(s=Z0e,o=_h(t[0]/dz,t[1]/dz,n)):i?(i=n2[r/n2[i-1][2]<n2[i][2]/r?i-1:i],s=i[0],o=i[1]):(s=Q0e,o=Math.max(_h(t[0],t[1],n),1)),{units:s,step:o}}function qot(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function hz(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:qot(e)}function e1e(e,t,n){return n||e+(t?"_"+t:"")}const tB=()=>{},Got={init:tB,add:tB,rem:tB,idx:0},x$={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},GS=Object.keys(x$);function Hot(e,t){return n=>qt({name:e,out:n||e},Got,t)}GS.forEach(e=>{x$[e]=Hot(e,x$[e])});function t1e(e,t){return x$[e](t)}function n1e(e,t){return e.idx-t.idx}function Xot(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{r.req&&r.req.forEach(i=>{t[i]||n(t[i]=x$[i]())})};return e.forEach(n),Object.values(t).sort(n1e)}function Yot(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function Kot(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function Qot(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function Zot(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function r1e(e,t){const n=t||za,r=Xot(e),i=e.slice().sort(n1e);function s(o){this._ops=r,this._out=i,this.cell=o,this.init()}return s.prototype.init=Yot,s.prototype.add=Kot,s.prototype.rem=Qot,s.prototype.set=Zot,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function Yj(e){this._key=e?wh(e):dt,this.reset()}const Xi=Yj.prototype;Xi.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Xi.add=function(e){this._add.push(e)};Xi.rem=function(e){this._rem.push(e)};Xi.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,s=Array(r-i),o={};let a,u,l;for(a=0;a<i;++a)o[n(t[a])]=1;for(a=0,u=0;a<r;++a)o[n(l=e[a])]?o[n(l)]=0:s[u++]=l;return this._rem=[],this._add=s};Xi.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,s;for(;--r>=0;)s=e(t[r])+"",Nt(n,s)||(n[s]=1,++i);return i};Xi.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=mme(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Xi.argmin=function(e){return this.extent(e)[0]||{}};Xi.argmax=function(e){return this.extent(e)[1]||{}};Xi.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Xi.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Xi.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Ij(this.values(),e),this._get=e),this._q};Xi.q1=function(e){return this.quartile(e)[0]};Xi.q2=function(e){return this.quartile(e)[1]};Xi.q3=function(e){return this.quartile(e)[2]};Xi.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=C0e(this.values(),1e3,.05,e),this._get=e),this._ci};Xi.ci0=function(e){return this.ci(e)[0]};Xi.ci1=function(e){return this.ci(e)[1]};function Th(e){xe.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Th.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:GS},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};ze(Th,xe,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function s(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}s(e._prev),s(t);function o(a,u,l){const c=n[l],f=r[l++];for(const d in f){const h=a?a+"|"+d:d;u[c]=f[d],l<i?o(h,u,l):t[h]||e.cell(h,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(x){const b=It(ms(x)),v=b.length;let $=0,C;for(;$<v;++$)r[C=b[$]]||(r[C]=1,t.push(C))}this._dims=It(e.groupby),this._dnames=this._dims.map(x=>{const b=gr(x);return i(x),n.push(b),b}),this.cellkey=e.key?e.key:hz(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.as||[],u=s.length,l={};let c,f,d,h,p,m;for(u!==o.length&&ke("Unmatched number of fields and aggregate ops."),m=0;m<u;++m){if(c=s[m],f=o[m],c==null&&f!=="count"&&ke("Null aggregate field specified."),h=gr(c),p=e1e(f,h,a[m]),n.push(p),f==="count"){this._counts.push(p);continue}d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(t1e(f,p))}return this._measures=this._measures.map(x=>r1e(x,x.field)),{}},cellkey:hz(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let s=0;s<i;++s)n.agg[s]=new r[s](n)}return n.store&&(n.data=new Yj),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,s={};for(let o=0;o<i;++o)s[n[o]]=r[o](e);return t?a0e(t.tuple,s):dn(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,s=r.length;i<s;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,s=r.length;i<s;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,s=r.length;i<s;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,s=e.add,o=e.rem,a=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?o:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const Jot=1e-14;function Kj(e){xe.call(this,null,e)}Kj.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};ze(Kj,xe,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,s=r.step,o=e.as||["bin0","bin1"],a=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(ms(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[a]=f,c[u]=f==null?null:i+s*(1+(f-i)/s)}:c=>c[a]=r(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=$0e(e),r=n.step;let i=n.start,s=i+Math.ceil((n.stop-i)/r)*r,o,a;(o=e.anchor)!=null&&(a=o-(i+r*Math.floor((o-i)/r)),i+=a,s+=a);const u=function(l){let c=$h(t(l));return c==null?null:c<i?-1/0:c>s?1/0:(c=Math.max(i,Math.min(c,s-r)),i+r*Math.floor(Jot+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=Qa(u,ms(t),e.name||"bin_"+gr(t))}});function i1e(e,t,n){const r=e;let i=t||[],s=n||[],o={},a=0;return{add:u=>s.push(u),remove:u=>o[r(u)]=++a,size:()=>i.length,data:(u,l)=>(a&&(i=i.filter(c=>!o[r(c)]),o={},a=0),l&&u&&i.sort(u),s.length&&(i=u?wme(u,i,s.sort(u)):i.concat(s),s=[]),i)}}function Qj(e){xe.call(this,[],e)}Qj.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};ze(Qj,xe,{transform(e,t){const n=t.fork(t.ALL),r=i1e(dt,this.value,n.materialize(n.ADD).add),i=e.sort,s=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(s),this.value=n.source=r.data(e0(i),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function s1e(e){Nn.call(this,null,eat,e)}ze(s1e,Nn);function eat(e){return this.value&&!e.modified()?this.value:pme(e.fields,e.orders)}function Zj(e){xe.call(this,null,e)}Zj.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function tat(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}ze(Zj,xe,{transform(e,t){const n=f=>d=>{for(var h=tat(a(d),e.case,s)||[],p,m=0,x=h.length;m<x;++m)o.test(p=h[m])||f(p)},r=this._parameterCheck(e,t),i=this._counts,s=this._match,o=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=r[a],l=n[a]||0,!u&&l?(r[a]=u=dn({}),u[i]=a,u[s]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[a]=null,r[a]=null):u[s]!==l&&(u[s]=l,o.mod.push(u));return o.modifies(t)}});function Jj(e){xe.call(this,null,e)}Jj.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};ze(Jj,xe,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],s=r[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=nat(a,i,s,e.filter||xb)):n.mod=a,n.source=this.value,n.modifies(r)}});function nat(e,t,n,r){for(var i=[],s={},o=e.length,a=0,u,l;a<o;++a)for(s[t]=l=e[a],u=0;u<o;++u)s[n]=e[u],r(s)&&(i.push(dn(s)),s={},s[t]=l);return i}const dte={kde:Rj,mixture:A0e,normal:Fj,lognormal:E0e,uniform:_0e},rat="distributions",hte="function",iat="field";function o1e(e,t){const n=e[hte];Nt(dte,n)||ke("Unknown distribution function: "+n);const r=dte[n]();for(const i in e)i===iat?r.data((e.from||t()).map(e[i])):i===rat?r[i](e[i].map(s=>o1e(s,t))):typeof r[i]===hte&&r[i](e[i]);return r}function eW(e){xe.call(this,null,e)}const a1e=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],sat={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:a1e},{name:"weights",type:"number",array:!0}]};eW.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:a1e.concat(sat)},{name:"as",type:"string",array:!0,default:["value","density"]}]};ze(eW,xe,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=o1e(e.distribution,oat(t)),i=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&ke("Invalid density method: "+o),!e.extent&&!r.data&&ke("Missing density extent parameter."),o=r[o];const a=e.as||["value","density"],u=e.extent||Ch(r.data()),l=J3(o,u,i,s).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],dn(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function oat(e){return()=>e.materialize(e.SOURCE).source}function u1e(e,t){return e?e.map((n,r)=>t[r]||gr(n)):null}function tW(e,t,n){const r=[],i=f=>f(u);let s,o,a,u,l,c;if(t==null)r.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)u=e[o],l=t.map(i),c=s[l],c||(s[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const l1e="bin";function nW(e){xe.call(this,null,e)}nW.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:l1e}]};const aat=(e,t)=>B3(Ch(e,t))/30;ze(nW,xe,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=tW(t.source,e.groupby,za),i=e.smooth||!1,s=e.field,o=e.step||aat(n,s),a=e0((p,m)=>s(p)-s(m)),u=e.as||l1e,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=r[d].sort(a);h=-1;for(const m of S0e(p,o,i,s))m<c&&(c=m),m>f&&(f=m),p[++h][u]=m}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function c1e(e){Nn.call(this,null,uat,e),this.modified(!0)}ze(c1e,Nn);function uat(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Qa(n=>t(n,e),ms(t),gr(t))}function rW(e){xe.call(this,[void 0,void 0],e)}rW.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};ze(rW,xe,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let s=n[0],o=n[1];if((i||s==null)&&(s=1/0,o=-1/0),t.visit(i?t.SOURCE:t.ADD,a=>{const u=$h(r(a));u!=null&&(u<s&&(s=u),u>o&&(o=u))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=gr(r);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${s}, ${o}]`),s=o=void 0}this.value=[s,o]}});function iW(e,t){Nn.call(this,e),this.parent=t,this.count=0}ze(iW,Nn,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function sR(e){xe.call(this,{},e),this._keys=bb();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}ze(sR,xe,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let s=Nt(i,e)&&i[e],o,a;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=r||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new iW(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),i[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,s=this._keys,o=e.modified("key"),a=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=dt(u),c=s.get(l);c!==void 0&&(s.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);s.set(dt(u),l),a(l).add(u)}),o||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=dt(u),c=s.get(l),f=r(u);c===f?a(f).mod(u):(s.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(s.get(dt(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=dt(u),c=s.get(l),f=r(u);c!==f&&(s.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function f1e(e){Nn.call(this,null,lat,e)}ze(f1e,Nn);function lat(e){return this.value&&!e.modified()?this.value:Rt(e.name)?It(e.name).map(t=>wh(t)):wh(e.name,e.as)}function sW(e){xe.call(this,bb(),e)}sW.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};ze(sW,xe,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),s=i.add,o=i.rem,a=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=dt(f);r.has(d)?r.delete(d):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?s.push(f):r.set(dt(f),1)});function c(f){const d=dt(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),s.push(f)):!h&&!p?(r.set(d,1),o.push(f)):l&&h&&!p&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function oW(e){xe.call(this,[],e)}oW.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};ze(oW,xe,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=u1e(r,e.as||[]),s=e.index||null,o=i.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=r.map(p=>p(a)),l=u.reduce((p,m)=>Math.max(p,m.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Ej(a),f=0;f<o;++f)d[i[f]]=(h=u[f][c])==null?null:h;s&&(d[s]=c),n.add.push(d)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(i)}});function aW(e){xe.call(this,[],e)}aW.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};ze(aW,xe,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(gr),s=e.as||["key","value"],o=s[0],a=s[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Ej(l),f[o]=i[c],f[a]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}});function uW(e){xe.call(this,null,e)}uW.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};ze(uW,xe,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),s=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(s,o=>o[r]=n(o,e))}});function d1e(e){xe.call(this,[],e)}ze(d1e,xe,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,s=e.size-i.length,o,a,u;if(s>0){for(o=[];--s>=0;)o.push(u=dn(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=i.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,i=i.slice(-s);return n.source=this.value=i,n}});const NA={value:"value",median:x0e,mean:iot,min:oz,max:zg},cat=[];function lW(e){xe.call(this,[],e)}lW.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function fat(e){var t=e.method||NA.value,n;if(NA[t]==null)ke("Unrecognized imputation method: "+t);else return t===NA.value?(n=e.value!==void 0?e.value:0,()=>n):NA[t]}function dat(e){const t=e.field;return n=>n?t(n):NaN}ze(lW,xe,{transform(e,t){var n=t.fork(t.ALL),r=fat(e),i=dat(e),s=gr(e.field),o=gr(e.key),a=(e.groupby||[]).map(gr),u=hat(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,m,x,b,v,$,C,S;for(x=0,$=u.length;x<$;++x)for(d=u[x],p=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(m=u.domain[v],S={_impute:!0},b=0,C=p.length;b<C;++b)S[a[b]]=p[b];S[o]=m,S[s]=Number.isNaN(h)?h=r(d,i):h,l.push(dn(S))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function hat(e,t,n,r){var i=b=>b(x),s=[],o=r?r.slice():[],a={},u={},l,c,f,d,h,p,m,x;for(o.forEach((b,v)=>a[b]=v+1),d=0,m=e.length;d<m;++d)x=e[d],p=n(x),h=a[p]||(a[p]=o.push(p)),c=(l=t?t.map(i):cat)+"",(f=u[c])||(f=u[c]=[],s.push(f),f.values=l),f[h-1]=x;return s.domain=o,s}function cW(e){Th.call(this,e)}cW.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:GS},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};ze(cW,Th,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(i=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{qt(s,i[n.cellkey(s)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function fW(e){xe.call(this,null,e)}fW.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};ze(fW,xe,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=tW(r,e.groupby,e.field),s=(e.groupby||[]).map(gr),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&ke("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=Ch(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=Rj(h,o)[a],m=e.counts?h.length:1,x=c||Ch(h);J3(p,x,f,d).forEach(b=>{const v={};for(let $=0;$<s.length;++$)v[s[$]]=h.dims[$];v[u[0]]=b[0],v[u[1]]=b[1]*m,l.push(dn(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function h1e(e){Nn.call(this,null,pat,e)}ze(h1e,Nn);function pat(e){return this.value&&!e.modified()?this.value:bme(e.fields,e.flat)}function p1e(e){xe.call(this,[],e),this._pending=null}ze(p1e,xe,{transform(e,t){const n=t.dataflow;return this._pending?nB(this,t,this._pending):gat(e)?t.StopPropagation:e.values?nB(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=It(i.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(r=>nB(this,t,It(r.data)))}});function gat(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function nB(e,t,n){n.forEach(dn);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function dW(e){xe.call(this,{},e)}dW.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};ze(dW,xe,{transform(e,t){const n=e.fields,r=e.index,i=e.values,s=e.default==null?null:e.default,o=e.modified(),a=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,a>1&&!c&&ke('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&ke('The "as" parameter has too few output field names.'),c=c||i.map(gr),f=function(p){for(var m=0,x=0,b,v;m<a;++m)if(v=r.get(n[m](p)),v==null)for(b=0;b<d;++b,++x)p[c[x]]=s;else for(b=0;b<d;++b,++x)p[c[x]]=i[b](v)}):(c||ke("Missing output field names."),f=function(p){for(var m=0,x;m<a;++m)x=r.get(n[m](p)),p[c[m]]=x??s}),o?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function g1e(e){Nn.call(this,null,mat,e)}ze(g1e,Nn);function mat(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,s,o;for(s=0;s<n;++s)o=t[s],o[0]<r&&(r=o[0]),o[1]>i&&(i=o[1]);return[r,i]}function m1e(e){Nn.call(this,null,yat,e)}ze(m1e,Nn);function yat(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function y1e(e){xe.call(this,null,e)}ze(y1e,xe,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function hW(e){Th.call(this,e)}hW.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:GS,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};ze(hW,Th,{_transform:Th.prototype.transform,transform(e,t){return this._transform(xat(e,t),t)}});function xat(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",s=ms(n).concat(ms(r)),o=vat(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>i),fields:o.map(a=>bat(a,n,r,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}function bat(e,t,n,r){return Qa(i=>t(i)===e?n(i):NaN,r,e+"")}function vat(e,t,n){const r={},i=[];return n.visit(n.SOURCE,s=>{const o=e(s);r[o]||(r[o]=1,i.push(o))}),i.sort(L3),t?i.slice(0,t):i}function x1e(e){sR.call(this,e)}ze(x1e,sR,{transform(e,t){const n=e.subflow,r=e.field,i=s=>this.subflow(dt(s),n,t,s);return(e.modified("field")||r&&t.modified(ms(r)))&&ke("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,s=>{const o=i(s);r(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=i(s);r(s).forEach(a=>o.add(dn(a)))}),t.visit(t.REM,s=>{const o=i(s);r(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>i(s).mod(s)),t.visit(t.ADD,s=>i(s).add(s)),t.visit(t.REM,s=>i(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function pW(e){xe.call(this,null,e)}pW.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};ze(pW,xe,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=u1e(e.fields,e.as||[]),s=r?(a,u)=>wat(a,u,r,i):G3;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const u=dt(a);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,a=>{const u=s(a,dn({}));o[dt(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[dt(a)]))}),n}});function wat(e,t,n,r){for(let i=0,s=n.length;i<s;++i)t[r[i]]=n[i](e);return t}function b1e(e){xe.call(this,null,e)}ze(b1e,xe,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function gW(e){xe.call(this,null,e)}gW.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const $at=1e-14;ze(gW,xe,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,s=tW(i,e.groupby,e.field),o=(e.groupby||[]).map(gr),a=[],u=e.step||.01,l=e.probs||ta(u/2,1-$at,u),c=l.length;return s.forEach(f=>{const d=Tj(f,l);for(let h=0;h<c;++h){const p={};for(let m=0;m<o.length;++m)p[o[m]]=f.dims[m];p[r[0]]=l[h],p[r[1]]=d[h],a.push(dn(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function v1e(e){xe.call(this,null,e)}ze(v1e,xe,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const s=dt(i);n.rem.push(r[s]),r[s]=null}),t.visit(t.ADD,i=>{const s=Ej(i);r[dt(i)]=s,n.add.push(s)}),t.visit(t.MOD,i=>{const s=r[dt(i)];for(const o in i)s[o]=i[o],n.modifies(o);n.mod.push(s)})),n}});function mW(e){xe.call(this,[],e),this.count=0}mW.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};ze(mW,xe,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,s=this.value.reduce((c,f)=>(c[dt(f)]=1,c),{});let o=this.value,a=this.count,u=0;function l(c){let f,d;o.length<i?o.push(c):(d=~~((a+1)*Uu()),d<o.length&&d>=u&&(f=o[d],s[dt(f)]&&n.rem.push(f),o[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=dt(c);s[f]&&(s[f]=-1,n.rem.push(c)),--a}),o=o.filter(c=>s[dt(c)]!==-1)),(t.rem.length||r)&&o.length<i&&t.source&&(u=a=o.length,t.visit(t.SOURCE,c=>{s[dt(c)]||l(c)}),u=-1),r&&o.length>i){const c=o.length-i;for(let f=0;f<c;++f)s[dt(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[dt(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!s[dt(c)])),this.count=a,this.value=n.source=o,n}});function yW(e){xe.call(this,null,e)}yW.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};ze(yW,xe,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=ta(e.start,e.stop,e.step||1).map(i=>{const s={};return s[r]=i,dn(s)}),n.add=t.add.concat(this.value),n}});function w1e(e){xe.call(this,null,e),this.modified(!0)}ze(w1e,xe,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function xW(e){xe.call(this,null,e)}const $1e=["unit0","unit1"];xW.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Gj,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:$1e}]};ze(xW,xe,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",s=this._floor(e,t),o=(i?Ab:Eb)(s.unit).offset,a=e.as||$1e,u=a[0],l=a[1],c=s.step;let f=s.start||1/0,d=s.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(ms(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const m=n(p);let x,b;m==null?(p[u]=null,r&&(p[l]=null)):(p[u]=x=b=s(m),r&&(p[l]=b=o(x,c)),x<f&&(f=x),b>d&&(d=b))}),s.start=f,s.stop=d,t.modifies(r?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:J0e({extent:e.extent||Ch(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=Hj(r),o=this.value||{},a=(n?V0e:W0e)(s,i);return a.unit=An(s),a.units=s,a.step=i,a.start=o.start,a.stop=o.stop,this.value=a}});function C1e(e){xe.call(this,bb(),e)}ze(C1e,xe,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,s=a=>i.set(r(a),a);let o=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>i.delete(r(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function S1e(e){xe.call(this,null,e)}ze(S1e,xe,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(e0(e.sort)):t.source).map(e.field))}});function Cat(e,t,n,r){const i=b$[e](t,n);return{init:i.init||Rd,update:function(s,o){o[r]=i.next(s)}}}const b$={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=b$.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||ke("ntile num must be greater than zero.");const n=b$.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||ke("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=Sat(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function Sat(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const kat=Object.keys(b$);function k1e(e){const t=It(e.ops),n=It(e.fields),r=It(e.params),i=It(e.as),s=this.outputs=[],o=this.windows=[],a={},u={},l=[],c=[];let f=!0;function d(h){It(ms(h)).forEach(p=>a[p]=1)}d(e.sort),t.forEach((h,p)=>{const m=n[p],x=gr(m),b=e1e(h,x,i[p]);if(d(m),s.push(b),Nt(b$,h))o.push(Cat(h,n[p],r[p],b));else{if(m==null&&h!=="count"&&ke("Null aggregate field specified."),h==="count"){l.push(b);return}f=!1;let v=u[x];v||(v=u[x]=[],v.field=m,c.push(v)),v.push(t1e(h,b))}}),(l.length||c.length)&&(this.cell=Eat(c,l,f)),this.inputs=Object.keys(a)}const E1e=k1e.prototype;E1e.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};E1e.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,s=r&&r.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(i[o]);for(o=e.p1;o<e.i1;++o)n.add(i[o]);n.set(t)}for(o=0;o<s;++o)r[o].update(e,t)};function Eat(e,t,n){e=e.map(u=>r1e(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,s=r.agg=Array(i),o=0;o<i;++o)s[o]=new e[o](r);if(r.store)var a=r.data=new Yj;return r.add=function(u){if(r.num+=1,!n){a&&a.add(u);for(let l=0;l<i;++l)s[l].add(s[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){a&&a.rem(u);for(let l=0;l<i;++l)s[l].rem(s[l].get(u),u)}},r.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=s.length;l<c;++l)s[l].set(u)},r.init=function(){r.num=0,a&&a.reset();for(let u=0;u<i;++u)s[u].init()},r}function bW(e){xe.call(this,{},e),this._mlen=0,this._mods=[]}bW.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:kat.concat(GS)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};ze(bW,xe,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=e0(e.sort),i=hz(e.groupby),s=a=>this.group(i(a));let o=this.state;(!o||n)&&(o=this.state=new k1e(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)Aat(this._mods[a],o,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=i1e(dt),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function Aat(e,t,n,r){const i=r.sort,s=i&&!r.ignorePeers,o=r.frame||[null,0],a=e.data(n),u=a.length,l=s?WS(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||Ua(-1)};t.init();for(let f=0;f<u;++f)_at(c,o,f,u),s&&Tat(c,l),t.update(c,a[f])}function _at(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function Tat(e,t){const n=e.i0,r=e.i1-1,i=e.compare,s=e.data,o=s.length-1;n>0&&!i(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),r<o&&!i(s[r],s[r+1])&&(e.i1=t.right(s,s[r]))}const Iat=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Th,bin:Kj,collect:Qj,compare:s1e,countpattern:Zj,cross:Jj,density:eW,dotbin:nW,expression:c1e,extent:rW,facet:sR,field:f1e,filter:sW,flatten:oW,fold:aW,formula:uW,generate:d1e,impute:lW,joinaggregate:cW,kde:fW,key:h1e,load:p1e,lookup:dW,multiextent:g1e,multivalues:m1e,params:y1e,pivot:hW,prefacet:x1e,project:pW,proxy:b1e,quantile:gW,relay:v1e,sample:mW,sequence:yW,sieve:w1e,subflow:iW,timeunit:xW,tupleindex:C1e,values:S1e,window:bW},Symbol.toStringTag,{value:"Module"}));function _b(e,t,n){return e.fields=t||[],e.fname=n,e}function Nat(e){return e.length===1?Dat(e[0]):Fat(e)}const Dat=e=>function(t){return t[e]},Fat=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function rB(e){throw Error(e)}function Rat(e){const t=[],n=e.length;let r=null,i=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=a+1,r=u):u==="."&&!i?a>o?l():o=a+1:u==="["?(a>o&&l(),i=o=a+1):u==="]"&&(i||rB("Access path missing open bracket: "+e),i>0&&l(),i=0,o=a+1)}return i&&rB("Access path missing closing bracket: "+e),r&&rB("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Oat(e,t,n){const r=Rat(e);return e=r.length===1?r[0]:e,_b(Nat(r),[e],e)}Oat("id");_b(e=>e,[],"identity");_b(()=>0,[],"zero");_b(()=>1,[],"one");const A1e=_b(()=>!0,[],"true");_b(()=>!1,[],"false");var i0=Array.isArray;function Mat(e){return e===Object(e)}function aT(e){return e[e.length-1]}function Lat(e){return e==null||e===""?null:+e}function Pat(e){return e!=null?i0(e)?e:[e]:[]}function _1e(e){return typeof e=="function"}function Bat(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}const zat=Object.prototype.hasOwnProperty;function Od(e,t){return zat.call(e,t)}function s0(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Bat(r,n)}const Uat=1e4;function jat(e){e=+e||Uat;let t,n,r;const i=()=>{t={},n={},r=0},s=(o,a)=>(++r>e&&(n=t,t={},r=1),t[o]=a);return i(),{clear:i,has:o=>Od(t,o)||Od(n,o),get:o=>Od(t,o)?t[o]:Od(n,o)?s(o,n[o]):void 0,set:(o,a)=>Od(t,o)?t[o]=a:s(o,a)}}function T1e(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function gn(e){return function(){return e}}const pte=Math.abs,Ji=Math.atan2,Hp=Math.cos,Wat=Math.max,iB=Math.min,fl=Math.sin,_g=Math.sqrt,ts=1e-12,wy=Math.PI,SI=wy/2,I1e=2*wy;function Vat(e){return e>1?0:e<-1?wy:Math.acos(e)}function gte(e){return e>=1?SI:e<=-1?-SI:Math.asin(e)}const pz=Math.PI,gz=2*pz,dg=1e-6,qat=gz-dg;function N1e(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Gat(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return N1e;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let vW=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?N1e:Gat(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,o){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,u=r-t,l=i-n,c=o-t,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>dg)if(!(Math.abs(f*u-l*c)>dg)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let h=r-o,p=i-a,m=u*u+l*l,x=h*h+p*p,b=Math.sqrt(m),v=Math.sqrt(d),$=s*Math.tan((pz-Math.acos((m+d-x)/(2*b*v)))/2),C=$/v,S=$/b;Math.abs(C-1)>dg&&this._append`L${t+C*c},${n+C*f}`,this._append`A${s},${s},0,0,${+(f*h>c*p)},${this._x1=t+S*u},${this._y1=n+S*l}`}}arc(t,n,r,i,s,o){if(t=+t,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),u=r*Math.sin(i),l=t+a,c=n+u,f=1^o,d=o?i-s:s-i;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>dg||Math.abs(this._y1-c)>dg)&&this._append`L${l},${c}`,r&&(d<0&&(d=d%gz+gz),d>qat?this._append`A${r},${r},0,1,${f},${t-a},${n-u}A${r},${r},0,1,${f},${this._x1=l},${this._y1=c}`:d>dg&&this._append`A${r},${r},0,${+(d>=pz)},${f},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function wW(){return new vW}wW.prototype=vW.prototype;function oR(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new vW(t)}function Hat(e){return e.innerRadius}function Xat(e){return e.outerRadius}function Yat(e){return e.startAngle}function Kat(e){return e.endAngle}function Qat(e){return e&&e.padAngle}function Zat(e,t,n,r,i,s,o,a){var u=n-e,l=r-t,c=o-i,f=a-s,d=f*u-c*l;if(!(d*d<ts))return d=(c*(t-s)-f*(e-i))/d,[e+d*u,t+d*l]}function DA(e,t,n,r,i,s,o){var a=e-n,u=t-r,l=(o?s:-s)/_g(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,p=n+c,m=r+f,x=(d+p)/2,b=(h+m)/2,v=p-d,$=m-h,C=v*v+$*$,S=i-s,A=d*m-p*h,E=($<0?-1:1)*_g(Wat(0,S*S*C-A*A)),_=(A*$-v*E)/C,D=(-A*v-$*E)/C,N=(A*$+v*E)/C,T=(-A*v+$*E)/C,L=_-x,O=D-b,M=N-x,R=T-b;return L*L+O*O>M*M+R*R&&(_=N,D=T),{cx:_,cy:D,x01:-c,y01:-f,x11:_*(i/S-1),y11:D*(i/S-1)}}function Jat(){var e=Hat,t=Xat,n=gn(0),r=null,i=Yat,s=Kat,o=Qat,a=null,u=oR(l);function l(){var c,f,d=+e.apply(this,arguments),h=+t.apply(this,arguments),p=i.apply(this,arguments)-SI,m=s.apply(this,arguments)-SI,x=pte(m-p),b=m>p;if(a||(a=c=u()),h<d&&(f=h,h=d,d=f),!(h>ts))a.moveTo(0,0);else if(x>I1e-ts)a.moveTo(h*Hp(p),h*fl(p)),a.arc(0,0,h,p,m,!b),d>ts&&(a.moveTo(d*Hp(m),d*fl(m)),a.arc(0,0,d,m,p,b));else{var v=p,$=m,C=p,S=m,A=x,E=x,_=o.apply(this,arguments)/2,D=_>ts&&(r?+r.apply(this,arguments):_g(d*d+h*h)),N=iB(pte(h-d)/2,+n.apply(this,arguments)),T=N,L=N,O,M;if(D>ts){var R=gte(D/d*fl(_)),P=gte(D/h*fl(_));(A-=R*2)>ts?(R*=b?1:-1,C+=R,S-=R):(A=0,C=S=(p+m)/2),(E-=P*2)>ts?(P*=b?1:-1,v+=P,$-=P):(E=0,v=$=(p+m)/2)}var j=h*Hp(v),z=h*fl(v),q=d*Hp(S),H=d*fl(S);if(N>ts){var V=h*Hp($),X=h*fl($),re=d*Hp(C),le=d*fl(C),ue;if(x<wy)if(ue=Zat(j,z,re,le,V,X,q,H)){var be=j-ue[0],_e=z-ue[1],Ne=V-ue[0],Y=X-ue[1],ae=1/fl(Vat((be*Ne+_e*Y)/(_g(be*be+_e*_e)*_g(Ne*Ne+Y*Y)))/2),he=_g(ue[0]*ue[0]+ue[1]*ue[1]);T=iB(N,(d-he)/(ae-1)),L=iB(N,(h-he)/(ae+1))}else T=L=0}E>ts?L>ts?(O=DA(re,le,j,z,h,L,b),M=DA(V,X,q,H,h,L,b),a.moveTo(O.cx+O.x01,O.cy+O.y01),L<N?a.arc(O.cx,O.cy,L,Ji(O.y01,O.x01),Ji(M.y01,M.x01),!b):(a.arc(O.cx,O.cy,L,Ji(O.y01,O.x01),Ji(O.y11,O.x11),!b),a.arc(0,0,h,Ji(O.cy+O.y11,O.cx+O.x11),Ji(M.cy+M.y11,M.cx+M.x11),!b),a.arc(M.cx,M.cy,L,Ji(M.y11,M.x11),Ji(M.y01,M.x01),!b))):(a.moveTo(j,z),a.arc(0,0,h,v,$,!b)):a.moveTo(j,z),!(d>ts)||!(A>ts)?a.lineTo(q,H):T>ts?(O=DA(q,H,V,X,d,-T,b),M=DA(j,z,re,le,d,-T,b),a.lineTo(O.cx+O.x01,O.cy+O.y01),T<N?a.arc(O.cx,O.cy,T,Ji(O.y01,O.x01),Ji(M.y01,M.x01),!b):(a.arc(O.cx,O.cy,T,Ji(O.y01,O.x01),Ji(O.y11,O.x11),!b),a.arc(0,0,d,Ji(O.cy+O.y11,O.cx+O.x11),Ji(M.cy+M.y11,M.cx+M.x11),b),a.arc(M.cx,M.cy,T,Ji(M.y11,M.x11),Ji(M.y01,M.x01),!b))):a.arc(0,0,d,S,C,b)}if(a.closePath(),c)return a=null,c+""||null}return l.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-wy/2;return[Hp(f)*c,fl(f)*c]},l.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:gn(+c),l):e},l.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:gn(+c),l):t},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:gn(+c),l):n},l.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:gn(+c),l):r},l.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:gn(+c),l):i},l.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:gn(+c),l):s},l.padAngle=function(c){return arguments.length?(o=typeof c=="function"?c:gn(+c),l):o},l.context=function(c){return arguments.length?(a=c??null,l):a},l}function D1e(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function F1e(e){this._context=e}F1e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $W(e){return new F1e(e)}function R1e(e){return e[0]}function O1e(e){return e[1]}function M1e(e,t){var n=gn(!0),r=null,i=$W,s=null,o=oR(a);e=typeof e=="function"?e:e===void 0?R1e:gn(e),t=typeof t=="function"?t:t===void 0?O1e:gn(t);function a(u){var l,c=(u=D1e(u)).length,f,d=!1,h;for(r==null&&(s=i(h=o())),l=0;l<=c;++l)!(l<c&&n(f=u[l],l,u))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(f,l,u),+t(f,l,u));if(h)return s=null,h+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:gn(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:gn(+u),a):t},a.defined=function(u){return arguments.length?(n=typeof u=="function"?u:gn(!!u),a):n},a.curve=function(u){return arguments.length?(i=u,r!=null&&(s=i(r)),a):i},a.context=function(u){return arguments.length?(u==null?r=s=null:s=i(r=u),a):r},a}function L1e(e,t,n){var r=null,i=gn(!0),s=null,o=$W,a=null,u=oR(l);e=typeof e=="function"?e:e===void 0?R1e:gn(+e),t=typeof t=="function"?t:gn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?O1e:gn(+n);function l(f){var d,h,p,m=(f=D1e(f)).length,x,b=!1,v,$=new Array(m),C=new Array(m);for(s==null&&(a=o(v=u())),d=0;d<=m;++d){if(!(d<m&&i(x=f[d],d,f))===b)if(b=!b)h=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=d-1;p>=h;--p)a.point($[p],C[p]);a.lineEnd(),a.areaEnd()}b&&($[d]=+e(x,d,f),C[d]=+t(x,d,f),a.point(r?+r(x,d,f):$[d],n?+n(x,d,f):C[d]))}if(v)return a=null,v+""||null}function c(){return M1e().defined(i).curve(o).context(s)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:gn(+f),r=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:gn(+f),l):e},l.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:gn(+f),l):r},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:gn(+f),n=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:gn(+f),l):t},l.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:gn(+f),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(r).y(t)},l.defined=function(f){return arguments.length?(i=typeof f=="function"?f:gn(!!f),l):i},l.curve=function(f){return arguments.length?(o=f,s!=null&&(a=o(s)),l):o},l.context=function(f){return arguments.length?(f==null?s=a=null:a=o(s=f),l):s},l}const eut={draw(e,t){const n=_g(t/wy);e.moveTo(n,0),e.arc(0,0,n,0,I1e)}};function tut(e,t){let n=null,r=oR(i);e=typeof e=="function"?e:gn(e||eut),t=typeof t=="function"?t:gn(t===void 0?64:+t);function i(){let s;if(n||(n=s=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:gn(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:gn(+s),i):t},i.context=function(s){return arguments.length?(n=s??null,i):n},i}function Ih(){}function kI(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function aR(e){this._context=e}aR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:kI(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:kI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function nut(e){return new aR(e)}function P1e(e){this._context=e}P1e.prototype={areaStart:Ih,areaEnd:Ih,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:kI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rut(e){return new P1e(e)}function B1e(e){this._context=e}B1e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:kI(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function iut(e){return new B1e(e)}function z1e(e,t){this._basis=new aR(e),this._beta=t}z1e.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,o=t[n]-i,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+u*s),this._beta*t[a]+(1-this._beta)*(i+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const sut=function e(t){function n(r){return t===1?new aR(r):new z1e(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function EI(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function CW(e,t){this._context=e,this._k=(1-t)/6}CW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:EI(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:EI(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const out=function e(t){function n(r){return new CW(r,t)}return n.tension=function(r){return e(+r)},n}(0);function SW(e,t){this._context=e,this._k=(1-t)/6}SW.prototype={areaStart:Ih,areaEnd:Ih,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:EI(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const aut=function e(t){function n(r){return new SW(r,t)}return n.tension=function(r){return e(+r)},n}(0);function kW(e,t){this._context=e,this._k=(1-t)/6}kW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:EI(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const uut=function e(t){function n(r){return new kW(r,t)}return n.tension=function(r){return e(+r)},n}(0);function EW(e,t,n){var r=e._x1,i=e._y1,s=e._x2,o=e._y2;if(e._l01_a>ts){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>ts){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,s,o,e._x2,e._y2)}function U1e(e,t){this._context=e,this._alpha=t}U1e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:EW(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const lut=function e(t){function n(r){return t?new U1e(r,t):new CW(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function j1e(e,t){this._context=e,this._alpha=t}j1e.prototype={areaStart:Ih,areaEnd:Ih,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:EW(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const cut=function e(t){function n(r){return t?new j1e(r,t):new SW(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function W1e(e,t){this._context=e,this._alpha=t}W1e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:EW(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const fut=function e(t){function n(r){return t?new W1e(r,t):new kW(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function V1e(e){this._context=e}V1e.prototype={areaStart:Ih,areaEnd:Ih,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function dut(e){return new V1e(e)}function mte(e){return e<0?-1:1}function yte(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),a=(s*i+o*r)/(r+i);return(mte(s)+mte(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function xte(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function sB(e,t,n){var r=e._x0,i=e._y0,s=e._x1,o=e._y1,a=(s-r)/3;e._context.bezierCurveTo(r+a,i+a*t,s-a,o-a*n,s,o)}function AI(e){this._context=e}AI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:sB(this,this._t0,xte(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,sB(this,xte(this,n=yte(this,e,t)),n);break;default:sB(this,this._t0,n=yte(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function q1e(e){this._context=new G1e(e)}(q1e.prototype=Object.create(AI.prototype)).point=function(e,t){AI.prototype.point.call(this,t,e)};function G1e(e){this._context=e}G1e.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function hut(e){return new AI(e)}function put(e){return new q1e(e)}function H1e(e){this._context=e}H1e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=bte(e),i=bte(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function bte(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),o=new Array(n);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function gut(e){return new H1e(e)}function uR(e,t){this._context=e,this._t=t}uR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function mut(e){return new uR(e,.5)}function yut(e){return new uR(e,0)}function xut(e){return new uR(e,1)}function op(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const but=()=>typeof Image<"u"?Image:null;function fw(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function vut(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function AW(e){let t,n,r;e.length!==2?(t=fw,n=(a,u)=>fw(e(a),u),r=(a,u)=>e(a)-u):(t=e===fw||e===vut?e:wut,n=e,r=e);function i(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){const f=i(a,u,l,c-1);return f>l&&r(a[f-1],u)>-r(a[f],u)?f-1:f}return{left:i,center:o,right:s}}function wut(){return 0}function X1e(e){return e===null?NaN:+e}const $ut=AW(fw),pm=$ut.right;AW(X1e).center;const Cut=Math.sqrt(50),Sut=Math.sqrt(10),kut=Math.sqrt(2);function _I(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=Cut?10:s>=Sut?5:s>=kut?2:1;let a,u,l;return i<0?(l=Math.pow(10,-i)/o,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*o,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?_I(e,t,n*2):[a,u,l]}function mz(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,o]=r?_I(t,e,n):_I(e,t,n);if(!(s>=i))return[];const a=s-i+1,u=new Array(a);if(r)if(o<0)for(let l=0;l<a;++l)u[l]=(s-l)/-o;else for(let l=0;l<a;++l)u[l]=(s-l)*o;else if(o<0)for(let l=0;l<a;++l)u[l]=(i+l)/-o;else for(let l=0;l<a;++l)u[l]=(i+l)*o;return u}function yz(e,t,n){return t=+t,e=+e,n=+n,_I(e,t,n)[2]}function xz(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?yz(t,e,n):yz(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function Eut(e,t,n=X1e){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(i-s)}}function Aut(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function _ut(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function TI(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function $y(e){return e=TI(Math.abs(e)),e?e[1]:NaN}function Tut(e,t){return function(n,r){for(var i=n.length,s=[],o=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),s.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function Iut(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Nut=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function v$(e){if(!(t=Nut.exec(e)))throw new Error("invalid format: "+e);var t;return new _W({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}v$.prototype=_W.prototype;function _W(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}_W.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Dut(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Y1e;function Fut(e,t){var n=TI(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(Y1e=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+TI(e,Math.max(0,t+s-1))[0]}function vte(e,t){var n=TI(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const wte={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:_ut,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>vte(e*100,t),r:vte,s:Fut,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function $te(e){return e}var Cte=Array.prototype.map,Ste=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Rut(e){var t=e.grouping===void 0||e.thousands===void 0?$te:Tut(Cte.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?$te:Iut(Cte.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=v$(f);var d=f.fill,h=f.align,p=f.sign,m=f.symbol,x=f.zero,b=f.width,v=f.comma,$=f.precision,C=f.trim,S=f.type;S==="n"?(v=!0,S="g"):wte[S]||($===void 0&&($=12),C=!0,S="g"),(x||d==="0"&&h==="=")&&(x=!0,d="0",h="=");var A=m==="$"?n:m==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",E=m==="$"?r:/[%p]/.test(S)?o:"",_=wte[S],D=/[defgprs%]/.test(S);$=$===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,$)):Math.max(0,Math.min(20,$));function N(T){var L=A,O=E,M,R,P;if(S==="c")O=_(T)+O,T="";else{T=+T;var j=T<0||1/T<0;if(T=isNaN(T)?u:_(Math.abs(T),$),C&&(T=Dut(T)),j&&+T==0&&p!=="+"&&(j=!1),L=(j?p==="("?p:a:p==="-"||p==="("?"":p)+L,O=(S==="s"?Ste[8+Y1e/3]:"")+O+(j&&p==="("?")":""),D){for(M=-1,R=T.length;++M<R;)if(P=T.charCodeAt(M),48>P||P>57){O=(P===46?i+T.slice(M+1):T.slice(M))+O,T=T.slice(0,M);break}}}v&&!x&&(T=t(T,1/0));var z=L.length+T.length+O.length,q=z<b?new Array(b-z+1).join(d):"";switch(v&&x&&(T=t(q+T,q.length?b-O.length:1/0),q=""),h){case"<":T=L+T+O+q;break;case"=":T=L+q+T+O;break;case"^":T=q.slice(0,z=q.length>>1)+L+T+O+q.slice(z);break;default:T=q+L+T+O;break}return s(T)}return N.toString=function(){return f+""},N}function c(f,d){var h=l((f=v$(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor($y(d)/3)))*3,m=Math.pow(10,-p),x=Ste[8+p/3];return function(b){return h(m*b)+x}}return{format:l,formatPrefix:c}}var FA,TW,K1e;Out({thousands:",",grouping:[3],currency:["$",""]});function Out(e){return FA=Rut(e),TW=FA.format,K1e=FA.formatPrefix,FA}function Mut(e){return Math.max(0,-$y(Math.abs(e)))}function Lut(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor($y(t)/3)))*3-$y(Math.abs(e)))}function Put(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,$y(t)-$y(e))+1}const oB=new Date,aB=new Date;function ni(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,a)=>{const u=[];if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;let l;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},i.filter=s=>ni(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(i.count=(s,o)=>(oB.setTime(+s),aB.setTime(+o),e(oB),e(aB),Math.floor(n(oB,aB))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?o=>r(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const Cy=ni(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Cy.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ni(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Cy);Cy.range;const uf=1e3,Ia=uf*60,lf=Ia*60,If=lf*24,IW=If*7,kte=If*30,uB=If*365,cf=ni(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*uf)},(e,t)=>(t-e)/uf,e=>e.getUTCSeconds());cf.range;const lR=ni(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*uf)},(e,t)=>{e.setTime(+e+t*Ia)},(e,t)=>(t-e)/Ia,e=>e.getMinutes());lR.range;const cR=ni(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ia)},(e,t)=>(t-e)/Ia,e=>e.getUTCMinutes());cR.range;const fR=ni(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*uf-e.getMinutes()*Ia)},(e,t)=>{e.setTime(+e+t*lf)},(e,t)=>(t-e)/lf,e=>e.getHours());fR.range;const dR=ni(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*lf)},(e,t)=>(t-e)/lf,e=>e.getUTCHours());dR.range;const ih=ni(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ia)/If,e=>e.getDate()-1);ih.range;const Ug=ni(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/If,e=>e.getUTCDate()-1);Ug.range;const Q1e=ni(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/If,e=>Math.floor(e/If));Q1e.range;function o0(e){return ni(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ia)/IW)}const HS=o0(0),II=o0(1),But=o0(2),zut=o0(3),Sy=o0(4),Uut=o0(5),jut=o0(6);HS.range;II.range;But.range;zut.range;Sy.range;Uut.range;jut.range;function a0(e){return ni(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/IW)}const XS=a0(0),NI=a0(1),Wut=a0(2),Vut=a0(3),ky=a0(4),qut=a0(5),Gut=a0(6);XS.range;NI.range;Wut.range;Vut.range;ky.range;qut.range;Gut.range;const w$=ni(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());w$.range;const $$=ni(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());$$.range;const Zl=ni(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Zl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ni(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Zl.range;const Jl=ni(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Jl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ni(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Jl.range;function Z1e(e,t,n,r,i,s){const o=[[cf,1,uf],[cf,5,5*uf],[cf,15,15*uf],[cf,30,30*uf],[s,1,Ia],[s,5,5*Ia],[s,15,15*Ia],[s,30,30*Ia],[i,1,lf],[i,3,3*lf],[i,6,6*lf],[i,12,12*lf],[r,1,If],[r,2,2*If],[n,1,IW],[t,1,kte],[t,3,3*kte],[e,1,uB]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=AW(([,,x])=>x).right(o,d);if(h===o.length)return e.every(xz(l/uB,c/uB,f));if(h===0)return Cy.every(Math.max(xz(l,c,f),1));const[p,m]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(m)}return[a,u]}const[Hut,Xut]=Z1e(Jl,$$,XS,Q1e,dR,cR),[Yut,Kut]=Z1e(Zl,w$,HS,ih,fR,lR),NW="year",DW="quarter",FW="month",RW="week",OW="date",MW="day",LW="dayofyear",PW="hours",BW="minutes",zW="seconds",UW="milliseconds",Qut=[NW,DW,FW,RW,OW,MW,LW,PW,BW,zW,UW];Qut.reduce((e,t,n)=>(e[t]=1+n,e),{});NW+"",DW+"",w$.every(3),FW+"",RW+"",OW+"",MW+"",LW+"",PW+"",BW+"",zW+"",UW+"";NW+"",DW+"",$$.every(3),FW+"",RW+"",OW+"",MW+"",LW+"",PW+"",BW+"",zW+"",UW+"";function lB(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function cB(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function r2(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Zut(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,o=e.shortDays,a=e.months,u=e.shortMonths,l=i2(i),c=s2(i),f=i2(s),d=s2(s),h=i2(o),p=s2(o),m=i2(a),x=s2(a),b=i2(u),v=s2(u),$={a:j,A:z,b:q,B:H,c:null,d:Nte,e:Nte,f:wlt,g:Nlt,G:Flt,H:xlt,I:blt,j:vlt,L:J1e,m:$lt,M:Clt,p:V,q:X,Q:Rte,s:Ote,S:Slt,u:klt,U:Elt,V:Alt,w:_lt,W:Tlt,x:null,X:null,y:Ilt,Y:Dlt,Z:Rlt,"%":Fte},C={a:re,A:le,b:ue,B:be,c:null,d:Dte,e:Dte,f:Plt,g:Xlt,G:Klt,H:Olt,I:Mlt,j:Llt,L:tye,m:Blt,M:zlt,p:_e,q:Ne,Q:Rte,s:Ote,S:Ult,u:jlt,U:Wlt,V:Vlt,w:qlt,W:Glt,x:null,X:null,y:Hlt,Y:Ylt,Z:Qlt,"%":Fte},S={a:N,A:T,b:L,B:O,c:M,d:Tte,e:Tte,f:plt,g:_te,G:Ate,H:Ite,I:Ite,j:clt,L:hlt,m:llt,M:flt,p:D,q:ult,Q:mlt,s:ylt,S:dlt,u:rlt,U:ilt,V:slt,w:nlt,W:olt,x:R,X:P,y:_te,Y:Ate,Z:alt,"%":glt};$.x=A(n,$),$.X=A(r,$),$.c=A(t,$),C.x=A(n,C),C.X=A(r,C),C.c=A(t,C);function A(Y,ae){return function(he){var G=[],je=-1,Ce=0,We=Y.length,Ve,gt,ct;for(he instanceof Date||(he=new Date(+he));++je<We;)Y.charCodeAt(je)===37&&(G.push(Y.slice(Ce,je)),(gt=Ete[Ve=Y.charAt(++je)])!=null?Ve=Y.charAt(++je):gt=Ve==="e"?" ":"0",(ct=ae[Ve])&&(Ve=ct(he,gt)),G.push(Ve),Ce=je+1);return G.push(Y.slice(Ce,je)),G.join("")}}function E(Y,ae){return function(he){var G=r2(1900,void 0,1),je=_(G,Y,he+="",0),Ce,We;if(je!=he.length)return null;if("Q"in G)return new Date(G.Q);if("s"in G)return new Date(G.s*1e3+("L"in G?G.L:0));if(ae&&!("Z"in G)&&(G.Z=0),"p"in G&&(G.H=G.H%12+G.p*12),G.m===void 0&&(G.m="q"in G?G.q:0),"V"in G){if(G.V<1||G.V>53)return null;"w"in G||(G.w=1),"Z"in G?(Ce=cB(r2(G.y,0,1)),We=Ce.getUTCDay(),Ce=We>4||We===0?NI.ceil(Ce):NI(Ce),Ce=Ug.offset(Ce,(G.V-1)*7),G.y=Ce.getUTCFullYear(),G.m=Ce.getUTCMonth(),G.d=Ce.getUTCDate()+(G.w+6)%7):(Ce=lB(r2(G.y,0,1)),We=Ce.getDay(),Ce=We>4||We===0?II.ceil(Ce):II(Ce),Ce=ih.offset(Ce,(G.V-1)*7),G.y=Ce.getFullYear(),G.m=Ce.getMonth(),G.d=Ce.getDate()+(G.w+6)%7)}else("W"in G||"U"in G)&&("w"in G||(G.w="u"in G?G.u%7:"W"in G?1:0),We="Z"in G?cB(r2(G.y,0,1)).getUTCDay():lB(r2(G.y,0,1)).getDay(),G.m=0,G.d="W"in G?(G.w+6)%7+G.W*7-(We+5)%7:G.w+G.U*7-(We+6)%7);return"Z"in G?(G.H+=G.Z/100|0,G.M+=G.Z%100,cB(G)):lB(G)}}function _(Y,ae,he,G){for(var je=0,Ce=ae.length,We=he.length,Ve,gt;je<Ce;){if(G>=We)return-1;if(Ve=ae.charCodeAt(je++),Ve===37){if(Ve=ae.charAt(je++),gt=S[Ve in Ete?ae.charAt(je++):Ve],!gt||(G=gt(Y,he,G))<0)return-1}else if(Ve!=he.charCodeAt(G++))return-1}return G}function D(Y,ae,he){var G=l.exec(ae.slice(he));return G?(Y.p=c.get(G[0].toLowerCase()),he+G[0].length):-1}function N(Y,ae,he){var G=h.exec(ae.slice(he));return G?(Y.w=p.get(G[0].toLowerCase()),he+G[0].length):-1}function T(Y,ae,he){var G=f.exec(ae.slice(he));return G?(Y.w=d.get(G[0].toLowerCase()),he+G[0].length):-1}function L(Y,ae,he){var G=b.exec(ae.slice(he));return G?(Y.m=v.get(G[0].toLowerCase()),he+G[0].length):-1}function O(Y,ae,he){var G=m.exec(ae.slice(he));return G?(Y.m=x.get(G[0].toLowerCase()),he+G[0].length):-1}function M(Y,ae,he){return _(Y,t,ae,he)}function R(Y,ae,he){return _(Y,n,ae,he)}function P(Y,ae,he){return _(Y,r,ae,he)}function j(Y){return o[Y.getDay()]}function z(Y){return s[Y.getDay()]}function q(Y){return u[Y.getMonth()]}function H(Y){return a[Y.getMonth()]}function V(Y){return i[+(Y.getHours()>=12)]}function X(Y){return 1+~~(Y.getMonth()/3)}function re(Y){return o[Y.getUTCDay()]}function le(Y){return s[Y.getUTCDay()]}function ue(Y){return u[Y.getUTCMonth()]}function be(Y){return a[Y.getUTCMonth()]}function _e(Y){return i[+(Y.getUTCHours()>=12)]}function Ne(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var ae=A(Y+="",$);return ae.toString=function(){return Y},ae},parse:function(Y){var ae=E(Y+="",!1);return ae.toString=function(){return Y},ae},utcFormat:function(Y){var ae=A(Y+="",C);return ae.toString=function(){return Y},ae},utcParse:function(Y){var ae=E(Y+="",!0);return ae.toString=function(){return Y},ae}}}var Ete={"-":"",_:" ",0:"0"},Ti=/^\s*\d+/,Jut=/^%/,elt=/[\\^$*+?|[\]().{}]/g;function ln(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function tlt(e){return e.replace(elt,"\\$&")}function i2(e){return new RegExp("^(?:"+e.map(tlt).join("|")+")","i")}function s2(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function nlt(e,t,n){var r=Ti.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function rlt(e,t,n){var r=Ti.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ilt(e,t,n){var r=Ti.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function slt(e,t,n){var r=Ti.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function olt(e,t,n){var r=Ti.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Ate(e,t,n){var r=Ti.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function _te(e,t,n){var r=Ti.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function alt(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ult(e,t,n){var r=Ti.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function llt(e,t,n){var r=Ti.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Tte(e,t,n){var r=Ti.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function clt(e,t,n){var r=Ti.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ite(e,t,n){var r=Ti.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function flt(e,t,n){var r=Ti.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function dlt(e,t,n){var r=Ti.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function hlt(e,t,n){var r=Ti.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function plt(e,t,n){var r=Ti.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function glt(e,t,n){var r=Jut.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function mlt(e,t,n){var r=Ti.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function ylt(e,t,n){var r=Ti.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Nte(e,t){return ln(e.getDate(),t,2)}function xlt(e,t){return ln(e.getHours(),t,2)}function blt(e,t){return ln(e.getHours()%12||12,t,2)}function vlt(e,t){return ln(1+ih.count(Zl(e),e),t,3)}function J1e(e,t){return ln(e.getMilliseconds(),t,3)}function wlt(e,t){return J1e(e,t)+"000"}function $lt(e,t){return ln(e.getMonth()+1,t,2)}function Clt(e,t){return ln(e.getMinutes(),t,2)}function Slt(e,t){return ln(e.getSeconds(),t,2)}function klt(e){var t=e.getDay();return t===0?7:t}function Elt(e,t){return ln(HS.count(Zl(e)-1,e),t,2)}function eye(e){var t=e.getDay();return t>=4||t===0?Sy(e):Sy.ceil(e)}function Alt(e,t){return e=eye(e),ln(Sy.count(Zl(e),e)+(Zl(e).getDay()===4),t,2)}function _lt(e){return e.getDay()}function Tlt(e,t){return ln(II.count(Zl(e)-1,e),t,2)}function Ilt(e,t){return ln(e.getFullYear()%100,t,2)}function Nlt(e,t){return e=eye(e),ln(e.getFullYear()%100,t,2)}function Dlt(e,t){return ln(e.getFullYear()%1e4,t,4)}function Flt(e,t){var n=e.getDay();return e=n>=4||n===0?Sy(e):Sy.ceil(e),ln(e.getFullYear()%1e4,t,4)}function Rlt(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ln(t/60|0,"0",2)+ln(t%60,"0",2)}function Dte(e,t){return ln(e.getUTCDate(),t,2)}function Olt(e,t){return ln(e.getUTCHours(),t,2)}function Mlt(e,t){return ln(e.getUTCHours()%12||12,t,2)}function Llt(e,t){return ln(1+Ug.count(Jl(e),e),t,3)}function tye(e,t){return ln(e.getUTCMilliseconds(),t,3)}function Plt(e,t){return tye(e,t)+"000"}function Blt(e,t){return ln(e.getUTCMonth()+1,t,2)}function zlt(e,t){return ln(e.getUTCMinutes(),t,2)}function Ult(e,t){return ln(e.getUTCSeconds(),t,2)}function jlt(e){var t=e.getUTCDay();return t===0?7:t}function Wlt(e,t){return ln(XS.count(Jl(e)-1,e),t,2)}function nye(e){var t=e.getUTCDay();return t>=4||t===0?ky(e):ky.ceil(e)}function Vlt(e,t){return e=nye(e),ln(ky.count(Jl(e),e)+(Jl(e).getUTCDay()===4),t,2)}function qlt(e){return e.getUTCDay()}function Glt(e,t){return ln(NI.count(Jl(e)-1,e),t,2)}function Hlt(e,t){return ln(e.getUTCFullYear()%100,t,2)}function Xlt(e,t){return e=nye(e),ln(e.getUTCFullYear()%100,t,2)}function Ylt(e,t){return ln(e.getUTCFullYear()%1e4,t,4)}function Klt(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ky(e):ky.ceil(e),ln(e.getUTCFullYear()%1e4,t,4)}function Qlt(){return"+0000"}function Fte(){return"%"}function Rte(e){return+e}function Ote(e){return Math.floor(+e/1e3)}var c1,rye,iye;Zlt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Zlt(e){return c1=Zut(e),rye=c1.format,c1.parse,iye=c1.utcFormat,c1.utcParse,c1}function cc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ap(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Mte=Symbol("implicit");function jW(){var e=new mI,t=[],n=[],r=Mte;function i(s){let o=e.get(s);if(o===void 0){if(r!==Mte)return r;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new mI;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return jW(t,n).unknown(r)},cc.apply(i,arguments),i}function Tb(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function YS(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function up(){}var gm=.7,Ey=1/gm,Y1="\\s*([+-]?\\d+)\\s*",C$="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ol="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Jlt=/^#([0-9a-f]{3,8})$/,ect=new RegExp("^rgb\\("+[Y1,Y1,Y1]+"\\)$"),tct=new RegExp("^rgb\\("+[Ol,Ol,Ol]+"\\)$"),nct=new RegExp("^rgba\\("+[Y1,Y1,Y1,C$]+"\\)$"),rct=new RegExp("^rgba\\("+[Ol,Ol,Ol,C$]+"\\)$"),ict=new RegExp("^hsl\\("+[C$,Ol,Ol]+"\\)$"),sct=new RegExp("^hsla\\("+[C$,Ol,Ol,C$]+"\\)$"),Lte={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Tb(up,Nf,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Pte,formatHex:Pte,formatHsl:oct,formatRgb:Bte,toString:Bte});function Pte(){return this.rgb().formatHex()}function oct(){return sye(this).formatHsl()}function Bte(){return this.rgb().formatRgb()}function Nf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Jlt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?zte(t):n===3?new Pi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?RA(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?RA(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ect.exec(e))?new Pi(t[1],t[2],t[3],1):(t=tct.exec(e))?new Pi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=nct.exec(e))?RA(t[1],t[2],t[3],t[4]):(t=rct.exec(e))?RA(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ict.exec(e))?Wte(t[1],t[2]/100,t[3]/100,1):(t=sct.exec(e))?Wte(t[1],t[2]/100,t[3]/100,t[4]):Lte.hasOwnProperty(e)?zte(Lte[e]):e==="transparent"?new Pi(NaN,NaN,NaN,0):null}function zte(e){return new Pi(e>>16&255,e>>8&255,e&255,1)}function RA(e,t,n,r){return r<=0&&(e=t=n=NaN),new Pi(e,t,n,r)}function WW(e){return e instanceof up||(e=Nf(e)),e?(e=e.rgb(),new Pi(e.r,e.g,e.b,e.opacity)):new Pi}function Ro(e,t,n,r){return arguments.length===1?WW(e):new Pi(e,t,n,r??1)}function Pi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Tb(Pi,Ro,YS(up,{brighter:function(e){return e=e==null?Ey:Math.pow(Ey,e),new Pi(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?gm:Math.pow(gm,e),new Pi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ute,formatHex:Ute,formatRgb:jte,toString:jte}));function Ute(){return"#"+fB(this.r)+fB(this.g)+fB(this.b)}function jte(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function fB(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Wte(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new vl(e,t,n,r)}function sye(e){if(e instanceof vl)return new vl(e.h,e.s,e.l,e.opacity);if(e instanceof up||(e=Nf(e)),!e)return new vl;if(e instanceof vl)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,a=s-i,u=(s+i)/2;return a?(t===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-t)/a+2:o=(t-n)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new vl(o,a,u,e.opacity)}function Nh(e,t,n,r){return arguments.length===1?sye(e):new vl(e,t,n,r??1)}function vl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Tb(vl,Nh,YS(up,{brighter:function(e){return e=e==null?Ey:Math.pow(Ey,e),new vl(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?gm:Math.pow(gm,e),new vl(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Pi(dB(e>=240?e-240:e+120,i,r),dB(e,i,r),dB(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function dB(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const oye=Math.PI/180,aye=180/Math.PI,DI=18,uye=.96422,lye=1,cye=.82521,fye=4/29,K1=6/29,dye=3*K1*K1,act=K1*K1*K1;function hye(e){if(e instanceof Ml)return new Ml(e.l,e.a,e.b,e.opacity);if(e instanceof ff)return pye(e);e instanceof Pi||(e=WW(e));var t=mB(e.r),n=mB(e.g),r=mB(e.b),i=hB((.2225045*t+.7168786*n+.0606169*r)/lye),s,o;return t===n&&n===r?s=o=i:(s=hB((.4360747*t+.3850649*n+.1430804*r)/uye),o=hB((.0139322*t+.0971045*n+.7141733*r)/cye)),new Ml(116*i-16,500*(s-i),200*(i-o),e.opacity)}function Dh(e,t,n,r){return arguments.length===1?hye(e):new Ml(e,t,n,r??1)}function Ml(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Tb(Ml,Dh,YS(up,{brighter:function(e){return new Ml(this.l+DI*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new Ml(this.l-DI*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=uye*pB(t),e=lye*pB(e),n=cye*pB(n),new Pi(gB(3.1338561*t-1.6168667*e-.4906146*n),gB(-.9787684*t+1.9161415*e+.033454*n),gB(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function hB(e){return e>act?Math.pow(e,1/3):e/dye+fye}function pB(e){return e>K1?e*e*e:dye*(e-fye)}function gB(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function mB(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function uct(e){if(e instanceof ff)return new ff(e.h,e.c,e.l,e.opacity);if(e instanceof Ml||(e=hye(e)),e.a===0&&e.b===0)return new ff(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*aye;return new ff(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Fh(e,t,n,r){return arguments.length===1?uct(e):new ff(e,t,n,r??1)}function ff(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function pye(e){if(isNaN(e.h))return new Ml(e.l,0,0,e.opacity);var t=e.h*oye;return new Ml(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Tb(ff,Fh,YS(up,{brighter:function(e){return new ff(this.h,this.c,this.l+DI*(e??1),this.opacity)},darker:function(e){return new ff(this.h,this.c,this.l-DI*(e??1),this.opacity)},rgb:function(){return pye(this).rgb()}}));var gye=-.14861,VW=1.78277,qW=-.29227,hR=-.90649,S$=1.97294,Vte=S$*hR,qte=S$*VW,Gte=VW*qW-hR*gye;function lct(e){if(e instanceof jg)return new jg(e.h,e.s,e.l,e.opacity);e instanceof Pi||(e=WW(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Gte*r+Vte*t-qte*n)/(Gte+Vte-qte),s=r-i,o=(S$*(n-i)-qW*s)/hR,a=Math.sqrt(o*o+s*s)/(S$*i*(1-i)),u=a?Math.atan2(o,s)*aye-120:NaN;return new jg(u<0?u+360:u,a,i,e.opacity)}function mm(e,t,n,r){return arguments.length===1?lct(e):new jg(e,t,n,r??1)}function jg(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Tb(jg,mm,YS(up,{brighter:function(e){return e=e==null?Ey:Math.pow(Ey,e),new jg(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?gm:Math.pow(gm,e),new jg(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*oye,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Pi(255*(t+n*(gye*r+VW*i)),255*(t+n*(qW*r+hR*i)),255*(t+n*(S$*r)),this.opacity)}}));function mye(e,t,n,r,i){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*r+o*i)/6}function yye(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],o=r>0?e[r-1]:2*i-s,a=r<t-1?e[r+2]:2*s-i;return mye((n-r/t)*t,o,i,s,a)}}function xye(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],o=e[(r+1)%t],a=e[(r+2)%t];return mye((n-r/t)*t,i,s,o,a)}}const pR=e=>()=>e;function bye(e,t){return function(n){return e+n*t}}function cct(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function gR(e,t){var n=t-e;return n?bye(e,n>180||n<-180?n-360*Math.round(n/360):n):pR(isNaN(e)?t:e)}function fct(e){return(e=+e)==1?hi:function(t,n){return n-t?cct(t,n,e):pR(isNaN(t)?n:t)}}function hi(e,t){var n=t-e;return n?bye(e,n):pR(isNaN(e)?t:e)}const bz=function e(t){var n=fct(t);function r(i,s){var o=n((i=Ro(i)).r,(s=Ro(s)).r),a=n(i.g,s.g),u=n(i.b,s.b),l=hi(i.opacity,s.opacity);return function(c){return i.r=o(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function vye(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Ro(t[o]),r[o]=a.r||0,i[o]=a.g||0,s[o]=a.b||0;return r=e(r),i=e(i),s=e(s),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=s(u),a+""}}}var dct=vye(yye),hct=vye(xye);function GW(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function wye(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function pct(e,t){return(wye(t)?GW:$ye)(e,t)}function $ye(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=u0(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function Cye(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function bu(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Sye(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=u0(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var vz=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yB=new RegExp(vz.source,"g");function gct(e){return function(){return e}}function mct(e){return function(t){return e(t)+""}}function kye(e,t){var n=vz.lastIndex=yB.lastIndex=0,r,i,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(r=vz.exec(e))&&(i=yB.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,u.push({i:o,x:bu(r,i)})),n=yB.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?mct(u[0].x):gct(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function u0(e,t){var n=typeof t,r;return t==null||n==="boolean"?pR(t):(n==="number"?bu:n==="string"?(r=Nf(t))?(t=r,bz):kye:t instanceof Nf?bz:t instanceof Date?Cye:wye(t)?GW:Array.isArray(t)?$ye:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Sye:bu)(e,t)}function yct(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function xct(e,t){var n=gR(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function mR(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Hte=180/Math.PI,wz={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Eye(e,t,n,r,i,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*Hte,skewX:Math.atan(u)*Hte,scaleX:o,scaleY:a}}var OA;function bct(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?wz:Eye(t.a,t.b,t.c,t.d,t.e,t.f)}function vct(e){return e==null||(OA||(OA=document.createElementNS("http://www.w3.org/2000/svg","g")),OA.setAttribute("transform",e),!(e=OA.transform.baseVal.consolidate()))?wz:(e=e.matrix,Eye(e.a,e.b,e.c,e.d,e.e,e.f))}function Aye(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,c,f,d,h,p){if(l!==f||c!==d){var m=h.push("translate(",null,t,null,n);p.push({i:m-4,x:bu(l,f)},{i:m-2,x:bu(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:bu(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:bu(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var m=h.push(i(h)+"scale(",null,",",null,")");p.push({i:m-4,x:bu(l,f)},{i:m-2,x:bu(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,m=d.length,x;++p<m;)f[(x=d[p]).i]=x.x(h);return f.join("")}}}var wct=Aye(bct,"px, ","px)","deg)"),$ct=Aye(vct,", ",")",")"),Cct=1e-12;function Xte(e){return((e=Math.exp(e))+1/e)/2}function Sct(e){return((e=Math.exp(e))-1/e)/2}function kct(e){return((e=Math.exp(2*e))-1)/(e+1)}const Ect=function e(t,n,r){function i(s,o){var a=s[0],u=s[1],l=s[2],c=o[0],f=o[1],d=o[2],h=c-a,p=f-u,m=h*h+p*p,x,b;if(m<Cct)b=Math.log(d/l)/t,x=function(E){return[a+E*h,u+E*p,l*Math.exp(t*E*b)]};else{var v=Math.sqrt(m),$=(d*d-l*l+r*m)/(2*l*n*v),C=(d*d-l*l-r*m)/(2*d*n*v),S=Math.log(Math.sqrt($*$+1)-$),A=Math.log(Math.sqrt(C*C+1)-C);b=(A-S)/t,x=function(E){var _=E*b,D=Xte(S),N=l/(n*v)*(D*kct(t*_+S)-Sct(S));return[a+N*h,u+N*p,l*D/Xte(t*_+S)]}}return x.duration=b*1e3*t/Math.SQRT2,x}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return e(o,a,u)},i}(Math.SQRT2,2,4);function _ye(e){return function(t,n){var r=e((t=Nh(t)).h,(n=Nh(n)).h),i=hi(t.s,n.s),s=hi(t.l,n.l),o=hi(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const Act=_ye(gR);var _ct=_ye(hi);function Tct(e,t){var n=hi((e=Dh(e)).l,(t=Dh(t)).l),r=hi(e.a,t.a),i=hi(e.b,t.b),s=hi(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=s(o),e+""}}function Tye(e){return function(t,n){var r=e((t=Fh(t)).h,(n=Fh(n)).h),i=hi(t.c,n.c),s=hi(t.l,n.l),o=hi(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const Ict=Tye(gR);var Nct=Tye(hi);function Iye(e){return function t(n){n=+n;function r(i,s){var o=e((i=mm(i)).h,(s=mm(s)).h),a=hi(i.s,s.s),u=hi(i.l,s.l),l=hi(i.opacity,s.opacity);return function(c){return i.h=o(c),i.s=a(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}const Dct=Iye(gR);var Fct=Iye(hi);function HW(e,t){t===void 0&&(t=e,e=u0);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(o){var a=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return s[a](o-a)}}function Rct(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const Oct=Object.freeze(Object.defineProperty({__proto__:null,interpolate:u0,interpolateArray:pct,interpolateBasis:yye,interpolateBasisClosed:xye,interpolateCubehelix:Dct,interpolateCubehelixLong:Fct,interpolateDate:Cye,interpolateDiscrete:yct,interpolateHcl:Ict,interpolateHclLong:Nct,interpolateHsl:Act,interpolateHslLong:_ct,interpolateHue:xct,interpolateLab:Tct,interpolateNumber:bu,interpolateNumberArray:GW,interpolateObject:Sye,interpolateRgb:bz,interpolateRgbBasis:dct,interpolateRgbBasisClosed:hct,interpolateRound:mR,interpolateString:kye,interpolateTransformCss:wct,interpolateTransformSvg:$ct,interpolateZoom:Ect,piecewise:HW,quantize:Rct},Symbol.toStringTag,{value:"Module"}));function Mct(e){return function(){return e}}function $z(e){return+e}var Yte=[0,1];function So(e){return e}function Cz(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Mct(isNaN(t)?NaN:.5)}function Lct(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Pct(e,t,n){var r=e[0],i=e[1],s=t[0],o=t[1];return i<r?(r=Cz(i,r),s=n(o,s)):(r=Cz(r,i),s=n(s,o)),function(a){return s(r(a))}}function Bct(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=Cz(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var u=pm(e,a,1,r)-1;return s[u](i[u](a))}}function KS(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function yR(){var e=Yte,t=Yte,n=u0,r,i,s,o=So,a,u,l;function c(){var d=Math.min(e.length,t.length);return o!==So&&(o=Lct(e[0],e[d-1])),a=d>2?Bct:Pct,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?s:(u||(u=a(e.map(r),t,n)))(r(o(d)))}return f.invert=function(d){return o(i((l||(l=a(t,e.map(r),bu)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,$z),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=mR,c()},f.clamp=function(d){return arguments.length?(o=d?!0:So,c()):o!==So},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return r=d,i=h,c()}}function Nye(){return yR()(So,So)}function Dye(e,t,n,r){var i=xz(e,t,n),s;switch(r=v$(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=Lut(i,o))&&(r.precision=s),K1e(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=Put(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=Mut(i))&&(r.precision=s-(r.type==="%")*2);break}}return TW(r)}function l0(e){var t=e.domain;return e.ticks=function(n){var r=t();return mz(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Dye(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,o=r[i],a=r[s],u,l,c=10;for(a<o&&(l=o,o=a,a=l,l=i,i=s,s=l);c-- >0;){if(l=yz(o,a,n),l===u)return r[i]=o,r[s]=a,t(r);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function Fye(){var e=Nye();return e.copy=function(){return KS(e,Fye())},cc.apply(e,arguments),l0(e)}function Rye(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,$z),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Rye(e).unknown(t)},e=arguments.length?Array.from(e,$z):[0,1],l0(n)}function Oye(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],o;return s<i&&(o=n,n=r,r=o,o=i,i=s,s=o),e[n]=t.floor(i),e[r]=t.ceil(s),e}function Kte(e){return Math.log(e)}function Qte(e){return Math.exp(e)}function zct(e){return-Math.log(-e)}function Uct(e){return-Math.exp(-e)}function jct(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Wct(e){return e===10?jct:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Vct(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Zte(e){return(t,n)=>-e(-t,n)}function XW(e){const t=e(Kte,Qte),n=t.domain;let r=10,i,s;function o(){return i=Vct(r),s=Wct(r),n()[0]<0?(i=Zte(i),s=Zte(s),e(zct,Uct)):e(Kte,Qte),t}return t.base=function(a){return arguments.length?(r=+a,o()):r},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const u=n();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let d=i(l),h=i(c),p,m;const x=a==null?10:+a;let b=[];if(!(r%1)&&h-d<x){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1;p<r;++p)if(m=d<0?p/s(-d):p*s(d),!(m<l)){if(m>c)break;b.push(m)}}else for(;d<=h;++d)for(p=r-1;p>=1;--p)if(m=d>0?p/s(-d):p*s(d),!(m<l)){if(m>c)break;b.push(m)}b.length*2<x&&(b=mz(l,c,x))}else b=mz(d,h,Math.min(h-d,x)).map(s);return f?b.reverse():b},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=r===10?"s":","),typeof u!="function"&&(!(r%1)&&(u=v$(u)).precision==null&&(u.trim=!0),u=TW(u)),a===1/0)return u;const l=Math.max(1,r*a/t.ticks().length);return c=>{let f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=()=>n(Oye(n(),{floor:a=>s(Math.floor(i(a))),ceil:a=>s(Math.ceil(i(a)))})),t}function Mye(){const e=XW(yR()).domain([1,10]);return e.copy=()=>KS(e,Mye()).base(e.base()),cc.apply(e,arguments),e}function Jte(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function ene(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function YW(e){var t=1,n=e(Jte(t),ene(t));return n.constant=function(r){return arguments.length?e(Jte(t=+r),ene(t)):t},l0(n)}function Lye(){var e=YW(yR());return e.copy=function(){return KS(e,Lye()).constant(e.constant())},cc.apply(e,arguments)}function tne(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function qct(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Gct(e){return e<0?-e*e:e*e}function KW(e){var t=e(So,So),n=1;function r(){return n===1?e(So,So):n===.5?e(qct,Gct):e(tne(n),tne(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},l0(t)}function QW(){var e=KW(yR());return e.copy=function(){return KS(e,QW()).exponent(e.exponent())},cc.apply(e,arguments),e}function Hct(){return QW.apply(null,arguments).exponent(.5)}function Pye(){var e=[],t=[],n=[],r;function i(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=Eut(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?r:t[pm(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(fw),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(r=o,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return Pye().domain(e).range(t).unknown(r)},cc.apply(s,arguments)}function Bye(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function o(u){return u!=null&&u<=u?i[pm(r,u,0,n)]:s}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},o.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,a()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return r.slice()},o.copy=function(){return Bye().domain([e,t]).range(i).unknown(s)},cc.apply(l0(o),arguments)}function zye(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[pm(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return zye().domain(e).range(t).unknown(n)},cc.apply(i,arguments)}function Xct(e){return new Date(e)}function Yct(e){return e instanceof Date?+e:+new Date(+e)}function ZW(e,t,n,r,i,s,o,a,u,l){var c=Nye(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),m=l("%I:%M"),x=l("%I %p"),b=l("%a %d"),v=l("%b %d"),$=l("%B"),C=l("%Y");function S(A){return(u(A)<A?h:a(A)<A?p:o(A)<A?m:s(A)<A?x:r(A)<A?i(A)<A?b:v:n(A)<A?$:C)(A)}return c.invert=function(A){return new Date(f(A))},c.domain=function(A){return arguments.length?d(Array.from(A,Yct)):d().map(Xct)},c.ticks=function(A){var E=d();return e(E[0],E[E.length-1],A??10)},c.tickFormat=function(A,E){return E==null?S:l(E)},c.nice=function(A){var E=d();return(!A||typeof A.range!="function")&&(A=t(E[0],E[E.length-1],A??10)),A?d(Oye(E,A)):c},c.copy=function(){return KS(c,ZW(e,t,n,r,i,s,o,a,u,l))},c}function Kct(){return cc.apply(ZW(Yut,Kut,Zl,w$,HS,ih,fR,lR,cf,rye).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Qct(){return cc.apply(ZW(Hut,Xut,Jl,$$,XS,Ug,dR,cR,cf,iye).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function xR(){var e=0,t=1,n,r,i,s,o=So,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(i===0?.5:(f=(s(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(u0),l.rangeRound=c(mR),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function lp(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function JW(){var e=l0(xR()(So));return e.copy=function(){return lp(e,JW())},ap.apply(e,arguments)}function Uye(){var e=XW(xR()).domain([1,10]);return e.copy=function(){return lp(e,Uye()).base(e.base())},ap.apply(e,arguments)}function jye(){var e=YW(xR());return e.copy=function(){return lp(e,jye()).constant(e.constant())},ap.apply(e,arguments)}function eV(){var e=KW(xR());return e.copy=function(){return lp(e,eV()).exponent(e.exponent())},ap.apply(e,arguments)}function Zct(){return eV.apply(null,arguments).exponent(.5)}function bR(){var e=0,t=.5,n=1,r=1,i,s,o,a,u,l=So,c,f=!1,d;function h(m){return isNaN(m=+m)?d:(m=.5+((m=+c(m))-s)*(r*m<r*s?a:u),l(f?Math.max(0,Math.min(1,m)):m))}h.domain=function(m){return arguments.length?([e,t,n]=m,i=c(e=+e),s=c(t=+t),o=c(n=+n),a=i===s?0:.5/(s-i),u=s===o?0:.5/(o-s),r=s<i?-1:1,h):[e,t,n]},h.clamp=function(m){return arguments.length?(f=!!m,h):f},h.interpolator=function(m){return arguments.length?(l=m,h):l};function p(m){return function(x){var b,v,$;return arguments.length?([b,v,$]=x,l=HW(m,[b,v,$]),h):[l(0),l(.5),l(1)]}}return h.range=p(u0),h.rangeRound=p(mR),h.unknown=function(m){return arguments.length?(d=m,h):d},function(m){return c=m,i=m(e),s=m(t),o=m(n),a=i===s?0:.5/(s-i),u=s===o?0:.5/(o-s),r=s<i?-1:1,h}}function Wye(){var e=l0(bR()(So));return e.copy=function(){return lp(e,Wye())},ap.apply(e,arguments)}function Vye(){var e=XW(bR()).domain([.1,1,10]);return e.copy=function(){return lp(e,Vye()).base(e.base())},ap.apply(e,arguments)}function qye(){var e=YW(bR());return e.copy=function(){return lp(e,qye()).constant(e.constant())},ap.apply(e,arguments)}function tV(){var e=KW(bR());return e.copy=function(){return lp(e,tV()).exponent(e.exponent())},ap.apply(e,arguments)}function Jct(){return tV.apply(null,arguments).exponent(.5)}function fc(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const Gye=fc("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Hye=fc("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Xye=fc("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Yye=fc("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),Kye=fc("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Qye=fc("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Zye=fc("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Jye=fc("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),exe=fc("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),txe=fc("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function nxe(e,t,n,r,i){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*r+o*i)/6}function rxe(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],o=r>0?e[r-1]:2*i-s,a=r<t-1?e[r+2]:2*s-i;return nxe((n-r/t)*t,o,i,s,a)}}function ixe(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],o=e[(r+1)%t],a=e[(r+2)%t];return nxe((n-r/t)*t,i,s,o,a)}}const vR=e=>()=>e;function sxe(e,t){return function(n){return e+n*t}}function eft(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function wR(e,t){var n=t-e;return n?sxe(e,n>180||n<-180?n-360*Math.round(n/360):n):vR(isNaN(e)?t:e)}function tft(e){return(e=+e)==1?pi:function(t,n){return n-t?eft(t,n,e):vR(isNaN(t)?n:t)}}function pi(e,t){var n=t-e;return n?sxe(e,n):vR(isNaN(e)?t:e)}const Sz=function e(t){var n=tft(t);function r(i,s){var o=n((i=Ro(i)).r,(s=Ro(s)).r),a=n(i.g,s.g),u=n(i.b,s.b),l=pi(i.opacity,s.opacity);return function(c){return i.r=o(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function oxe(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Ro(t[o]),r[o]=a.r||0,i[o]=a.g||0,s[o]=a.b||0;return r=e(r),i=e(i),s=e(s),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=s(u),a+""}}}var nft=oxe(rxe),rft=oxe(ixe);function nV(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function axe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ift(e,t){return(axe(t)?nV:uxe)(e,t)}function uxe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=cp(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function lxe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function vu(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function cxe(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=cp(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var kz=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xB=new RegExp(kz.source,"g");function sft(e){return function(){return e}}function oft(e){return function(t){return e(t)+""}}function fxe(e,t){var n=kz.lastIndex=xB.lastIndex=0,r,i,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(r=kz.exec(e))&&(i=xB.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,u.push({i:o,x:vu(r,i)})),n=xB.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?oft(u[0].x):sft(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function cp(e,t){var n=typeof t,r;return t==null||n==="boolean"?vR(t):(n==="number"?vu:n==="string"?(r=Nf(t))?(t=r,Sz):fxe:t instanceof Nf?Sz:t instanceof Date?lxe:axe(t)?nV:Array.isArray(t)?uxe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?cxe:vu)(e,t)}function aft(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function uft(e,t){var n=wR(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function QS(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var nne=180/Math.PI,Ez={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function dxe(e,t,n,r,i,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*nne,skewX:Math.atan(u)*nne,scaleX:o,scaleY:a}}var MA;function lft(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ez:dxe(t.a,t.b,t.c,t.d,t.e,t.f)}function cft(e){return e==null||(MA||(MA=document.createElementNS("http://www.w3.org/2000/svg","g")),MA.setAttribute("transform",e),!(e=MA.transform.baseVal.consolidate()))?Ez:(e=e.matrix,dxe(e.a,e.b,e.c,e.d,e.e,e.f))}function hxe(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,c,f,d,h,p){if(l!==f||c!==d){var m=h.push("translate(",null,t,null,n);p.push({i:m-4,x:vu(l,f)},{i:m-2,x:vu(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:vu(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:vu(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var m=h.push(i(h)+"scale(",null,",",null,")");p.push({i:m-4,x:vu(l,f)},{i:m-2,x:vu(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,m=d.length,x;++p<m;)f[(x=d[p]).i]=x.x(h);return f.join("")}}}var fft=hxe(lft,"px, ","px)","deg)"),dft=hxe(cft,", ",")",")"),hft=1e-12;function rne(e){return((e=Math.exp(e))+1/e)/2}function pft(e){return((e=Math.exp(e))-1/e)/2}function gft(e){return((e=Math.exp(2*e))-1)/(e+1)}const mft=function e(t,n,r){function i(s,o){var a=s[0],u=s[1],l=s[2],c=o[0],f=o[1],d=o[2],h=c-a,p=f-u,m=h*h+p*p,x,b;if(m<hft)b=Math.log(d/l)/t,x=function(E){return[a+E*h,u+E*p,l*Math.exp(t*E*b)]};else{var v=Math.sqrt(m),$=(d*d-l*l+r*m)/(2*l*n*v),C=(d*d-l*l-r*m)/(2*d*n*v),S=Math.log(Math.sqrt($*$+1)-$),A=Math.log(Math.sqrt(C*C+1)-C);b=(A-S)/t,x=function(E){var _=E*b,D=rne(S),N=l/(n*v)*(D*gft(t*_+S)-pft(S));return[a+N*h,u+N*p,l*D/rne(t*_+S)]}}return x.duration=b*1e3*t/Math.SQRT2,x}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return e(o,a,u)},i}(Math.SQRT2,2,4);function pxe(e){return function(t,n){var r=e((t=Nh(t)).h,(n=Nh(n)).h),i=pi(t.s,n.s),s=pi(t.l,n.l),o=pi(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const yft=pxe(wR);var xft=pxe(pi);function bft(e,t){var n=pi((e=Dh(e)).l,(t=Dh(t)).l),r=pi(e.a,t.a),i=pi(e.b,t.b),s=pi(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=s(o),e+""}}function gxe(e){return function(t,n){var r=e((t=Fh(t)).h,(n=Fh(n)).h),i=pi(t.c,n.c),s=pi(t.l,n.l),o=pi(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const vft=gxe(wR);var wft=gxe(pi);function mxe(e){return function t(n){n=+n;function r(i,s){var o=e((i=mm(i)).h,(s=mm(s)).h),a=pi(i.s,s.s),u=pi(i.l,s.l),l=pi(i.opacity,s.opacity);return function(c){return i.h=o(c),i.s=a(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}const $ft=mxe(wR);var Cft=mxe(pi);function rV(e,t){t===void 0&&(t=e,e=cp);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(o){var a=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return s[a](o-a)}}function Sft(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const kft=Object.freeze(Object.defineProperty({__proto__:null,interpolate:cp,interpolateArray:ift,interpolateBasis:rxe,interpolateBasisClosed:ixe,interpolateCubehelix:$ft,interpolateCubehelixLong:Cft,interpolateDate:lxe,interpolateDiscrete:aft,interpolateHcl:vft,interpolateHclLong:wft,interpolateHsl:yft,interpolateHslLong:xft,interpolateHue:uft,interpolateLab:bft,interpolateNumber:vu,interpolateNumberArray:nV,interpolateObject:cxe,interpolateRgb:Sz,interpolateRgbBasis:nft,interpolateRgbBasisClosed:rft,interpolateRound:QS,interpolateString:fxe,interpolateTransformCss:fft,interpolateTransformSvg:dft,interpolateZoom:mft,piecewise:rV,quantize:Sft},Symbol.toStringTag,{value:"Module"}));function Eft(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const Aft="identity",iV="linear",Ay="log",sV="pow",oV="sqrt",aV="symlog",_ft="time",Tft="utc",Ib="sequential",ZS="diverging",ine="quantile",Ift="quantize",Nft="threshold",Dft="ordinal",Fft="point",Rft="band",Oft="bin-ordinal",Ii="continuous",$R="discrete",CR="discretizing",Xu="interpolating",yxe="temporal";function Mft(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function Lft(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,o,a,u,l;for(i<r&&(a=r,r=i,i=a),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(s<0&&(s=u),o=u);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function uV(){const e=jW().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,o=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=Eft(f,a,u);let m=r[d-0];i=(h-m)/(p||1),o&&(i=Math.floor(i)),m+=(h-m-i*(f-a))*l,s=i*(1-a),o&&(m=Math.round(m),s=Math.round(s));const x=Aut(f).map(b=>m+i*b);return n(d?x.reverse():x)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let m=+f[0],x=+f[1],b,v,$;if(!(m!==m||x!==x)&&(x<m&&($=m,m=x,x=$),!(x<h[0]||m>r[1-d])))return b=Math.max(0,pm(h,m)-1),v=m===x?b:pm(h,x)-1,m-h[b]>s+1e-10&&++b,d&&($=b,b=p-v,v=p-$),b>v?void 0:t().slice(b,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return uV().domain(t()).range(r).round(o).paddingInner(a).paddingOuter(u).align(l)},c()}function xxe(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return xxe(t())},e}function Pft(){return xxe(uV().paddingInner(1))}var Bft=Array.prototype.map;function zft(e){return Bft.call(e,Lat)}const Uft=Array.prototype.slice;function bxe(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(pm(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=zft(r),n):e.slice()},n.range=function(r){return arguments.length?(t=Uft.call(r),n):t.slice()},n.tickFormat=function(r,i){return Dye(e[0],aT(e),r??10,i)},n.copy=function(){return bxe().domain(n.domain()).range(n.range())},n}const Az=new Map,jft=Symbol("vega_scale");function Wft(e){return e[jft]=!0,e}function Vft(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?Mft(s):s.invertExtent?Lft(s):void 0),s.type=e,Wft(s)};return r.metadata=T1e(Pat(n)),r}function Bn(e,t,n){return arguments.length>1?(Az.set(e,Vft(e,t,n)),this):qft(e)?Az.get(e):void 0}Bn(Aft,Rye);Bn(iV,Fye,Ii);Bn(Ay,Mye,[Ii,Ay]);Bn(sV,QW,Ii);Bn(oV,Hct,Ii);Bn(aV,Lye,Ii);Bn(_ft,Kct,[Ii,yxe]);Bn(Tft,Qct,[Ii,yxe]);Bn(Ib,JW,[Ii,Xu]);Bn(`${Ib}-${iV}`,JW,[Ii,Xu]);Bn(`${Ib}-${Ay}`,Uye,[Ii,Xu,Ay]);Bn(`${Ib}-${sV}`,eV,[Ii,Xu]);Bn(`${Ib}-${oV}`,Zct,[Ii,Xu]);Bn(`${Ib}-${aV}`,jye,[Ii,Xu]);Bn(`${ZS}-${iV}`,Wye,[Ii,Xu]);Bn(`${ZS}-${Ay}`,Vye,[Ii,Xu,Ay]);Bn(`${ZS}-${sV}`,tV,[Ii,Xu]);Bn(`${ZS}-${oV}`,Jct,[Ii,Xu]);Bn(`${ZS}-${aV}`,qye,[Ii,Xu]);Bn(ine,Pye,[CR,ine]);Bn(Ift,Bye,CR);Bn(Nft,zye,CR);Bn(Oft,bxe,[$R,CR]);Bn(Dft,jW,$R);Bn(Rft,uV,$R);Bn(Fft,Pft,$R);function qft(e){return Az.has(e)}function Gft(e,t,n){return HW(Hft("rgb",n),e)}function Hft(e,t){const n=Oct[Xft(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function Xft(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const Yft={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Kft={accent:Hye,category10:Gye,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:Xye,observable10:Yye,paired:Kye,pastel1:Qye,pastel2:Zye,set1:Jye,set2:exe,set3:txe,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function vxe(e){if(i0(e))return e;const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function wxe(e,t){for(const n in e)Qft(n,t(e[n]))}const sne={};wxe(Kft,vxe);wxe(Yft,e=>Gft(vxe(e)));function Qft(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(sne[e]=t,this):sne[e]}function Zft(e){return e&&e.gradient}const one={basis:{curve:nut},"basis-closed":{curve:rut},"basis-open":{curve:iut},bundle:{curve:sut,tension:"beta",value:.85},cardinal:{curve:out,tension:"tension",value:0},"cardinal-open":{curve:uut,tension:"tension",value:0},"cardinal-closed":{curve:aut,tension:"tension",value:0},"catmull-rom":{curve:lut,tension:"alpha",value:.5},"catmull-rom-closed":{curve:cut,tension:"alpha",value:.5},"catmull-rom-open":{curve:fut,tension:"alpha",value:.5},linear:{curve:$W},"linear-closed":{curve:dut},monotone:{horizontal:put,vertical:hut},natural:{curve:gut},step:{curve:mut},"step-after":{curve:xut},"step-before":{curve:yut}};function $xe(e,t,n){var r=Od(one,e)&&one[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const Jft={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},edt=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,tdt=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,ndt=/^((\s+,?\s*)|(,\s*))/,rdt=/^[01]/;function Cxe(e){const t=[];return(e.match(edt)||[]).forEach(r=>{let i=r[0];const s=i.toLowerCase(),o=Jft[s],a=idt(s,o,r.slice(1).trim()),u=a.length;if(u<o||u&&u%o!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([i,...a.slice(0,o)]),u!==o){s==="m"&&(i=i==="M"?"L":"l");for(let l=o;l<u;l+=o)t.push([i,...a.slice(l,l+o)])}}),t}function idt(e,t,n){const r=[];for(let i=0;t&&i<n.length;)for(let s=0;s<t;++s){const o=e==="a"&&(s===3||s===4)?rdt:tdt,a=n.slice(i).match(o);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");i+=a[0].length,r.push(+a[0]);const u=n.slice(i).match(ndt);u!==null&&(i+=u[0].length)}return r}const Rh=Math.PI/180,sdt=1e-14,bg=Math.PI/2,wl=Math.PI*2,f1=Math.sqrt(3)/2;var bB={},vB={},Sxe=[].join;function odt(e,t,n,r,i,s,o,a,u){const l=Sxe.call(arguments);if(bB[l])return bB[l];const c=o*Rh,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(a-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(a-e)*.5;let m=h*h/(n*n)+p*p/(r*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const x=d/n,b=f/n,v=-f/r,$=d/r,C=x*a+b*u,S=v*a+$*u,A=x*e+b*t,E=v*e+$*t;let D=1/((A-C)*(A-C)+(E-S)*(E-S))-.25;D<0&&(D=0);let N=Math.sqrt(D);s==i&&(N=-N);const T=.5*(C+A)-N*(E-S),L=.5*(S+E)+N*(A-C),O=Math.atan2(S-L,C-T);let R=Math.atan2(E-L,A-T)-O;R<0&&s===1?R+=wl:R>0&&s===0&&(R-=wl);const P=Math.ceil(Math.abs(R/(bg+.001))),j=[];for(let z=0;z<P;++z){const q=O+z*R/P,H=O+(z+1)*R/P;j[z]=[T,L,q,H,n,r,f,d]}return bB[l]=j}function adt(e){const t=Sxe.call(e);if(vB[t])return vB[t];var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7];const c=l*o,f=-u*a,d=u*o,h=l*a,p=Math.cos(i),m=Math.sin(i),x=Math.cos(s),b=Math.sin(s),v=.5*(s-i),$=Math.sin(v*.5),C=8/3*$*$/Math.sin(v),S=n+p-C*m,A=r+m+C*p,E=n+x,_=r+b,D=E+C*b,N=_-C*x;return vB[t]=[c*S+f*A,d*S+h*A,c*D+f*N,d*D+h*N,c*E+f*_,d*E+h*_]}const wa=["l",0,0,0,0,0,0,0];function udt(e,t,n){const r=wa[0]=e[0];if(r==="a"||r==="A")wa[1]=t*e[1],wa[2]=n*e[2],wa[3]=e[3],wa[4]=e[4],wa[5]=e[5],wa[6]=t*e[6],wa[7]=n*e[7];else if(r==="h"||r==="H")wa[1]=t*e[1];else if(r==="v"||r==="V")wa[1]=n*e[1];else for(var i=1,s=e.length;i<s;++i)wa[i]=(i%2==1?t:n)*e[i];return wa}function _z(e,t,n,r,i,s){var o,a=null,u=0,l=0,c=0,f=0,d,h,p,m,x=0,b=0;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),s==null&&(s=i),e.beginPath&&e.beginPath();for(var v=0,$=t.length;v<$;++v){switch(o=t[v],(i!==1||s!==1)&&(o=udt(o,i,s)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+r);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+r);break;case"h":u+=o[1],e.lineTo(u+n,l+r);break;case"H":u=o[1],e.lineTo(u+n,l+r);break;case"v":l+=o[1],e.lineTo(u+n,l+r);break;case"V":l=o[1],e.lineTo(u+n,l+r);break;case"m":u+=o[1],l+=o[2],x=u,b=l,e.moveTo(u+n,l+r);break;case"M":u=o[1],l=o[2],x=u,b=l,e.moveTo(u+n,l+r);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+o[1]+n,l+o[2]+r,d+n,h+r),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-p,f=2*l-m):a[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,m=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":ane(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+r]),u+=o[6],l+=o[7];break;case"A":ane(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),u=o[6],l=o[7];break;case"z":case"Z":u=x,l=b,e.closePath();break}a=o}}function ane(e,t,n,r){const i=odt(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let s=0;s<i.length;++s){const o=adt(i[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const une=.5773502691896257,lne={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,wl)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,s=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-s),e.lineTo(i,-s),e.lineTo(0,-n),e.lineTo(-i,-s),e.lineTo(-r,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=f1*n,i=r-n*une,s=n/4;e.moveTo(0,-r-i),e.lineTo(-s,r-i),e.lineTo(s,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=f1*n,i=r-n*une;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=f1*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=f1*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=f1*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=f1*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function ldt(e){return Od(lne,e)?lne[e]:cdt(e)}var wB={};function cdt(e){if(!Od(wB,e)){const t=Cxe(e);wB[e]={draw:function(n,r){_z(n,t,0,0,Math.sqrt(r)/2)}}}return wB[e]}const $d=.448084975506;function fdt(e){return e.x}function ddt(e){return e.y}function hdt(e){return e.width}function pdt(e){return e.height}function zc(e){return typeof e=="function"?e:()=>+e}function LA(e,t,n){return Math.max(t,Math.min(e,n))}function gdt(){var e=fdt,t=ddt,n=hdt,r=pdt,i=zc(0),s=i,o=i,a=i,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),m=d??+t.call(this,c),x=+n.call(this,c),b=+r.call(this,c),v=Math.min(x,b)/2,$=LA(+i.call(this,c),0,v),C=LA(+s.call(this,c),0,v),S=LA(+o.call(this,c),0,v),A=LA(+a.call(this,c),0,v);if(u||(u=h=wW()),$<=0&&C<=0&&S<=0&&A<=0)u.rect(p,m,x,b);else{var E=p+x,_=m+b;u.moveTo(p+$,m),u.lineTo(E-C,m),u.bezierCurveTo(E-$d*C,m,E,m+$d*C,E,m+C),u.lineTo(E,_-A),u.bezierCurveTo(E,_-$d*A,E-$d*A,_,E-A,_),u.lineTo(p+S,_),u.bezierCurveTo(p+$d*S,_,p,_-$d*S,p,_-S),u.lineTo(p,m+$),u.bezierCurveTo(p,m+$d*$,p+$d*$,m,p+$,m),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=zc(c),l):e},l.y=function(c){return arguments.length?(t=zc(c),l):t},l.width=function(c){return arguments.length?(n=zc(c),l):n},l.height=function(c){return arguments.length?(r=zc(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=zc(c),s=f!=null?zc(f):i,a=d!=null?zc(d):i,o=h!=null?zc(h):s,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function mdt(){var e,t,n,r,i=null,s,o,a,u;function l(f,d,h){const p=h/2;if(s){var m=a-d,x=f-o;if(m||x){var b=Math.hypot(m,x),v=(m/=b)*u,$=(x/=b)*u,C=Math.atan2(x,m);i.moveTo(o-v,a-$),i.lineTo(f-m*p,d-x*p),i.arc(f,d,p,C-Math.PI,C),i.lineTo(o+v,a+$),i.arc(o,a,u,C,C+Math.PI)}else i.arc(f,d,p,0,wl);i.closePath()}else s=1;o=f,a=d,u=p}function c(f){var d,h=f.length,p,m=!1,x;for(i==null&&(i=x=wW()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===m&&(m=!m)&&(s=0),m&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(x)return i=null,x+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function JS(e,t){return e??t}const ek=e=>e.x||0,tk=e=>e.y||0,ydt=e=>e.width||0,xdt=e=>e.height||0,bdt=e=>(e.x||0)+(e.width||0),vdt=e=>(e.y||0)+(e.height||0),wdt=e=>e.startAngle||0,$dt=e=>e.endAngle||0,Cdt=e=>e.padAngle||0,Sdt=e=>e.innerRadius||0,kdt=e=>e.outerRadius||0,Edt=e=>e.cornerRadius||0,Adt=e=>JS(e.cornerRadiusTopLeft,e.cornerRadius)||0,_dt=e=>JS(e.cornerRadiusTopRight,e.cornerRadius)||0,Tdt=e=>JS(e.cornerRadiusBottomRight,e.cornerRadius)||0,Idt=e=>JS(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Ndt=e=>JS(e.size,64),Ddt=e=>e.size||1,SR=e=>e.defined!==!1,Fdt=e=>ldt(e.shape||"circle"),Rdt=Jat().startAngle(wdt).endAngle($dt).padAngle(Cdt).innerRadius(Sdt).outerRadius(kdt).cornerRadius(Edt),Odt=L1e().x(ek).y1(tk).y0(vdt).defined(SR),Mdt=L1e().y(tk).x1(ek).x0(bdt).defined(SR),Ldt=M1e().x(ek).y(tk).defined(SR),Pdt=gdt().x(ek).y(tk).width(ydt).height(xdt).cornerRadius(Adt,_dt,Tdt,Idt),Bdt=tut().type(Fdt).size(Ndt),zdt=mdt().x(ek).y(tk).defined(SR).size(Ddt);function lV(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Udt(e,t){return Rdt.context(e)(t)}function jdt(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Mdt:Odt).curve($xe(r,n.orient,n.tension)).context(e)(t)}function Wdt(e,t){const n=t[0],r=n.interpolate||"linear";return Ldt.curve($xe(r,n.orient,n.tension)).context(e)(t)}function Nb(e,t,n,r){return Pdt.context(e)(t,n,r)}function Vdt(e,t){return(t.mark.shape||t.shape).context(e)(t)}function qdt(e,t){return Bdt.context(e)(t)}function Gdt(e,t){return zdt.context(e)(t)}var Hdt=1;function Xdt(e,t,n){var r=t.clip,i=e._defs,s=t.clip_id||(t.clip_id="clip"+Hdt++),o=i.clipping[s]||(i.clipping[s]={id:s});return _1e(r)?o.path=r(null):lV(n)?o.path=Nb(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function ec(e){this.clear(),e&&this.union(e)}ec.prototype={clone(){return new ec(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:s,y2:o}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*r-u*i+l,u*r+a*i+c,a*r-u*o+l,u*r+a*o+c,a*s-u*i+l,u*s+a*i+c,a*s-u*o+l,u*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function cV(e){this.mark=e,this.bounds=this.bounds||new ec}function kxe(e){cV.call(this,e),this.items=this.items||[]}s0(kxe,cV);function fp(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Ydt(t,r):0))}return e}function Ydt(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const Kdt=wl-1e-8;let kR,uT,lT,Tg,Tz,cT,Iz,Nz;const zd=(e,t)=>kR.add(e,t),fT=(e,t)=>zd(uT=e,lT=t),cne=e=>zd(e,kR.y1),fne=e=>zd(kR.x1,e),vg=(e,t)=>Tz*e+Iz*t,wg=(e,t)=>cT*e+Nz*t,$B=(e,t)=>zd(vg(e,t),wg(e,t)),CB=(e,t)=>fT(vg(e,t),wg(e,t));function ER(e,t){return kR=e,t?(Tg=t*Rh,Tz=Nz=Math.cos(Tg),cT=Math.sin(Tg),Iz=-cT):(Tz=Nz=1,Tg=cT=Iz=0),Qdt}const Qdt={beginPath(){},closePath(){},moveTo:CB,lineTo:CB,rect(e,t,n,r){Tg?($B(e+n,t),$B(e+n,t+r),$B(e,t+r),CB(e,t)):(zd(e+n,t+r),fT(e,t))},quadraticCurveTo(e,t,n,r){const i=vg(e,t),s=wg(e,t),o=vg(n,r),a=wg(n,r);dne(uT,i,o,cne),dne(lT,s,a,fne),fT(o,a)},bezierCurveTo(e,t,n,r,i,s){const o=vg(e,t),a=wg(e,t),u=vg(n,r),l=wg(n,r),c=vg(i,s),f=wg(i,s);hne(uT,o,u,c,cne),hne(lT,a,l,f,fne),fT(c,f)},arc(e,t,n,r,i,s){if(r+=Tg,i+=Tg,uT=n*Math.cos(i)+e,lT=n*Math.sin(i)+t,Math.abs(i-r)>Kdt)zd(e-n,t-n),zd(e+n,t+n);else{const o=l=>zd(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(o(r),o(i),i!==r)if(r=r%wl,r<0&&(r+=wl),i=i%wl,i<0&&(i+=wl),i<r&&(s=!s,a=r,r=i,i=a),s)for(i-=wl,a=r-r%bg,u=0;u<4&&a>i;++u,a-=bg)o(a);else for(a=r-r%bg+bg,u=0;u<4&&a<i;++u,a=a+bg)o(a)}}};function dne(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function hne(e,t,n,r,i){const s=r-e+3*t-3*n,o=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(s)>sdt?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),u=(-o+c)/s,l=(-o-c)/s)):u=.5*a/o,0<u&&u<1&&i(pne(u,e,t,n,r)),0<l&&l<1&&i(pne(l,e,t,n,r))}function pne(e,t,n,r,i){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*r+a*e*i}var sh=(sh=op(1,1))?sh.getContext("2d"):null;const Dz=new ec;function Exe(e){return function(t,n){if(!sh)return!0;e(sh,t),Dz.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:s,y2:o}=Dz;for(let a=i;a<=o;++a)for(let u=r;u<=s;++u)if(sh.isPointInPath(u,a))return!0;return!1}}function Axe(e,t){return t.contains(e.x||0,e.y||0)}function _xe(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,s=e.height||0;return t.intersects(Dz.set(n,r,n+i,r+s))}function Zdt(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:r;return q2(t,n,r,i,s)}function q2(e,t,n,r,i){const{x1:s,y1:o,x2:a,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,p,m,x;for(x=0;x<4;++x){if(x===0&&(h=-l,p=-(s-t)),x===1&&(h=l,p=a-t),x===2&&(h=-c,p=-(o-n)),x===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(m=p/h,h<0){if(m>d)return!1;m>f&&(f=m)}else if(h>0){if(m<f)return!1;m<d&&(d=m)}}return!0}function _y(e,t){e.globalCompositeOperation=t.blend||"source-over"}function fu(e,t){return e??t}function gne(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function Jdt(e,t,n){const r=n.width(),i=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+fu(t.x1,.5)*r,n.y1+fu(t.y1,.5)*i,Math.max(r,i)*fu(t.r1,0),n.x1+fu(t.x2,.5)*r,n.y1+fu(t.y2,.5)*i,Math.max(r,i)*fu(t.r2,.5));else{const o=fu(t.x1,0),a=fu(t.y1,0),u=fu(t.x2,1),l=fu(t.y2,0);if(o===u||a===l||r===i)s=e.createLinearGradient(n.x1+o*r,n.y1+a*i,n.x1+u*r,n.y1+l*i);else{const c=op(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=gne(f.createLinearGradient(o,a,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return gne(s,t.stops)}function Txe(e,t,n){return Zft(n)?Jdt(e,n,t.bounds):n}function FI(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=Txe(e,t,t.fill),!0):!1}var eht=[];function Ty(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=Txe(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||eht),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function tht(e,t){return e.zindex-t.zindex||e.index-t.index}function Ixe(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,s;for(i=0,s=t.length;i<s;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(tht)}function Iy(e,t){var n=e.items,r,i;if(!n||!n.length)return;const s=Ixe(e);if(s&&s.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=s}for(r=0,i=n.length;r<i;++r)t(n[r])}function Fz(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const s=Ixe(e);for(s&&s.length&&(n=s),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===s){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function fV(e){return function(t,n,r){Iy(n,i=>{(!r||r.intersects(i.bounds))&&Nxe(e,t,i,i)})}}function nht(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&Nxe(e,t,n.items[0],n.items)}}function Nxe(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(_y(t,n),n.fill&&FI(t,n,i)&&t.fill(),n.stroke&&Ty(t,n,i)&&t.stroke()))}function AR(e){return e=e||A1e,function(t,n,r,i,s,o){return r*=t.pixelRatio,i*=t.pixelRatio,Fz(n,a=>{const u=a.bounds;if(!(u&&!u.contains(s,o)||!u)&&e(t,a,r,i,s,o))return a})}}function nk(e,t){return function(n,r,i,s){var o=Array.isArray(r)?r[0]:r,a=t??o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,s)||u&&n.isPointInStroke(i,s)}}function dV(e){return AR(nk(e))}function Wg(e,t){return"translate("+e+","+t+")"}function hV(e){return"rotate("+e+")"}function rht(e,t){return"scale("+e+","+t+")"}function Dxe(e){return Wg(e.x||0,e.y||0)}function iht(e){return Wg(e.x||0,e.y||0)+(e.angle?" "+hV(e.angle):"")}function sht(e){return Wg(e.x||0,e.y||0)+(e.angle?" "+hV(e.angle):"")+(e.scaleX||e.scaleY?" "+rht(e.scaleX||1,e.scaleY||1):"")}function pV(e,t,n){function r(o,a){o("transform",iht(a)),o("d",t(null,a))}function i(o,a){return t(ER(o,a.angle),a),fp(o,a).translate(a.x||0,a.y||0)}function s(o,a){var u=a.x||0,l=a.y||0,c=a.angle||0;o.translate(u,l),c&&o.rotate(c*=Rh),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:fV(s),pick:dV(s),isect:n||Exe(s)}}var oht=pV("arc",Udt);function aht(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,s=1/0,o,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<s&&(s=a,o=e[i]));return o}function uht(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,s,o;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],s=e[r].y-t[1],o=i*i+s*s,o<n))return e[r];return null}function lht(e,t){for(var n=e.length,r,i,s;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],s=r*r+i*i,r=e[n].size||1,s<r*r))return e[n];return null}function gV(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(ER(u),c),fp(u,c[0]))}function s(u,l){u.beginPath(),t(u,l)}const o=nk(s);function a(u,l,c,f,d,h){var p=l.items,m=l.bounds;return!p||!p.length||m&&!m.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:nht(s),pick:a,isect:Axe,tip:n}}var cht=gV("area",jdt,aht);function fht(e,t){e.beginPath(),lV(t)?Nb(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Fxe(e){const t=fu(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function dht(e,t){e("transform",Dxe(t))}function Rxe(e,t){const n=Fxe(t);e("d",Nb(null,t,n,n))}function hht(e,t){e("class","background"),e("aria-hidden",!0),Rxe(e,t)}function pht(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?Rxe(e,t):e("d","")}function ght(e,t,n){const r=t.clip?Xdt(n,t,t):null;e("clip-path",r)}function mht(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),fp(e,t),e.translate(t.x||0,t.y||0)}function k$(e,t,n,r){const i=Fxe(t);e.beginPath(),Nb(e,t,(n||0)+i,(r||0)+i)}const yht=nk(k$),xht=nk(k$,!1),bht=nk(k$,!0);function vht(e,t,n,r){Iy(t,i=>{const s=i.x||0,o=i.y||0,a=i.strokeForeground,u=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&u&&(k$(e,i,s,o),_y(e,i),i.fill&&FI(e,i,u)&&e.fill(),i.stroke&&!a&&Ty(e,i,u)&&e.stroke()),e.save(),e.translate(s,o),i.clip&&fht(e,i),n&&n.translate(-s,-o),Iy(i,l=>{(l.marktype==="group"||r==null||r.includes(l.marktype))&&this.draw(e,l,n,r)}),n&&n.translate(s,o),e.restore(),a&&i.stroke&&u&&(k$(e,i,s,o),_y(e,i),Ty(e,i,u)&&e.stroke())})}function wht(e,t,n,r,i,s){if(t.bounds&&!t.bounds.contains(i,s)||!t.items)return null;const o=n*e.pixelRatio,a=r*e.pixelRatio;return Fz(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,s))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),m=u.clip;if(m&&(i<c||i>h||s<f||s>p))return;if(e.save(),e.translate(c,f),c=i-c,f=s-f,m&&lV(u)&&!bht(e,u,o,a))return e.restore(),null;const x=u.strokeForeground,b=t.interactive!==!1;return b&&x&&u.stroke&&xht(e,u,o,a)?(e.restore(),u):(l=Fz(u,v=>$ht(v,c,f)?this.pick(v,n,r,c,f):null),!l&&b&&(u.fill||!x&&u.stroke)&&yht(e,u,o,a)&&(l=u),e.restore(),l||null)})}function $ht(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var Cht={type:"group",tag:"g",nested:!1,attr:dht,bound:mht,draw:vht,pick:wht,isect:_xe,content:ght,background:hht,foreground:pht},Sht={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function mV(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function yV(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function xV(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function _R(e,t){return e==="center"?t/2:e==="right"?t:0}function TR(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function kht(e,t,n){const r=mV(t,n),i=yV(t,r),s=xV(t,r),o=(t.x||0)-_R(t.align,i),a=(t.y||0)-TR(t.baseline,s),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,Sht["xmlns:xlink"],"xlink:href"),e("transform",Wg(o,a)),e("width",i),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function Eht(e,t){const n=t.image,r=yV(t,n),i=xV(t,n),s=(t.x||0)-_R(t.align,r),o=(t.y||0)-TR(t.baseline,i);return e.set(s,o,s+r,o+i)}function Aht(e,t,n){Iy(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=mV(r,this);let s=yV(r,i),o=xV(r,i);if(s===0||o===0)return;let a=(r.x||0)-_R(r.align,s),u=(r.y||0)-TR(r.baseline,o),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=s/c,u+=(o-d)/2,o=d):(d=o*c,a+=(s-d)/2,s=d))),(i.complete||i.toDataURL)&&(_y(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,a,u,s,o))})}var _ht={type:"image",tag:"image",nested:!1,attr:kht,bound:Eht,draw:Aht,pick:AR(),isect:A1e,get:mV,xOffset:_R,yOffset:TR},Tht=gV("line",Wdt,uht);function Iht(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",sht(t)),e("d",t.path)}function dT(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*Rh,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Cxe(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),_z(e,u,0,0,s,o),e.rotate(-a),e.translate(-r,-i)):_z(e,u,r,i,s,o)}function Nht(e,t){return dT(ER(e,t.angle),t)?e.set(0,0,0,0):fp(e,t,!0)}var Dht={type:"path",tag:"path",nested:!1,attr:Iht,bound:Nht,draw:fV(dT),pick:dV(dT),isect:Exe(dT)};function Fht(e,t){e("d",Nb(null,t))}function Rht(e,t){var n,r;return fp(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function mne(e,t){e.beginPath(),Nb(e,t)}var Oht={type:"rect",tag:"path",nested:!1,attr:Fht,bound:Rht,draw:fV(mne),pick:dV(mne),isect:_xe};function Mht(e,t){e("transform",Dxe(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function Lht(e,t){var n,r;return fp(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function Oxe(e,t,n){var r,i,s,o;return t.stroke&&Ty(e,t,n)?(r=t.x||0,i=t.y||0,s=t.x2!=null?t.x2:r,o=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(s,o),!0):!1}function Pht(e,t,n){Iy(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&Oxe(e,r,i)&&(_y(e,r),e.stroke())}})}function Bht(e,t,n,r){return e.isPointInStroke?Oxe(e,t,1)&&e.isPointInStroke(n,r):!1}var zht={type:"rule",tag:"line",nested:!1,attr:Mht,bound:Lht,draw:Pht,pick:AR(Bht),isect:Zdt},Uht=pV("shape",Vdt),jht=pV("symbol",qdt,Axe);const yne=jat();var Vg={height:c0,measureWidth:bV,estimateWidth:RI,width:RI,canvas:Mxe};Mxe(!0);function Mxe(e){Vg.width=e&&sh?bV:RI}function RI(e,t){return Lxe(OI(e,t),c0(e))}function Lxe(e,t){return~~(.8*e.length*t)}function bV(e,t){return c0(e)<=0||!(t=OI(e,t))?0:Pxe(t,wV(e))}function Pxe(e,t){const n=`(${t}) ${e}`;let r=yne.get(n);return r===void 0&&(sh.font=t,r=sh.measureText(e).width,yne.set(n,r)),r}function c0(e){return e.fontSize!=null?+e.fontSize||0:11}function E$(e){return e.lineHeight!=null?e.lineHeight:c0(e)+2}function Wht(e){return i0(e)?e.length>1?e:e[0]:e}function vV(e){return Wht(e.lineBreak&&e.text&&!i0(e.text)?e.text.split(e.lineBreak):e.text)}function Bxe(e){const t=vV(e);return(i0(t)?t.length-1:0)*E$(e)}function OI(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?qht(e,n):n}function Vht(e){if(Vg.width===bV){const t=wV(e);return n=>Pxe(n,t)}else if(Vg.width===RI){const t=c0(e);return n=>Lxe(n,t)}else return t=>Vg.width(e,t)}function qht(e,t){var n=+e.limit,r=Vht(e);if(r(t)<n)return t;var i=e.ellipsis||"…",s=e.dir==="rtl",o=0,a=t.length,u;if(n-=r(i),s){for(;o<a;)u=o+a>>>1,r(t.slice(u))>n?o=u+1:a=u;return i+t.slice(o)}else{for(;o<a;)u=1+(o+a>>>1),r(t.slice(0,u))<n?o=u:a=u-1;return t.slice(0,o)+i}}function Ght(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function wV(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+c0(e)+"px "+Ght(e,t)}function $V(e){var t=e.baseline,n=c0(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*E$(e):t==="line-bottom"?.29*n-.5*E$(e):0)}const Hht={left:"start",center:"middle",right:"end"},dw=new ec;function IR(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-bg,t+=r*Math.cos(i),n+=r*Math.sin(i)),dw.x1=t,dw.y1=n,dw}function Xht(e,t){var n=t.dx||0,r=(t.dy||0)+$V(t),i=IR(t),s=i.x1,o=i.y1,a=t.angle||0,u;e("text-anchor",Hht[t.align]||"start"),a?(u=Wg(s,o)+" "+hV(a),(n||r)&&(u+=" "+Wg(n,r))):u=Wg(s+n,o+r),e("transform",u)}function CV(e,t,n){var r=Vg.height(t),i=t.align,s=IR(t),o=s.x1,a=s.y1,u=t.dx||0,l=(t.dy||0)+$V(t)-Math.round(.8*r),c=vV(t),f;if(i0(c)?(r+=E$(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Vg.width(t,h)),0)):f=Vg.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=o,l+=a,u+f,l+r),t.angle&&!n)e.rotate(t.angle*Rh,o,a);else if(n===2)return e.rotatedPoints(t.angle*Rh,o,a);return e}function Yht(e,t,n){Iy(t,r=>{var i=r.opacity==null?1:r.opacity,s,o,a,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=wV(r),e.textAlign=r.align||"left",s=IR(r),o=s.x1,a=s.y1,r.angle&&(e.save(),e.translate(o,a),e.rotate(r.angle*Rh),o=a=0),o+=r.dx||0,a+=(r.dy||0)+$V(r),c=vV(r),_y(e,r),i0(c))for(l=E$(r),u=0;u<c.length;++u)f=OI(r,c[u]),r.fill&&FI(e,r,i)&&e.fillText(f,o,a),r.stroke&&Ty(e,r,i)&&e.strokeText(f,o,a),a+=l;else f=OI(r,c),r.fill&&FI(e,r,i)&&e.fillText(f,o,a),r.stroke&&Ty(e,r,i)&&e.strokeText(f,o,a);r.angle&&e.restore()}})}function Kht(e,t,n,r,i,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=IR(t),a=o.x1,u=o.y1,l=CV(dw,t,1),c=-t.angle*Rh,f=Math.cos(c),d=Math.sin(c),h=f*i-d*s+(a-f*a+d*u),p=d*i+f*s+(u-d*a-f*u);return l.contains(h,p)}function Qht(e,t){const n=CV(dw,e,2);return q2(t,n[0],n[1],n[2],n[3])||q2(t,n[0],n[1],n[4],n[5])||q2(t,n[4],n[5],n[6],n[7])||q2(t,n[2],n[3],n[6],n[7])}var Zht={type:"text",tag:"text",nested:!1,attr:Xht,bound:CV,draw:Yht,pick:AR(Kht),isect:Qht},Jht=gV("trail",Gdt,lht),ept={arc:oht,area:cht,group:Cht,image:_ht,line:Tht,path:Dht,rect:Oht,rule:zht,shape:Uht,symbol:jht,text:Zht,trail:Jht};T1e(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]);const SB=new ec;function tpt(e){const t=e.clip;if(_1e(t))t(ER(SB.clear()));else if(t)SB.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(SB)}const Ny="top",Cu="left",ku="right",Oh="bottom",npt="top-left",rpt="top-right",ipt="bottom-left",spt="bottom-right",SV="start",Rz="middle",Os="end",opt="x",apt="y",NR="group",kV="axis",EV="title",upt="frame",lpt="scope",AV="legend",zxe="row-header",Uxe="row-footer",jxe="row-title",Wxe="column-header",Vxe="column-footer",qxe="column-title",cpt="padding",fpt="symbol",Gxe="fit",Hxe="fit-x",Xxe="fit-y",dpt="pad",_V="none",PA="all",Oz="each",TV="flush",Ud="column",jd="row";function Yxe(e){xe.call(this,null,e)}s0(Yxe,xe,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,s=ept[i],o=s.bound;let a=r.bounds,u;if(s.nested)r.items.length&&n.dirty(r.items[0]),a=BA(r,o),r.items.forEach(l=>{l.bounds.clear().union(a)});else if(i===NR||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),r.items.forEach(l=>a.union(BA(l,o))),r.role){case kV:case AV:case EV:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(BA(l,o))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(BA(l,o))}),u&&(a.clear(),r.items.forEach(l=>a.union(l.bounds)));return tpt(r),t.modifies("bounds")}});function BA(e,t,n){return t(e.bounds.clear(),e,n)}const xne=":vega_identifier:";function IV(e){xe.call(this,0,e)}IV.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};s0(IV,xe,{transform(e,t){const n=hpt(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,s=>s[r]=s[r]||++i),n.set(this.value=i),t}});function hpt(e){return e._signals[xne]||(e._signals[xne]=e.add(0))}function Kxe(e){xe.call(this,null,e)}s0(Kxe,xe,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,ppt(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===NR?kxe:cV;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function ppt(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function Qxe(e){xe.call(this,null,e)}const bne={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!Zxe(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},Zxe=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),vne=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,s;n<r;i=s,++n)if(Zxe(i,s=e[n].bounds,t))return!0},gpt=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},mpt=(e,t,n)=>{var r=e.range(),i=new ec;return t===Ny||t===Oh?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),s=>i.encloses(s.bounds)},wne=e=>(e.forEach(t=>t.opacity=1),e),$ne=(e,t)=>e.reflow(t.modified()).modifies("opacity");s0(Qxe,xe,{transform(e,t){const n=bne[e.method]||bne.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,s,o;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(wne(i),t=$ne(t,e)),t;if(i=i.filter(gpt),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),s=wne(i),t=$ne(t,e),s.length>=3&&vne(s,r)){do s=n(s,r);while(s.length>=3&&vne(s,r));s.length<3&&!aT(i).opacity&&(s.length>1&&(aT(s).opacity=0),aT(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=mpt(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{o(u)||(u.opacity=0)}));const a=s[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function Jxe(e){xe.call(this,null,e)}s0(Jxe,xe,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const ns=new ec;function O1(e,t,n){return e[t]===n?0:(e[t]=n,1)}function ypt(e){var t=e.items[0].orient;return t===Cu||t===ku}function xpt(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function bpt(e,t,n,r){var i=t.items[0],s=i.datum,o=i.translate!=null?i.translate:.5,a=i.orient,u=xpt(s),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=s.title&&i.items[u[2]].items[0],m=i.titlePadding,x=i.bounds,b=p&&Bxe(p),v=0,$=0,C,S;switch(ns.clear().union(x),x.clear(),(C=u[0])>-1&&x.union(i.items[C].bounds),(C=u[1])>-1&&x.union(i.items[C].bounds),a){case Ny:v=f||0,$=-c,S=Math.max(d,Math.min(h,-x.y1)),x.add(0,-S).add(l,0),p&&zA(e,p,S,m,b,0,-1,x);break;case Cu:v=-c,$=f||0,S=Math.max(d,Math.min(h,-x.x1)),x.add(-S,0).add(0,l),p&&zA(e,p,S,m,b,1,-1,x);break;case ku:v=n+c,$=f||0,S=Math.max(d,Math.min(h,x.x2)),x.add(0,0).add(S,l),p&&zA(e,p,S,m,b,1,1,x);break;case Oh:v=f||0,$=r+c,S=Math.max(d,Math.min(h,x.y2)),x.add(0,0).add(l,S),p&&zA(e,p,S,m,0,0,1,x);break;default:v=i.x,$=i.y}return fp(x.translate(v,$),i),O1(i,"x",v+o)|O1(i,"y",$+o)&&(i.bounds=ns,e.dirty(i),i.bounds=x,e.dirty(i)),i.mark.bounds.clear().union(x)}function zA(e,t,n,r,i,s,o,a){const u=t.bounds;if(t.auto){const l=o*(n+i+r);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const Cne=(e,t)=>Math.floor(Math.min(e,t)),Sne=(e,t)=>Math.ceil(Math.max(e,t));function vpt(e){var t=e.items,n=t.length,r=0,i,s;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],s=i.items,i.marktype===NR)switch(i.role){case kV:case AV:case EV:break;case zxe:o.rowheaders.push(...s);break;case Uxe:o.rowfooters.push(...s);break;case Wxe:o.colheaders.push(...s);break;case Vxe:o.colfooters.push(...s);break;case jxe:o.rowtitle=s[0];break;case qxe:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}function wpt(e){return new ec().set(0,0,e.width||0,e.height||0)}function $pt(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function Kn(e,t,n){const r=Mat(e)?e[t]:e;return r??(n!==void 0?n:0)}function kne(e){return e<0?Math.ceil(-e):0}function ebe(e,t,n){var r=!n.nodirty,i=n.bounds===TV?wpt:$pt,s=ns.set(0,0,0,0),o=Kn(n.align,Ud),a=Kn(n.align,jd),u=Kn(n.padding,Ud),l=Kn(n.padding,jd),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),m=0,x=Array(d),b=Array(f),v=0,$=Array(d),C=Array(d),S=Array(d),A,E,_,D,N,T,L,O,M,R,P;for(E=0;E<c;++E)p[E]=0;for(E=0;E<f;++E)b[E]=0;for(E=0;E<d;++E)T=t[E],N=S[E]=i(T),T.x=T.x||0,$[E]=0,T.y=T.y||0,C[E]=0,_=E%c,D=~~(E/c),m=Math.max(m,L=Math.ceil(N.x2)),v=Math.max(v,O=Math.ceil(N.y2)),p[_]=Math.max(p[_],L),b[D]=Math.max(b[D],O),h[E]=u+kne(N.x1),x[E]=l+kne(N.y1),r&&e.dirty(t[E]);for(E=0;E<d;++E)E%c===0&&(h[E]=0),E<c&&(x[E]=0);if(o===Oz)for(_=1;_<c;++_){for(P=0,E=_;E<d;E+=c)P<h[E]&&(P=h[E]);for(E=_;E<d;E+=c)h[E]=P+p[_-1]}else if(o===PA){for(P=0,E=0;E<d;++E)E%c&&P<h[E]&&(P=h[E]);for(E=0;E<d;++E)E%c&&(h[E]=P+m)}else for(o=!1,_=1;_<c;++_)for(E=_;E<d;E+=c)h[E]+=p[_-1];if(a===Oz)for(D=1;D<f;++D){for(P=0,E=D*c,A=E+c;E<A;++E)P<x[E]&&(P=x[E]);for(E=D*c;E<A;++E)x[E]=P+b[D-1]}else if(a===PA){for(P=0,E=c;E<d;++E)P<x[E]&&(P=x[E]);for(E=c;E<d;++E)x[E]=P+v}else for(a=!1,D=1;D<f;++D)for(E=D*c,A=E+c;E<A;++E)x[E]+=b[D-1];for(M=0,E=0;E<d;++E)M=h[E]+(E%c?M:0),$[E]+=M-t[E].x;for(_=0;_<c;++_)for(R=0,E=_;E<d;E+=c)R+=x[E],C[E]+=R-t[E].y;if(o&&Kn(n.center,Ud)&&f>1)for(E=0;E<d;++E)N=o===PA?m:p[E%c],M=N-S[E].x2-t[E].x-$[E],M>0&&($[E]+=M/2);if(a&&Kn(n.center,jd)&&c!==1)for(E=0;E<d;++E)N=a===PA?v:b[~~(E/c)],R=N-S[E].y2-t[E].y-C[E],R>0&&(C[E]+=R/2);for(E=0;E<d;++E)s.union(S[E].translate($[E],C[E]));switch(M=Kn(n.anchor,opt),R=Kn(n.anchor,apt),Kn(n.anchor,Ud)){case Os:M-=s.width();break;case Rz:M-=s.width()/2}switch(Kn(n.anchor,jd)){case Os:R-=s.height();break;case Rz:R-=s.height()/2}for(M=Math.round(M),R=Math.round(R),s.clear(),E=0;E<d;++E)t[E].mark.bounds.clear();for(E=0;E<d;++E)T=t[E],T.x+=$[E]+=M,T.y+=C[E]+=R,s.union(T.mark.bounds.union(T.bounds.translate($[E],C[E]))),r&&e.dirty(T);return s}function Cpt(e,t,n){var r=vpt(t),i=r.marks,s=n.bounds===TV?Spt:kpt,o=n.offset,a=n.columns||i.length,u=a<=0?1:Math.ceil(i.length/a),l=u*a,c,f,d,h,p,m,x;const b=ebe(e,i,n);b.empty()&&b.set(0,0,0,0),r.rowheaders&&(m=Kn(n.headerBand,jd,null),c=UA(e,r.rowheaders,i,a,u,-Kn(o,"rowHeader"),Cne,0,s,"x1",0,a,1,m)),r.colheaders&&(m=Kn(n.headerBand,Ud,null),f=UA(e,r.colheaders,i,a,a,-Kn(o,"columnHeader"),Cne,1,s,"y1",0,1,a,m)),r.rowfooters&&(m=Kn(n.footerBand,jd,null),d=UA(e,r.rowfooters,i,a,u,Kn(o,"rowFooter"),Sne,0,s,"x2",a-1,a,1,m)),r.colfooters&&(m=Kn(n.footerBand,Ud,null),h=UA(e,r.colfooters,i,a,a,Kn(o,"columnFooter"),Sne,1,s,"y2",l-a,1,a,m)),r.rowtitle&&(p=Kn(n.titleAnchor,jd),x=Kn(o,"rowTitle"),x=p===Os?d+x:c-x,m=Kn(n.titleBand,jd,.5),Ene(e,r.rowtitle,x,0,b,m)),r.coltitle&&(p=Kn(n.titleAnchor,Ud),x=Kn(o,"columnTitle"),x=p===Os?h+x:f-x,m=Kn(n.titleBand,Ud,.5),Ene(e,r.coltitle,x,1,b,m))}function Spt(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function kpt(e,t){return e.bounds[t]}function UA(e,t,n,r,i,s,o,a,u,l,c,f,d,h){var p=n.length,m=0,x=0,b,v,$,C,S,A,E,_,D;if(!p)return m;for(b=c;b<p;b+=f)n[b]&&(m=o(m,u(n[b],l)));if(!t.length)return m;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),m+=s,v=0,C=t.length;v<C;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(b=c,v=0,C=t.length;v<C;++v,b+=f){for(A=t[v],S=A.mark.bounds,$=b;$>=0&&(E=n[$])==null;$-=d);a?(_=h==null?E.x:Math.round(E.bounds.x1+h*E.bounds.width()),D=m):(_=m,D=h==null?E.y:Math.round(E.bounds.y1+h*E.bounds.height())),S.union(A.bounds.translate(_-(A.x||0),D-(A.y||0))),A.x=_,A.y=D,e.dirty(A),x=o(x,S[l])}return x}function Ene(e,t,n,r,i,s){if(t){e.dirty(t);var o=n,a=n;r?o=Math.round(i.x1+s*i.width()):a=Math.round(i.y1+s*i.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function Ept(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function Apt(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function _pt(e,t,n,r,i,s,o){const a=Ept(n,t),u=Apt(e,a("offset",0)),l=a("anchor",SV),c=l===Os?1:l===Rz?.5:0,f={align:Oz,bounds:a("bounds",TV),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Cu:f.anchor={x:Math.floor(r.x1)-u,column:Os,y:c*(o||r.height()+2*r.y1),row:l};break;case ku:f.anchor={x:Math.ceil(r.x2)+u,y:c*(o||r.height()+2*r.y1),row:l};break;case Ny:f.anchor={y:Math.floor(i.y1)-u,row:Os,x:c*(s||i.width()+2*i.x1),column:l};break;case Oh:f.anchor={y:Math.ceil(i.y2)+u,x:c*(s||i.width()+2*i.x1),column:l};break;case npt:f.anchor={x:u,y:u};break;case rpt:f.anchor={x:s-u,y:u,column:Os};break;case ipt:f.anchor={x:u,y:o-u,row:Os};break;case spt:f.anchor={x:s-u,y:o-u,column:Os,row:Os};break}return f}function Tpt(e,t){var n=t.items[0],r=n.datum,i=n.orient,s=n.bounds,o=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),Npt(e,n,n.items[0].items[0]),s=Ipt(n,s),u=2*n.padding,l=2*n.padding,s.empty()||(u=Math.ceil(s.width()+u),l=Math.ceil(s.height()+l)),r.type===fpt&&Dpt(n.items[0].items[0].items[0].items),i!==_V&&(n.x=o=0,n.y=a=0),n.width=u,n.height=l,fp(s.set(o,a,o+u,a+l),n),n.mark.bounds.clear().union(s),n}function Ipt(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function Npt(e,t,n){var r=t.padding,i=r-n.x,s=r-n.y;if(!t.datum.title)(i||s)&&o2(e,n,i,s);else{var o=t.items[1].items[0],a=o.anchor,u=t.titlePadding||0,l=r-o.x,c=r-o.y;switch(o.orient){case Cu:i+=Math.ceil(o.bounds.width())+u;break;case ku:case Oh:break;default:s+=o.bounds.height()+u}switch((i||s)&&o2(e,n,i,s),o.orient){case Cu:c+=d1(t,n,o,a,1,1);break;case ku:l+=d1(t,n,o,Os,0,0)+u,c+=d1(t,n,o,a,1,1);break;case Oh:l+=d1(t,n,o,a,0,0),c+=d1(t,n,o,Os,-1,0,1)+u;break;default:l+=d1(t,n,o,a,0,0)}(l||c)&&o2(e,o,l,c),(l=Math.round(o.bounds.x1-r))<0&&(o2(e,n,-l,0),o2(e,o,-l,0))}}function d1(e,t,n,r,i,s,o){const a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(s||!u)&&!o?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&s?c:0,d=u&&s?0:c,h=i<=0?0:Bxe(n);return Math.round(r===SV?f:r===Os?d-h:.5*(c-h))}function o2(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function Dpt(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Fpt(e,t,n,r,i){var s=t.items[0],o=s.frame,a=s.orient,u=s.anchor,l=s.offset,c=s.padding,f=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],h=a===Cu||a===ku?r:n,p=0,m=0,x=0,b=0,v=0,$;if(o!==NR?a===Cu?(p=i.y2,h=i.y1):a===ku?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):a===Cu&&(p=r,h=0),$=u===SV?p:u===Os?h:(p+h)/2,d&&d.text){switch(a){case Ny:case Oh:v=f.bounds.height()+c;break;case Cu:b=f.bounds.width()+c;break;case ku:b=-f.bounds.width()-c;break}ns.clear().union(d.bounds),ns.translate(b-(d.x||0),v-(d.y||0)),O1(d,"x",b)|O1(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(ns),d.mark.bounds.clear().union(ns),e.dirty(d)),ns.clear().union(d.bounds)}else ns.clear();switch(ns.union(f.bounds),a){case Ny:m=$,x=i.y1-ns.height()-l;break;case Cu:m=i.x1-ns.width()-l,x=$;break;case ku:m=i.x2+ns.width()+l,x=$;break;case Oh:m=$,x=i.y2+l;break;default:m=s.x,x=s.y}return O1(s,"x",m)|O1(s,"y",x)&&(ns.translate(m,x),e.dirty(s),s.bounds.clear().union(ns),t.bounds.clear().union(ns),e.dirty(s)),s.bounds}function tbe(e){xe.call(this,null,e)}s0(tbe,xe,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&Cpt(n,r,e.layout),Opt(n,r,e)}),Rpt(e.mark.group)?t.reflow():t}});function Rpt(e){return e&&e.mark.role!=="legend-entry"}function Opt(e,t,n){var r=t.items,i=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=new ec().set(0,0,i,s),a=o.clone(),u=o.clone(),l=[],c,f,d,h,p,m;for(p=0,m=r.length;p<m;++p)switch(f=r[p],f.role){case kV:h=ypt(f)?a:u,h.union(bpt(e,f,i,s));break;case EV:c=f;break;case AV:l.push(Tpt(e,f));break;case upt:case lpt:case zxe:case Uxe:case jxe:case Wxe:case Vxe:case qxe:a.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const x={};l.forEach(b=>{d=b.orient||ku,d!==_V&&(x[d]||(x[d]=[])).push(b)});for(const b in x){const v=x[b];ebe(e,v,_pt(v,b,n.legends,a,u,i,s))}l.forEach(b=>{const v=b.bounds;if(v.equals(b._bounds)||(b.bounds=b._bounds,e.dirty(b),b.bounds=v,e.dirty(b)),n.autosize&&(n.autosize.type===Gxe||n.autosize.type===Hxe||n.autosize.type===Xxe))switch(b.orient){case Cu:case ku:o.add(v.x1,0).add(v.x2,0);break;case Ny:case Oh:o.add(0,v.y1).add(0,v.y2)}else o.union(v)})}o.union(a).union(u),c&&o.union(Fpt(e,c,i,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),Mpt(e,t,o,n)}function Mpt(e,t,n,r){const i=r.autosize||{},s=i.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===cpt){const p=e.padding();o-=p.left+p.right,a-=p.top+p.bottom}s===_V?(l=0,f=0,u=o,c=a):s===Gxe?(u=Math.max(0,o-l-d),c=Math.max(0,a-f-h)):s===Hxe?(u=Math.max(0,o-l-d),a=c+f+h):s===Xxe?(o=u+l+d,c=Math.max(0,a-f-h)):s===dpt&&(o=u+l+d,a=c+f+h),e._resizeView(o,a,u,c,[l,f],i.resize)}const Lpt=Object.freeze(Object.defineProperty({__proto__:null,bound:Yxe,identifier:IV,mark:Kxe,overlap:Qxe,render:Jxe,viewlayout:tbe},Symbol.toStringTag,{value:"Module"}));function dc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function dp(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Mz=Symbol("implicit");function NV(){var e=new Map,t=[],n=[],r=Mz;function i(s){var o=s+"",a=e.get(o);if(!a){if(r!==Mz)return r;e.set(o,a=t.push(s))}return n[(a-1)%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Map;for(const o of s){const a=o+"";e.has(a)||e.set(a,t.push(o))}return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return NV(t,n).unknown(r)},dc.apply(i,arguments),i}function Ppt(e){return function(){return e}}function Lz(e){return+e}var Ane=[0,1];function ko(e){return e}function Pz(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Ppt(isNaN(t)?NaN:.5)}function Bpt(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function zpt(e,t,n){var r=e[0],i=e[1],s=t[0],o=t[1];return i<r?(r=Pz(i,r),s=n(o,s)):(r=Pz(r,i),s=n(s,o)),function(a){return s(r(a))}}function Upt(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=Pz(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var u=Ah(e,a,1,r)-1;return s[u](i[u](a))}}function rk(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function DR(){var e=Ane,t=Ane,n=cp,r,i,s,o=ko,a,u,l;function c(){var d=Math.min(e.length,t.length);return o!==ko&&(o=Bpt(e[0],e[d-1])),a=d>2?Upt:zpt,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?s:(u||(u=a(e.map(r),t,n)))(r(o(d)))}return f.invert=function(d){return o(i((l||(l=a(t,e.map(r),vu)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,Lz),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=QS,c()},f.clamp=function(d){return arguments.length?(o=d?!0:ko,c()):o!==ko},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return r=d,i=h,c()}}function nbe(){return DR()(ko,ko)}function MI(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Dy(e){return e=MI(Math.abs(e)),e?e[1]:NaN}function jpt(e,t){return function(n,r){for(var i=n.length,s=[],o=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),s.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function Wpt(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Vpt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ym(e){return new DV(e)}ym.prototype=DV.prototype;function DV(e){if(!(t=Vpt.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}DV.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function qpt(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}return r>0?e.slice(0,r)+e.slice(i+1):e}var rbe;function Gpt(e,t){var n=MI(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(rbe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+MI(e,Math.max(0,t+s-1))[0]}function _ne(e,t){var n=MI(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Tne={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return _ne(e*100,t)},r:_ne,s:Gpt,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Ine(e){return e}var Nne=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function ibe(e){var t=e.grouping&&e.thousands?jpt(e.grouping,e.thousands):Ine,n=e.currency,r=e.decimal,i=e.numerals?Wpt(e.numerals):Ine,s=e.percent||"%";function o(u){u=ym(u);var l=u.fill,c=u.align,f=u.sign,d=u.symbol,h=u.zero,p=u.width,m=u.comma,x=u.precision,b=u.trim,v=u.type;v==="n"?(m=!0,v="g"):Tne[v]||(x==null&&(x=12),b=!0,v="g"),(h||l==="0"&&c==="=")&&(h=!0,l="0",c="=");var $=d==="$"?n[0]:d==="#"&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",C=d==="$"?n[1]:/[%p]/.test(v)?s:"",S=Tne[v],A=/[defgprs%]/.test(v);x=x==null?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function E(_){var D=$,N=C,T,L,O;if(v==="c")N=S(_)+N,_="";else{_=+_;var M=_<0;if(_=S(Math.abs(_),x),b&&(_=qpt(_)),M&&+_==0&&(M=!1),D=(M?f==="("?f:"-":f==="-"||f==="("?"":f)+D,N=(v==="s"?Nne[8+rbe/3]:"")+N+(M&&f==="("?")":""),A){for(T=-1,L=_.length;++T<L;)if(O=_.charCodeAt(T),48>O||O>57){N=(O===46?r+_.slice(T+1):_.slice(T))+N,_=_.slice(0,T);break}}}m&&!h&&(_=t(_,1/0));var R=D.length+_.length+N.length,P=R<p?new Array(p-R+1).join(l):"";switch(m&&h&&(_=t(P+_,P.length?p-N.length:1/0),P=""),c){case"<":_=D+_+N+P;break;case"=":_=D+P+_+N;break;case"^":_=P.slice(0,R=P.length>>1)+D+_+N+P.slice(R);break;default:_=P+D+_+N;break}return i(_)}return E.toString=function(){return u+""},E}function a(u,l){var c=o((u=ym(u),u.type="f",u)),f=Math.max(-8,Math.min(8,Math.floor(Dy(l)/3)))*3,d=Math.pow(10,-f),h=Nne[8+f/3];return function(p){return c(d*p)+h}}return{format:o,formatPrefix:a}}var jA,Db,FR;sbe({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function sbe(e){return jA=ibe(e),Db=jA.format,FR=jA.formatPrefix,jA}function FV(e){return Math.max(0,-Dy(Math.abs(e)))}function RV(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Dy(t)/3)))*3-Dy(Math.abs(e)))}function OV(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Dy(t)-Dy(e))+1}const Hpt=Object.freeze(Object.defineProperty({__proto__:null,get format(){return Db},formatDefaultLocale:sbe,formatLocale:ibe,get formatPrefix(){return FR},formatSpecifier:ym,precisionFixed:FV,precisionPrefix:RV,precisionRound:OV},Symbol.toStringTag,{value:"Module"}));function obe(e,t,n,r){var i=_h(e,t,n),s;switch(r=ym(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=RV(i,o))&&(r.precision=s),FR(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=OV(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=FV(i))&&(r.precision=s-(r.type==="%")*2);break}}return Db(r)}function f0(e){var t=e.domain;return e.ticks=function(n){var r=t();return sz(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return obe(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,o=r[i],a=r[s],u,l,c=10;for(a<o&&(l=o,o=a,a=l,l=i,i=s,s=l);c-- >0;){if(l=g0e(o,a,n),l===u)return r[i]=o,r[s]=a,t(r);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function abe(){var e=nbe();return e.copy=function(){return rk(e,abe())},dc.apply(e,arguments),f0(e)}function ube(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,Lz),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return ube(e).unknown(t)},e=arguments.length?Array.from(e,Lz):[0,1],f0(n)}function lbe(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],o;return s<i&&(o=n,n=r,r=o,o=i,i=s,s=o),e[n]=t.floor(i),e[r]=t.ceil(s),e}function Dne(e){return Math.log(e)}function Fne(e){return Math.exp(e)}function Xpt(e){return-Math.log(-e)}function Ypt(e){return-Math.exp(-e)}function Kpt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Qpt(e){return e===10?Kpt:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function Zpt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function Rne(e){return function(t){return-e(-t)}}function MV(e){var t=e(Dne,Fne),n=t.domain,r=10,i,s;function o(){return i=Zpt(r),s=Qpt(r),n()[0]<0?(i=Rne(i),s=Rne(s),e(Xpt,Ypt)):e(Dne,Fne),t}return t.base=function(a){return arguments.length?(r=+a,o()):r},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=function(a){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=i(l),h=i(c),p,m,x,b=a==null?10:+a,v=[];if(!(r%1)&&h-d<b){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(m=1,p=s(d);m<r;++m)if(x=p*m,!(x<l)){if(x>c)break;v.push(x)}}else for(;d<=h;++d)for(m=r-1,p=s(d);m>=1;--m)if(x=p*m,!(x<l)){if(x>c)break;v.push(x)}v.length*2<b&&(v=sz(l,c,b))}else v=sz(d,h,Math.min(h-d,b)).map(s);return f?v.reverse():v},t.tickFormat=function(a,u){if(u==null&&(u=r===10?".0e":","),typeof u!="function"&&(u=Db(u)),a===1/0)return u;a==null&&(a=10);var l=Math.max(1,r*a/t.ticks().length);return function(c){var f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=function(){return n(lbe(n(),{floor:function(a){return s(Math.floor(i(a)))},ceil:function(a){return s(Math.ceil(i(a)))}}))},t}function cbe(){var e=MV(DR()).domain([1,10]);return e.copy=function(){return rk(e,cbe()).base(e.base())},dc.apply(e,arguments),e}function One(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Mne(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function LV(e){var t=1,n=e(One(t),Mne(t));return n.constant=function(r){return arguments.length?e(One(t=+r),Mne(t)):t},f0(n)}function fbe(){var e=LV(DR());return e.copy=function(){return rk(e,fbe()).constant(e.constant())},dc.apply(e,arguments)}function Lne(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Jpt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function egt(e){return e<0?-e*e:e*e}function PV(e){var t=e(ko,ko),n=1;function r(){return n===1?e(ko,ko):n===.5?e(Jpt,egt):e(Lne(n),Lne(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},f0(t)}function BV(){var e=PV(DR());return e.copy=function(){return rk(e,BV()).exponent(e.exponent())},dc.apply(e,arguments),e}function tgt(){return BV.apply(null,arguments).exponent(.5)}function dbe(){var e=[],t=[],n=[],r;function i(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=y0e(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?r:t[Ah(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort($b),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(r=o,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return dbe().domain(e).range(t).unknown(r)},dc.apply(s,arguments)}function hbe(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function o(u){return u!=null&&u<=u?i[Ah(r,u,0,n)]:s}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},o.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,a()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return r.slice()},o.copy=function(){return hbe().domain([e,t]).range(i).unknown(s)},dc.apply(f0(o),arguments)}function pbe(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[Ah(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return pbe().domain(e).range(t).unknown(n)},dc.apply(i,arguments)}function kB(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function EB(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function a2(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function gbe(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,o=e.shortDays,a=e.months,u=e.shortMonths,l=u2(i),c=l2(i),f=u2(s),d=l2(s),h=u2(o),p=l2(o),m=u2(a),x=l2(a),b=u2(u),v=l2(u),$={a:j,A:z,b:q,B:H,c:null,d:Wne,e:Wne,f:Sgt,g:Rgt,G:Mgt,H:wgt,I:$gt,j:Cgt,L:mbe,m:kgt,M:Egt,p:V,q:X,Q:Gne,s:Hne,S:Agt,u:_gt,U:Tgt,V:Igt,w:Ngt,W:Dgt,x:null,X:null,y:Fgt,Y:Ogt,Z:Lgt,"%":qne},C={a:re,A:le,b:ue,B:be,c:null,d:Vne,e:Vne,f:Ugt,g:Qgt,G:Jgt,H:Pgt,I:Bgt,j:zgt,L:xbe,m:jgt,M:Wgt,p:_e,q:Ne,Q:Gne,s:Hne,S:Vgt,u:qgt,U:Ggt,V:Hgt,w:Xgt,W:Ygt,x:null,X:null,y:Kgt,Y:Zgt,Z:emt,"%":qne},S={a:N,A:T,b:L,B:O,c:M,d:Une,e:Une,f:ygt,g:zne,G:Bne,H:jne,I:jne,j:hgt,L:mgt,m:dgt,M:pgt,p:D,q:fgt,Q:bgt,s:vgt,S:ggt,u:ogt,U:agt,V:ugt,w:sgt,W:lgt,x:R,X:P,y:zne,Y:Bne,Z:cgt,"%":xgt};$.x=A(n,$),$.X=A(r,$),$.c=A(t,$),C.x=A(n,C),C.X=A(r,C),C.c=A(t,C);function A(Y,ae){return function(he){var G=[],je=-1,Ce=0,We=Y.length,Ve,gt,ct;for(he instanceof Date||(he=new Date(+he));++je<We;)Y.charCodeAt(je)===37&&(G.push(Y.slice(Ce,je)),(gt=Pne[Ve=Y.charAt(++je)])!=null?Ve=Y.charAt(++je):gt=Ve==="e"?" ":"0",(ct=ae[Ve])&&(Ve=ct(he,gt)),G.push(Ve),Ce=je+1);return G.push(Y.slice(Ce,je)),G.join("")}}function E(Y,ae){return function(he){var G=a2(1900,void 0,1),je=_(G,Y,he+="",0),Ce,We;if(je!=he.length)return null;if("Q"in G)return new Date(G.Q);if("s"in G)return new Date(G.s*1e3+("L"in G?G.L:0));if(ae&&!("Z"in G)&&(G.Z=0),"p"in G&&(G.H=G.H%12+G.p*12),G.m===void 0&&(G.m="q"in G?G.q:0),"V"in G){if(G.V<1||G.V>53)return null;"w"in G||(G.w=1),"Z"in G?(Ce=EB(a2(G.y,0,1)),We=Ce.getUTCDay(),Ce=We>4||We===0?CI.ceil(Ce):CI(Ce),Ce=xf.offset(Ce,(G.V-1)*7),G.y=Ce.getUTCFullYear(),G.m=Ce.getUTCMonth(),G.d=Ce.getUTCDate()+(G.w+6)%7):(Ce=kB(a2(G.y,0,1)),We=Ce.getDay(),Ce=We>4||We===0?$I.ceil(Ce):$I(Ce),Ce=yf.offset(Ce,(G.V-1)*7),G.y=Ce.getFullYear(),G.m=Ce.getMonth(),G.d=Ce.getDate()+(G.w+6)%7)}else("W"in G||"U"in G)&&("w"in G||(G.w="u"in G?G.u%7:"W"in G?1:0),We="Z"in G?EB(a2(G.y,0,1)).getUTCDay():kB(a2(G.y,0,1)).getDay(),G.m=0,G.d="W"in G?(G.w+6)%7+G.W*7-(We+5)%7:G.w+G.U*7-(We+6)%7);return"Z"in G?(G.H+=G.Z/100|0,G.M+=G.Z%100,EB(G)):kB(G)}}function _(Y,ae,he,G){for(var je=0,Ce=ae.length,We=he.length,Ve,gt;je<Ce;){if(G>=We)return-1;if(Ve=ae.charCodeAt(je++),Ve===37){if(Ve=ae.charAt(je++),gt=S[Ve in Pne?ae.charAt(je++):Ve],!gt||(G=gt(Y,he,G))<0)return-1}else if(Ve!=he.charCodeAt(G++))return-1}return G}function D(Y,ae,he){var G=l.exec(ae.slice(he));return G?(Y.p=c.get(G[0].toLowerCase()),he+G[0].length):-1}function N(Y,ae,he){var G=h.exec(ae.slice(he));return G?(Y.w=p.get(G[0].toLowerCase()),he+G[0].length):-1}function T(Y,ae,he){var G=f.exec(ae.slice(he));return G?(Y.w=d.get(G[0].toLowerCase()),he+G[0].length):-1}function L(Y,ae,he){var G=b.exec(ae.slice(he));return G?(Y.m=v.get(G[0].toLowerCase()),he+G[0].length):-1}function O(Y,ae,he){var G=m.exec(ae.slice(he));return G?(Y.m=x.get(G[0].toLowerCase()),he+G[0].length):-1}function M(Y,ae,he){return _(Y,t,ae,he)}function R(Y,ae,he){return _(Y,n,ae,he)}function P(Y,ae,he){return _(Y,r,ae,he)}function j(Y){return o[Y.getDay()]}function z(Y){return s[Y.getDay()]}function q(Y){return u[Y.getMonth()]}function H(Y){return a[Y.getMonth()]}function V(Y){return i[+(Y.getHours()>=12)]}function X(Y){return 1+~~(Y.getMonth()/3)}function re(Y){return o[Y.getUTCDay()]}function le(Y){return s[Y.getUTCDay()]}function ue(Y){return u[Y.getUTCMonth()]}function be(Y){return a[Y.getUTCMonth()]}function _e(Y){return i[+(Y.getUTCHours()>=12)]}function Ne(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var ae=A(Y+="",$);return ae.toString=function(){return Y},ae},parse:function(Y){var ae=E(Y+="",!1);return ae.toString=function(){return Y},ae},utcFormat:function(Y){var ae=A(Y+="",C);return ae.toString=function(){return Y},ae},utcParse:function(Y){var ae=E(Y+="",!0);return ae.toString=function(){return Y},ae}}}var Pne={"-":"",_:" ",0:"0"},Ni=/^\s*\d+/,ngt=/^%/,rgt=/[\\^$*+?|[\]().{}]/g;function cn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function igt(e){return e.replace(rgt,"\\$&")}function u2(e){return new RegExp("^(?:"+e.map(igt).join("|")+")","i")}function l2(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function sgt(e,t,n){var r=Ni.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function ogt(e,t,n){var r=Ni.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function agt(e,t,n){var r=Ni.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function ugt(e,t,n){var r=Ni.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function lgt(e,t,n){var r=Ni.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Bne(e,t,n){var r=Ni.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function zne(e,t,n){var r=Ni.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function cgt(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function fgt(e,t,n){var r=Ni.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function dgt(e,t,n){var r=Ni.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Une(e,t,n){var r=Ni.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function hgt(e,t,n){var r=Ni.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function jne(e,t,n){var r=Ni.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function pgt(e,t,n){var r=Ni.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function ggt(e,t,n){var r=Ni.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function mgt(e,t,n){var r=Ni.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function ygt(e,t,n){var r=Ni.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function xgt(e,t,n){var r=ngt.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function bgt(e,t,n){var r=Ni.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function vgt(e,t,n){var r=Ni.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Wne(e,t){return cn(e.getDate(),t,2)}function wgt(e,t){return cn(e.getHours(),t,2)}function $gt(e,t){return cn(e.getHours()%12||12,t,2)}function Cgt(e,t){return cn(1+yf.count(Yl(e),e),t,3)}function mbe(e,t){return cn(e.getMilliseconds(),t,3)}function Sgt(e,t){return mbe(e,t)+"000"}function kgt(e,t){return cn(e.getMonth()+1,t,2)}function Egt(e,t){return cn(e.getMinutes(),t,2)}function Agt(e,t){return cn(e.getSeconds(),t,2)}function _gt(e){var t=e.getDay();return t===0?7:t}function Tgt(e,t){return cn(Sb.count(Yl(e)-1,e),t,2)}function ybe(e){var t=e.getDay();return t>=4||t===0?xy(e):xy.ceil(e)}function Igt(e,t){return e=ybe(e),cn(xy.count(Yl(e),e)+(Yl(e).getDay()===4),t,2)}function Ngt(e){return e.getDay()}function Dgt(e,t){return cn($I.count(Yl(e)-1,e),t,2)}function Fgt(e,t){return cn(e.getFullYear()%100,t,2)}function Rgt(e,t){return e=ybe(e),cn(e.getFullYear()%100,t,2)}function Ogt(e,t){return cn(e.getFullYear()%1e4,t,4)}function Mgt(e,t){var n=e.getDay();return e=n>=4||n===0?xy(e):xy.ceil(e),cn(e.getFullYear()%1e4,t,4)}function Lgt(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+cn(t/60|0,"0",2)+cn(t%60,"0",2)}function Vne(e,t){return cn(e.getUTCDate(),t,2)}function Pgt(e,t){return cn(e.getUTCHours(),t,2)}function Bgt(e,t){return cn(e.getUTCHours()%12||12,t,2)}function zgt(e,t){return cn(1+xf.count(Kl(e),e),t,3)}function xbe(e,t){return cn(e.getUTCMilliseconds(),t,3)}function Ugt(e,t){return xbe(e,t)+"000"}function jgt(e,t){return cn(e.getUTCMonth()+1,t,2)}function Wgt(e,t){return cn(e.getUTCMinutes(),t,2)}function Vgt(e,t){return cn(e.getUTCSeconds(),t,2)}function qgt(e){var t=e.getUTCDay();return t===0?7:t}function Ggt(e,t){return cn(kb.count(Kl(e)-1,e),t,2)}function bbe(e){var t=e.getUTCDay();return t>=4||t===0?by(e):by.ceil(e)}function Hgt(e,t){return e=bbe(e),cn(by.count(Kl(e),e)+(Kl(e).getUTCDay()===4),t,2)}function Xgt(e){return e.getUTCDay()}function Ygt(e,t){return cn(CI.count(Kl(e)-1,e),t,2)}function Kgt(e,t){return cn(e.getUTCFullYear()%100,t,2)}function Qgt(e,t){return e=bbe(e),cn(e.getUTCFullYear()%100,t,2)}function Zgt(e,t){return cn(e.getUTCFullYear()%1e4,t,4)}function Jgt(e,t){var n=e.getUTCDay();return e=n>=4||n===0?by(e):by.ceil(e),cn(e.getUTCFullYear()%1e4,t,4)}function emt(){return"+0000"}function qne(){return"%"}function Gne(e){return+e}function Hne(e){return Math.floor(+e/1e3)}var h1,RR,vbe,OR,wbe;tmt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function tmt(e){return h1=gbe(e),RR=h1.format,vbe=h1.parse,OR=h1.utcFormat,wbe=h1.utcParse,h1}function nmt(e){return new Date(e)}function rmt(e){return e instanceof Date?+e:+new Date(+e)}function zV(e,t,n,r,i,s,o,a,u,l){var c=nbe(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),m=l("%I:%M"),x=l("%I %p"),b=l("%a %d"),v=l("%b %d"),$=l("%B"),C=l("%Y");function S(A){return(u(A)<A?h:a(A)<A?p:o(A)<A?m:s(A)<A?x:r(A)<A?i(A)<A?b:v:n(A)<A?$:C)(A)}return c.invert=function(A){return new Date(f(A))},c.domain=function(A){return arguments.length?d(Array.from(A,rmt)):d().map(nmt)},c.ticks=function(A){var E=d();return e(E[0],E[E.length-1],A??10)},c.tickFormat=function(A,E){return E==null?S:l(E)},c.nice=function(A){var E=d();return(!A||typeof A.range!="function")&&(A=t(E[0],E[E.length-1],A??10)),A?d(lbe(E,A)):c},c.copy=function(){return rk(c,zV(e,t,n,r,i,s,o,a,u,l))},c}function imt(){return dc.apply(zV(Iot,Not,Yl,m$,Sb,yf,tR,eR,af,RR).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function smt(){return dc.apply(zV(_ot,Tot,Kl,y$,kb,xf,rR,nR,af,OR).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function MR(){var e=0,t=1,n,r,i,s,o=ko,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(i===0?.5:(f=(s(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(cp),l.rangeRound=c(QS),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function hp(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function UV(){var e=f0(MR()(ko));return e.copy=function(){return hp(e,UV())},dp.apply(e,arguments)}function $be(){var e=MV(MR()).domain([1,10]);return e.copy=function(){return hp(e,$be()).base(e.base())},dp.apply(e,arguments)}function Cbe(){var e=LV(MR());return e.copy=function(){return hp(e,Cbe()).constant(e.constant())},dp.apply(e,arguments)}function jV(){var e=PV(MR());return e.copy=function(){return hp(e,jV()).exponent(e.exponent())},dp.apply(e,arguments)}function omt(){return jV.apply(null,arguments).exponent(.5)}function LR(){var e=0,t=.5,n=1,r=1,i,s,o,a,u,l=ko,c,f=!1,d;function h(m){return isNaN(m=+m)?d:(m=.5+((m=+c(m))-s)*(r*m<r*s?a:u),l(f?Math.max(0,Math.min(1,m)):m))}h.domain=function(m){return arguments.length?([e,t,n]=m,i=c(e=+e),s=c(t=+t),o=c(n=+n),a=i===s?0:.5/(s-i),u=s===o?0:.5/(o-s),r=s<i?-1:1,h):[e,t,n]},h.clamp=function(m){return arguments.length?(f=!!m,h):f},h.interpolator=function(m){return arguments.length?(l=m,h):l};function p(m){return function(x){var b,v,$;return arguments.length?([b,v,$]=x,l=rV(m,[b,v,$]),h):[l(0),l(.5),l(1)]}}return h.range=p(cp),h.rangeRound=p(QS),h.unknown=function(m){return arguments.length?(d=m,h):d},function(m){return c=m,i=m(e),s=m(t),o=m(n),a=i===s?0:.5/(s-i),u=s===o?0:.5/(o-s),r=s<i?-1:1,h}}function Sbe(){var e=f0(LR()(ko));return e.copy=function(){return hp(e,Sbe())},dp.apply(e,arguments)}function kbe(){var e=MV(LR()).domain([.1,1,10]);return e.copy=function(){return hp(e,kbe()).base(e.base())},dp.apply(e,arguments)}function Ebe(){var e=LV(LR());return e.copy=function(){return hp(e,Ebe()).constant(e.constant())},dp.apply(e,arguments)}function WV(){var e=PV(LR());return e.copy=function(){return hp(e,WV()).exponent(e.exponent())},dp.apply(e,arguments)}function amt(){return WV.apply(null,arguments).exponent(.5)}function VV(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const umt="identity",Fy="linear",Df="log",ik="pow",sk="sqrt",PR="symlog",xm="time",bm="utc",Ll="sequential",Fb="diverging",Ry="quantile",BR="quantize",zR="threshold",qV="ordinal",Bz="point",Abe="band",GV="bin-ordinal",ri="continuous",ok="discrete",ak="discretizing",Za="interpolating",HV="temporal";function lmt(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function cmt(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,o,a,u,l;for(i<r&&(a=r,r=i,i=a),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(s<0&&(s=u),o=u);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function XV(){const e=NV().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,o=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=VV(f,a,u);let m=r[d-0];i=(h-m)/(p||1),o&&(i=Math.floor(i)),m+=(h-m-i*(f-a))*l,s=i*(1-a),o&&(m=Math.round(m),s=Math.round(s));const x=ta(f).map(b=>m+i*b);return n(d?x.reverse():x)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let m=+f[0],x=+f[1],b,v,$;if(!(m!==m||x!==x)&&(x<m&&($=m,m=x,x=$),!(x<h[0]||m>r[1-d])))return b=Math.max(0,Ah(h,m)-1),v=m===x?b:Ah(h,x)-1,m-h[b]>s+1e-10&&++b,d&&($=b,b=p-v,v=p-$),b>v?void 0:t().slice(b,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return XV().domain(t()).range(r).round(o).paddingInner(a).paddingOuter(u).align(l)},c()}function _be(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return _be(t())},e}function fmt(){return _be(XV().paddingInner(1))}var dmt=Array.prototype.map;function hmt(e){return dmt.call(e,$h)}const pmt=Array.prototype.slice;function Tbe(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(Ah(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=hmt(r),n):e.slice()},n.range=function(r){return arguments.length?(t=pmt.call(r),n):t.slice()},n.tickFormat=function(r,i){return obe(e[0],An(e),r??10,i)},n.copy=function(){return Tbe().domain(n.domain()).range(n.range())},n}const LI={};function gmt(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?lmt(s):s.invertExtent?cmt(s):void 0),s.type=e,s};return r.metadata=Tf(It(n)),r}function hn(e,t,n){return arguments.length>1?(LI[e]=gmt(e,t,n),this):Ibe(e)?LI[e]:void 0}hn(umt,ube);hn(Fy,abe,ri);hn(Df,cbe,[ri,Df]);hn(ik,BV,ri);hn(sk,tgt,ri);hn(PR,fbe,ri);hn(xm,imt,[ri,HV]);hn(bm,smt,[ri,HV]);hn(Ll,UV,[ri,Za]);hn("".concat(Ll,"-").concat(Fy),UV,[ri,Za]);hn("".concat(Ll,"-").concat(Df),$be,[ri,Za,Df]);hn("".concat(Ll,"-").concat(ik),jV,[ri,Za]);hn("".concat(Ll,"-").concat(sk),omt,[ri,Za]);hn("".concat(Ll,"-").concat(PR),Cbe,[ri,Za]);hn("".concat(Fb,"-").concat(Fy),Sbe,[ri,Za]);hn("".concat(Fb,"-").concat(Df),kbe,[ri,Za,Df]);hn("".concat(Fb,"-").concat(ik),WV,[ri,Za]);hn("".concat(Fb,"-").concat(sk),amt,[ri,Za]);hn("".concat(Fb,"-").concat(PR),Ebe,[ri,Za]);hn(Ry,dbe,[ak,Ry]);hn(BR,hbe,ak);hn(zR,pbe,ak);hn(GV,Tbe,[ok,ak]);hn(qV,NV,ok);hn(Abe,XV,ok);hn(Bz,fmt,ok);function Ibe(e){return Nt(LI,e)}function d0(e,t){const n=LI[e];return n&&n.metadata[t]}function YV(e){return d0(e,ri)}function Oy(e){return d0(e,ok)}function zz(e){return d0(e,ak)}function Nbe(e){return d0(e,Df)}function mmt(e){return d0(e,HV)}function Dbe(e){return d0(e,Za)}function Fbe(e){return d0(e,Ry)}const ymt=["clamp","base","constant","exponent"];function Rbe(e,t){const n=t[0],r=An(t)-n;return function(i){return e(n+i*r)}}function UR(e,t,n){return rV(KV(t||"rgb",n),e)}function Obe(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function Mbe(e,t,n){const r=n-t;let i,s,o;return!r||!Number.isFinite(r)?Ua(.5):(i=(s=e.type).indexOf("-"),s=i<0?s:s.slice(i+1),o=hn(s)().domain([t,n]).range([0,1]),ymt.forEach(a=>e[a]?o[a](e[a]()):0),o)}function KV(e,t){const n=kft[xmt(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function xmt(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const bmt={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},vmt={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function Lbe(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function Pbe(e,t){for(const n in e)QV(n,t(e[n]))}const Xne={};Pbe(vmt,Lbe);Pbe(bmt,e=>UR(Lbe(e)));function QV(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(Xne[e]=t,this):Xne[e]}const hT="symbol",wmt="discrete",$mt="gradient",Cmt=e=>Rt(e)?e.map(t=>String(t)):String(e),Smt=(e,t)=>e[1]-t[1],kmt=(e,t)=>t[1]-e[1];function ZV(e,t,n){let r;return dm(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(B3(e.domain())/n||1)))),Wt(t)&&(r=t.step,t=t.interval),Hn(t)&&(t=e.type===xm?Eb(t):e.type==bm?Ab(t):ke("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function Bbe(e,t,n){let r=e.range(),i=r[0],s=An(r),o=Smt;if(i>s&&(r=s,s=i,i=r,o=kmt),i=Math.floor(i),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>i<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],An(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function JV(e,t){return e.bins?Bbe(e,e.bins):e.ticks?e.ticks(t):e.domain()}function zbe(e,t,n,r,i,s){const o=t.type;let a=Cmt;if(o===xm||i===xm)a=e.timeFormat(r);else if(o===bm||i===bm)a=e.utcFormat(r);else if(Nbe(o)){const u=e.formatFloat(r);if(s||t.bins)a=u;else{const l=Ube(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(a=e.format(r));return a}function Ube(e,t,n){const r=JV(e,t),i=e.base(),s=Math.log(i),o=Math.max(1,i*t/r.length),a=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/s));return l*i<i-.5&&(l*=i),l<=o};return n?r.filter(a):a}const Uz={[Ry]:"quantiles",[BR]:"thresholds",[zR]:"domain"},jbe={[Ry]:"quantiles",[BR]:"domain"};function Wbe(e,t){return e.bins?_mt(e.bins):e.type===Df?Ube(e,t,!0):Uz[e.type]?Amt(e[Uz[e.type]]()):JV(e,t)}function Emt(e,t,n){const r=t[jbe[t.type]](),i=r.length;let s=i>1?r[1]-r[0]:r[0],o;for(o=1;o<i;++o)s=Math.min(s,r[o]-r[o-1]);return e.formatSpan(0,s,3*10,n)}function Amt(e){const t=[-1/0].concat(e);return t.max=1/0,t}function _mt(e){const t=e.slice(0,-1);return t.max=An(e),t}const Tmt=e=>Uz[e.type]||e.bins;function Vbe(e,t,n,r,i,s,o){const a=jbe[t.type]&&s!==xm&&s!==bm?Emt(e,t,i):zbe(e,t,n,i,s,o);return r===hT&&Tmt(t)?Imt(a):r===wmt?Nmt(a):Dmt(a)}const Imt=e=>(t,n,r)=>{const i=Yne(r[n+1],Yne(r.max,1/0)),s=Kne(t,e),o=Kne(i,e);return s&&o?s+" – "+o:o?"< "+o:"≥ "+s},Yne=(e,t)=>e??t,Nmt=e=>(t,n)=>n?e(t):null,Dmt=e=>t=>e(t),Kne=(e,t)=>Number.isFinite(e)?t(e):null;function Fmt(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+An(t),s=i-r;if(e.type===zR){const o=n?s/n:.1;r-=o,i+=o,s=i-r}return o=>(o-r)/s}function Rmt(e,t,n,r){const i=r||t.type;return Hn(n)&&mmt(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===xm?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===bm?e.utcFormat("%A, %d %B %Y, %X UTC"):Vbe(e,t,5,null,n,r,!0)}function qbe(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=Rmt(e,t,n.format,n.formatType);if(zz(t.type)){const s=Wbe(t).slice(1).map(i),o=s.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(s.join(", "))}else if(Oy(t.type)){const s=t.domain(),o=s.length,a=o>r?s.slice(0,r-2).map(i).join(", ")+", ending with "+s.slice(-1).map(i):s.map(i).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(a)}else{const s=t.domain();return"values from ".concat(i(s[0])," to ").concat(i(An(s)))}}function Gbe(e){xe.call(this,null,e)}ze(Gbe,xe,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,s=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,a=ZV(s,o,e.minstep),u=e.format||zbe(n,s,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?Bbe(s,e.values,a):JV(s,a);return i&&(r.rem=i),i=l.map((c,f)=>dn({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(dn({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function Hbe(e){xe.call(this,null,e)}function Omt(){return dn({})}function Mmt(e){const t=bb().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}ze(Hbe,xe,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Omt,s=e.key||dt,o=this.value;return Rt(r.encode)&&(r.encode=null),o&&(e.modified("key")||t.modified(s))&&ke("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=Mmt(s)),t.visit(t.ADD,a=>{const u=s(a);let l=o.get(u);l?l.exit?(o.empty--,r.add.push(l)):r.mod.push(l):(l=i(a),o.set(u,l),r.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=s(a),l=o.get(u);l&&(l.datum=a,r.mod.push(l))}),t.visit(t.REM,a=>{const u=s(a),l=o.get(u);a===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}});function Xbe(e){xe.call(this,null,e)}ze(Xbe,xe,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,s=t.encode;if(Rt(s))if(n.changed()||s.every(f=>i[f]))s=s[0],n.encode=null;else return t.StopPropagation;var o=s==="enter",a=i.update||kd,u=i.enter||kd,l=i.exit||kd,c=(s&&!o?i[s]:a)||kd;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==kd&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==kd&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==kd){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function Ybe(e){xe.call(this,[],e)}ze(Ybe,xe,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,s=e.type||hT,o=e.scale,a=+e.limit,u=ZV(o,e.count==null?5:e.count,e.minstep),l=!!e.values||s===hT,c=e.format||Vbe(n,o,u,s,e.formatSpecifier,e.formatType,l),f=e.values||Wbe(o,u),d,h,p,m,x;return i&&(r.rem=i),s===hT?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,a-1),x=!0):i=f,xn(p=e.size)?(!e.values&&o(i[0])===0&&(i=i.slice(1)),m=i.reduce((b,v)=>Math.max(b,p(v,e)),0)):p=Ua(m=p||8),i=i.map((b,v)=>dn({index:v,label:c(b,v,i),value:b,offset:m,size:p(b,e)})),x&&(x=f[i.length],i.push(dn({index:i.length,label:"…".concat(f.length-i.length," entries"),value:x,offset:m,size:p(x,e)})))):s===$mt?(d=o.domain(),h=Mbe(o,d[0],An(d)),f.length<3&&!e.values&&d[0]!==An(d)&&(f=[d[0],An(d)]),i=f.map((b,v)=>dn({index:v,label:c(b,v,f),value:b,perc:h(b)}))):(p=f.length-1,h=Fmt(o),i=f.map((b,v)=>dn({index:v,label:c(b,v,f),value:b,perc:v?h(b):0,perc2:v===p?1:h(f[v+1])}))),r.source=i,r.add=i,this.value=i,r}});const Lmt=e=>e.source.x,Pmt=e=>e.source.y,Bmt=e=>e.target.x,zmt=e=>e.target.y;function eq(e){xe.call(this,{},e)}eq.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};ze(eq,xe,{transform(e,t){var n=e.sourceX||Lmt,r=e.sourceY||Pmt,i=e.targetX||Bmt,s=e.targetY||zmt,o=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=Qne.get(u+"-"+a)||Qne.get(u);return l||ke("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),r(c),i(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const Kbe=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,Umt=(e,t,n,r)=>Kbe(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Qbe=(e,t,n,r)=>{var i=n-e,s=r-t,o=Math.sqrt(i*i+s*s)/2,a=180*Math.atan2(s,i)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+a+" 0 1 "+n+","+r},jmt=(e,t,n,r)=>Qbe(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Zbe=(e,t,n,r)=>{const i=n-e,s=r-t,o=.2*(i+s),a=.2*(s-i);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(r-o)+" "+n+","+r},Wmt=(e,t,n,r)=>Zbe(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Vmt=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,qmt=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,Gmt=(e,t,n,r)=>{const i=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*s+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*a+"L"+r*o+","+r*a},Hmt=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},Xmt=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},Ymt=(e,t,n,r)=>{const i=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*s+"C"+u*i+","+u*s+" "+u*o+","+u*a+" "+r*o+","+r*a},Qne=bb({line:Kbe,"line-radial":Umt,arc:Qbe,"arc-radial":jmt,curve:Zbe,"curve-radial":Wmt,"orthogonal-horizontal":Vmt,"orthogonal-vertical":qmt,"orthogonal-radial":Gmt,"diagonal-horizontal":Hmt,"diagonal-vertical":Xmt,"diagonal-radial":Ymt});function tq(e){xe.call(this,null,e)}tq.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};ze(tq,xe,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],s=e.field||yb,o=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(s),c=l.length,f=o,d=(a-o)/v0e(l),h=ta(c),p,m,x;for(e.sort&&h.sort((b,v)=>l[b]-l[v]),p=0;p<c;++p)x=l[h[p]],m=u[h[p]],m[r]=f,m[i]=f+=x*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const Kmt=5;function Qmt(e){const t=e.type;return!e.bins&&(t===Fy||t===ik||t===sk)}function Jbe(e){return YV(e)&&e!==Ll}const Zmt=Tf(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function eve(e){xe.call(this,null,e),this.modified(!0)}ze(eve,xe,{transform(e,t){var n=t.dataflow,r=this.value,i=Jmt(e);(!r||i!==r.type)&&(this.value=r=hn(i)());for(i in e)if(!Zmt[i]){if(i==="padding"&&Jbe(r.type))continue;xn(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return s0t(r,e,i0t(r,e,t0t(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Jmt(e){var t=e.type,n="",r;return t===Ll?Ll+"-"+Fy:(e0t(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?Ll+"-":r===3?Fb+"-":""),(n+t||Fy).toLowerCase())}function e0t(e){const t=e.type;return YV(t)&&t!==xm&&t!==bm&&(e.scheme||e.range&&e.range.length&&e.range.every(Hn))}function t0t(e,t,n){const r=n0t(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,s=e.type,o=t.zero||t.zero===void 0&&Qmt(e),a,u;if(!i)return 0;if(Jbe(s)&&t.padding&&i[0]!==An(i)&&(i=r0t(s,i,t.range,t.padding,t.exponent,t.constant)),(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(i=i.slice()).length-1||1,o&&(i[0]>0&&(i[0]=0),i[a]<0&&(i[a]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[a]?a+1:u<i[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(tve(s,i,n)),s===qV&&e.unknown(t.domainImplicit?Mz:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&ZV(e,t.nice)||null),i.length}function n0t(e,t,n){return t?(e.domain(tve(e.type,t,n)),t.length):-1}function r0t(e,t,n,r,i,s){var o=Math.abs(An(n)-n[0]),a=o/(o-2*r),u=e===Df?dme(t,null,a):e===sk?H6(t,null,a,.5):e===ik?H6(t,null,a,i||1):e===PR?hme(t,null,a,s||1):fme(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function tve(e,t,n){if(Nbe(e)){var r=Math.abs(t.reduce((i,s)=>i+(s<0?-1:s>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+St(t))}return t}function i0t(e,t,n){let r=t.bins;if(r&&!Rt(r)){const i=e.domain(),s=i[0],o=An(i),a=r.step;let u=r.start==null?s:r.start,l=r.stop==null?o:r.stop;a||ke("Scale bins parameter missing step property."),u<s&&(u=a*Math.ceil(s/a)),l>o&&(l=a*Math.floor(o/a)),r=ta(u,l+a/2,a)}return r?e.bins=r:e.bins&&delete e.bins,e.type===GV&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function s0t(e,t,n){var r=e.type,i=t.round||!1,s=t.range;if(t.rangeStep!=null)s=o0t(r,t,n);else if(t.scheme&&(s=a0t(r,t,n),xn(s))){if(e.interpolator)return e.interpolator(s);ke("Scale type ".concat(r," does not support interpolating color schemes."))}if(s&&Dbe(r))return e.interpolator(UR(jz(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(KV(t.interpolate,t.interpolateGamma)):xn(e.round)?e.round(i):xn(e.rangeRound)&&e.interpolate(i?QS:cp),s&&e.range(jz(s,t.reverse))}function o0t(e,t,n){e!==Abe&&e!==Bz&&ke("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===Bz?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*VV(n,i,r)]}function a0t(e,t,n){var r=t.schemeExtent,i,s;return Rt(t.scheme)?s=UR(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),s=QV(i),s||ke("Unrecognized scheme name: ".concat(t.scheme))),n=e===zR?n+1:e===GV?n-1:e===Ry||e===BR?+t.schemeCount||Kmt:n,Dbe(e)?Zne(s,r,t.reverse):xn(s)?Obe(Zne(s,r),n):e===qV?s:s.slice(0,n)}function Zne(e,t,n){return xn(e)&&(t||n)?Rbe(e,jz(t||[0,1],n)):e}function jz(e,t){return t?e.slice().reverse():e}function nve(e){xe.call(this,null,e)}ze(nve,xe,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(e0(e.sort)),this.modified(n),t}});const Jne="zero",rve="center",ive="normalize",sve=["y0","y1"];function nq(e){xe.call(this,null,e)}nq.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Jne,values:[Jne,rve,ive]},{name:"as",type:"string",array:!0,length:2,default:sve}]};ze(nq,xe,{transform(e,t){var n=e.as||sve,r=n[0],i=n[1],s=e0(e.sort),o=e.field||yb,a=e.offset===rve?u0t:e.offset===ive?l0t:c0t,u,l,c,f;for(u=f0t(t.source,e.groupby,s,o),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,o,r,i);return t.reflow(e.modified()).modifies(n)}});function u0t(e,t,n,r,i){for(var s=(t-e.sum)/2,o=e.length,a=0,u;a<o;++a)u=e[a],u[r]=s,u[i]=s+=Math.abs(n(u))}function l0t(e,t,n,r,i){for(var s=1/e.sum,o=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[r]=o,c[i]=o=s*(l+=Math.abs(n(c)))}function c0t(e,t,n,r,i){for(var s=0,o=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[r]=o,c[i]=o+=l):(c[r]=s,c[i]=s+=l)}function f0t(e,t,n,r){var i=[],s=m=>m(c),o,a,u,l,c,f,d,h,p;if(t==null)i.push(e.slice());else for(o={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(s),d=o[f],d||(o[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(d=i[f],a=0,h=0,u=d.length;a<u;++a)h+=Math.abs(r(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}const d0t=Object.freeze(Object.defineProperty({__proto__:null,axisticks:Gbe,datajoin:Hbe,encode:Xbe,legendentries:Ybe,linkpath:eq,pie:tq,scale:eve,sortitems:nve,stack:nq},Symbol.toStringTag,{value:"Module"}));var mt=1e-6,PI=1e-12,Pt=Math.PI,pr=Pt/2,BI=Pt/4,Ys=Pt*2,$r=180/Pt,Bt=Pt/180,Jt=Math.abs,Rb=Math.atan,Wa=Math.atan2,xt=Math.cos,WA=Math.ceil,ove=Math.exp,Wz=Math.hypot,zI=Math.log,AB=Math.pow,pt=Math.sin,Na=Math.sign||function(e){return e>0?1:e<0?-1:0},Ks=Math.sqrt,rq=Math.tan;function ave(e){return e>1?0:e<-1?Pt:Math.acos(e)}function Oo(e){return e>1?pr:e<-1?-pr:Math.asin(e)}function Bi(){}function UI(e,t){e&&tre.hasOwnProperty(e.type)&&tre[e.type](e,t)}var ere={Feature:function(e,t){UI(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)UI(n[r].geometry,t)}},tre={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Vz(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Vz(n[r],t,0)},Polygon:function(e,t){nre(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)nre(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)UI(n[r],t)}};function Vz(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function nre(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Vz(e[n],t,1);t.polygonEnd()}function nf(e,t){e&&ere.hasOwnProperty(e.type)?ere[e.type](e,t):UI(e,t)}var jI=new Vs,WI=new Vs,uve,lve,qz,Gz,Hz,tc={point:Bi,lineStart:Bi,lineEnd:Bi,polygonStart:function(){jI=new Vs,tc.lineStart=h0t,tc.lineEnd=p0t},polygonEnd:function(){var e=+jI;WI.add(e<0?Ys+e:e),this.lineStart=this.lineEnd=this.point=Bi},sphere:function(){WI.add(Ys)}};function h0t(){tc.point=g0t}function p0t(){cve(uve,lve)}function g0t(e,t){tc.point=cve,uve=e,lve=t,e*=Bt,t*=Bt,qz=e,Gz=xt(t=t/2+BI),Hz=pt(t)}function cve(e,t){e*=Bt,t*=Bt,t=t/2+BI;var n=e-qz,r=n>=0?1:-1,i=r*n,s=xt(t),o=pt(t),a=Hz*o,u=Gz*s+a*xt(i),l=a*r*pt(i);jI.add(Wa(l,u)),qz=e,Gz=s,Hz=o}function m0t(e){return WI=new Vs,nf(e,tc),WI*2}function VI(e){return[Wa(e[1],e[0]),Oo(e[2])]}function vm(e){var t=e[0],n=e[1],r=xt(n);return[r*xt(t),r*pt(t),pt(n)]}function VA(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function My(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function _B(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function qA(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function qI(e){var t=Ks(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var or,yo,fr,Ko,hg,fve,dve,Q1,hw,Id,Ff,Yc={point:Xz,lineStart:rre,lineEnd:ire,polygonStart:function(){Yc.point=pve,Yc.lineStart=y0t,Yc.lineEnd=x0t,hw=new Vs,tc.polygonStart()},polygonEnd:function(){tc.polygonEnd(),Yc.point=Xz,Yc.lineStart=rre,Yc.lineEnd=ire,jI<0?(or=-(fr=180),yo=-(Ko=90)):hw>mt?Ko=90:hw<-mt&&(yo=-90),Ff[0]=or,Ff[1]=fr},sphere:function(){or=-(fr=180),yo=-(Ko=90)}};function Xz(e,t){Id.push(Ff=[or=e,fr=e]),t<yo&&(yo=t),t>Ko&&(Ko=t)}function hve(e,t){var n=vm([e*Bt,t*Bt]);if(Q1){var r=My(Q1,n),i=[r[1],-r[0],0],s=My(i,r);qI(s),s=VI(s);var o=e-hg,a=o>0?1:-1,u=s[0]*$r*a,l,c=Jt(o)>180;c^(a*hg<u&&u<a*e)?(l=s[1]*$r,l>Ko&&(Ko=l)):(u=(u+360)%360-180,c^(a*hg<u&&u<a*e)?(l=-s[1]*$r,l<yo&&(yo=l)):(t<yo&&(yo=t),t>Ko&&(Ko=t))),c?e<hg?Yo(or,e)>Yo(or,fr)&&(fr=e):Yo(e,fr)>Yo(or,fr)&&(or=e):fr>=or?(e<or&&(or=e),e>fr&&(fr=e)):e>hg?Yo(or,e)>Yo(or,fr)&&(fr=e):Yo(e,fr)>Yo(or,fr)&&(or=e)}else Id.push(Ff=[or=e,fr=e]);t<yo&&(yo=t),t>Ko&&(Ko=t),Q1=n,hg=e}function rre(){Yc.point=hve}function ire(){Ff[0]=or,Ff[1]=fr,Yc.point=Xz,Q1=null}function pve(e,t){if(Q1){var n=e-hg;hw.add(Jt(n)>180?n+(n>0?360:-360):n)}else fve=e,dve=t;tc.point(e,t),hve(e,t)}function y0t(){tc.lineStart()}function x0t(){pve(fve,dve),tc.lineEnd(),Jt(hw)>mt&&(or=-(fr=180)),Ff[0]=or,Ff[1]=fr,Q1=null}function Yo(e,t){return(t-=e)<0?t+360:t}function b0t(e,t){return e[0]-t[0]}function sre(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function v0t(e){var t,n,r,i,s,o,a;if(Ko=fr=-(or=yo=1/0),Id=[],nf(e,Yc),n=Id.length){for(Id.sort(b0t),t=1,r=Id[0],s=[r];t<n;++t)i=Id[t],sre(r,i[0])||sre(r,i[1])?(Yo(r[0],i[1])>Yo(r[0],r[1])&&(r[1]=i[1]),Yo(i[0],r[1])>Yo(r[0],r[1])&&(r[0]=i[0])):s.push(r=i);for(o=-1/0,n=s.length-1,t=0,r=s[n];t<=n;r=i,++t)i=s[t],(a=Yo(r[1],i[0]))>o&&(o=a,or=i[0],fr=r[1])}return Id=Ff=null,or===1/0||yo===1/0?[[NaN,NaN],[NaN,NaN]]:[[or,yo],[fr,Ko]]}var G2,GI,HI,XI,YI,KI,QI,ZI,Yz,Kz,Qz,gve,mve,Ls,Ps,Bs,Eu={sphere:Bi,point:iq,lineStart:ore,lineEnd:are,polygonStart:function(){Eu.lineStart=C0t,Eu.lineEnd=S0t},polygonEnd:function(){Eu.lineStart=ore,Eu.lineEnd=are}};function iq(e,t){e*=Bt,t*=Bt;var n=xt(t);uk(n*xt(e),n*pt(e),pt(t))}function uk(e,t,n){++G2,HI+=(e-HI)/G2,XI+=(t-XI)/G2,YI+=(n-YI)/G2}function ore(){Eu.point=w0t}function w0t(e,t){e*=Bt,t*=Bt;var n=xt(t);Ls=n*xt(e),Ps=n*pt(e),Bs=pt(t),Eu.point=$0t,uk(Ls,Ps,Bs)}function $0t(e,t){e*=Bt,t*=Bt;var n=xt(t),r=n*xt(e),i=n*pt(e),s=pt(t),o=Wa(Ks((o=Ps*s-Bs*i)*o+(o=Bs*r-Ls*s)*o+(o=Ls*i-Ps*r)*o),Ls*r+Ps*i+Bs*s);GI+=o,KI+=o*(Ls+(Ls=r)),QI+=o*(Ps+(Ps=i)),ZI+=o*(Bs+(Bs=s)),uk(Ls,Ps,Bs)}function are(){Eu.point=iq}function C0t(){Eu.point=k0t}function S0t(){yve(gve,mve),Eu.point=iq}function k0t(e,t){gve=e,mve=t,e*=Bt,t*=Bt,Eu.point=yve;var n=xt(t);Ls=n*xt(e),Ps=n*pt(e),Bs=pt(t),uk(Ls,Ps,Bs)}function yve(e,t){e*=Bt,t*=Bt;var n=xt(t),r=n*xt(e),i=n*pt(e),s=pt(t),o=Ps*s-Bs*i,a=Bs*r-Ls*s,u=Ls*i-Ps*r,l=Wz(o,a,u),c=Oo(l),f=l&&-c/l;Yz.add(f*o),Kz.add(f*a),Qz.add(f*u),GI+=c,KI+=c*(Ls+(Ls=r)),QI+=c*(Ps+(Ps=i)),ZI+=c*(Bs+(Bs=s)),uk(Ls,Ps,Bs)}function E0t(e){G2=GI=HI=XI=YI=KI=QI=ZI=0,Yz=new Vs,Kz=new Vs,Qz=new Vs,nf(e,Eu);var t=+Yz,n=+Kz,r=+Qz,i=Wz(t,n,r);return i<PI&&(t=KI,n=QI,r=ZI,GI<mt&&(t=HI,n=XI,r=YI),i=Wz(t,n,r),i<PI)?[NaN,NaN]:[Wa(n,t)*$r,Oo(r/i)*$r]}function Zz(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function Jz(e,t){return[Jt(e)>Pt?e+Math.round(-e/Ys)*Ys:e,t]}Jz.invert=Jz;function xve(e,t,n){return(e%=Ys)?t||n?Zz(lre(e),cre(t,n)):lre(e):t||n?cre(t,n):Jz}function ure(e){return function(t,n){return t+=e,[t>Pt?t-Ys:t<-Pt?t+Ys:t,n]}}function lre(e){var t=ure(e);return t.invert=ure(-e),t}function cre(e,t){var n=xt(e),r=pt(e),i=xt(t),s=pt(t);function o(a,u){var l=xt(u),c=xt(a)*l,f=pt(a)*l,d=pt(u),h=d*n+c*r;return[Wa(f*i-h*s,c*n-d*r),Oo(h*i+f*s)]}return o.invert=function(a,u){var l=xt(u),c=xt(a)*l,f=pt(a)*l,d=pt(u),h=d*i-f*s;return[Wa(f*i+d*s,c*n+h*r),Oo(h*n-c*r)]},o}function A0t(e){e=xve(e[0]*Bt,e[1]*Bt,e.length>2?e[2]*Bt:0);function t(n){return n=e(n[0]*Bt,n[1]*Bt),n[0]*=$r,n[1]*=$r,n}return t.invert=function(n){return n=e.invert(n[0]*Bt,n[1]*Bt),n[0]*=$r,n[1]*=$r,n},t}function _0t(e,t,n,r,i,s){if(n){var o=xt(t),a=pt(t),u=r*n;i==null?(i=t+r*Ys,s=t-u/2):(i=fre(o,i),s=fre(o,s),(r>0?i<s:i>s)&&(i+=r*Ys));for(var l,c=i;r>0?c>s:c<s;c-=u)l=VI([o,-a*xt(c),-a*pt(c)]),e.point(l[0],l[1])}}function fre(e,t){t=vm(t),t[0]-=e,qI(t);var n=ave(-t[1]);return((-t[2]<0?-n:n)+Ys-mt)%Ys}function bve(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Bi,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function pT(e,t){return Jt(e[0]-t[0])<mt&&Jt(e[1]-t[1])<mt}function GA(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function vve(e,t,n,r,i){var s=[],o=[],a,u;if(e.forEach(function(p){if(!((m=p.length-1)<=0)){var m,x=p[0],b=p[m],v;if(pT(x,b)){if(!x[2]&&!b[2]){for(i.lineStart(),a=0;a<m;++a)i.point((x=p[a])[0],x[1]);i.lineEnd();return}b[0]+=2*mt}s.push(v=new GA(x,p,null,!0)),o.push(v.o=new GA(x,null,v,!1)),s.push(v=new GA(b,p,null,!1)),o.push(v.o=new GA(b,null,v,!0))}}),!!s.length){for(o.sort(t),dre(s),dre(o),a=0,u=o.length;a<u;++a)o[a].e=n=!n;for(var l=s[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)i.point((f=c[a])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)i.point((f=c[a])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function dre(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function TB(e){return Jt(e[0])<=Pt?e[0]:Na(e[0])*((Jt(e[0])+Pt)%Ys-Pt)}function T0t(e,t){var n=TB(t),r=t[1],i=pt(r),s=[pt(n),-xt(n),0],o=0,a=0,u=new Vs;i===1?r=pr+mt:i===-1&&(r=-pr-mt);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=TB(h),m=h[1]/2+BI,x=pt(m),b=xt(m),v=0;v<d;++v,p=C,x=A,b=E,h=$){var $=f[v],C=TB($),S=$[1]/2+BI,A=pt(S),E=xt(S),_=C-p,D=_>=0?1:-1,N=D*_,T=N>Pt,L=x*A;if(u.add(Wa(L*D*pt(N),b*E+L*xt(N))),o+=T?_+D*Ys:_,T^p>=n^C>=n){var O=My(vm(h),vm($));qI(O);var M=My(s,O);qI(M);var R=(T^_>=0?-1:1)*Oo(M[2]);(r>R||r===R&&(O[0]||O[1]))&&(a+=T^_>=0?1:-1)}}return(o<-mt||o<mt&&u<-PI)^a&1}function wve(e,t,n,r){return function(i){var s=t(i),o=bve(),a=t(o),u=!1,l,c,f,d={point:h,lineStart:m,lineEnd:x,polygonStart:function(){d.point=b,d.lineStart=v,d.lineEnd=$,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=m,d.lineEnd=x,c=b0e(c);var C=T0t(l,r);c.length?(u||(i.polygonStart(),u=!0),vve(c,N0t,C,n,i)):C&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(C,S){e(C,S)&&i.point(C,S)}function p(C,S){s.point(C,S)}function m(){d.point=p,s.lineStart()}function x(){d.point=h,s.lineEnd()}function b(C,S){f.push([C,S]),a.point(C,S)}function v(){a.lineStart(),f=[]}function $(){b(f[0][0],f[0][1]),a.lineEnd();var C=a.clean(),S=o.result(),A,E=S.length,_,D,N;if(f.pop(),l.push(f),f=null,!!E){if(C&1){if(D=S[0],(_=D.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),A=0;A<_;++A)i.point((N=D[A])[0],N[1]);i.lineEnd()}return}E>1&&C&2&&S.push(S.pop().concat(S.shift())),c.push(S.filter(I0t))}}return d}}function I0t(e){return e.length>1}function N0t(e,t){return((e=e.x)[0]<0?e[1]-pr-mt:pr-e[1])-((t=t.x)[0]<0?t[1]-pr-mt:pr-t[1])}const hre=wve(function(){return!0},D0t,R0t,[-Pt,-pr]);function D0t(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,o){var a=s>0?Pt:-Pt,u=Jt(s-t);Jt(u-Pt)<mt?(e.point(t,n=(n+o)/2>0?pr:-pr),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),i=0):r!==a&&u>=Pt&&(Jt(t-r)<mt&&(t-=r*mt),Jt(s-a)<mt&&(s-=a*mt),n=F0t(t,n,s,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),i=0),e.point(t=s,n=o),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function F0t(e,t,n,r){var i,s,o=pt(e-n);return Jt(o)>mt?Rb((pt(t)*(s=xt(r))*pt(n)-pt(r)*(i=xt(t))*pt(e))/(i*s*o)):(t+r)/2}function R0t(e,t,n,r){var i;if(e==null)i=n*pr,r.point(-Pt,i),r.point(0,i),r.point(Pt,i),r.point(Pt,0),r.point(Pt,-i),r.point(0,-i),r.point(-Pt,-i),r.point(-Pt,0),r.point(-Pt,i);else if(Jt(e[0]-t[0])>mt){var s=e[0]<t[0]?Pt:-Pt;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function O0t(e){var t=xt(e),n=6*Bt,r=t>0,i=Jt(t)>mt;function s(c,f,d,h){_0t(h,e,n,d,c,f)}function o(c,f){return xt(c)*xt(f)>t}function a(c){var f,d,h,p,m;return{lineStart:function(){p=h=!1,m=1},point:function(x,b){var v=[x,b],$,C=o(x,b),S=r?C?0:l(x,b):C?l(x+(x<0?Pt:-Pt),b):0;if(!f&&(p=h=C)&&c.lineStart(),C!==h&&($=u(f,v),(!$||pT(f,$)||pT(v,$))&&(v[2]=1)),C!==h)m=0,C?(c.lineStart(),$=u(v,f),c.point($[0],$[1])):($=u(f,v),c.point($[0],$[1],2),c.lineEnd()),f=$;else if(i&&f&&r^C){var A;!(S&d)&&(A=u(v,f,!0))&&(m=0,r?(c.lineStart(),c.point(A[0][0],A[0][1]),c.point(A[1][0],A[1][1]),c.lineEnd()):(c.point(A[1][0],A[1][1]),c.lineEnd(),c.lineStart(),c.point(A[0][0],A[0][1],3)))}C&&(!f||!pT(f,v))&&c.point(v[0],v[1]),f=v,h=C,d=S},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return m|(p&&h)<<1}}}function u(c,f,d){var h=vm(c),p=vm(f),m=[1,0,0],x=My(h,p),b=VA(x,x),v=x[0],$=b-v*v;if(!$)return!d&&c;var C=t*b/$,S=-t*v/$,A=My(m,x),E=qA(m,C),_=qA(x,S);_B(E,_);var D=A,N=VA(E,D),T=VA(D,D),L=N*N-T*(VA(E,E)-1);if(!(L<0)){var O=Ks(L),M=qA(D,(-N-O)/T);if(_B(M,E),M=VI(M),!d)return M;var R=c[0],P=f[0],j=c[1],z=f[1],q;P<R&&(q=R,R=P,P=q);var H=P-R,V=Jt(H-Pt)<mt,X=V||H<mt;if(!V&&z<j&&(q=j,j=z,z=q),X?V?j+z>0^M[1]<(Jt(M[0]-R)<mt?j:z):j<=M[1]&&M[1]<=z:H>Pt^(R<=M[0]&&M[0]<=P)){var re=qA(D,(-N+O)/T);return _B(re,E),[M,VI(re)]}}}function l(c,f){var d=r?e:Pt-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return wve(o,a,s,r?[0,-e]:[-Pt,e-Pt])}function M0t(e,t,n,r,i,s){var o=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-a,p;if(p=n-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=s-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*d,e[1]=a+c*h),f<1&&(t[0]=o+f*d,t[1]=a+f*h),!0}}}}}var H2=1e9,HA=-H2;function $ve(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function s(l,c,f,d){var h=0,p=0;if(l==null||(h=o(l,f))!==(p=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function o(l,c){return Jt(l[0]-e)<mt?c>0?0:3:Jt(l[0]-n)<mt?c>0?2:1:Jt(l[1]-t)<mt?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=bve(),d,h,p,m,x,b,v,$,C,S,A,E={point:_,lineStart:L,lineEnd:O,polygonStart:N,polygonEnd:T};function _(R,P){i(R,P)&&c.point(R,P)}function D(){for(var R=0,P=0,j=h.length;P<j;++P)for(var z=h[P],q=1,H=z.length,V=z[0],X,re,le=V[0],ue=V[1];q<H;++q)X=le,re=ue,V=z[q],le=V[0],ue=V[1],re<=r?ue>r&&(le-X)*(r-re)>(ue-re)*(e-X)&&++R:ue<=r&&(le-X)*(r-re)<(ue-re)*(e-X)&&--R;return R}function N(){c=f,d=[],h=[],A=!0}function T(){var R=D(),P=A&&R,j=(d=b0e(d)).length;(P||j)&&(l.polygonStart(),P&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),j&&vve(d,a,R,s,l),l.polygonEnd()),c=l,d=h=p=null}function L(){E.point=M,h&&h.push(p=[]),S=!0,C=!1,v=$=NaN}function O(){d&&(M(m,x),b&&C&&f.rejoin(),d.push(f.result())),E.point=_,C&&c.lineEnd()}function M(R,P){var j=i(R,P);if(h&&p.push([R,P]),S)m=R,x=P,b=j,S=!1,j&&(c.lineStart(),c.point(R,P));else if(j&&C)c.point(R,P);else{var z=[v=Math.max(HA,Math.min(H2,v)),$=Math.max(HA,Math.min(H2,$))],q=[R=Math.max(HA,Math.min(H2,R)),P=Math.max(HA,Math.min(H2,P))];M0t(z,q,e,t,n,r)?(C||(c.lineStart(),c.point(z[0],z[1])),c.point(q[0],q[1]),j||c.lineEnd(),A=!1):j&&(c.lineStart(),c.point(R,P),A=!1)}v=R,$=P,C=j}return E}}function pre(e,t,n){var r=ta(e,t-mt,n).concat(t);return function(i){return r.map(function(s){return[i,s]})}}function gre(e,t,n){var r=ta(e,t-mt,n).concat(t);return function(i){return r.map(function(s){return[s,i]})}}function L0t(){var e,t,n,r,i,s,o,a,u=10,l=u,c=90,f=360,d,h,p,m,x=2.5;function b(){return{type:"MultiLineString",coordinates:v()}}function v(){return ta(WA(r/c)*c,n,c).map(p).concat(ta(WA(a/f)*f,o,f).map(m)).concat(ta(WA(t/u)*u,e,u).filter(function($){return Jt($%c)>mt}).map(d)).concat(ta(WA(s/l)*l,i,l).filter(function($){return Jt($%f)>mt}).map(h))}return b.lines=function(){return v().map(function($){return{type:"LineString",coordinates:$}})},b.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(m(o).slice(1),p(n).reverse().slice(1),m(a).reverse().slice(1))]}},b.extent=function($){return arguments.length?b.extentMajor($).extentMinor($):b.extentMinor()},b.extentMajor=function($){return arguments.length?(r=+$[0][0],n=+$[1][0],a=+$[0][1],o=+$[1][1],r>n&&($=r,r=n,n=$),a>o&&($=a,a=o,o=$),b.precision(x)):[[r,a],[n,o]]},b.extentMinor=function($){return arguments.length?(t=+$[0][0],e=+$[1][0],s=+$[0][1],i=+$[1][1],t>e&&($=t,t=e,e=$),s>i&&($=s,s=i,i=$),b.precision(x)):[[t,s],[e,i]]},b.step=function($){return arguments.length?b.stepMajor($).stepMinor($):b.stepMinor()},b.stepMajor=function($){return arguments.length?(c=+$[0],f=+$[1],b):[c,f]},b.stepMinor=function($){return arguments.length?(u=+$[0],l=+$[1],b):[u,l]},b.precision=function($){return arguments.length?(x=+$,d=pre(s,i,90),h=gre(t,e,x),p=pre(a,o,90),m=gre(r,n,x),b):x},b.extentMajor([[-180,-90+mt],[180,90-mt]]).extentMinor([[-180,-80-mt],[180,80+mt]])}const A$=e=>e;var IB=new Vs,e8=new Vs,Cve,Sve,t8,n8,rf={point:Bi,lineStart:Bi,lineEnd:Bi,polygonStart:function(){rf.lineStart=P0t,rf.lineEnd=z0t},polygonEnd:function(){rf.lineStart=rf.lineEnd=rf.point=Bi,IB.add(Jt(e8)),e8=new Vs},result:function(){var e=IB/2;return IB=new Vs,e}};function P0t(){rf.point=B0t}function B0t(e,t){rf.point=kve,Cve=t8=e,Sve=n8=t}function kve(e,t){e8.add(n8*e-t8*t),t8=e,n8=t}function z0t(){kve(Cve,Sve)}var Ly=1/0,JI=Ly,_$=-Ly,eN=_$,tN={point:U0t,lineStart:Bi,lineEnd:Bi,polygonStart:Bi,polygonEnd:Bi,result:function(){var e=[[Ly,JI],[_$,eN]];return _$=eN=-(JI=Ly=1/0),e}};function U0t(e,t){e<Ly&&(Ly=e),e>_$&&(_$=e),t<JI&&(JI=t),t>eN&&(eN=t)}var r8=0,i8=0,X2=0,nN=0,rN=0,M1=0,s8=0,o8=0,Y2=0,Eve,Ave,$l,Cl,ka={point:wm,lineStart:mre,lineEnd:yre,polygonStart:function(){ka.lineStart=V0t,ka.lineEnd=q0t},polygonEnd:function(){ka.point=wm,ka.lineStart=mre,ka.lineEnd=yre},result:function(){var e=Y2?[s8/Y2,o8/Y2]:M1?[nN/M1,rN/M1]:X2?[r8/X2,i8/X2]:[NaN,NaN];return r8=i8=X2=nN=rN=M1=s8=o8=Y2=0,e}};function wm(e,t){r8+=e,i8+=t,++X2}function mre(){ka.point=j0t}function j0t(e,t){ka.point=W0t,wm($l=e,Cl=t)}function W0t(e,t){var n=e-$l,r=t-Cl,i=Ks(n*n+r*r);nN+=i*($l+e)/2,rN+=i*(Cl+t)/2,M1+=i,wm($l=e,Cl=t)}function yre(){ka.point=wm}function V0t(){ka.point=G0t}function q0t(){_ve(Eve,Ave)}function G0t(e,t){ka.point=_ve,wm(Eve=$l=e,Ave=Cl=t)}function _ve(e,t){var n=e-$l,r=t-Cl,i=Ks(n*n+r*r);nN+=i*($l+e)/2,rN+=i*(Cl+t)/2,M1+=i,i=Cl*e-$l*t,s8+=i*($l+e),o8+=i*(Cl+t),Y2+=i*3,wm($l=e,Cl=t)}function Tve(e){this._context=e}Tve.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Ys);break}}},result:Bi};var a8=new Vs,NB,Ive,Nve,K2,Q2,T$={point:Bi,lineStart:function(){T$.point=H0t},lineEnd:function(){NB&&Dve(Ive,Nve),T$.point=Bi},polygonStart:function(){NB=!0},polygonEnd:function(){NB=null},result:function(){var e=+a8;return a8=new Vs,e}};function H0t(e,t){T$.point=Dve,Ive=K2=e,Nve=Q2=t}function Dve(e,t){K2-=e,Q2-=t,a8.add(Ks(K2*K2+Q2*Q2)),K2=e,Q2=t}function Fve(){this._string=[]}Fve.prototype={_radius:4.5,_circle:xre(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=xre(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function xre(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Rve(e,t){var n=4.5,r,i;function s(o){return o&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),nf(o,r(i))),i.result()}return s.area=function(o){return nf(o,r(rf)),rf.result()},s.measure=function(o){return nf(o,r(T$)),T$.result()},s.bounds=function(o){return nf(o,r(tN)),tN.result()},s.centroid=function(o){return nf(o,r(ka)),ka.result()},s.projection=function(o){return arguments.length?(r=o==null?(e=null,A$):(e=o).stream,s):e},s.context=function(o){return arguments.length?(i=o==null?(t=null,new Fve):new Tve(t=o),typeof n!="function"&&i.pointRadius(n),s):t},s.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(i.pointRadius(+o),+o),s):n},s.projection(e).context(t)}function jR(e){return function(t){var n=new u8;for(var r in e)n[r]=e[r];return n.stream=t,n}}function u8(){}u8.prototype={constructor:u8,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function sq(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),nf(n,e.stream(tN)),t(tN.result()),r!=null&&e.clipExtent(r),e}function WR(e,t,n){return sq(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),a=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(s-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([a,u])},n)}function oq(e,t,n){return WR(e,[[0,0],t],n)}function aq(e,t,n){return sq(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,a=-s*r[0][1];e.scale(150*s).translate([o,a])},n)}function uq(e,t,n){return sq(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],a=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var bre=16,X0t=xt(30*Bt);function vre(e,t){return+t?K0t(e,t):Y0t(e)}function Y0t(e){return jR({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function K0t(e,t){function n(r,i,s,o,a,u,l,c,f,d,h,p,m,x){var b=l-r,v=c-i,$=b*b+v*v;if($>4*t&&m--){var C=o+d,S=a+h,A=u+p,E=Ks(C*C+S*S+A*A),_=Oo(A/=E),D=Jt(Jt(A)-1)<mt||Jt(s-f)<mt?(s+f)/2:Wa(S,C),N=e(D,_),T=N[0],L=N[1],O=T-r,M=L-i,R=v*O-b*M;(R*R/$>t||Jt((b*O+v*M)/$-.5)>.3||o*d+a*h+u*p<X0t)&&(n(r,i,s,o,a,u,T,L,D,C/=E,S/=E,A,m,x),x.point(T,L),n(T,L,D,C,S,A,l,c,f,d,h,p,m,x))}}return function(r){var i,s,o,a,u,l,c,f,d,h,p,m,x={point:b,lineStart:v,lineEnd:C,polygonStart:function(){r.polygonStart(),x.lineStart=S},polygonEnd:function(){r.polygonEnd(),x.lineStart=v}};function b(_,D){_=e(_,D),r.point(_[0],_[1])}function v(){f=NaN,x.point=$,r.lineStart()}function $(_,D){var N=vm([_,D]),T=e(_,D);n(f,d,c,h,p,m,f=T[0],d=T[1],c=_,h=N[0],p=N[1],m=N[2],bre,r),r.point(f,d)}function C(){x.point=b,r.lineEnd()}function S(){v(),x.point=A,x.lineEnd=E}function A(_,D){$(i=_,D),s=f,o=d,a=h,u=p,l=m,x.point=$}function E(){n(f,d,c,h,p,m,s,o,i,a,u,l,bre,r),x.lineEnd=C,C()}return x}}var Q0t=jR({point:function(e,t){this.stream.point(e*Bt,t*Bt)}});function Z0t(e){return jR({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function J0t(e,t,n,r,i){function s(o,a){return o*=r,a*=i,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*r,(n-a)/e*i]},s}function wre(e,t,n,r,i,s){if(!s)return J0t(e,t,n,r,i);var o=xt(s),a=pt(s),u=o*e,l=a*e,c=o/e,f=a/e,d=(a*n-o*t)/e,h=(a*t+o*n)/e;function p(m,x){return m*=r,x*=i,[u*m-l*x+t,n-l*m-u*x]}return p.invert=function(m,x){return[r*(c*m-f*x+d),i*(h-f*m-c*x)]},p}function hc(e){return Ove(function(){return e})()}function Ove(e){var t,n=150,r=480,i=250,s=0,o=0,a=0,u=0,l=0,c,f=0,d=1,h=1,p=null,m=hre,x=null,b,v,$,C=A$,S=.5,A,E,_,D,N;function T(R){return _(R[0]*Bt,R[1]*Bt)}function L(R){return R=_.invert(R[0],R[1]),R&&[R[0]*$r,R[1]*$r]}T.stream=function(R){return D&&N===R?D:D=Q0t(Z0t(c)(m(A(C(N=R)))))},T.preclip=function(R){return arguments.length?(m=R,p=void 0,M()):m},T.postclip=function(R){return arguments.length?(C=R,x=b=v=$=null,M()):C},T.clipAngle=function(R){return arguments.length?(m=+R?O0t(p=R*Bt):(p=null,hre),M()):p*$r},T.clipExtent=function(R){return arguments.length?(C=R==null?(x=b=v=$=null,A$):$ve(x=+R[0][0],b=+R[0][1],v=+R[1][0],$=+R[1][1]),M()):x==null?null:[[x,b],[v,$]]},T.scale=function(R){return arguments.length?(n=+R,O()):n},T.translate=function(R){return arguments.length?(r=+R[0],i=+R[1],O()):[r,i]},T.center=function(R){return arguments.length?(s=R[0]%360*Bt,o=R[1]%360*Bt,O()):[s*$r,o*$r]},T.rotate=function(R){return arguments.length?(a=R[0]%360*Bt,u=R[1]%360*Bt,l=R.length>2?R[2]%360*Bt:0,O()):[a*$r,u*$r,l*$r]},T.angle=function(R){return arguments.length?(f=R%360*Bt,O()):f*$r},T.reflectX=function(R){return arguments.length?(d=R?-1:1,O()):d<0},T.reflectY=function(R){return arguments.length?(h=R?-1:1,O()):h<0},T.precision=function(R){return arguments.length?(A=vre(E,S=R*R),M()):Ks(S)},T.fitExtent=function(R,P){return WR(T,R,P)},T.fitSize=function(R,P){return oq(T,R,P)},T.fitWidth=function(R,P){return aq(T,R,P)},T.fitHeight=function(R,P){return uq(T,R,P)};function O(){var R=wre(n,0,0,d,h,f).apply(null,t(s,o)),P=wre(n,r-R[0],i-R[1],d,h,f);return c=xve(a,u,l),E=Zz(t,P),_=Zz(c,E),A=vre(E,S),M()}function M(){return D=N=null,T}return function(){return t=e.apply(this,arguments),T.invert=t.invert&&L,O()}}function lq(e){var t=0,n=Pt/3,r=Ove(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*Bt,n=s[1]*Bt):[t*$r,n*$r]},i}function e1t(e){var t=xt(e);function n(r,i){return[r*t,pt(i)/t]}return n.invert=function(r,i){return[r/t,Oo(i*t)]},n}function t1t(e,t){var n=pt(e),r=(n+pt(t))/2;if(Jt(r)<mt)return e1t(e);var i=1+n*(2*r-n),s=Ks(i)/r;function o(a,u){var l=Ks(i-2*r*pt(u))/r;return[l*pt(a*=r),s-l*xt(a)]}return o.invert=function(a,u){var l=s-u,c=Wa(a,Jt(l))*Na(l);return l*r<0&&(c-=Pt*Na(a)*Na(l)),[c/r,Oo((i-(a*a+l*l)*r*r)/(2*r))]},o}function iN(){return lq(t1t).scale(155.424).center([0,33.6442])}function Mve(){return iN().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function n1t(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function r1t(){var e,t,n=Mve(),r,i=iN().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=iN().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(s.point(h,p),u)||(a.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),m=(d[0]-p[0])/h,x=(d[1]-p[1])/h;return(x>=.12&&x<.234&&m>=-.425&&m<-.214?i:x>=.166&&x<.234&&m>=-.214&&m<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=n1t([n.stream(t=d),i.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],m=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,m-.238*h],[p+.455*h,m+.238*h]]).stream(l),s=i.translate([p-.307*h,m+.201*h]).clipExtent([[p-.425*h+mt,m+.12*h+mt],[p-.214*h-mt,m+.234*h-mt]]).stream(l),a=o.translate([p-.205*h,m+.212*h]).clipExtent([[p-.214*h+mt,m+.166*h+mt],[p-.115*h-mt,m+.234*h-mt]]).stream(l),f()},c.fitExtent=function(d,h){return WR(c,d,h)},c.fitSize=function(d,h){return oq(c,d,h)},c.fitWidth=function(d,h){return aq(c,d,h)},c.fitHeight=function(d,h){return uq(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function Lve(e){return function(t,n){var r=xt(t),i=xt(n),s=e(r*i);return s===1/0?[2,0]:[s*i*pt(t),s*pt(n)]}}function lk(e){return function(t,n){var r=Ks(t*t+n*n),i=e(r),s=pt(i),o=xt(i);return[Wa(t*s,r*o),Oo(r&&n*s/r)]}}var Pve=Lve(function(e){return Ks(2/(1+e))});Pve.invert=lk(function(e){return 2*Oo(e/2)});function i1t(){return hc(Pve).scale(124.75).clipAngle(180-.001)}var Bve=Lve(function(e){return(e=ave(e))&&e/pt(e)});Bve.invert=lk(function(e){return e});function s1t(){return hc(Bve).scale(79.4188).clipAngle(180-.001)}function VR(e,t){return[e,zI(rq((pr+t)/2))]}VR.invert=function(e,t){return[e,2*Rb(ove(t))-pr]};function o1t(){return zve(VR).scale(961/Ys)}function zve(e){var t=hc(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,o=null,a,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=a=u=l=null:(o=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,a],[u,l]]};function c(){var f=Pt*r(),d=t(A0t(t.rotate()).invert([0,0]));return s(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===VR?[[Math.max(d[0]-f,o),a],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function XA(e){return rq((pr+e)/2)}function a1t(e,t){var n=xt(e),r=e===t?pt(e):zI(n/xt(t))/zI(XA(t)/XA(e)),i=n*AB(XA(e),r)/r;if(!r)return VR;function s(o,a){i>0?a<-pr+mt&&(a=-pr+mt):a>pr-mt&&(a=pr-mt);var u=i/AB(XA(a),r);return[u*pt(r*o),i-u*xt(r*o)]}return s.invert=function(o,a){var u=i-a,l=Na(r)*Ks(o*o+u*u),c=Wa(o,Jt(u))*Na(u);return u*r<0&&(c-=Pt*Na(o)*Na(u)),[c/r,2*Rb(AB(i/l,1/r))-pr]},s}function u1t(){return lq(a1t).scale(109.5).parallels([30,30])}function sN(e,t){return[e,t]}sN.invert=sN;function l1t(){return hc(sN).scale(152.63)}function c1t(e,t){var n=xt(e),r=e===t?pt(e):(n-xt(t))/(t-e),i=n/r+e;if(Jt(r)<mt)return sN;function s(o,a){var u=i-a,l=r*o;return[u*pt(l),i-u*xt(l)]}return s.invert=function(o,a){var u=i-a,l=Wa(o,Jt(u))*Na(u);return u*r<0&&(l-=Pt*Na(o)*Na(u)),[l/r,i-Na(r)*Ks(o*o+u*u)]},s}function f1t(){return lq(c1t).scale(131.154).center([0,13.9389])}var pw=1.340264,gw=-.081106,mw=893e-6,yw=.003796,oN=Ks(3)/2,d1t=12;function Uve(e,t){var n=Oo(oN*pt(t)),r=n*n,i=r*r*r;return[e*xt(n)/(oN*(pw+3*gw*r+i*(7*mw+9*yw*r))),n*(pw+gw*r+i*(mw+yw*r))]}Uve.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,o,a,u;s<d1t&&(a=n*(pw+gw*r+i*(mw+yw*r))-t,u=pw+3*gw*r+i*(7*mw+9*yw*r),n-=o=a/u,r=n*n,i=r*r*r,!(Jt(o)<PI));++s);return[oN*e*(pw+3*gw*r+i*(7*mw+9*yw*r))/xt(n),Oo(pt(n)/oN)]};function h1t(){return hc(Uve).scale(177.158)}function jve(e,t){var n=xt(t),r=xt(e)*n;return[n*pt(e)/r,pt(t)/r]}jve.invert=lk(Rb);function p1t(){return hc(jve).scale(144.049).clipAngle(60)}function g1t(){var e=1,t=0,n=0,r=1,i=1,s=0,o,a,u=null,l,c,f,d=1,h=1,p=jR({point:function(C,S){var A=$([C,S]);this.stream.point(A[0],A[1])}}),m=A$,x,b;function v(){return d=e*r,h=e*i,x=b=null,$}function $(C){var S=C[0]*d,A=C[1]*h;if(s){var E=A*o-S*a;S=S*o+A*a,A=E}return[S+t,A+n]}return $.invert=function(C){var S=C[0]-t,A=C[1]-n;if(s){var E=A*o+S*a;S=S*o-A*a,A=E}return[S/d,A/h]},$.stream=function(C){return x&&b===C?x:x=p(m(b=C))},$.postclip=function(C){return arguments.length?(m=C,u=l=c=f=null,v()):m},$.clipExtent=function(C){return arguments.length?(m=C==null?(u=l=c=f=null,A$):$ve(u=+C[0][0],l=+C[0][1],c=+C[1][0],f=+C[1][1]),v()):u==null?null:[[u,l],[c,f]]},$.scale=function(C){return arguments.length?(e=+C,v()):e},$.translate=function(C){return arguments.length?(t=+C[0],n=+C[1],v()):[t,n]},$.angle=function(C){return arguments.length?(s=C%360*Bt,a=pt(s),o=xt(s),v()):s*$r},$.reflectX=function(C){return arguments.length?(r=C?-1:1,v()):r<0},$.reflectY=function(C){return arguments.length?(i=C?-1:1,v()):i<0},$.fitExtent=function(C,S){return WR($,C,S)},$.fitSize=function(C,S){return oq($,C,S)},$.fitWidth=function(C,S){return aq($,C,S)},$.fitHeight=function(C,S){return uq($,C,S)},$}function Wve(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}Wve.invert=function(e,t){var n=t,r=25,i;do{var s=n*n,o=s*s;n-=i=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(Jt(i)>mt&&--r>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function m1t(){return hc(Wve).scale(175.295)}function Vve(e,t){return[xt(t)*pt(e),pt(t)]}Vve.invert=lk(Oo);function y1t(){return hc(Vve).scale(249.5).clipAngle(90+mt)}function qve(e,t){var n=xt(t),r=1+xt(e)*n;return[n*pt(e)/r,pt(t)/r]}qve.invert=lk(function(e){return 2*Rb(e)});function x1t(){return hc(qve).scale(250).clipAngle(142)}function Gve(e,t){return[zI(rq((pr+t)/2)),-e]}Gve.invert=function(e,t){return[-t,2*Rb(ove(e))-pr]};function b1t(){var e=zve(Gve),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var v1t=Math.abs,l8=Math.cos,aN=Math.sin,w1t=1e-6,Hve=Math.PI,c8=Hve/2,$re=$1t(2);function Cre(e){return e>1?c8:e<-1?-c8:Math.asin(e)}function $1t(e){return e>0?Math.sqrt(e):0}function C1t(e,t){var n=e*aN(t),r=30,i;do t-=i=(t+aN(t)-n)/(1+l8(t));while(v1t(i)>w1t&&--r>0);return t/2}function S1t(e,t,n){function r(i,s){return[e*i*l8(s=C1t(n,s)),t*aN(s)]}return r.invert=function(i,s){return s=Cre(s/t),[i/(e*l8(s)),Cre((2*s+aN(2*s))/n)]},r}var k1t=S1t($re/c8,$re,Hve);function E1t(){return hc(k1t).scale(169.529)}const A1t=Rve(),f8=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function _1t(e,t){return function n(){const r=t();return r.type=e,r.path=Rve().projection(r),r.copy=r.copy||function(){const i=n();return f8.forEach(s=>{r[s]&&i[s](r[s]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function cq(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(uN[e]=_1t(e,t),this):uN[e]||null}function Xve(e){return e&&e.path||A1t}const uN={albers:Mve,albersusa:r1t,azimuthalequalarea:i1t,azimuthalequidistant:s1t,conicconformal:u1t,conicequalarea:iN,conicequidistant:f1t,equalEarth:h1t,equirectangular:l1t,gnomonic:p1t,identity:g1t,mercator:o1t,mollweide:E1t,naturalEarth1:m1t,orthographic:y1t,stereographic:x1t,transversemercator:b1t};for(const e in uN)cq(e,uN[e]);function T1t(){}const Uc=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Yve(){var e=1,t=1,n=a;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return s(u,l,d=>{n(d,u,l),I1t(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,m;h<p;++h)if(N1t((m=c[h])[0],d)!==-1){m.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function s(u,l,c){var f=new Array,d=new Array,h,p,m,x,b,v;for(h=p=-1,x=u[0]>=l,Uc[x<<1].forEach($);++h<e-1;)m=x,x=u[h+1]>=l,Uc[m|x<<1].forEach($);for(Uc[x<<0].forEach($);++p<t-1;){for(h=-1,x=u[p*e+e]>=l,b=u[p*e]>=l,Uc[x<<1|b<<2].forEach($);++h<e-1;)m=x,x=u[p*e+e+h+1]>=l,v=b,b=u[p*e+h+1]>=l,Uc[m|x<<1|b<<2|v<<3].forEach($);Uc[x|b<<3].forEach($)}for(h=-1,b=u[p*e]>=l,Uc[b<<2].forEach($);++h<e-1;)v=b,b=u[p*e+h+1]>=l,Uc[b<<2|v<<3].forEach($);Uc[b<<3].forEach($);function $(C){var S=[C[0][0]+h,C[0][1]+p],A=[C[1][0]+h,C[1][1]+p],E=o(S),_=o(A),D,N;(D=d[E])?(N=f[_])?(delete d[D.end],delete f[N.start],D===N?(D.ring.push(A),c(D.ring)):f[D.start]=d[N.end]={start:D.start,end:N.end,ring:D.ring.concat(N.ring)}):(delete d[D.end],D.ring.push(A),d[D.end=_]=D):(D=f[_])?(N=d[E])?(delete f[D.start],delete d[N.end],D===N?(D.ring.push(A),c(D.ring)):f[N.start]=d[D.end]={start:N.start,end:D.end,ring:N.ring.concat(D.ring)}):(delete f[D.start],D.ring.unshift(S),f[D.start=E]=D):f[E]=d[_]={start:E,end:_,ring:[S,A]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,m=h|0,x,b=l[m*e+p];d>0&&d<e&&p===d&&(x=l[m*e+p-1],f[0]=d+(c-x)/(b-x)-.5),h>0&&h<t&&m===h&&(x=l[(m-1)*e+p],f[1]=h+(c-x)/(b-x)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||ke("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?a:T1t,r):n===a},r}function I1t(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function N1t(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=D1t(e,t[n]))return i;return 0}function D1t(e,t){for(var n=t[0],r=t[1],i=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var u=e[s],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(F1t(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function F1t(e,t,n){var r;return R1t(e,t,n)&&O1t(e[r=+(e[0]===t[0])],n[r],t[r])}function R1t(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function O1t(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function Kve(e,t,n){return function(r){var i=Ch(r),s=n?Math.min(i[0],0):i[0],o=i[1],a=o-s,u=t?_h(s,o,e):a/(e+1);return ta(s+u,o,u)}}function fq(e){xe.call(this,null,e)}fq.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};ze(fq,xe,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||za,s=Yve().smooth(e.smooth!==!1),o=e.thresholds||M1t(r,i,e),a=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=s.size([c.width,c.height])(c.values,Rt(o)?o:o(c.values));L1t(f,c,l,e),f.forEach(d=>{u.push(G3(l,dn(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function M1t(e,t,n){const r=Kve(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>zg(t(i).values)))}function L1t(e,t,n,r){let i=r.scale||t.scale,s=r.translate||t.translate;if(xn(i)&&(i=i(n,r)),xn(s)&&(s=s(n,r)),(i===1||i==null)&&!s)return;const o=(dm(i)?i:i[0])||1,a=(dm(i)?i:i[1])||1,u=s&&s[0]||0,l=s&&s[1]||0;e.forEach(Qve(t,o,a,u,l))}function Qve(e,t,n,r,i){const s=e.x1||0,o=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+r,f[1]=(f[1]-o)*n+i}return function(f){return f.coordinates.forEach(u),f}}function Sre(e,t,n){const r=e>=0?e:Nj(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function DB(e){return xn(e)?e:Ua(+e)}function Zve(){var e=u=>u[0],t=u=>u[1],n=yb,r=[-1,-1],i=960,s=500,o=2;function a(u,l){const c=Sre(r[0],u,e)>>o,f=Sre(r[1],u,t)>>o,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>o),m=2*h+(s>>o),x=new Float32Array(p*m),b=new Float32Array(p*m);let v=x;u.forEach(C=>{const S=d+(+e(C)>>o),A=h+(+t(C)>>o);S>=0&&S<p&&A>=0&&A<m&&(x[S+A*p]+=+n(C))}),c>0&&f>0?(p1(p,m,x,b,c),g1(p,m,b,x,f),p1(p,m,x,b,c),g1(p,m,b,x,f),p1(p,m,x,b,c),g1(p,m,b,x,f)):c>0?(p1(p,m,x,b,c),p1(p,m,b,x,c),p1(p,m,x,b,c),v=b):f>0&&(g1(p,m,x,b,f),g1(p,m,b,x,f),g1(p,m,x,b,f),v=b);const $=l?Math.pow(2,-2*o):1/v0e(v);for(let C=0,S=p*m;C<S;++C)v[C]*=$;return{values:v,scale:1<<o,width:p,height:m,x1:d,y1:h,x2:d+(i>>o),y2:h+(s>>o)}}return a.x=function(u){return arguments.length?(e=DB(u),a):e},a.y=function(u){return arguments.length?(t=DB(u),a):t},a.weight=function(u){return arguments.length?(n=DB(u),a):n},a.size=function(u){if(!arguments.length)return[i,s];var l=+u[0],c=+u[1];return l>=0&&c>=0||ke("invalid size"),i=l,s=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||ke("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),a):1<<o},a.bandwidth=function(u){return arguments.length?(u=It(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&ke("invalid bandwidth"),r=u,a):r},a}function p1(e,t,n,r,i){const s=(i<<1)+1;for(let o=0;o<t;++o)for(let a=0,u=0;a<e+i;++a)a<e&&(u+=n[a+o*e]),a>=i&&(a>=s&&(u-=n[a-s+o*e]),r[a-i+o*e]=u/Math.min(a+1,e-1+s-a,s))}function g1(e,t,n,r,i){const s=(i<<1)+1;for(let o=0;o<e;++o)for(let a=0,u=0;a<t+i;++a)a<t&&(u+=n[o+a*e]),a>=i&&(a>=s&&(u-=n[o+(a-s)*e]),r[o+(a-i)*e]=u/Math.min(a+1,t-1+s-a,s))}function dq(e){xe.call(this,null,e)}dq.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const P1t=["x","y","weight","size","cellSize","bandwidth"];function Jve(e,t){return P1t.forEach(n=>t[n]!=null?e[n](t[n]):0),e}ze(dq,xe,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=B1t(r,e.groupby),s=(e.groupby||[]).map(gr),o=Jve(Zve(),e),a=e.as||"grid",u=[];function l(c,f){for(let d=0;d<s.length;++d)c[s[d]]=f[d];return c}return u=i.map(c=>dn(l({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function B1t(e,t){var n=[],r=c=>c(a),i,s,o,a,u,l;if(t==null)n.push(e);else for(i={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function hq(e){xe.call(this,null,e)}hq.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};ze(hq,xe,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=Yve().smooth(e.smooth!==!1),i=e.values,s=e.thresholds||Kve(e.count||10,e.nice,!!i),o=e.size,a,u;return i||(i=t.materialize(t.SOURCE).source,a=Jve(Zve(),e)(i,!0),u=Qve(a,a.scale||1,a.scale||1,0,0),o=[a.width,a.height],i=a.values),s=Rt(s)?s:s(i),i=r.size(o)(i,s),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(dn),n}});const d8="Feature",pq="FeatureCollection",z1t="MultiPoint";function gq(e){xe.call(this,null,e)}gq.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};ze(gq,xe,{transform(e,t){var n=this._features,r=this._points,i=e.fields,s=i&&i[0],o=i&&i[1],a=e.geojson||!i&&za,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(ms(a))||s&&t.modified(ms(s))||o&&t.modified(ms(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),a&&t.visit(u,c=>n.push(a(c))),s&&o&&(t.visit(u,c=>{var f=s(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:d8,geometry:{type:z1t,coordinates:r}})),this.value={type:pq,features:n}}});function mq(e){xe.call(this,null,e)}mq.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};ze(mq,xe,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||za,s=e.as||"path",o=n.SOURCE;!r||e.modified()?(this.value=r=Xve(e.projection),n.materialize().reflow()):o=i===za||t.modified(i.fields)?n.ADD_MOD:n.ADD;const a=U1t(r,e.pointRadius);return n.visit(o,u=>u[s]=r(i(u))),r.pointRadius(a),n.modifies(s)}});function U1t(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function yq(e){xe.call(this,null,e)}yq.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};ze(yq,xe,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[o]=f[0],c[a]=f[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(s)}});function xq(e){xe.call(this,null,e)}xq.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};ze(xq,xe,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",s=n.ADD;return(!r||e.modified())&&(this.value=r=j1t(Xve(e.projection),e.field||wh("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[i]=r),n.modifies(i)}});function j1t(e,t,n){const r=n==null?i=>e(t(i)):i=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(i));return e.pointRadius(s),o};return r.context=i=>(e.context(i),r),r}function bq(e){xe.call(this,[],e),this.generator=L0t()}bq.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};ze(bq,xe,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const s in e)xn(r[s])&&r[s](e[s]);return i=r(),n.length?t.mod.push(a0e(n[0],i)):t.add.push(dn(i)),n[0]=i,t}});function vq(e){xe.call(this,null,e)}vq.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};ze(vq,xe,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||za,s=V1t(e.opacity,e),o=W1t(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?zg(n.map(l=>zg(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=qt({},l,u);r||(f.$max=zg(c.values||[])),l[a]=q1t(c,f,o.dep?o:Ua(o(f)),s.dep?s:Ua(s(f)))}),t.reflow(!0).modifies(a)}});function W1t(e,t){let n;return xn(e)?(n=r=>Ro(e(r,t)),n.dep=e2e(e)):n=Ua(Ro(e||"#888")),n}function V1t(e,t){let n;return xn(e)?(n=r=>e(r,t),n.dep=e2e(e)):e?n=Ua(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function e2e(e){if(!xn(e))return!1;const t=Tf(ms(e));return t.$x||t.$y||t.$value||t.$max}function q1t(e,t,n,r){const i=e.width,s=e.height,o=e.x1||0,a=e.y1||0,u=e.x2||i,l=e.y2||s,c=e.values,f=c?x=>c[x]:Rd,d=op(u-o,l-a),h=d.getContext("2d"),p=h.getImageData(0,0,u-o,l-a),m=p.data;for(let x=a,b=0;x<l;++x){t.$y=x-a;for(let v=o,$=x*i;v<u;++v,b+=4){t.$x=v-o,t.$value=f(v+$);const C=n(t);m[b+0]=C.r,m[b+1]=C.g,m[b+2]=C.b,m[b+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function t2e(e){xe.call(this,null,e),this.modified(!0)}ze(t2e,xe,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=H1t(e.type),f8.forEach(r=>{e[r]!=null&&kre(n,r,e[r])})):f8.forEach(r=>{e.modified(r)&&kre(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&G1t(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function G1t(e,t){const n=X1t(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function H1t(e){const t=cq((e||"mercator").toLowerCase());return t||ke("Unrecognized projection type: "+e),t()}function kre(e,t,n){xn(e[t])&&e[t](n)}function X1t(e){return e=It(e),e.length===1?e[0]:{type:pq,features:e.reduce((t,n)=>t.concat(Y1t(n)),[])}}function Y1t(e){return e.type===pq?e.features:It(e).filter(t=>t!=null).map(t=>t.type===d8?t:{type:d8,geometry:t})}const K1t=Object.freeze(Object.defineProperty({__proto__:null,contour:hq,geojson:gq,geopath:mq,geopoint:yq,geoshape:xq,graticule:bq,heatmap:vq,isocontour:fq,kde2d:dq,projection:t2e},Symbol.toStringTag,{value:"Module"}));function Q1t(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var s,o=n.length,a,u=0,l=0;for(s=0;s<o;++s)a=n[s],u+=a.x,l+=a.y;for(u=(u/o-e)*r,l=(l/o-t)*r,s=0;s<o;++s)a=n[s],a.x-=u,a.y-=l}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(t=+s,i):t},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function Z1t(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return n2e(this.cover(t,n),t,n,e)}function n2e(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,s=e._root,o={data:r},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,m,x,b,v;if(!s)return e._root=o,e;for(;s.length;)if((m=t>=(f=(a+l)/2))?a=f:l=f,(x=n>=(d=(u+c)/2))?u=d:c=d,i=s,!(s=s[b=x<<1|m]))return i[b]=o,e;if(h=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===h&&n===p)return o.next=s,i?i[b]=o:e._root=o,e;do i=i?i[b]=new Array(4):e._root=new Array(4),(m=t>=(f=(a+l)/2))?a=f:l=f,(x=n>=(d=(u+c)/2))?u=d:c=d;while((b=x<<1|m)===(v=(p>=d)<<1|h>=f));return i[v]=s,i[b]=o,e}function J1t(e){var t,n,r=e.length,i,s,o=new Array(r),a=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=i,a[n]=s,i<u&&(u=i),i>c&&(c=i),s<l&&(l=s),s>f&&(f=s));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)n2e(this,o[n],a[n],e[n]);return this}function eyt(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(r=Math.floor(t))+1;else{for(var o=i-n||1,a=this._root,u,l;n>e||e>=i||r>t||t>=s;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=a,a=u,o*=2,l){case 0:i=n+o,s=r+o;break;case 1:n=i-o,s=r+o;break;case 2:i=n+o,r=s-o;break;case 3:n=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function tyt(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function nyt(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Us(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function ryt(e,t,n){var r,i=this._x0,s=this._y0,o,a,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,m;for(h&&d.push(new Us(h,i,s,c,f)),n==null?n=1/0:(i=e-n,s=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(a=p.y0)>f||(u=p.x1)<i||(l=p.y1)<s))if(h.length){var x=(o+u)/2,b=(a+l)/2;d.push(new Us(h[3],x,b,u,l),new Us(h[2],o,b,x,l),new Us(h[1],x,a,u,b),new Us(h[0],o,a,x,b)),(m=(t>=b)<<1|e>=x)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-m],d[d.length-1-m]=p)}else{var v=e-+this._x.call(null,h.data),$=t-+this._y.call(null,h.data),C=v*v+$*$;if(C<n){var S=Math.sqrt(n=C);i=e-S,s=t-S,c=e+S,f=t+S,r=h.data}}return r}function iyt(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,s,o=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,m,x,b;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+u)/2))?o=d:u=d,(m=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[x=m<<1|p]))return this;if(!n.length)break;(t[x+1&3]||t[x+2&3]||t[x+3&3])&&(r=t,b=x)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):t?(s?t[x]=s:delete t[x],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[b]=n:this._root=n),this):(this._root=s,this)}function syt(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function oyt(){return this._root}function ayt(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function uyt(e){var t=[],n,r=this._root,i,s,o,a,u;for(r&&t.push(new Us(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,s=n.x0,o=n.y0,a=n.x1,u=n.y1)&&r.length){var l=(s+a)/2,c=(o+u)/2;(i=r[3])&&t.push(new Us(i,l,c,a,u)),(i=r[2])&&t.push(new Us(i,s,c,l,u)),(i=r[1])&&t.push(new Us(i,l,o,a,c)),(i=r[0])&&t.push(new Us(i,s,o,l,c))}return this}function lyt(e){var t=[],n=[],r;for(this._root&&t.push(new Us(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var s,o=r.x0,a=r.y0,u=r.x1,l=r.y1,c=(o+u)/2,f=(a+l)/2;(s=i[0])&&t.push(new Us(s,o,a,c,f)),(s=i[1])&&t.push(new Us(s,c,a,u,f)),(s=i[2])&&t.push(new Us(s,o,f,c,l)),(s=i[3])&&t.push(new Us(s,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function cyt(e){return e[0]}function fyt(e){return arguments.length?(this._x=e,this):this._x}function dyt(e){return e[1]}function hyt(e){return arguments.length?(this._y=e,this):this._y}function wq(e,t,n){var r=new $q(t??cyt,n??dyt,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function $q(e,t,n,r,i,s){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function Ere(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var to=wq.prototype=$q.prototype;to.copy=function(){var e=new $q(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Ere(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Ere(r));return e};to.add=Z1t;to.addAll=J1t;to.cover=eyt;to.data=tyt;to.extent=nyt;to.find=ryt;to.remove=iyt;to.removeAll=syt;to.root=oyt;to.size=ayt;to.visit=uyt;to.visitAfter=lyt;to.x=fyt;to.y=hyt;function js(e){return function(){return e}}function Wd(e){return(e()-.5)*1e-6}function pyt(e){return e.x+e.vx}function gyt(e){return e.y+e.vy}function myt(e){var t,n,r,i=1,s=1;typeof e!="function"&&(e=js(e==null?1:+e));function o(){for(var l,c=t.length,f,d,h,p,m,x,b=0;b<s;++b)for(f=wq(t,pyt,gyt).visitAfter(a),l=0;l<c;++l)d=t[l],m=n[d.index],x=m*m,h=d.x+d.vx,p=d.y+d.vy,f.visit(v);function v($,C,S,A,E){var _=$.data,D=$.r,N=m+D;if(_){if(_.index>d.index){var T=h-_.x-_.vx,L=p-_.y-_.vy,O=T*T+L*L;O<N*N&&(T===0&&(T=Wd(r),O+=T*T),L===0&&(L=Wd(r),O+=L*L),O=(N-(O=Math.sqrt(O)))/O*i,d.vx+=(T*=O)*(N=(D*=D)/(x+D)),d.vy+=(L*=O)*N,_.vx-=T*(N=1-N),_.vy-=L*N)}return}return C>h+N||A<h-N||S>p+N||E<p-N}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,r=c,u()},o.iterations=function(l){return arguments.length?(s=+l,o):s},o.strength=function(l){return arguments.length?(i=+l,o):i},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:js(+l),u(),o):e},o}function yyt(e){return e.index}function Are(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function xyt(e){var t=yyt,n=f,r,i=js(30),s,o,a,u,l,c=1;e==null&&(e=[]);function f(x){return 1/Math.min(a[x.source.index],a[x.target.index])}function d(x){for(var b=0,v=e.length;b<c;++b)for(var $=0,C,S,A,E,_,D,N;$<v;++$)C=e[$],S=C.source,A=C.target,E=A.x+A.vx-S.x-S.vx||Wd(l),_=A.y+A.vy-S.y-S.vy||Wd(l),D=Math.sqrt(E*E+_*_),D=(D-s[$])/D*x*r[$],E*=D,_*=D,A.vx-=E*(N=u[$]),A.vy-=_*N,S.vx+=E*(N=1-N),S.vy+=_*N}function h(){if(o){var x,b=o.length,v=e.length,$=new Map(o.map((S,A)=>[t(S,A,o),S])),C;for(x=0,a=new Array(b);x<v;++x)C=e[x],C.index=x,typeof C.source!="object"&&(C.source=Are($,C.source)),typeof C.target!="object"&&(C.target=Are($,C.target)),a[C.source.index]=(a[C.source.index]||0)+1,a[C.target.index]=(a[C.target.index]||0)+1;for(x=0,u=new Array(v);x<v;++x)C=e[x],u[x]=a[C.source.index]/(a[C.source.index]+a[C.target.index]);r=new Array(v),p(),s=new Array(v),m()}}function p(){if(o)for(var x=0,b=e.length;x<b;++x)r[x]=+n(e[x],x,e)}function m(){if(o)for(var x=0,b=e.length;x<b;++x)s[x]=+i(e[x],x,e)}return d.initialize=function(x,b){o=x,l=b,h()},d.links=function(x){return arguments.length?(e=x,h(),d):e},d.id=function(x){return arguments.length?(t=x,d):t},d.iterations=function(x){return arguments.length?(c=+x,d):c},d.strength=function(x){return arguments.length?(n=typeof x=="function"?x:js(+x),p(),d):n},d.distance=function(x){return arguments.length?(i=typeof x=="function"?x:js(+x),m(),d):i},d}var byt={value:()=>{}};function r2e(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new gT(n)}function gT(e){this._=e}function vyt(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}gT.prototype=r2e.prototype={constructor:gT,on:function(e,t){var n=this._,r=vyt(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=wyt(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=_re(n[i],e.name,t);else if(t==null)for(i in n)n[i]=_re(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new gT(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function wyt(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function _re(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=byt,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Py=0,Z2=0,c2=0,i2e=1e3,lN,J2,cN=0,$m=0,qR=0,I$=typeof performance=="object"&&performance.now?performance:Date,s2e=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Cq(){return $m||(s2e($yt),$m=I$.now()+qR)}function $yt(){$m=0}function fN(){this._call=this._time=this._next=null}fN.prototype=o2e.prototype={constructor:fN,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Cq():+n)+(t==null?0:+t),!this._next&&J2!==this&&(J2?J2._next=this:lN=this,J2=this),this._call=e,this._time=n,h8()},stop:function(){this._call&&(this._call=null,this._time=1/0,h8())}};function o2e(e,t,n){var r=new fN;return r.restart(e,t,n),r}function Cyt(){Cq(),++Py;for(var e=lN,t;e;)(t=$m-e._time)>=0&&e._call.call(null,t),e=e._next;--Py}function Tre(){$m=(cN=I$.now())+qR,Py=Z2=0;try{Cyt()}finally{Py=0,kyt(),$m=0}}function Syt(){var e=I$.now(),t=e-cN;t>i2e&&(qR-=t,cN=e)}function kyt(){for(var e,t=lN,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:lN=n);J2=e,h8(r)}function h8(e){if(!Py){Z2&&(Z2=clearTimeout(Z2));var t=e-$m;t>24?(e<1/0&&(Z2=setTimeout(Tre,e-I$.now()-qR)),c2&&(c2=clearInterval(c2))):(c2||(cN=I$.now(),c2=setInterval(Syt,i2e)),Py=1,s2e(Tre))}}function Eyt(e,t,n){var r=new fN,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(s,o,a){o=+o,a=a==null?Cq():+a,r._restart(function u(l){l+=i,r._restart(u,i+=o,a),s(l)},o,a)},r.restart(e,t,n),r)}const Ayt=1664525,_yt=1013904223,Ire=4294967296;function Tyt(){let e=1;return()=>(e=(Ayt*e+_yt)%Ire)/Ire}function Iyt(e){return e.x}function Nyt(e){return e.y}var Dyt=10,Fyt=Math.PI*(3-Math.sqrt(5));function Ryt(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,a=new Map,u=o2e(f),l=r2e("tick","end"),c=Tyt();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(m){var x,b=e.length,v;m===void 0&&(m=1);for(var $=0;$<m;++$)for(n+=(s-n)*i,a.forEach(function(C){C(n)}),x=0;x<b;++x)v=e[x],v.fx==null?v.x+=v.vx*=o:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=o:(v.y=v.fy,v.vy=0);return t}function h(){for(var m=0,x=e.length,b;m<x;++m){if(b=e[m],b.index=m,b.fx!=null&&(b.x=b.fx),b.fy!=null&&(b.y=b.fy),isNaN(b.x)||isNaN(b.y)){var v=Dyt*Math.sqrt(.5+m),$=m*Fyt;b.x=v*Math.cos($),b.y=v*Math.sin($)}(isNaN(b.vx)||isNaN(b.vy))&&(b.vx=b.vy=0)}}function p(m){return m.initialize&&m.initialize(e,c),m}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(m){return arguments.length?(e=m,h(),a.forEach(p),t):e},alpha:function(m){return arguments.length?(n=+m,t):n},alphaMin:function(m){return arguments.length?(r=+m,t):r},alphaDecay:function(m){return arguments.length?(i=+m,t):+i},alphaTarget:function(m){return arguments.length?(s=+m,t):s},velocityDecay:function(m){return arguments.length?(o=1-m,t):1-o},randomSource:function(m){return arguments.length?(c=m,a.forEach(p),t):c},force:function(m,x){return arguments.length>1?(x==null?a.delete(m):a.set(m,p(x)),t):a.get(m)},find:function(m,x,b){var v=0,$=e.length,C,S,A,E,_;for(b==null?b=1/0:b*=b,v=0;v<$;++v)E=e[v],C=m-E.x,S=x-E.y,A=C*C+S*S,A<b&&(_=E,b=A);return _},on:function(m,x){return arguments.length>1?(l.on(m,x),t):l.on(m)}}}function Oyt(){var e,t,n,r,i=js(-30),s,o=1,a=1/0,u=.81;function l(h){var p,m=e.length,x=wq(e,Iyt,Nyt).visitAfter(f);for(r=h,p=0;p<m;++p)t=e[p],x.visit(d)}function c(){if(e){var h,p=e.length,m;for(s=new Array(p),h=0;h<p;++h)m=e[h],s[m.index]=+i(m,h,e)}}function f(h){var p=0,m,x,b=0,v,$,C;if(h.length){for(v=$=C=0;C<4;++C)(m=h[C])&&(x=Math.abs(m.value))&&(p+=m.value,b+=x,v+=x*m.x,$+=x*m.y);h.x=v/b,h.y=$/b}else{m=h,m.x=m.data.x,m.y=m.data.y;do p+=s[m.data.index];while(m=m.next)}h.value=p}function d(h,p,m,x){if(!h.value)return!0;var b=h.x-t.x,v=h.y-t.y,$=x-p,C=b*b+v*v;if($*$/u<C)return C<a&&(b===0&&(b=Wd(n),C+=b*b),v===0&&(v=Wd(n),C+=v*v),C<o&&(C=Math.sqrt(o*C)),t.vx+=b*h.value*r/C,t.vy+=v*h.value*r/C),!0;if(h.length||C>=a)return;(h.data!==t||h.next)&&(b===0&&(b=Wd(n),C+=b*b),v===0&&(v=Wd(n),C+=v*v),C<o&&(C=Math.sqrt(o*C)));do h.data!==t&&($=s[h.data.index]*r/C,t.vx+=b*$,t.vy+=v*$);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:js(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(o=h*h,l):Math.sqrt(o)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function Myt(e){var t=js(.1),n,r,i;typeof e!="function"&&(e=js(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*a}function o(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:js(+a),o(),s):t},s.x=function(a){return arguments.length?(e=typeof a=="function"?a:js(+a),o(),s):e},s}function Lyt(e){var t=js(.1),n,r,i;typeof e!="function"&&(e=js(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*a}function o(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:js(+a),o(),s):t},s.y=function(a){return arguments.length?(e=typeof a=="function"?a:js(+a),o(),s):e},s}const Nre={center:Q1t,collide:myt,nbody:Oyt,link:xyt,x:Myt,y:Lyt},ew="forces",p8=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Pyt=["static","iterations"],a2e=["x","y","vx","vy"];function Sq(e){xe.call(this,null,e)}Sq.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:a2e}]};ze(Sq,xe,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(p8),s=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&u2e(n,e,0,t)):(this.value=n=zyt(t.source,e),n.on("tick",Byt(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(Pyt)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==ew||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,s=r.length,o;i<s;++i)if(r[i].name==="links"&&(o=r[i].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(a2e)}});function Byt(e,t){return()=>e.touch(t).run()}function zyt(e,t){const n=Ryt(e),r=n.stop,i=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,i()),n.stop=()=>(s=!0,r()),u2e(n,t,!0).on("end",()=>s=!0)}function u2e(e,t,n,r){var i=It(t.forces),s,o,a,u;for(s=0,o=p8.length;s<o;++s)a=p8[s],a!==ew&&t.modified(a)&&e[a](t[a]);for(s=0,o=i.length;s<o;++s)u=ew+s,a=n||t.modified(ew,s)?jyt(i[s]):r&&Uyt(i[s],r)?e.force(u):null,a&&e.force(u,a);for(o=e.numForces||0;s<o;++s)e.force(ew+s,null);return e.numForces=i.length,e}function Uyt(e,t){var n,r;for(n in e)if(xn(r=e[n])&&t.modified(ms(r)))return 1;return 0}function jyt(e){var t,n;Nt(Nre,e.force)||ke("Unrecognized force: "+e.force),t=Nre[e.force]();for(n in e)xn(t[n])&&Wyt(t[n],e[n],e);return t}function Wyt(e,t,n){e(xn(t)?r=>t(r,n):t)}const Vyt=Object.freeze(Object.defineProperty({__proto__:null,force:Sq},Symbol.toStringTag,{value:"Module"}));function qyt(e,t){return e.parent===t.parent?1:2}function Gyt(e){return e.reduce(Hyt,0)/e.length}function Hyt(e,t){return e+t.x}function Xyt(e){return 1+e.reduce(Yyt,0)}function Yyt(e,t){return Math.max(e,t.y)}function Kyt(e){for(var t;t=e.children;)e=t[0];return e}function Qyt(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Zyt(){var e=qyt,t=1,n=1,r=!1;function i(s){var o,a=0;s.eachAfter(function(d){var h=d.children;h?(d.x=Gyt(h),d.y=Xyt(h)):(d.x=o?a+=e(d,o):0,d.y=0,o=d)});var u=Kyt(s),l=Qyt(s),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return s.eachAfter(r?function(d){d.x=(d.x-s.x)*t,d.y=(s.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(s.y?d.y/s.y:1))*n})}return i.separation=function(s){return arguments.length?(e=s,i):e},i.size=function(s){return arguments.length?(r=!1,t=+s[0],n=+s[1],i):r?null:[t,n]},i.nodeSize=function(s){return arguments.length?(r=!0,t=+s[0],n=+s[1],i):r?[t,n]:null},i}function Jyt(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function ext(){return this.eachAfter(Jyt)}function txt(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function nxt(e,t){for(var n=this,r=[n],i,s,o=-1;n=r.pop();)if(e.call(t,n,++o,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function rxt(e,t){for(var n=this,r=[n],i=[],s,o,a,u=-1;n=r.pop();)if(i.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)r.push(s[o]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function ixt(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function sxt(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function oxt(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function axt(e){for(var t=this,n=uxt(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function uxt(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function lxt(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function cxt(){return Array.from(this)}function fxt(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function dxt(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*hxt(){var e=this,t,n=[e],r,i,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);while(n.length)}function kq(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=mxt)):t===void 0&&(t=gxt);for(var n=new By(e),r,i=[n],s,o,a,u;r=i.pop();)if((o=t(r.data))&&(u=(o=Array.from(o)).length))for(r.children=o,a=u-1;a>=0;--a)i.push(s=o[a]=new By(o[a])),s.parent=r,s.depth=r.depth+1;return n.eachBefore(l2e)}function pxt(){return kq(this).eachBefore(yxt)}function gxt(e){return e.children}function mxt(e){return Array.isArray(e)?e[1]:null}function yxt(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function l2e(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function By(e){this.data=e,this.depth=this.height=0,this.parent=null}By.prototype=kq.prototype={constructor:By,count:ext,each:txt,eachAfter:rxt,eachBefore:nxt,find:ixt,sum:sxt,sort:oxt,path:axt,ancestors:lxt,descendants:cxt,leaves:fxt,links:dxt,copy:pxt,[Symbol.iterator]:hxt};function xxt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function bxt(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function vxt(e){for(var t=0,n=(e=bxt(Array.from(e))).length,r=[],i,s;t<n;)i=e[t],s&&c2e(s,i)?++t:(s=$xt(r=wxt(r,i)),t=0);return s}function wxt(e,t){var n,r;if(FB(t,e))return[t];for(n=0;n<e.length;++n)if(YA(t,e[n])&&FB(tw(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(YA(tw(e[n],e[r]),t)&&YA(tw(e[n],t),e[r])&&YA(tw(e[r],t),e[n])&&FB(f2e(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function YA(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function c2e(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function FB(e,t){for(var n=0;n<t.length;++n)if(!c2e(e,t[n]))return!1;return!0}function $xt(e){switch(e.length){case 1:return Cxt(e[0]);case 2:return tw(e[0],e[1]);case 3:return f2e(e[0],e[1],e[2])}}function Cxt(e){return{x:e.x,y:e.y,r:e.r}}function tw(e,t){var n=e.x,r=e.y,i=e.r,s=t.x,o=t.y,a=t.r,u=s-n,l=o-r,c=a-i,f=Math.sqrt(u*u+l*l);return{x:(n+s+u/f*c)/2,y:(r+o+l/f*c)/2,r:(f+i+a)/2}}function f2e(e,t,n){var r=e.x,i=e.y,s=e.r,o=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-o,h=r-l,p=i-a,m=i-c,x=u-s,b=f-s,v=r*r+i*i-s*s,$=v-o*o-a*a+u*u,C=v-l*l-c*c+f*f,S=h*p-d*m,A=(p*C-m*$)/(S*2)-r,E=(m*x-p*b)/S,_=(h*$-d*C)/(S*2)-i,D=(d*b-h*x)/S,N=E*E+D*D-1,T=2*(s+A*E+_*D),L=A*A+_*_-s*s,O=-(N?(T+Math.sqrt(T*T-4*N*L))/(2*N):L/T);return{x:r+A+E*O,y:i+_+D*O,r:O}}function Dre(e,t,n){var r=e.x-t.x,i,s,o=e.y-t.y,a,u,l=r*r+o*o;l?(s=t.r+n.r,s*=s,u=e.r+n.r,u*=u,s>u?(i=(l+u-s)/(2*l),a=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-a*o,n.y=e.y-i*o+a*r):(i=(l+s-u)/(2*l),a=Math.sqrt(Math.max(0,s/l-i*i)),n.x=t.x+i*r-a*o,n.y=t.y+i*o+a*r)):(n.x=t.x+n.r,n.y=t.y)}function Fre(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function Rre(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,s=(t.y*n.r+n.y*t.r)/r;return i*i+s*s}function KA(e){this._=e,this.next=null,this.previous=null}function Sxt(e){if(!(i=(e=xxt(e)).length))return 0;var t,n,r,i,s,o,a,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;Dre(n,t,r=e[2]),t=new KA(t),n=new KA(n),r=new KA(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(a=3;a<i;++a){Dre(t._,n._,r=e[a]),r=new KA(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(Fre(u._,r._)){n=u,t.next=n,n.previous=t,--a;continue e}c+=u._.r,u=u.next}else{if(Fre(l._,r._)){t=l,t.next=n,n.previous=t,--a;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,s=Rre(t);(r=r.next)!==n;)(o=Rre(r))<s&&(t=r,s=o);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=vxt(t),a=0;a<i;++a)t=e[a],t.x-=r.x,t.y-=r.y;return r.r}function kxt(e){return e==null?null:dN(e)}function dN(e){if(typeof e!="function")throw new Error;return e}function $g(){return 0}function D1(e){return function(){return e}}function Ext(e){return Math.sqrt(e.value)}function Axt(){var e=null,t=1,n=1,r=$g;function i(s){return s.x=t/2,s.y=n/2,e?s.eachBefore(Ore(e)).eachAfter(RB(r,.5)).eachBefore(Mre(1)):s.eachBefore(Ore(Ext)).eachAfter(RB($g,1)).eachAfter(RB(r,s.r/Math.min(t,n))).eachBefore(Mre(Math.min(t,n)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(e=kxt(s),i):e},i.size=function(s){return arguments.length?(t=+s[0],n=+s[1],i):[t,n]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:D1(+s),i):r},i}function Ore(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function RB(e,t){return function(n){if(r=n.children){var r,i,s=r.length,o=e(n)*t||0,a;if(o)for(i=0;i<s;++i)r[i].r+=o;if(a=Sxt(r),o)for(i=0;i<s;++i)r[i].r-=o;n.r=a+o}}}function Mre(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function d2e(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function ck(e,t,n,r,i){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(r-t)/e.value;++a<u;)o=s[a],o.y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*l}function _xt(){var e=1,t=1,n=0,r=!1;function i(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(s(t,a)),r&&o.eachBefore(d2e),o}function s(o,a){return function(u){u.children&&ck(u,u.x0,o*(u.depth+1)/a,u.x1,o*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(o){return arguments.length?(r=!!o,i):r},i.size=function(o){return arguments.length?(e=+o[0],t=+o[1],i):[e,t]},i.padding=function(o){return arguments.length?(n=+o,i):n},i}var Txt={depth:-1},Lre={};function Ixt(e){return e.id}function Nxt(e){return e.parentId}function Pre(){var e=Ixt,t=Nxt;function n(r){var i=Array.from(r),s=i.length,o,a,u,l,c,f,d,h=new Map;for(a=0;a<s;++a)o=i[a],c=i[a]=new By(o),(f=e(o,a,r))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?Lre:c)),(f=t(o,a,r))!=null&&(f+="")&&(c.parent=f);for(a=0;a<s;++a)if(c=i[a],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===Lre)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=Txt,u.eachBefore(function(p){p.depth=p.parent.depth+1,--s}).eachBefore(l2e),u.parent=null,s>0)throw new Error("cycle");return u}return n.id=function(r){return arguments.length?(e=dN(r),n):e},n.parentId=function(r){return arguments.length?(t=dN(r),n):t},n}function Dxt(e,t){return e.parent===t.parent?1:2}function OB(e){var t=e.children;return t?t[0]:e.t}function MB(e){var t=e.children;return t?t[t.length-1]:e.t}function Fxt(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Rxt(e){for(var t=0,n=0,r=e.children,i=r.length,s;--i>=0;)s=r[i],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function Oxt(e,t,n){return e.a.parent===t.parent?e.a:n}function mT(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}mT.prototype=Object.create(By.prototype);function Mxt(e){for(var t=new mT(e,0),n,r=[t],i,s,o,a;n=r.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)r.push(i=n.children[o]=new mT(s[o],o)),i.parent=n;return(t.parent=new mT(null,0)).children=[t],t}function Lxt(){var e=Dxt,t=1,n=1,r=null;function i(l){var c=Mxt(l);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var p=f===d?1:e(f,d)/2,m=p-f.x,x=t/(d.x+p+m),b=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+m)*x,v.y=v.depth*b})}return l}function s(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){Rxt(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,h=l,p=c,m=d.parent.children[0],x=d.m,b=h.m,v=p.m,$=m.m,C;p=MB(p),d=OB(d),p&&d;)m=OB(m),h=MB(h),h.a=l,C=p.z+v-d.z-x+e(p._,d._),C>0&&(Fxt(Oxt(p,l,f),l,C),x+=C,b+=C),v+=p.m,x+=d.m,$+=m.m,b+=h.m;p&&!MB(h)&&(h.t=p,h.m+=v-b),d&&!OB(m)&&(m.t=d,m.m+=x-$,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function GR(e,t,n,r,i){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(i-n)/e.value;++a<u;)o=s[a],o.x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*l}var h2e=(1+Math.sqrt(5))/2;function p2e(e,t,n,r,i,s){for(var o=[],a=t.children,u,l,c=0,f=0,d=a.length,h,p,m=t.value,x,b,v,$,C,S,A;c<d;){h=i-n,p=s-r;do x=a[f++].value;while(!x&&f<d);for(b=v=x,S=Math.max(p/h,h/p)/(m*e),A=x*x*S,C=Math.max(v/A,A/b);f<d;++f){if(x+=l=a[f].value,l<b&&(b=l),l>v&&(v=l),A=x*x*S,$=Math.max(v/A,A/b),$>C){x-=l;break}C=$}o.push(u={value:x,dice:h<p,children:a.slice(c,f)}),u.dice?ck(u,n,r,i,m?r+=p*x/m:s):GR(u,n,r,m?n+=h*x/m:i,s),m-=x,c=f}return o}const g2e=function e(t){function n(r,i,s,o,a){p2e(t,r,i,s,o,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(h2e);function Pxt(){var e=g2e,t=!1,n=1,r=1,i=[0],s=$g,o=$g,a=$g,u=$g,l=$g;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore(d2e),d}function f(d){var h=i[d.depth],p=d.x0+h,m=d.y0+h,x=d.x1-h,b=d.y1-h;x<p&&(p=x=(p+x)/2),b<m&&(m=b=(m+b)/2),d.x0=p,d.y0=m,d.x1=x,d.y1=b,d.children&&(h=i[d.depth+1]=s(d)/2,p+=l(d)-h,m+=o(d)-h,x-=a(d)-h,b-=u(d)-h,x<p&&(p=x=(p+x)/2),b<m&&(m=b=(m+b)/2),e(d,p,m,x,b))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=dN(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s=typeof d=="function"?d:D1(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:D1(+d),c):o},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:D1(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:D1(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:D1(+d),c):l},c}function Bxt(e,t,n,r,i){var s=e.children,o,a=s.length,u,l=new Array(a+1);for(l[0]=u=o=0;o<a;++o)l[o+1]=u+=s[o].value;c(0,a,e.value,t,n,r,i);function c(f,d,h,p,m,x,b){if(f>=d-1){var v=s[f];v.x0=p,v.y0=m,v.x1=x,v.y1=b;return}for(var $=l[f],C=h/2+$,S=f+1,A=d-1;S<A;){var E=S+A>>>1;l[E]<C?S=E+1:A=E}C-l[S-1]<l[S]-C&&f+1<S&&--S;var _=l[S]-$,D=h-_;if(x-p>b-m){var N=h?(p*D+x*_)/h:x;c(f,S,_,p,m,N,b),c(S,d,D,N,m,x,b)}else{var T=h?(m*D+b*_)/h:b;c(f,S,_,p,m,x,T),c(S,d,D,p,T,x,b)}}}function zxt(e,t,n,r,i){(e.depth&1?GR:ck)(e,t,n,r,i)}const Uxt=function e(t){function n(r,i,s,o,a){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,m=r.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?ck(l,i,s,o,m?s+=(a-s)*l.value/m:a):GR(l,i,s,m?i+=(o-i)*l.value/m:o,a),m-=l.value}else r._squarify=u=p2e(t,r,i,s,o,a),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(h2e);function g8(e,t,n){const r={};return e.each(i=>{const s=i.data;n(s)&&(r[t(s)]=i)}),e.lookup=r,e}function Eq(e){xe.call(this,null,e)}Eq.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const jxt=e=>e.values;ze(Eq,xe,{transform(e,t){t.source||ke("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),s=this.value;return(!s||r||t.changed())&&(s&&s.each(o=>{o.children&&q3(o.data)&&i.rem.push(o.data)}),this.value=s=kq({values:It(e.keys).reduce((o,a)=>(o.key(a),o),Wxt()).entries(i.source)},jxt),n&&s.each(o=>{o.children&&(o=dn(o.data),i.add.push(o),i.source.push(o))}),g8(s,dt,dt)),i.source.root=s,i}});function Wxt(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,s){if(s>=e.length)return i;const o=i.length,a=e[s++],u={},l={};let c=-1,f,d,h;for(;++c<o;)f=a(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],s);return l}function r(i,s){if(++s>e.length)return i;const o=[];for(const a in i)o.push({key:a,values:r(i[a],s)});return o}return t}function qf(e){xe.call(this,null,e)}const Vxt=(e,t)=>e.parent===t.parent?1:2;ze(qf,xe,{transform(e,t){(!t.source||!t.source.root)&&ke(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,s=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(e0(e.sort,o=>o.data)),qxt(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Vxt:yb);try{this.value=n(i)}catch(o){ke(o)}return i.each(o=>Gxt(o,r,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function qxt(e,t,n){for(let r,i=0,s=t.length;i<s;++i)r=t[i],r in n&&e[r](n[r])}function Gxt(e,t,n){const r=e.data,i=t.length-1;for(let s=0;s<i;++s)r[n[s]]=e[t[s]];r[n[i]]=e.children?e.children.length:0}const m8=["x","y","r","depth","children"];function Aq(e){qf.call(this,e)}Aq.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:m8.length,default:m8}]};ze(Aq,qf,{layout:Axt,params:["radius","size","padding"],fields:m8});const y8=["x0","y0","x1","y1","depth","children"];function _q(e){qf.call(this,e)}_q.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:y8.length,default:y8}]};ze(_q,qf,{layout:_xt,params:["size","round","padding"],fields:y8});function Tq(e){xe.call(this,null,e)}Tq.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};ze(Tq,xe,{transform(e,t){t.source||ke("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),s=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),s&&(n=i.source.length?g8(Pre().id(e.key).parentId(e.parentKey)(i.source),e.key,xb):g8(Pre()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const Bre={tidy:Lxt,cluster:Zyt},x8=["x","y","depth","children"];function Iq(e){qf.call(this,e)}Iq.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:x8.length,default:x8}]};ze(Iq,qf,{layout(e){const t=e||"tidy";if(Nt(Bre,t))return Bre[t]();ke("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:x8});function Nq(e){xe.call(this,[],e)}Nq.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};ze(Nq,xe,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),s={};return r||ke("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,o=>s[dt(o)]=1),r.each(o=>{const a=o.data,u=o.parent&&o.parent.data;u&&s[dt(a)]&&s[dt(u)]&&i.add.push(dn({source:u,target:a}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[dt(o)]=1),n.forEach(o=>{(s[dt(o.source)]||s[dt(o.target)])&&i.mod.push(o)})),i}});const zre={binary:Bxt,dice:ck,slice:GR,slicedice:zxt,squarify:g2e,resquarify:Uxt},b8=["x0","y0","x1","y1","depth","children"];function Dq(e){qf.call(this,e)}Dq.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:b8.length,default:b8}]};ze(Dq,qf,{layout(){const e=Pxt();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Nt(zre,t)?e.tile(zre[t]):ke("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:b8});const Hxt=Object.freeze(Object.defineProperty({__proto__:null,nest:Eq,pack:Aq,partition:_q,stratify:Tq,tree:Iq,treelinks:Nq,treemap:Dq},Symbol.toStringTag,{value:"Module"})),v8=Math.PI,w8=2*v8,pg=1e-6,Xxt=w8-pg;function $8(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function h0(){return new $8}$8.prototype=h0.prototype={constructor:$8,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var s=this._x1,o=this._y1,a=n-e,u=r-t,l=s-e,c=o-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>pg)if(!(Math.abs(c*a-u*l)>pg)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-s,h=r-o,p=a*a+u*u,m=d*d+h*h,x=Math.sqrt(p),b=Math.sqrt(f),v=i*Math.tan((v8-Math.acos((p+f-m)/(2*x*b)))/2),$=v/b,C=v/x;Math.abs($-1)>pg&&(this._+="L"+(e+$*l)+","+(t+$*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+C*a)+","+(this._y1=t+C*u)}},arc:function(e,t,n,r,i,s){e=+e,t=+t,n=+n,s=!!s;var o=n*Math.cos(r),a=n*Math.sin(r),u=e+o,l=t+a,c=1^s,f=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>pg||Math.abs(this._y1-l)>pg)&&(this._+="L"+u+","+l),n&&(f<0&&(f=f%w8+w8),f>Xxt?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>pg&&(this._+="A"+n+","+n+",0,"+ +(f>=v8)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function mn(e){return function(){return e}}var Ure=Math.abs,es=Math.atan2,Xp=Math.cos,Yxt=Math.max,LB=Math.min,dl=Math.sin,L1=Math.sqrt,rs=1e-12,zy=Math.PI,hN=zy/2,m2e=2*zy;function Kxt(e){return e>1?0:e<-1?zy:Math.acos(e)}function jre(e){return e>=1?hN:e<=-1?-hN:Math.asin(e)}function Qxt(e){return e.innerRadius}function Zxt(e){return e.outerRadius}function Jxt(e){return e.startAngle}function ebt(e){return e.endAngle}function tbt(e){return e&&e.padAngle}function nbt(e,t,n,r,i,s,o,a){var u=n-e,l=r-t,c=o-i,f=a-s,d=f*u-c*l;if(!(d*d<rs))return d=(c*(t-s)-f*(e-i))/d,[e+d*u,t+d*l]}function QA(e,t,n,r,i,s,o){var a=e-n,u=t-r,l=(o?s:-s)/L1(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,p=n+c,m=r+f,x=(d+p)/2,b=(h+m)/2,v=p-d,$=m-h,C=v*v+$*$,S=i-s,A=d*m-p*h,E=($<0?-1:1)*L1(Yxt(0,S*S*C-A*A)),_=(A*$-v*E)/C,D=(-A*v-$*E)/C,N=(A*$+v*E)/C,T=(-A*v+$*E)/C,L=_-x,O=D-b,M=N-x,R=T-b;return L*L+O*O>M*M+R*R&&(_=N,D=T),{cx:_,cy:D,x01:-c,y01:-f,x11:_*(i/S-1),y11:D*(i/S-1)}}function rbt(){var e=Qxt,t=Zxt,n=mn(0),r=null,i=Jxt,s=ebt,o=tbt,a=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-hN,p=s.apply(this,arguments)-hN,m=Ure(p-h),x=p>h;if(a||(a=l=h0()),d<f&&(c=d,d=f,f=c),!(d>rs))a.moveTo(0,0);else if(m>m2e-rs)a.moveTo(d*Xp(h),d*dl(h)),a.arc(0,0,d,h,p,!x),f>rs&&(a.moveTo(f*Xp(p),f*dl(p)),a.arc(0,0,f,p,h,x));else{var b=h,v=p,$=h,C=p,S=m,A=m,E=o.apply(this,arguments)/2,_=E>rs&&(r?+r.apply(this,arguments):L1(f*f+d*d)),D=LB(Ure(d-f)/2,+n.apply(this,arguments)),N=D,T=D,L,O;if(_>rs){var M=jre(_/f*dl(E)),R=jre(_/d*dl(E));(S-=M*2)>rs?(M*=x?1:-1,$+=M,C-=M):(S=0,$=C=(h+p)/2),(A-=R*2)>rs?(R*=x?1:-1,b+=R,v-=R):(A=0,b=v=(h+p)/2)}var P=d*Xp(b),j=d*dl(b),z=f*Xp(C),q=f*dl(C);if(D>rs){var H=d*Xp(v),V=d*dl(v),X=f*Xp($),re=f*dl($),le;if(m<zy&&(le=nbt(P,j,X,re,H,V,z,q))){var ue=P-le[0],be=j-le[1],_e=H-le[0],Ne=V-le[1],Y=1/dl(Kxt((ue*_e+be*Ne)/(L1(ue*ue+be*be)*L1(_e*_e+Ne*Ne)))/2),ae=L1(le[0]*le[0]+le[1]*le[1]);N=LB(D,(f-ae)/(Y-1)),T=LB(D,(d-ae)/(Y+1))}}A>rs?T>rs?(L=QA(X,re,P,j,d,T,x),O=QA(H,V,z,q,d,T,x),a.moveTo(L.cx+L.x01,L.cy+L.y01),T<D?a.arc(L.cx,L.cy,T,es(L.y01,L.x01),es(O.y01,O.x01),!x):(a.arc(L.cx,L.cy,T,es(L.y01,L.x01),es(L.y11,L.x11),!x),a.arc(0,0,d,es(L.cy+L.y11,L.cx+L.x11),es(O.cy+O.y11,O.cx+O.x11),!x),a.arc(O.cx,O.cy,T,es(O.y11,O.x11),es(O.y01,O.x01),!x))):(a.moveTo(P,j),a.arc(0,0,d,b,v,!x)):a.moveTo(P,j),!(f>rs)||!(S>rs)?a.lineTo(z,q):N>rs?(L=QA(z,q,H,V,f,-N,x),O=QA(P,j,X,re,f,-N,x),a.lineTo(L.cx+L.x01,L.cy+L.y01),N<D?a.arc(L.cx,L.cy,N,es(L.y01,L.x01),es(O.y01,O.x01),!x):(a.arc(L.cx,L.cy,N,es(L.y01,L.x01),es(L.y11,L.x11),!x),a.arc(0,0,f,es(L.cy+L.y11,L.cx+L.x11),es(O.cy+O.y11,O.cx+O.x11),x),a.arc(O.cx,O.cy,N,es(O.y11,O.x11),es(O.y01,O.x01),!x))):a.arc(0,0,f,C,$,x)}if(a.closePath(),l)return a=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-zy/2;return[Xp(c)*l,dl(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:mn(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:mn(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:mn(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:mn(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:mn(+l),u):i},u.endAngle=function(l){return arguments.length?(s=typeof l=="function"?l:mn(+l),u):s},u.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:mn(+l),u):o},u.context=function(l){return arguments.length?(a=l??null,u):a},u}function y2e(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function x2e(e){this._context=e}x2e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Fq(e){return new x2e(e)}function b2e(e){return e[0]}function v2e(e){return e[1]}function w2e(e,t){var n=mn(!0),r=null,i=Fq,s=null;e=typeof e=="function"?e:e===void 0?b2e:mn(e),t=typeof t=="function"?t:t===void 0?v2e:mn(t);function o(a){var u,l=(a=y2e(a)).length,c,f=!1,d;for(r==null&&(s=i(d=h0())),u=0;u<=l;++u)!(u<l&&n(c=a[u],u,a))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+e(c,u,a),+t(c,u,a));if(d)return s=null,d+""||null}return o.x=function(a){return arguments.length?(e=typeof a=="function"?a:mn(+a),o):e},o.y=function(a){return arguments.length?(t=typeof a=="function"?a:mn(+a),o):t},o.defined=function(a){return arguments.length?(n=typeof a=="function"?a:mn(!!a),o):n},o.curve=function(a){return arguments.length?(i=a,r!=null&&(s=i(r)),o):i},o.context=function(a){return arguments.length?(a==null?r=s=null:s=i(r=a),o):r},o}function $2e(e,t,n){var r=null,i=mn(!0),s=null,o=Fq,a=null;e=typeof e=="function"?e:e===void 0?b2e:mn(+e),t=typeof t=="function"?t:mn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?v2e:mn(+n);function u(c){var f,d,h,p=(c=y2e(c)).length,m,x=!1,b,v=new Array(p),$=new Array(p);for(s==null&&(a=o(b=h0())),f=0;f<=p;++f){if(!(f<p&&i(m=c[f],f,c))===x)if(x=!x)d=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=f-1;h>=d;--h)a.point(v[h],$[h]);a.lineEnd(),a.areaEnd()}x&&(v[f]=+e(m,f,c),$[f]=+t(m,f,c),a.point(r?+r(m,f,c):v[f],n?+n(m,f,c):$[f]))}if(b)return a=null,b+""||null}function l(){return w2e().defined(i).curve(o).context(s)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:mn(+c),r=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:mn(+c),u):e},u.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:mn(+c),u):r},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:mn(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:mn(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:mn(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(c){return arguments.length?(i=typeof c=="function"?c:mn(!!c),u):i},u.curve=function(c){return arguments.length?(o=c,s!=null&&(a=o(s)),u):o},u.context=function(c){return arguments.length?(c==null?s=a=null:a=o(s=c),u):s},u}const ibt={draw:function(e,t){var n=Math.sqrt(t/zy);e.moveTo(n,0),e.arc(0,0,n,0,m2e)}};function sbt(e,t){var n=null;e=typeof e=="function"?e:mn(e||ibt),t=typeof t=="function"?t:mn(t===void 0?64:+t);function r(){var i;if(n||(n=i=h0()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:mn(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:mn(+i),r):t},r.context=function(i){return arguments.length?(n=i??null,r):n},r}function Mh(){}function pN(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function HR(e){this._context=e}HR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:pN(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:pN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function obt(e){return new HR(e)}function C2e(e){this._context=e}C2e.prototype={areaStart:Mh,areaEnd:Mh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:pN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function abt(e){return new C2e(e)}function S2e(e){this._context=e}S2e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:pN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ubt(e){return new S2e(e)}function k2e(e,t){this._basis=new HR(e),this._beta=t}k2e.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,o=t[n]-i,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+u*s),this._beta*t[a]+(1-this._beta)*(i+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const lbt=function e(t){function n(r){return t===1?new HR(r):new k2e(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function gN(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Rq(e,t){this._context=e,this._k=(1-t)/6}Rq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:gN(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:gN(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const cbt=function e(t){function n(r){return new Rq(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Oq(e,t){this._context=e,this._k=(1-t)/6}Oq.prototype={areaStart:Mh,areaEnd:Mh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:gN(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const fbt=function e(t){function n(r){return new Oq(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Mq(e,t){this._context=e,this._k=(1-t)/6}Mq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:gN(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const dbt=function e(t){function n(r){return new Mq(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Lq(e,t,n){var r=e._x1,i=e._y1,s=e._x2,o=e._y2;if(e._l01_a>rs){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>rs){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,s,o,e._x2,e._y2)}function E2e(e,t){this._context=e,this._alpha=t}E2e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Lq(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const hbt=function e(t){function n(r){return t?new E2e(r,t):new Rq(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function A2e(e,t){this._context=e,this._alpha=t}A2e.prototype={areaStart:Mh,areaEnd:Mh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Lq(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const pbt=function e(t){function n(r){return t?new A2e(r,t):new Oq(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function _2e(e,t){this._context=e,this._alpha=t}_2e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Lq(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const gbt=function e(t){function n(r){return t?new _2e(r,t):new Mq(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function T2e(e){this._context=e}T2e.prototype={areaStart:Mh,areaEnd:Mh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function mbt(e){return new T2e(e)}function Wre(e){return e<0?-1:1}function Vre(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),a=(s*i+o*r)/(r+i);return(Wre(s)+Wre(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function qre(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function PB(e,t,n){var r=e._x0,i=e._y0,s=e._x1,o=e._y1,a=(s-r)/3;e._context.bezierCurveTo(r+a,i+a*t,s-a,o-a*n,s,o)}function mN(e){this._context=e}mN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:PB(this,this._t0,qre(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,PB(this,qre(this,n=Vre(this,e,t)),n);break;default:PB(this,this._t0,n=Vre(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function I2e(e){this._context=new N2e(e)}(I2e.prototype=Object.create(mN.prototype)).point=function(e,t){mN.prototype.point.call(this,t,e)};function N2e(e){this._context=e}N2e.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function ybt(e){return new mN(e)}function xbt(e){return new I2e(e)}function D2e(e){this._context=e}D2e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=Gre(e),i=Gre(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Gre(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),o=new Array(n);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function bbt(e){return new D2e(e)}function XR(e,t){this._context=e,this._t=t}XR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function vbt(e){return new XR(e,.5)}function wbt(e){return new XR(e,0)}function $bt(e){return new XR(e,1)}var Hre={},BB={},zB=34,f2=10,UB=13;function F2e(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function Cbt(e,t){var n=F2e(e);return function(r,i){return t(n(r),i,e)}}function Xre(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function ho(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function Sbt(e){return e<0?"-"+ho(-e,6):e>9999?"+"+ho(e,6):ho(e,4)}function kbt(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Sbt(e.getUTCFullYear())+"-"+ho(e.getUTCMonth()+1,2)+"-"+ho(e.getUTCDate(),2)+(i?"T"+ho(t,2)+":"+ho(n,2)+":"+ho(r,2)+"."+ho(i,3)+"Z":r?"T"+ho(t,2)+":"+ho(n,2)+":"+ho(r,2)+"Z":n||t?"T"+ho(t,2)+":"+ho(n,2)+"Z":"")}function Ebt(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,m=i(f,function(x,b){if(h)return h(x,b-1);p=x,h=d?Cbt(x,d):F2e(x)});return m.columns=p||[],m}function i(f,d){var h=[],p=f.length,m=0,x=0,b,v=p<=0,$=!1;f.charCodeAt(p-1)===f2&&--p,f.charCodeAt(p-1)===UB&&--p;function C(){if(v)return BB;if($)return $=!1,Hre;var A,E=m,_;if(f.charCodeAt(E)===zB){for(;m++<p&&f.charCodeAt(m)!==zB||f.charCodeAt(++m)===zB;);return(A=m)>=p?v=!0:(_=f.charCodeAt(m++))===f2?$=!0:_===UB&&($=!0,f.charCodeAt(m)===f2&&++m),f.slice(E+1,A-1).replace(/""/g,'"')}for(;m<p;){if((_=f.charCodeAt(A=m++))===f2)$=!0;else if(_===UB)$=!0,f.charCodeAt(m)===f2&&++m;else if(_!==n)continue;return f.slice(E,A)}return v=!0,f.slice(E,p)}for(;(b=C())!==BB;){for(var S=[];b!==Hre&&b!==BB;)S.push(b),b=C();d&&(S=d(S,x++))==null||h.push(S)}return h}function s(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function o(f,d){return d==null&&(d=Xre(f)),[d.map(c).join(e)].concat(s(f,d)).join(`
`)}function a(f,d){return d==null&&(d=Xre(f)),s(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?kbt(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:o,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function Abt(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function yN(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Uy(e){return e=yN(Math.abs(e)),e?e[1]:NaN}function _bt(e,t){return function(n,r){for(var i=n.length,s=[],o=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),s.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function Tbt(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Ibt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function N$(e){if(!(t=Ibt.exec(e)))throw new Error("invalid format: "+e);var t;return new Pq({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}N$.prototype=Pq.prototype;function Pq(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Pq.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Nbt(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var R2e;function Dbt(e,t){var n=yN(e,t);if(!n)return e+"";var r=n[0],i=n[1],s=i-(R2e=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+yN(e,Math.max(0,t+s-1))[0]}function Yre(e,t){var n=yN(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Kre={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Abt,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Yre(e*100,t),r:Yre,s:Dbt,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Qre(e){return e}var Zre=Array.prototype.map,Jre=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function O2e(e){var t=e.grouping===void 0||e.thousands===void 0?Qre:_bt(Zre.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Qre:Tbt(Zre.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=N$(f);var d=f.fill,h=f.align,p=f.sign,m=f.symbol,x=f.zero,b=f.width,v=f.comma,$=f.precision,C=f.trim,S=f.type;S==="n"?(v=!0,S="g"):Kre[S]||($===void 0&&($=12),C=!0,S="g"),(x||d==="0"&&h==="=")&&(x=!0,d="0",h="=");var A=m==="$"?n:m==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",E=m==="$"?r:/[%p]/.test(S)?o:"",_=Kre[S],D=/[defgprs%]/.test(S);$=$===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,$)):Math.max(0,Math.min(20,$));function N(T){var L=A,O=E,M,R,P;if(S==="c")O=_(T)+O,T="";else{T=+T;var j=T<0||1/T<0;if(T=isNaN(T)?u:_(Math.abs(T),$),C&&(T=Nbt(T)),j&&+T==0&&p!=="+"&&(j=!1),L=(j?p==="("?p:a:p==="-"||p==="("?"":p)+L,O=(S==="s"?Jre[8+R2e/3]:"")+O+(j&&p==="("?")":""),D){for(M=-1,R=T.length;++M<R;)if(P=T.charCodeAt(M),48>P||P>57){O=(P===46?i+T.slice(M+1):T.slice(M))+O,T=T.slice(0,M);break}}}v&&!x&&(T=t(T,1/0));var z=L.length+T.length+O.length,q=z<b?new Array(b-z+1).join(d):"";switch(v&&x&&(T=t(q+T,q.length?b-O.length:1/0),q=""),h){case"<":T=L+T+O+q;break;case"=":T=L+q+T+O;break;case"^":T=q.slice(0,z=q.length>>1)+L+T+O+q.slice(z);break;default:T=q+L+T+O;break}return s(T)}return N.toString=function(){return f+""},N}function c(f,d){var h=l((f=N$(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Uy(d)/3)))*3,m=Math.pow(10,-p),x=Jre[8+p/3];return function(b){return h(m*b)+x}}return{format:l,formatPrefix:c}}var ZA,M2e,L2e;Fbt({thousands:",",grouping:[3],currency:["$",""]});function Fbt(e){return ZA=O2e(e),M2e=ZA.format,L2e=ZA.formatPrefix,ZA}function Rbt(e){return Math.max(0,-Uy(Math.abs(e)))}function Obt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Uy(t)/3)))*3-Uy(Math.abs(e)))}function Mbt(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Uy(t)-Uy(e))+1}function nw(e){const t={};return n=>t[n]||(t[n]=e(n))}function Lbt(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let s=Pbt(r,i);const o=s<r.length?r.slice(s):"";for(;--s>i;)if(r[s]!=="0"){++s;break}return r.slice(0,s)+o}}function Pbt(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function P2e(e){const t=nw(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=N$(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return Lbt(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,s,o){o=N$(o??",f");const a=_h(r,i,s),u=Math.max(Math.abs(r),Math.abs(i));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=Obt(a,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=Mbt(a,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=Rbt(a))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let C8;B2e();function B2e(){return C8=P2e({format:M2e,formatPrefix:L2e})}function z2e(e){return P2e(O2e(e))}function xN(e){return arguments.length?C8=z2e(e):C8}function eie(e,t,n){n=n||{},Wt(n)||ke("Invalid time multi-format specifier: ".concat(n));const r=t(ja),i=t(aa),s=t(oa),o=t(Fo),a=t(Hr),u=t(xs),l=t(Do),c=t(Vi),f=e(n[ju]||".%L"),d=e(n[ja]||":%S"),h=e(n[aa]||"%I:%M"),p=e(n[oa]||"%I %p"),m=e(n[Fo]||n[fs]||"%a %d"),x=e(n[Hr]||"%b %d"),b=e(n[xs]||"%B"),v=e(n[Do]||"%B"),$=e(n[Vi]||"%Y");return C=>(r(C)<C?f:i(C)<C?d:s(C)<C?h:o(C)<C?p:u(C)<C?a(C)<C?m:x:c(C)<C?l(C)<C?b:v:$)(C)}function U2e(e){const t=nw(e.format),n=nw(e.utcFormat);return{timeFormat:r=>Hn(r)?t(r):eie(t,Eb,r),utcFormat:r=>Hn(r)?n(r):eie(n,Ab,r),timeParse:nw(e.parse),utcParse:nw(e.utcParse)}}let S8;j2e();function j2e(){return S8=U2e({format:RR,parse:vbe,utcFormat:OR,utcParse:wbe})}function W2e(e){return U2e(gbe(e))}function D$(e){return arguments.length?S8=W2e(e):S8}const k8=(e,t)=>qt({},e,t);function V2e(e,t){const n=e?z2e(e):xN(),r=t?W2e(t):D$();return k8(n,r)}function q2e(e,t){const n=arguments.length;return n&&n!==2&&ke("defaultLocale expects either zero or two arguments."),n?k8(xN(e),D$(t)):k8(xN(),D$())}function Bbt(){return B2e(),j2e(),q2e()}const zbt=/^(data:|([A-Za-z]+:)?\/\/)/,Ubt=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,jbt=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,tie="file://";function Wbt(e,t){return n=>({options:n||{},sanitize:qbt,load:Vbt,fileAccess:!!t,file:Gbt(t),http:Xbt(e)})}async function Vbt(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function qbt(e,t){t=qt({},this.options,t);const n=this.fileAccess,r={href:null};let i,s,o;const a=Ubt.test(e.replace(jbt,""));(e==null||typeof e!="string"||!a)&&ke("Sanitize failure, invalid URI: "+St(e));const u=zbt.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(i=e.startsWith(tie))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(tie.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!s}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function Gbt(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,s)=>{i?r(i):n(s)})}):Hbt}async function Hbt(){ke("No file system access.")}function Xbt(e){return e?async function(t,n){const r=qt({},this.options.http,n),i=n&&n.response,s=await e(t,r);return s.ok?xn(s[i])?s[i]():s.text():ke(s.status+""+s.statusText)}:Ybt}async function Ybt(){ke("No HTTP fetch method available.")}const Kbt=e=>e!=null&&e===e,Qbt=e=>e==="true"||e==="false"||e===!0||e===!1,Zbt=e=>!Number.isNaN(Date.parse(e)),G2e=e=>!Number.isNaN(+e)&&!(e instanceof Date),Jbt=e=>G2e(e)&&Number.isInteger(+e),E8={boolean:$me,integer:$h,number:$h,date:Cme,string:Sme,unknown:za},JA=[Qbt,Jbt,G2e,Zbt],evt=["boolean","integer","number","date"];function H2e(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=JA.length,i=JA.map((s,o)=>o+1);for(let s=0,o=0,a,u;s<n;++s)for(u=t?e[s][t]:e[s],a=0;a<r;++a)if(i[a]&&Kbt(u)&&!JA[a](u)&&(i[a]=0,++o,o===JA.length))return"string";return evt[i.reduce((s,o)=>s===0?o:s,0)-1]}function X2e(e,t){return t.reduce((n,r)=>(n[r]=H2e(e,r),n),{})}function nie(e){const t=function(n,r){const i={delimiter:e};return Bq(n,r?qt(r,i):i)};return t.responseType="text",t}function Bq(e,t){return t.header&&(e=t.header.map(St).join(t.delimiter)+`
`+e),Ebt(t.delimiter).parse(e+"")}Bq.responseType="text";function tvt(e){return typeof Buffer=="function"&&xn(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function zq(e,t){const n=t&&t.property?wh(t.property):za;return Wt(e)&&!tvt(e)?nvt(n(e),t):n(JSON.parse(e))}zq.responseType="json";function nvt(e,t){return!Rt(e)&&xme(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const rvt={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function Y2e(e,t){let n,r,i,s;return e=zq(e,t),t&&t.feature?(n=Tme,i=t.feature):t&&t.mesh?(n=Nme,i=t.mesh,s=rvt[t.filter]):ke("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,s):ke("Invalid TopoJSON object: "+i),r&&r.features||[r]}Y2e.responseType="json";const yT={dsv:Bq,csv:nie(","),tsv:nie("	"),json:zq,topojson:Y2e};function Uq(e,t){return arguments.length>1?(yT[e]=t,this):Nt(yT,e)?yT[e]:null}function ivt(e){const t=Uq(e);return t&&t.responseType||"text"}function svt(e,t,n,r){t=t||{};const i=Uq(t.type||"json");return i||ke("Unknown data format type: "+t.type),e=i(e,t),t.parse&&ovt(e,t.parse,n,r),Nt(e,"columns")&&delete e.columns,e}function ovt(e,t,n,r){if(!e.length)return;const i=D$();n=n||i.timeParse,r=r||i.utcParse;let s=e.columns||Object.keys(e[0]),o,a,u,l,c,f;t==="auto"&&(t=X2e(e,s)),s=Object.keys(t);const d=s.map(h=>{const p=t[h];let m,x;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return m=p.split(/:(.+)?/,2),x=m[1],(x[0]==="'"&&x[x.length-1]==="'"||x[0]==='"'&&x[x.length-1]==='"')&&(x=x.slice(1,-1)),(m[0]==="utc"?r:n)(x);if(!E8[p])throw Error("Illegal format pattern: "+h+":"+p);return E8[p]});for(u=0,c=e.length,f=s.length;u<c;++u)for(o=e[u],l=0;l<f;++l)a=s[l],o[a]=d[l](o[a])}const jq=Wbt(typeof fetch<"u"&&fetch,null);let K2e=0;function avt(){K2e=0}const bN="p_";function Wq(e){return e&&e.gradient}function Q2e(e,t,n){const r=e.gradient;let i=e.id,s=r==="radial"?bN:"";return i||(i=e.id="gradient_"+K2e++,r==="radial"?(e.x1=hl(e.x1,.5),e.y1=hl(e.y1,.5),e.r1=hl(e.r1,0),e.x2=hl(e.x2,.5),e.y2=hl(e.y2,.5),e.r2=hl(e.r2,.5),s=bN):(e.x1=hl(e.x1,0),e.y1=hl(e.y1,0),e.x2=hl(e.x2,1),e.y2=hl(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+s+i+")"}function hl(e,t){return e??t}function Z2e(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,s){return n.push({offset:i,color:s}),r}}}const rie={basis:{curve:obt},"basis-closed":{curve:abt},"basis-open":{curve:ubt},bundle:{curve:lbt,tension:"beta",value:.85},cardinal:{curve:cbt,tension:"tension",value:0},"cardinal-open":{curve:dbt,tension:"tension",value:0},"cardinal-closed":{curve:fbt,tension:"tension",value:0},"catmull-rom":{curve:hbt,tension:"alpha",value:.5},"catmull-rom-closed":{curve:pbt,tension:"alpha",value:.5},"catmull-rom-open":{curve:gbt,tension:"alpha",value:.5},linear:{curve:Fq},"linear-closed":{curve:mbt},monotone:{horizontal:xbt,vertical:ybt},natural:{curve:bbt},step:{curve:vbt},"step-after":{curve:$bt},"step-before":{curve:wbt}};function Vq(e,t,n){var r=Nt(rie,e)&&rie[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const uvt={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},d2=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function jy(e){const t=[];let n,r,i,s,o,a,u,l,c,f;const d=e.slice().replace(d2[0],"###$1").split(d2[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(d2[2],"$1###$2").replace(d2[3],"$1###$2").split(d2[4]),o=n.charAt(0),i=[o],l=0,f=r.length;l<f;++l)(s=+r[l])===s&&i.push(s);if(a=uvt[o.toLowerCase()],i.length-1>a){const h=i.length;for(l=1,t.push([o].concat(i.slice(l,l+=a))),o=o==="M"?"L":o==="m"?"l":o;l<h;l+=a)t.push([o].concat(i.slice(l,l+a)))}else t.push(i)}return t}const Lh=Math.PI/180,lvt=1e-14,Cg=Math.PI/2,Sl=Math.PI*2,m1=Math.sqrt(3)/2;var jB={},WB={},J2e=[].join;function cvt(e,t,n,r,i,s,o,a,u){const l=J2e.call(arguments);if(jB[l])return jB[l];const c=o*Lh,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(a-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(a-e)*.5;let m=h*h/(n*n)+p*p/(r*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const x=d/n,b=f/n,v=-f/r,$=d/r,C=x*a+b*u,S=v*a+$*u,A=x*e+b*t,E=v*e+$*t;let D=1/((A-C)*(A-C)+(E-S)*(E-S))-.25;D<0&&(D=0);let N=Math.sqrt(D);s==i&&(N=-N);const T=.5*(C+A)-N*(E-S),L=.5*(S+E)+N*(A-C),O=Math.atan2(S-L,C-T);let R=Math.atan2(E-L,A-T)-O;R<0&&s===1?R+=Sl:R>0&&s===0&&(R-=Sl);const P=Math.ceil(Math.abs(R/(Cg+.001))),j=[];for(let z=0;z<P;++z){const q=O+z*R/P,H=O+(z+1)*R/P;j[z]=[T,L,q,H,n,r,f,d]}return jB[l]=j}function fvt(e){const t=J2e.call(e);if(WB[t])return WB[t];var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7];const c=l*o,f=-u*a,d=u*o,h=l*a,p=Math.cos(i),m=Math.sin(i),x=Math.cos(s),b=Math.sin(s),v=.5*(s-i),$=Math.sin(v*.5),C=8/3*$*$/Math.sin(v),S=n+p-C*m,A=r+m+C*p,E=n+x,_=r+b,D=E+C*b,N=_-C*x;return WB[t]=[c*S+f*A,d*S+h*A,c*D+f*N,d*D+h*N,c*E+f*_,d*E+h*_]}const $a=["l",0,0,0,0,0,0,0];function dvt(e,t,n){const r=$a[0]=e[0];if(r==="a"||r==="A")$a[1]=t*e[1],$a[2]=n*e[2],$a[3]=e[3],$a[4]=e[4],$a[5]=e[5],$a[6]=t*e[6],$a[7]=n*e[7];else if(r==="h"||r==="H")$a[1]=t*e[1];else if(r==="v"||r==="V")$a[1]=n*e[1];else for(var i=1,s=e.length;i<s;++i)$a[i]=(i%2==1?t:n)*e[i];return $a}function F$(e,t,n,r,i,s){var o,a=null,u=0,l=0,c=0,f=0,d,h,p,m;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),s==null&&(s=i),e.beginPath&&e.beginPath();for(var x=0,b=t.length;x<b;++x){switch(o=t[x],(i!==1||s!==1)&&(o=dvt(o,i,s)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+r);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+r);break;case"h":u+=o[1],e.lineTo(u+n,l+r);break;case"H":u=o[1],e.lineTo(u+n,l+r);break;case"v":l+=o[1],e.lineTo(u+n,l+r);break;case"V":l=o[1],e.lineTo(u+n,l+r);break;case"m":u+=o[1],l+=o[2],e.moveTo(u+n,l+r);break;case"M":u=o[1],l=o[2],e.moveTo(u+n,l+r);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+o[1]+n,l+o[2]+r,d+n,h+r),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-p,f=2*l-m):a[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,m=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":iie(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+r]),u+=o[6],l+=o[7];break;case"A":iie(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),u=o[6],l=o[7];break;case"z":case"Z":e.closePath();break}a=o}}function iie(e,t,n,r){const i=cvt(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let s=0;s<i.length;++s){const o=fvt(i[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const sie=.5773502691896257,oie={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Sl)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,s=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-s),e.lineTo(i,-s),e.lineTo(0,-n),e.lineTo(-i,-s),e.lineTo(-r,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=m1*n,i=r-n*sie,s=n/4;e.moveTo(0,-r-i),e.lineTo(-s,r-i),e.lineTo(s,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=m1*n,i=r-n*sie;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=m1*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=m1*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=m1*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=m1*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function ewe(e){return Nt(oie,e)?oie[e]:hvt(e)}var VB={};function hvt(e){if(!Nt(VB,e)){const t=jy(e);VB[e]={draw:function(n,r){F$(n,t,0,0,Math.sqrt(r)/2)}}}return VB[e]}const Cd=.448084975506;function pvt(e){return e.x}function gvt(e){return e.y}function mvt(e){return e.width}function yvt(e){return e.height}function jc(e){return typeof e=="function"?e:()=>+e}function e_(e,t,n){return Math.max(t,Math.min(e,n))}function twe(){var e=pvt,t=gvt,n=mvt,r=yvt,i=jc(0),s=i,o=i,a=i,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),m=d??+t.call(this,c),x=+n.call(this,c),b=+r.call(this,c),v=Math.min(x,b)/2,$=e_(+i.call(this,c),0,v),C=e_(+s.call(this,c),0,v),S=e_(+o.call(this,c),0,v),A=e_(+a.call(this,c),0,v);if(u||(u=h=h0()),$<=0&&C<=0&&S<=0&&A<=0)u.rect(p,m,x,b);else{var E=p+x,_=m+b;u.moveTo(p+$,m),u.lineTo(E-C,m),u.bezierCurveTo(E-Cd*C,m,E,m+Cd*C,E,m+C),u.lineTo(E,_-A),u.bezierCurveTo(E,_-Cd*A,E-Cd*A,_,E-A,_),u.lineTo(p+S,_),u.bezierCurveTo(p+Cd*S,_,p,_-Cd*S,p,_-S),u.lineTo(p,m+$),u.bezierCurveTo(p,m+Cd*$,p+Cd*$,m,p+$,m),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=jc(c),l):e},l.y=function(c){return arguments.length?(t=jc(c),l):t},l.width=function(c){return arguments.length?(n=jc(c),l):n},l.height=function(c){return arguments.length?(r=jc(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=jc(c),s=f!=null?jc(f):i,a=d!=null?jc(d):i,o=h!=null?jc(h):s,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function nwe(){var e,t,n,r,i=null,s,o,a,u;function l(f,d,h){const p=h/2;if(s){var m=a-d,x=f-o;if(m||x){var b=Math.sqrt(m*m+x*x),v=(m/=b)*u,$=(x/=b)*u,C=Math.atan2(x,m);i.moveTo(o-v,a-$),i.lineTo(f-m*p,d-x*p),i.arc(f,d,p,C-Math.PI,C),i.lineTo(o+v,a+$),i.arc(o,a,u,C,C+Math.PI)}else i.arc(f,d,p,0,Sl);i.closePath()}else s=1;o=f,a=d,u=p}function c(f){var d,h=f.length,p,m=!1,x;for(i==null&&(i=x=h0()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===m&&(m=!m)&&(s=0),m&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(x)return i=null,x+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function fk(e,t){return e??t}const dk=e=>e.x||0,hk=e=>e.y||0,xvt=e=>e.width||0,bvt=e=>e.height||0,vvt=e=>(e.x||0)+(e.width||0),wvt=e=>(e.y||0)+(e.height||0),$vt=e=>e.startAngle||0,Cvt=e=>e.endAngle||0,Svt=e=>e.padAngle||0,kvt=e=>e.innerRadius||0,Evt=e=>e.outerRadius||0,Avt=e=>e.cornerRadius||0,_vt=e=>fk(e.cornerRadiusTopLeft,e.cornerRadius)||0,Tvt=e=>fk(e.cornerRadiusTopRight,e.cornerRadius)||0,Ivt=e=>fk(e.cornerRadiusBottomRight,e.cornerRadius)||0,Nvt=e=>fk(e.cornerRadiusBottomLeft,e.cornerRadius)||0,Dvt=e=>fk(e.size,64),Fvt=e=>e.size||1,YR=e=>e.defined!==!1,Rvt=e=>ewe(e.shape||"circle"),Ovt=rbt().startAngle($vt).endAngle(Cvt).padAngle(Svt).innerRadius(kvt).outerRadius(Evt).cornerRadius(Avt),Mvt=$2e().x(dk).y1(hk).y0(wvt).defined(YR),Lvt=$2e().y(hk).x1(dk).x0(vvt).defined(YR),Pvt=w2e().x(dk).y(hk).defined(YR),Bvt=twe().x(dk).y(hk).width(xvt).height(bvt).cornerRadius(_vt,Tvt,Ivt,Nvt),zvt=sbt().type(Rvt).size(Dvt),Uvt=nwe().x(dk).y(hk).defined(YR).size(Fvt);function qq(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function jvt(e,t){return Ovt.context(e)(t)}function Wvt(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?Lvt:Mvt).curve(Vq(r,n.orient,n.tension)).context(e)(t)}function Vvt(e,t){const n=t[0],r=n.interpolate||"linear";return Pvt.curve(Vq(r,n.orient,n.tension)).context(e)(t)}function Ob(e,t,n,r){return Bvt.context(e)(t,n,r)}function qvt(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Gvt(e,t){return zvt.context(e)(t)}function Hvt(e,t){return Uvt.context(e)(t)}var rwe=1;function iwe(){rwe=1}function Gq(e,t,n){var r=t.clip,i=e._defs,s=t.clip_id||(t.clip_id="clip"+rwe++),o=i.clipping[s]||(i.clipping[s]={id:s});return xn(r)?o.path=r(null):qq(n)?o.path=Ob(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function Qs(e){this.clear(),e&&this.union(e)}Qs.prototype={clone(){return new Qs(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:s,y2:o}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*r-u*i+l,u*r+a*i+c,a*r-u*o+l,u*r+a*o+c,a*s-u*i+l,u*s+a*i+c,a*s-u*o+l,u*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Hq(e){this.mark=e,this.bounds=this.bounds||new Qs}function Xq(e){Hq.call(this,e),this.items=this.items||[]}ze(Xq,Hq);function Yq(e){this._pending=0,this._loader=e||jq()}function aie(e){e._pending+=1}function h2(e){e._pending-=1}Yq.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return aie(t),t._loader.sanitize(e,{context:"href"}).then(n=>(h2(t),n)).catch(()=>(h2(t),null))},loadImage(e){const t=this,n=but();return aie(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const s=new n,o=Nt(r,"crossOrigin")?r.crossOrigin:"anonymous";return o!=null&&(s.crossOrigin=o),s.onload=()=>h2(t),s.onerror=()=>h2(t),s.src=i,s}).catch(r=>(h2(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function p0(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?Xvt(t,r):0))}return e}function Xvt(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const Yvt=Sl-1e-8;let KR,xT,bT,Ig,A8,vT,_8,T8;const Vd=(e,t)=>KR.add(e,t),wT=(e,t)=>Vd(xT=e,bT=t),uie=e=>Vd(e,KR.y1),lie=e=>Vd(KR.x1,e),Sg=(e,t)=>A8*e+_8*t,kg=(e,t)=>vT*e+T8*t,qB=(e,t)=>Vd(Sg(e,t),kg(e,t)),GB=(e,t)=>wT(Sg(e,t),kg(e,t));function pk(e,t){return KR=e,t?(Ig=t*Lh,A8=T8=Math.cos(Ig),vT=Math.sin(Ig),_8=-vT):(A8=T8=1,Ig=vT=_8=0),Kvt}const Kvt={beginPath(){},closePath(){},moveTo:GB,lineTo:GB,rect(e,t,n,r){Ig?(qB(e+n,t),qB(e+n,t+r),qB(e,t+r),GB(e,t)):(Vd(e+n,t+r),wT(e,t))},quadraticCurveTo(e,t,n,r){const i=Sg(e,t),s=kg(e,t),o=Sg(n,r),a=kg(n,r);cie(xT,i,o,uie),cie(bT,s,a,lie),wT(o,a)},bezierCurveTo(e,t,n,r,i,s){const o=Sg(e,t),a=kg(e,t),u=Sg(n,r),l=kg(n,r),c=Sg(i,s),f=kg(i,s);fie(xT,o,u,c,uie),fie(bT,a,l,f,lie),wT(c,f)},arc(e,t,n,r,i,s){if(r+=Ig,i+=Ig,xT=n*Math.cos(i)+e,bT=n*Math.sin(i)+t,Math.abs(i-r)>Yvt)Vd(e-n,t-n),Vd(e+n,t+n);else{const o=l=>Vd(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(o(r),o(i),i!==r)if(r=r%Sl,r<0&&(r+=Sl),i=i%Sl,i<0&&(i+=Sl),i<r&&(s=!s,a=r,r=i,i=a),s)for(i-=Sl,a=r-r%Cg,u=0;u<4&&a>i;++u,a-=Cg)o(a);else for(a=r-r%Cg+Cg,u=0;u<4&&a<i;++u,a=a+Cg)o(a)}}};function cie(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function fie(e,t,n,r,i){const s=r-e+3*t-3*n,o=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(s)>lvt?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),u=(-o+c)/s,l=(-o-c)/s)):u=.5*a/o,0<u&&u<1&&i(die(u,e,t,n,r)),0<l&&l<1&&i(die(l,e,t,n,r))}function die(e,t,n,r,i){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*r+a*e*i}var oh=(oh=op(1,1))?oh.getContext("2d"):null;const I8=new Qs;function Kq(e){return function(t,n){if(!oh)return!0;e(oh,t),I8.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:s,y2:o}=I8;for(let a=i;a<=o;++a)for(let u=r;u<=s;++u)if(oh.isPointInPath(u,a))return!0;return!1}}function Qq(e,t){return t.contains(e.x||0,e.y||0)}function swe(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,s=e.height||0;return t.intersects(I8.set(n,r,n+i,r+s))}function owe(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:r;return P1(t,n,r,i,s)}function P1(e,t,n,r,i){const{x1:s,y1:o,x2:a,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,p,m,x;for(x=0;x<4;++x){if(x===0&&(h=-l,p=-(s-t)),x===1&&(h=l,p=a-t),x===2&&(h=-c,p=-(o-n)),x===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(m=p/h,h<0){if(m>d)return!1;m>f&&(f=m)}else if(h>0){if(m<f)return!1;m<d&&(d=m)}}return!0}function Wy(e,t){e.globalCompositeOperation=t.blend||"source-over"}function du(e,t){return e??t}function hie(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function Qvt(e,t,n){const r=n.width(),i=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+du(t.x1,.5)*r,n.y1+du(t.y1,.5)*i,Math.max(r,i)*du(t.r1,0),n.x1+du(t.x2,.5)*r,n.y1+du(t.y2,.5)*i,Math.max(r,i)*du(t.r2,.5));else{const o=du(t.x1,0),a=du(t.y1,0),u=du(t.x2,1),l=du(t.y2,0);if(o===u||a===l||r===i)s=e.createLinearGradient(n.x1+o*r,n.y1+a*i,n.x1+u*r,n.y1+l*i);else{const c=op(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=hie(f.createLinearGradient(o,a,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return hie(s,t.stops)}function awe(e,t,n){return Wq(n)?Qvt(e,n,t.bounds):n}function vN(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=awe(e,t,t.fill),!0):!1}var Zvt=[];function Vy(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=awe(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Zvt),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function Jvt(e,t){return e.zindex-t.zindex||e.index-t.index}function Zq(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,s;for(i=0,s=t.length;i<s;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(Jvt)}function Wu(e,t){var n=e.items,r,i;if(!n||!n.length)return;const s=Zq(e);if(s&&s.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=s}for(r=0,i=n.length;r<i;++r)t(n[r])}function wN(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const s=Zq(e);for(s&&s.length&&(n=s),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===s){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function Jq(e){return function(t,n,r){Wu(n,i=>{(!r||r.intersects(i.bounds))&&uwe(e,t,i,i)})}}function e2t(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&uwe(e,t,n.items[0],n.items)}}function uwe(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Wy(t,n),n.fill&&vN(t,n,i)&&t.fill(),n.stroke&&Vy(t,n,i)&&t.stroke()))}function QR(e){return e=e||xb,function(t,n,r,i,s,o){return r*=t.pixelRatio,i*=t.pixelRatio,wN(n,a=>{const u=a.bounds;if(!(u&&!u.contains(s,o)||!u)&&e(t,a,r,i,s,o))return a})}}function gk(e,t){return function(n,r,i,s){var o=Array.isArray(r)?r[0]:r,a=t??o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:a&&n.isPointInPath(i,s)||u&&n.isPointInStroke(i,s)}}function eG(e){return QR(gk(e))}function qg(e,t){return"translate("+e+","+t+")"}function tG(e){return"rotate("+e+")"}function t2t(e,t){return"scale("+e+","+t+")"}function lwe(e){return qg(e.x||0,e.y||0)}function n2t(e){return qg(e.x||0,e.y||0)+(e.angle?" "+tG(e.angle):"")}function r2t(e){return qg(e.x||0,e.y||0)+(e.angle?" "+tG(e.angle):"")+(e.scaleX||e.scaleY?" "+t2t(e.scaleX||1,e.scaleY||1):"")}function nG(e,t,n){function r(o,a){o("transform",n2t(a)),o("d",t(null,a))}function i(o,a){return t(pk(o,a.angle),a),p0(o,a).translate(a.x||0,a.y||0)}function s(o,a){var u=a.x||0,l=a.y||0,c=a.angle||0;o.translate(u,l),c&&o.rotate(c*=Lh),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:Jq(s),pick:eG(s),isect:n||Kq(s)}}var i2t=nG("arc",jvt);function s2t(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,s=1/0,o,a;--i>=0;)e[i].defined!==!1&&(a=Math.abs(e[i][r]-n),a<s&&(s=a,o=e[i]));return o}function o2t(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,s,o;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],s=e[r].y-t[1],o=i*i+s*s,o<n))return e[r];return null}function a2t(e,t){for(var n=e.length,r,i,s;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],s=r*r+i*i,r=e[n].size||1,s<r*r))return e[n];return null}function rG(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(pk(u),c),p0(u,c[0]))}function s(u,l){u.beginPath(),t(u,l)}const o=gk(s);function a(u,l,c,f,d,h){var p=l.items,m=l.bounds;return!p||!p.length||m&&!m.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:e2t(s),pick:a,isect:Qq,tip:n}}var u2t=rG("area",Wvt,s2t);function l2t(e,t){var n=t.clip;e.save(),xn(n)?(e.beginPath(),n(e),e.clip()):cwe(e,t.group)}function cwe(e,t){e.beginPath(),qq(t)?Ob(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function fwe(e){const t=du(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function c2t(e,t){e("transform",lwe(t))}function dwe(e,t){const n=fwe(t);e("d",Ob(null,t,n,n))}function f2t(e,t){e("class","background"),e("aria-hidden",!0),dwe(e,t)}function d2t(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?dwe(e,t):e("d","")}function h2t(e,t,n){const r=t.clip?Gq(n,t,t):null;e("clip-path",r)}function p2t(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),p0(e,t),e.translate(t.x||0,t.y||0)}function R$(e,t,n,r){const i=fwe(t);e.beginPath(),Ob(e,t,(n||0)+i,(r||0)+i)}const g2t=gk(R$),m2t=gk(R$,!1),y2t=gk(R$,!0);function x2t(e,t,n){Wu(t,r=>{const i=r.x||0,s=r.y||0,o=r.strokeForeground,a=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&a&&(R$(e,r,i,s),Wy(e,r),r.fill&&vN(e,r,a)&&e.fill(),r.stroke&&!o&&Vy(e,r,a)&&e.stroke()),e.save(),e.translate(i,s),r.clip&&cwe(e,r),n&&n.translate(-i,-s),Wu(r,u=>{this.draw(e,u,n)}),n&&n.translate(i,s),e.restore(),o&&r.stroke&&a&&(R$(e,r,i,s),Wy(e,r),Vy(e,r,a)&&e.stroke())})}function b2t(e,t,n,r,i,s){if(t.bounds&&!t.bounds.contains(i,s)||!t.items)return null;const o=n*e.pixelRatio,a=r*e.pixelRatio;return wN(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,s))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),m=u.clip;if(m&&(i<c||i>h||s<f||s>p))return;if(e.save(),e.translate(c,f),c=i-c,f=s-f,m&&qq(u)&&!y2t(e,u,o,a))return e.restore(),null;const x=u.strokeForeground,b=t.interactive!==!1;return b&&x&&u.stroke&&m2t(e,u,o,a)?(e.restore(),u):(l=wN(u,v=>v2t(v,c,f)?this.pick(v,n,r,c,f):null),!l&&b&&(u.fill||!x&&u.stroke)&&g2t(e,u,o,a)&&(l=u),e.restore(),l||null)})}function v2t(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var w2t={type:"group",tag:"g",nested:!1,attr:c2t,bound:p2t,draw:x2t,pick:b2t,isect:swe,content:h2t,background:f2t,foreground:d2t},O$={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function iG(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function sG(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function oG(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function ZR(e,t){return e==="center"?t/2:e==="right"?t:0}function JR(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function $2t(e,t,n){const r=iG(t,n),i=sG(t,r),s=oG(t,r),o=(t.x||0)-ZR(t.align,i),a=(t.y||0)-JR(t.baseline,s),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,O$["xmlns:xlink"],"xlink:href"),e("transform",qg(o,a)),e("width",i),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function C2t(e,t){const n=t.image,r=sG(t,n),i=oG(t,n),s=(t.x||0)-ZR(t.align,r),o=(t.y||0)-JR(t.baseline,i);return e.set(s,o,s+r,o+i)}function S2t(e,t,n){Wu(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=iG(r,this);let s=sG(r,i),o=oG(r,i);if(s===0||o===0)return;let a=(r.x||0)-ZR(r.align,s),u=(r.y||0)-JR(r.baseline,o),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=s/c,u+=(o-d)/2,o=d):(d=o*c,a+=(s-d)/2,s=d))),(i.complete||i.toDataURL)&&(Wy(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,a,u,s,o))})}var k2t={type:"image",tag:"image",nested:!1,attr:$2t,bound:C2t,draw:S2t,pick:QR(),isect:xb,get:iG,xOffset:ZR,yOffset:JR},E2t=rG("line",Vvt,o2t);function A2t(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",r2t(t)),e("d",t.path)}function $T(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*Lh,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=jy(n)).path=n),a&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(a),F$(e,u,0,0,s,o),e.rotate(-a),e.translate(-r,-i)):F$(e,u,r,i,s,o)}function _2t(e,t){return $T(pk(e,t.angle),t)?e.set(0,0,0,0):p0(e,t,!0)}var T2t={type:"path",tag:"path",nested:!1,attr:A2t,bound:_2t,draw:Jq($T),pick:eG($T),isect:Kq($T)};function I2t(e,t){e("d",Ob(null,t))}function N2t(e,t){var n,r;return p0(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function pie(e,t){e.beginPath(),Ob(e,t)}var D2t={type:"rect",tag:"path",nested:!1,attr:I2t,bound:N2t,draw:Jq(pie),pick:eG(pie),isect:swe};function F2t(e,t){e("transform",lwe(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function R2t(e,t){var n,r;return p0(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function hwe(e,t,n){var r,i,s,o;return t.stroke&&Vy(e,t,n)?(r=t.x||0,i=t.y||0,s=t.x2!=null?t.x2:r,o=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(s,o),!0):!1}function O2t(e,t,n){Wu(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&hwe(e,r,i)&&(Wy(e,r),e.stroke())}})}function M2t(e,t,n,r){return e.isPointInStroke?hwe(e,t,1)&&e.isPointInStroke(n,r):!1}var L2t={type:"rule",tag:"line",nested:!1,attr:F2t,bound:R2t,draw:O2t,pick:QR(M2t),isect:owe},P2t=nG("shape",qvt),B2t=nG("symbol",Gvt,Qq);const gie=vme();var Pl={height:pc,measureWidth:aG,estimateWidth:N8,width:N8,canvas:pwe};pwe(!0);function pwe(e){Pl.width=e&&oh?aG:N8}function N8(e,t){return gwe(Bh(e,t),pc(e))}function gwe(e,t){return~~(.8*e.length*t)}function aG(e,t){return pc(e)<=0||!(t=Bh(e,t))?0:mwe(t,eO(e))}function mwe(e,t){const n=`(${t}) ${e}`;let r=gie.get(n);return r===void 0&&(oh.font=t,r=oh.measureText(e).width,gie.set(n,r)),r}function pc(e){return e.fontSize!=null?+e.fontSize||0:11}function Ph(e){return e.lineHeight!=null?e.lineHeight:pc(e)+2}function z2t(e){return Rt(e)?e.length>1?e:e[0]:e}function mk(e){return z2t(e.lineBreak&&e.text&&!Rt(e.text)?e.text.split(e.lineBreak):e.text)}function U2t(e){const t=mk(e);return(Rt(t)?t.length-1:0)*Ph(e)}function Bh(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?W2t(e,n):n}function j2t(e){if(Pl.width===aG){const t=eO(e);return n=>mwe(n,t)}else{const t=pc(e);return n=>gwe(n,t)}}function W2t(e,t){var n=+e.limit,r=j2t(e);if(r(t)<n)return t;var i=e.ellipsis||"…",s=e.dir==="rtl",o=0,a=t.length,u;if(n-=r(i),s){for(;o<a;)u=o+a>>>1,r(t.slice(u))>n?o=u+1:a=u;return i+t.slice(o)}else{for(;o<a;)u=1+(o+a>>>1),r(t.slice(0,u))<n?o=u:a=u-1;return t.slice(0,o)+i}}function yk(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function eO(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+pc(e)+"px "+yk(e,t)}function uG(e){var t=e.baseline,n=pc(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Ph(e):t==="line-bottom"?.29*n-.5*Ph(e):0)}const V2t={left:"start",center:"middle",right:"end"},xw=new Qs;function tO(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-Cg,t+=r*Math.cos(i),n+=r*Math.sin(i)),xw.x1=t,xw.y1=n,xw}function q2t(e,t){var n=t.dx||0,r=(t.dy||0)+uG(t),i=tO(t),s=i.x1,o=i.y1,a=t.angle||0,u;e("text-anchor",V2t[t.align]||"start"),a?(u=qg(s,o)+" "+tG(a),(n||r)&&(u+=" "+qg(n,r))):u=qg(s+n,o+r),e("transform",u)}function lG(e,t,n){var r=Pl.height(t),i=t.align,s=tO(t),o=s.x1,a=s.y1,u=t.dx||0,l=(t.dy||0)+uG(t)-Math.round(.8*r),c=mk(t),f;if(Rt(c)?(r+=Ph(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Pl.width(t,h)),0)):f=Pl.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=o,l+=a,u+f,l+r),t.angle&&!n)e.rotate(t.angle*Lh,o,a);else if(n===2)return e.rotatedPoints(t.angle*Lh,o,a);return e}function G2t(e,t,n){Wu(t,r=>{var i=r.opacity==null?1:r.opacity,s,o,a,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=eO(r),e.textAlign=r.align||"left",s=tO(r),o=s.x1,a=s.y1,r.angle&&(e.save(),e.translate(o,a),e.rotate(r.angle*Lh),o=a=0),o+=r.dx||0,a+=(r.dy||0)+uG(r),c=mk(r),Wy(e,r),Rt(c))for(l=Ph(r),u=0;u<c.length;++u)f=Bh(r,c[u]),r.fill&&vN(e,r,i)&&e.fillText(f,o,a),r.stroke&&Vy(e,r,i)&&e.strokeText(f,o,a),a+=l;else f=Bh(r,c),r.fill&&vN(e,r,i)&&e.fillText(f,o,a),r.stroke&&Vy(e,r,i)&&e.strokeText(f,o,a);r.angle&&e.restore()}})}function H2t(e,t,n,r,i,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=tO(t),a=o.x1,u=o.y1,l=lG(xw,t,1),c=-t.angle*Lh,f=Math.cos(c),d=Math.sin(c),h=f*i-d*s+(a-f*a+d*u),p=d*i+f*s+(u-d*a-f*u);return l.contains(h,p)}function X2t(e,t){const n=lG(xw,e,2);return P1(t,n[0],n[1],n[2],n[3])||P1(t,n[0],n[1],n[4],n[5])||P1(t,n[4],n[5],n[6],n[7])||P1(t,n[2],n[3],n[6],n[7])}var Y2t={type:"text",tag:"text",nested:!1,attr:q2t,bound:lG,draw:G2t,pick:QR(H2t),isect:X2t},K2t=rG("trail",Hvt,a2t),Va={arc:i2t,area:u2t,group:w2t,image:k2t,line:E2t,path:T2t,rect:D2t,rule:L2t,shape:P2t,symbol:B2t,text:Y2t,trail:K2t};function D8(e,t,n){var r=Va[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Qs),e,n)}var mie={mark:null};function ywe(e,t,n){var r=Va[e.marktype],i=r.bound,s=e.items,o=s&&s.length,a,u,l,c;if(r.nested)return o?l=s[0]:(mie.mark=e,l=mie),c=D8(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Qs,o)for(a=0,u=s.length;a<u;++a)t.union(D8(s[a],i,n));return e.bounds=t}const Q2t=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function xwe(e,t){return JSON.stringify(e,Q2t,t)}function bwe(e){const t=typeof e=="string"?JSON.parse(e):e;return vwe(t)}function vwe(e){var t=e.marktype,n=e.items,r,i,s;if(n)for(i=0,s=n.length;i<s;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&vwe(n[i]);return t&&ywe(e),e}function cG(e){arguments.length?this.root=bwe(e):(this.root=wwe({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Xq(this.root)])}cG.prototype={toJSON(e){return xwe(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=wwe(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function wwe(e,t){const n={bounds:new Qs,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function qd(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function fG(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function bo(e,t,n,r){var i=e.childNodes[t],s;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(s=i||null,i=qd(e.ownerDocument,n,r),e.insertBefore(i,s)),i}function Su(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function $we(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function nO(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Z2t(e,t,n,r){var i=e&&e.mark,s,o;if(i&&(s=Va[i.marktype]).tip){for(o=nO(t,n),o[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(i.items,o)}return e}function zh(e,t){this._active=null,this._handlers={},this._loader=e||jq(),this._tooltip=t||J2t}function J2t(e,t,n,r){e.element().setAttribute("title",r||"")}zh.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),s=qd(null,"a");for(const o in r)s.setAttribute(o,r[o]);s.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=Z2t(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,s=i.width(),o=i.height();let a=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,u+=e.y||0;return{x:a,y:u,width:s,height:o,left:a,top:u,right:a+s,bottom:u+o}}};function gc(e){this._el=null,this._bgcolor=null,this._loader=new Yq(e)}gc.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(s=>{s&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const ewt="keydown",twt="keypress",nwt="keyup",Cwe="dragenter",CT="dragleave",Swe="dragover",F8="mousedown",rwt="mouseup",$N="mousemove",bw="mouseout",kwe="mouseover",CN="click",iwt="dblclick",swt="wheel",Ewe="mousewheel",SN="touchstart",kN="touchmove",EN="touchend",owt=[ewt,twt,nwt,Cwe,CT,Swe,F8,rwt,$N,bw,kwe,CN,iwt,swt,Ewe,SN,kN,EN],R8=$N,M$=bw,O8=CN;function xk(e,t){zh.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const awt=e=>e===SN||e===kN||e===EN?[SN,kN,EN]:[e];function yie(e,t){awt(t).forEach(n=>uwt(e,n))}function uwt(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function xie(e,t,n){return function(r){const i=this._active,s=this.pickEvent(r);s===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=s,this.fire(t,r),this.fire(e,r))}}function bie(e){return function(t){this.fire(e,t),this._active=null}}ze(xk,zh,{initialize(e,t,n){return this._canvas=e&&fG(e,"canvas"),[CN,F8,$N,bw,CT].forEach(r=>yie(this,r)),zh.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:owt,DOMMouseScroll(e){this.fire(Ewe,e)},mousemove:xie($N,kwe,bw),dragover:xie(Swe,Cwe,CT),mouseout:bie(bw),dragleave:bie(CT),mousedown(e){this._down=this._active,this.fire(F8,e)},click(e){this._down===this._active&&(this.fire(CN,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(SN,e,!0)},touchmove(e){this.fire(kN,e,!0)},touchend(e){this.fire(EN,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===O8&&r&&r.href?this.handleHref(t,r,r.href):(e===R8||e===M$)&&this.handleTooltip(t,r,e!==M$),i)for(let s=0,o=i.length;s<o;++s)i[s].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(yie(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=nO(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const s=this.context();return Va[e.marktype].pick.call(this,s,e,t,n,r,i)}});function lwt(){return typeof window<"u"&&window.devicePixelRatio||1}var cwt=lwt();function fwt(e,t,n,r,i,s){const o=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=o?cwt:i;e.width=t*u,e.height=n*u;for(const l in s)a[l]=s[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*r[0],u*r[1]),e}function AN(e){gc.call(this,e),this._options={},this._redraw=!1,this._dirty=new Qs,this._tempb=new Qs}const vie=gc.prototype,dwt=(e,t,n)=>new Qs().set(0,0,t,n).translate(-e[0],-e[1]);function hwt(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}ze(AN,gc,{initialize(e,t,n,r,i,s){return this._options=s||{},this._canvas=this._options.externalContext?null:op(1,1,this._options.type),e&&this._canvas&&(Su(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),vie.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(vie.resize.call(this,e,t,n,r),this._canvas)fwt(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||ke("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,s=this._dirty,o=dwt(n,r,i);t.save();const a=this._redraw||s.empty()?(this._redraw=!1,o.expand(1)):hwt(t,o.intersect(s),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,a),t.restore(),s.clear(),this},draw(e,t,n){const r=Va[t.marktype];t.clip&&l2t(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,s=this.context();i.type!=="pdf"&&!i.externalContext&&s.clearRect(e,t,n,r),this._bgcolor!=null&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,r))}});function dG(e,t){zh.call(this,e,t);const n=this;n._hrefHandler=M8(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=M8(n,(r,i)=>{n.handleTooltip(r,i,r.type!==M$)})}const M8=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};ze(dG,zh,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(O8,this._hrefHandler),r.removeEventListener(R8,this._tooltipHandler),r.removeEventListener(M$,this._tooltipHandler)),this._svg=r=e&&fG(e,"svg"),r&&(r.addEventListener(O8,this._hrefHandler),r.addEventListener(R8,this._tooltipHandler),r.addEventListener(M$,this._tooltipHandler)),zh.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const s={type:e,handler:t,listener:M8(this,t)};(r[n]||(r[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Awe="aria-hidden",hG="aria-label",pG="role",gG="aria-roledescription",_we="graphics-object",mG="graphics-symbol",Twe=(e,t,n)=>({[pG]:e,[gG]:t,[hG]:n||void 0}),pwt=Tf(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),wie={axis:{desc:"axis",caption:ywt},legend:{desc:"legend",caption:xwt},"title-text":{desc:"title",caption:e=>`Title text '${Cie(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Cie(e)}'`}},$ie={ariaRole:pG,ariaRoleDescription:gG,description:hG};function Iwe(e,t){const n=t.aria===!1;if(e(Awe,n||void 0),n||t.description==null)for(const r in $ie)e($ie[r],void 0);else{const r=t.mark.marktype;e(hG,t.description),e(pG,t.ariaRole||(r==="group"?_we:mG)),e(gG,t.ariaRoleDescription||`${r} mark`)}}function Nwe(e){return e.aria===!1?{[Awe]:!0}:pwt[e.role]?null:wie[e.role]?mwt(e,wie[e.role]):gwt(e)}function gwt(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return Twe(n?_we:mG,`${t} mark container`,e.description)}function mwt(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return Twe(t.role||mG,t.desc,n.description||r(n))}catch{return null}}function Cie(e){return It(e.text).join(" ")}function ywt(e){const t=e.datum,n=e.orient,r=t.title?Dwe(e):null,i=e.context,s=i.scales[t.scale].value,o=i.dataflow.locale(),a=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Oy(a)?"discrete":a} scale with ${qbe(o,s,e)}`}function xwt(e){const t=e.datum,n=t.title?Dwe(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,s=Object.keys(i),o=e.context,a=o.scales[i[s[0]]].value,u=o.dataflow.locale();return vwt(r)+(n?` titled '${n}'`:"")+` for ${bwt(s)} with ${qbe(u,a,e)}`}function Dwe(e){try{return It(An(e.items).items[0].text).join(" ")}catch{return null}}function bwt(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+An(e)}function vwt(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const Fwe=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),wwt=e=>Fwe(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function yG(){let e="",t="",n="";const r=[],i=()=>t=n="",s=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${wwt(l)}"`),a),a={open(u,...l){s(u),t="<"+u;for(const c of l)for(const f in c)o(f,c[f]);return a},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),a},attr:o,text:u=>(n+=Fwe(u),a),toString:()=>e};return a}const Rwe=e=>Owe(yG(),e)+"";function Owe(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const s=n[i];s.nodeType===3?e.text(s.nodeValue):Owe(e,s)}}return e.close()}const _N={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Mwe={fill:"none","stroke-miterlimit":10},p2=0,Sie="http://www.w3.org/2000/xmlns/",Vr=O$.xmlns;function xG(e){gc.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const HB=gc.prototype;ze(xG,gc,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=bo(e,0,"svg",Vr),this._svg.setAttributeNS(Sie,"xmlns",Vr),this._svg.setAttributeNS(Sie,"xmlns:xlink",O$["xmlns:xlink"]),this._svg.setAttribute("version",O$.version),this._svg.setAttribute("class","marks"),Su(e,1),this._root=bo(this._svg,p2,"g",Vr),Gd(this._root,Mwe),Su(this._svg,p2+1)),this.background(this._bgcolor),HB.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),HB.background.apply(this,arguments)},resize(e,t,n,r){return HB.resize.call(this,e,t,n,r),this._svg&&(Gd(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=bo(e,p2,"rect",Vr),Gd(n,{width:this._width,height:this._height,fill:t}));const r=Rwe(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Su(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,s,o,a,u;for(o=0,a=e.length;o<a;++o)if(n=e[o],r=n.mark,r.marktype!==i&&(i=r.marktype,s=Va[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,kie(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){s.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(s,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=s.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,kie(n,t)):this._update(s,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Va[t.marktype],s=t.interactive===!1?"none":null,o=i.tag==="g";let a=null,u=0;const l=Eie(t,e,n,"g",r);l.setAttribute("class",$we(t));const c=Nwe(t);for(const d in c)Rs(l,d,c[d]);o||Rs(l,"pointer-events",s),Rs(l,"clip-path",t.clip?Gq(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),p=Eie(d,l,a,i.tag,r);h&&(this._update(i,p,d),o&&Swt(this,p,d)),a=p,++u};return i.nested?t.items.length&&f(t.items[0]):Wu(t,f),Su(l,u),l},_update(e,t,n){df=t,is=t.__values__,Iwe(vw,n),e.attr(vw,n,this);const r=Ewt[e.type];r&&r.call(this,e,t,n),df&&this.style(df,n)},style(e,t){if(t!=null)for(const n in _N){let r=n==="font"?yk(t):t[n];if(r===is[n])continue;const i=_N[n];r==null?e.removeAttribute(i):(Wq(r)&&(r=Q2e(r,this._defs.gradient,Lwe())),e.setAttribute(i,r+"")),is[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=bo(e,p2+1,"defs",Vr)),r=$wt(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=bo(e,p2+1,"defs",Vr)),r=Cwt(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):Su(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function kie(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function $wt(e,t,n){let r,i,s;if(t.gradient==="radial"){let o=bo(e,n++,"pattern",Vr);Gd(o,{id:bN+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=bo(o,0,"rect",Vr),Gd(o,{width:1,height:1,fill:`url(${Lwe()}#${t.id})`}),e=bo(e,n++,"radialGradient",Vr),Gd(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=bo(e,n++,"linearGradient",Vr),Gd(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)s=bo(e,r,"stop",Vr),s.setAttribute("offset",t.stops[r].offset),s.setAttribute("stop-color",t.stops[r].color);return Su(e,r),n}function Cwt(e,t,n){let r;return e=bo(e,n,"clipPath",Vr),e.setAttribute("id",t.id),t.path?(r=bo(e,0,"path",Vr),r.setAttribute("d",t.path)):(r=bo(e,0,"rect",Vr),Gd(r,{x:0,y:0,width:t.width,height:t.height})),Su(e,1),n+1}function Swt(e,t,n){t=t.lastChild.previousSibling;let r,i=0;Wu(n,s=>{r=e.mark(t,s,r),++i}),Su(t,1+i)}function Eie(e,t,n,r,i){let s=e._svg,o;if(!s&&(o=t.ownerDocument,s=qd(o,r,Vr),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},r==="g"))){const a=qd(o,"path",Vr);s.appendChild(a),a.__data__=e;const u=qd(o,"g",Vr);s.appendChild(u),u.__data__=e;const l=qd(o,"path",Vr);s.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(s.ownerSVGElement!==i||kwt(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function kwt(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let df=null,is=null;const Ewt={group(e,t,n){const r=df=t.childNodes[2];is=r.__values__,e.foreground(vw,n,this),is=t.__values__,df=t.childNodes[1],e.content(vw,n,this);const i=df=t.childNodes[0];e.background(vw,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==is.events&&(Rs(r,"pointer-events",s),Rs(i,"pointer-events",s),is.events=s),n.strokeForeground&&n.stroke){const o=n.fill;Rs(r,"display",null),this.style(i,n),Rs(i,"stroke",null),o&&(n.fill=null),is=r.__values__,this.style(r,n),o&&(n.fill=o),df=null}else Rs(r,"display","none")},image(e,t,n){n.smooth===!1?(XB(t,"image-rendering","optimizeSpeed"),XB(t,"image-rendering","pixelated")):XB(t,"image-rendering",null)},text(e,t,n){const r=mk(n);let i,s,o,a;Rt(r)?(s=r.map(u=>Bh(n,u)),i=s.join(`
`),i!==is.text&&(Su(t,0),o=t.ownerDocument,a=Ph(n),s.forEach((u,l)=>{const c=qd(o,"tspan",Vr);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),is.text=i)):(s=Bh(n,r),s!==is.text&&(t.textContent=s,is.text=s)),Rs(t,"font-family",yk(n)),Rs(t,"font-size",pc(n)+"px"),Rs(t,"font-style",n.fontStyle),Rs(t,"font-variant",n.fontVariant),Rs(t,"font-weight",n.fontWeight)}};function vw(e,t,n){t!==is[e]&&(n?Awt(df,e,t,n):Rs(df,e,t),is[e]=t)}function XB(e,t,n){n!==is[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),is[t]=n)}function Gd(e,t){for(const n in t)Rs(e,n,t[n])}function Rs(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function Awt(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function Lwe(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function bG(e){gc.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}ze(bG,gc,{svg(){return this._text},_render(e){const t=yG();t.open("svg",qt({},O$,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",Mwe,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Va[t.marktype],r=n.tag,i=[Iwe,n.attr];e.open("g",{class:$we(t),"clip-path":t.clip?Gq(this,t,t.group):null},Nwe(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const s=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(r,this.attr(t,o,i,r!=="g"?r:null)),r==="text"){const u=mk(o);if(Rt(u)){const l={x:0,dy:Ph(o)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Bh(o,u[c])).close()}else e.text(Bh(o,u))}else if(r==="g"){const u=o.strokeForeground,l=o.fill,c=o.stroke;u&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),Wu(o,f=>this.mark(e,f)),e.close(),u&&c?(l&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Wu(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},s=(o,a,u,l)=>{i[l||o]=a};return Array.isArray(n)?n.forEach(o=>o(s,t,this)):n(s,t,this),r&&_wt(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const s=t[i],o=s.stops;s.gradient==="radial"?(e.open("pattern",{id:bN+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:i,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let a=0;a<o.length;++a)e.open("stop",{offset:o[a].offset,"stop-color":o[a].color}).close();e.close()}for(const i in n){const s=n[i];e.open("clipPath",{id:i}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});function _wt(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=yk(t),e["font-size"]=pc(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const s in _N){let o=t[s];const a=_N[s];o==="transparent"&&(a==="fill"||a==="stroke")||o!=null&&(Wq(o)&&(o=Q2e(o,i.gradient,"")),e[a]=o)}return e}const Pwe="canvas",Bwe="png",zwe="svg",Uwe="none",Hd={Canvas:Pwe,PNG:Bwe,SVG:zwe,None:Uwe},qy={};qy[Pwe]=qy[Bwe]={renderer:AN,headless:AN,handler:xk};qy[zwe]={renderer:xG,headless:bG,handler:dG};qy[Uwe]={};function rO(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(qy[e]=t,this):qy[e]}function jwe(e,t,n){const r=[],i=new Qs().union(t),s=e.marktype;return s?Wwe(e,i,n,r):s==="group"?Vwe(e,i,n,r):ke("Intersect scene must be mark node or group item.")}function Wwe(e,t,n,r){if(Twt(e,t,n)){const i=e.items,s=e.marktype,o=i.length;let a=0;if(s==="group")for(;a<o;++a)Vwe(i[a],t,n,r);else for(const u=Va[s].isect;a<o;++a){const l=i[a];qwe(l,t,u)&&r.push(l)}}return r}function Twt(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function Vwe(e,t,n,r){n&&n(e.mark)&&qwe(e,t,Va.group.isect)&&r.push(e);const i=e.items,s=i&&i.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let u=0;u<s;++u)Wwe(i[u],t,n,r);t.translate(o,a)}return r}function qwe(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const YB=new Qs;function Iwt(e){const t=e.clip;if(xn(t))t(pk(YB.clear()));else if(t)YB.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(YB)}const Nwt=1e-9;function vG(e,t,n){return e===t?!0:n==="path"?Gwe(e,t):e instanceof Date&&t instanceof Date?+e==+t:dm(e)&&dm(t)?Math.abs(e-t)<=Nwt:!e||!t||!Wt(e)&&!Wt(t)?e==t:Dwt(e,t)}function Gwe(e,t){return vG(jy(e),jy(t))}function Dwt(e,t){var n=Object.keys(e),r=Object.keys(t),i,s;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),s=n.length-1;s>=0;s--)if(n[s]!=r[s])return!1;for(s=n.length-1;s>=0;s--)if(i=n[s],!vG(e[i],t[i],i))return!1;return typeof e==typeof t}function Fwt(){iwe(),avt()}const Rwt=4278190080,Owt=268435456,Mwt=.0625;function Lwt(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function Pwt(e,t,n,r){const i=e.width,s=e.height,o=n||r,a=op(i,s).getContext("2d");t.forEach(x=>Hwe(a,x,o));const u=new Uint32Array(a.getImageData(0,0,i,s).data.buffer),l=e.bitmap(),c=o&&e.bitmap();let f,d,h,p,m;for(d=0;d<s;++d)for(f=0;f<i;++f)m=u[d*i+f]&Rwt,m&&(h=e(f),p=e(d),r||l.set(h,p),o&&m^Owt&&c.set(h,p));return[l,c]}function Hwe(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(s=>Hwe(e,s.items,n))}):Va[r].draw(e,{items:n?t.map(Bwt):t})}function Bwt(e){const t=G3(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=Mwt,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Wc=5,Fs=31,L$=32,Nd=new Uint32Array(L$+1),wu=new Uint32Array(L$+1);wu[0]=0;Nd[0]=~wu[0];for(let e=1;e<=L$;++e)wu[e]=wu[e-1]<<1|1,Nd[e]=~wu[e];function zwt(e,t){const n=new Uint32Array(~~((e*t+L$)/L$));function r(s,o){n[s]|=o}function i(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>Wc]&1<<(a&Fs)},set:(s,o)=>{const a=o*e+s;r(a>>>Wc,1<<(a&Fs))},clear:(s,o)=>{const a=o*e+s;i(a>>>Wc,~(1<<(a&Fs)))},getRange:(s,o,a,u)=>{let l=u,c,f,d,h;for(;l>=o;--l)if(c=l*e+s,f=l*e+a,d=c>>>Wc,h=f>>>Wc,d===h){if(n[d]&Nd[c&Fs]&wu[(f&Fs)+1])return!0}else{if(n[d]&Nd[c&Fs]||n[h]&wu[(f&Fs)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(s,o,a,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>Wc,d=c>>>Wc,f===d)r(f,Nd[l&Fs]&wu[(c&Fs)+1]);else for(r(f,Nd[l&Fs]),r(d,wu[(c&Fs)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(s,o,a,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>Wc,d=c>>>Wc,f===d)i(f,wu[l&Fs]|Nd[(c&Fs)+1]);else for(i(f,wu[l&Fs]),i(d,Nd[(c&Fs)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(s,o,a,u)=>s<0||o<0||u>=t||a>=e}}function Uwt(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),s=~~((t+2*n+r)/r),o=a=>~~((a+n)/r);return o.invert=a=>a*r-n,o.bitmap=()=>zwt(i,s),o.ratio=r,o.padding=n,o.width=e,o.height=t,o}function jwt(e,t,n,r){const i=e.width,s=e.height;return function(o){const a=o.datum.datum.items[r].items,u=a.length,l=o.datum.fontSize,c=Pl.width(o.datum,o.datum.text);let f=0,d,h,p,m,x,b,v;for(let $=0;$<u;++$)d=a[$].x,p=a[$].y,h=a[$].x2===void 0?d:a[$].x2,m=a[$].y2===void 0?p:a[$].y2,x=(d+h)/2,b=(p+m)/2,v=Math.abs(h-d+m-p),v>=f&&(f=v,o.x=x,o.y=b);return x=c/2,b=l/2,d=o.x-x,h=o.x+x,p=o.y-b,m=o.y+b,o.align="center",d<0&&h<=i?o.align="left":0<=d&&i<h&&(o.align="right"),o.baseline="middle",p<0&&m<=s?o.baseline="top":0<=p&&s<m&&(o.baseline="bottom"),!0}}function TN(e,t,n,r,i,s){let o=n/2;return e-o<0||e+o>i||t-(o=r/2)<0||t+o>s}function Xd(e,t,n,r,i,s,o,a){const u=i*s/(r*2),l=e(t-u),c=e(t+u),f=e(n-(s=s/2)),d=e(n+s);return o.outOfBounds(l,f,c,d)||o.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function Wwt(e,t,n,r){const i=e.width,s=e.height,o=t[0],a=t[1];function u(l,c,f,d,h){const p=e.invert(l),m=e.invert(c);let x=f,b=s,v;if(!TN(p,m,d,h,i,s)&&!Xd(e,p,m,h,d,x,o,a)&&!Xd(e,p,m,h,d,h,o,null)){for(;b-x>=1;)v=(x+b)/2,Xd(e,p,m,h,d,v,o,a)?b=v:x=v;if(x>f)return[p,m,x,!0]}}return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=Pl.width(l.datum,l.datum.text);let p=n?d:0,m=!1,x=!1,b=0,v,$,C,S,A,E,_,D,N,T,L,O,M,R,P,j,z;for(let q=0;q<f;++q){for(v=c[q].x,C=c[q].y,$=c[q].x2===void 0?v:c[q].x2,S=c[q].y2===void 0?C:c[q].y2,v>$&&(z=v,v=$,$=z),C>S&&(z=C,C=S,S=z),N=e(v),L=e($),T=~~((N+L)/2),O=e(C),R=e(S),M=~~((O+R)/2),_=T;_>=N;--_)for(D=M;D>=O;--D)j=u(_,D,p,h,d),j&&([l.x,l.y,p,m]=j);for(_=T;_<=L;++_)for(D=M;D<=R;++D)j=u(_,D,p,h,d),j&&([l.x,l.y,p,m]=j);!m&&!n&&(P=Math.abs($-v+S-C),A=(v+$)/2,E=(C+S)/2,P>=b&&!TN(A,E,h,d,i,s)&&!Xd(e,A,E,d,h,d,o,null)&&(b=P,l.x=A,l.y=E,x=!0))}return m||x?(A=h/2,E=d/2,o.setRange(e(l.x-A),e(l.y-E),e(l.x+A),e(l.y+E)),l.align="center",l.baseline="middle",!0):!1}}const Vwt=[-1,-1,1,1],qwt=[-1,1,-1,1];function Gwt(e,t,n,r){const i=e.width,s=e.height,o=t[0],a=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=Pl.width(l.datum,l.datum.text),p=[];let m=n?d:0,x=!1,b=!1,v=0,$,C,S,A,E,_,D,N,T,L,O,M;for(let R=0;R<f;++R){for($=c[R].x,S=c[R].y,C=c[R].x2===void 0?$:c[R].x2,A=c[R].y2===void 0?S:c[R].y2,p.push([e(($+C)/2),e((S+A)/2)]);p.length;)if([D,N]=p.pop(),!(o.get(D,N)||a.get(D,N)||u.get(D,N))){u.set(D,N);for(let P=0;P<4;++P)E=D+Vwt[P],_=N+qwt[P],u.outOfBounds(E,_,E,_)||p.push([E,_]);if(E=e.invert(D),_=e.invert(N),T=m,L=s,!TN(E,_,h,d,i,s)&&!Xd(e,E,_,d,h,T,o,a)&&!Xd(e,E,_,d,h,d,o,null)){for(;L-T>=1;)O=(T+L)/2,Xd(e,E,_,d,h,O,o,a)?L=O:T=O;T>m&&(l.x=E,l.y=_,m=T,x=!0)}}!x&&!n&&(M=Math.abs(C-$+A-S),E=($+C)/2,_=(S+A)/2,M>=v&&!TN(E,_,h,d,i,s)&&!Xd(e,E,_,d,h,d,o,null)&&(v=M,l.x=E,l.y=_,b=!0))}return x||b?(E=h/2,_=d/2,o.setRange(e(l.x-E),e(l.y-_),e(l.x+E),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const Hwt=["right","center","left"],Xwt=["bottom","middle","top"];function Ywt(e,t,n,r){const i=e.width,s=e.height,o=t[0],a=t[1],u=r.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>s)return!1;let d=0,h,p,m,x,b,v,$,C,S,A,E,_,D,N,T;for(let L=0;L<u;++L){if(h=(n[L]&3)-1,p=(n[L]>>>2&3)-1,m=h===0&&p===0||r[L]<0,x=h&&p?Math.SQRT1_2:1,b=r[L]<0?-1:1,v=c[1+h]+r[L]*h*x,E=c[4+p]+b*f*p/2+r[L]*p*x,C=E-f/2,S=E+f/2,_=e(v),N=e(C),T=e(S),!d)if(Aie(_,_,N,T,o,a,v,v,C,S,c,m))d=Pl.width(l.datum,l.datum.text);else continue;if(A=v+b*d*h/2,v=A-d/2,$=A+d/2,_=e(v),D=e($),Aie(_,D,N,T,o,a,v,$,C,S,c,m))return l.x=h?h*b<0?$:v:A,l.y=p?p*b<0?S:C:E,l.align=Hwt[h*b+1],l.baseline=Xwt[p*b+1],o.setRange(_,N,D,T),!0}return!1}}function Aie(e,t,n,r,i,s,o,a,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&s?s.getRange(e,n,t,r)||!Kwt(o,u,a,l,c):i.getRange(e,n,t,r)))}function Kwt(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}const KB=0,QB=4,ZB=8,JB=0,e5=1,t5=2,Qwt={"top-left":KB+JB,top:KB+e5,"top-right":KB+t5,left:QB+JB,middle:QB+e5,right:QB+t5,"bottom-left":ZB+JB,bottom:ZB+e5,"bottom-right":ZB+t5},Zwt={naive:jwt,"reduced-search":Wwt,floodfill:Gwt};function Jwt(e,t,n,r,i,s,o,a,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=e$t(r,f),h=t$t(i,f),p=n$t(e[0].datum),m=p==="group"&&e[0].datum.items[u].marktype,x=m==="area",b=r$t(p,m,a,u),v=Uwt(t[0],t[1],l),$=x&&c==="naive",C=e.map(E=>({datum:E,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:b(E)}));let S;if(!$){n&&C.sort((_,D)=>n(_.datum,D.datum));let E=!1;for(let _=0;_<h.length&&!E;++_)E=h[_]===5||d[_]<0;p&&(o||x)&&(s=[e.map(_=>_.datum)].concat(s)),S=s.length?Pwt(v,s,E,x):Lwt(v,o&&C)}const A=x?Zwt[c](v,S,o,u):Ywt(v,S,h,d);return C.forEach(E=>E.opacity=+A(E)),C}function e$t(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function t$t(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=Qwt[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function n$t(e){return e&&e.mark&&e.mark.marktype}function r$t(e,t,n,r){const i=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>i(s.datum):t==="line"?s=>{const o=s.datum.items[r].items;return i(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:i}const L8=["x","y","opacity","align","baseline"],Xwe=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function wG(e){xe.call(this,null,e)}wG.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Xwe},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:L8.length,default:L8}]};ze(wG,xe,{transform(e,t){function n(s){const o=e[s];return xn(o)&&t.modified(o.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&ke("Size parameter should be specified as a [width, height] array.");const i=e.as||L8;return Jwt(t.materialize(t.SOURCE).source,e.size,e.sort,It(e.offset||1),It(e.anchor||Xwe),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach(s=>{const o=s.datum;o[i[0]]=s.x,o[i[1]]=s.y,o[i[2]]=s.opacity,o[i[3]]=s.align,o[i[4]]=s.baseline}),t.reflow(r).modifies(i)}});const i$t=Object.freeze(Object.defineProperty({__proto__:null,label:wG},Symbol.toStringTag,{value:"Module"}));function Ywe(e,t){var n=[],r=function(c){return c(a)},i,s,o,a,u,l;if(t==null)n.push(e);else for(i={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function $G(e){xe.call(this,null,e)}$G.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};ze($G,xe,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Ywe(r,e.groupby),s=(e.groupby||[]).map(gr),o=s.length,a=e.as||[gr(e.x),gr(e.y)],u=[];i.forEach(l=>{F0e(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[s[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(dn(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const P8={linear:Wj,log:T0e,exp:I0e,pow:N0e,quad:Vj,poly:D0e},s$t=(e,t)=>e==="poly"?t:e==="quad"?2:1;function CG(e){xe.call(this,null,e)}CG.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(P8)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};ze(CG,xe,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Ywe(r,e.groupby),s=(e.groupby||[]).map(gr),o=e.method||"linear",a=e.order||3,u=s$t(o,a),l=e.as||[gr(e.x),gr(e.y)],c=P8[o],f=[];let d=e.extent;Nt(P8,o)||ke("Invalid regression method: "+o),d!=null&&o==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const m=c(h,e.x,e.y,a);if(e.params){f.push(dn({keys:h.dims,coef:m.coef,rSquared:m.rSquared}));return}const x=d||Ch(h,e.x),b=v=>{const $={};for(let C=0;C<s.length;++C)$[s[C]]=h.dims[C];$[l[0]]=v[0],$[l[1]]=v[1],f.push(dn($))};o==="linear"?x.forEach(v=>b([v,m.predict(v)])):J3(m.predict,x,25,200).forEach(b)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const o$t=Object.freeze(Object.defineProperty({__proto__:null,loess:$G,regression:CG},Symbol.toStringTag,{value:"Module"})),_ie=Math.pow(2,-52),t_=new Uint32Array(512);class IN{static from(t,n=f$t,r=d$t){const i=t.length,s=new Float64Array(i*2);for(let o=0;o<i;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=r(a)}return new IN(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:s}=this,o=t.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let N=0;N<o;N++){const T=t[2*N],L=t[2*N+1];T<a&&(a=T),L<u&&(u=L),T>l&&(l=T),L>c&&(c=L),this._ids[N]=N}const f=(a+l)/2,d=(u+c)/2;let h=1/0,p,m,x;for(let N=0;N<o;N++){const T=n5(f,d,t[2*N],t[2*N+1]);T<h&&(p=N,h=T)}const b=t[2*p],v=t[2*p+1];h=1/0;for(let N=0;N<o;N++){if(N===p)continue;const T=n5(b,v,t[2*N],t[2*N+1]);T<h&&T>0&&(m=N,h=T)}let $=t[2*m],C=t[2*m+1],S=1/0;for(let N=0;N<o;N++){if(N===p||N===m)continue;const T=l$t(b,v,$,C,t[2*N],t[2*N+1]);T<S&&(x=N,S=T)}let A=t[2*x],E=t[2*x+1];if(S===1/0){for(let L=0;L<o;L++)this._dists[L]=t[2*L]-t[0]||t[2*L+1]-t[1];B1(this._ids,this._dists,0,o-1);const N=new Uint32Array(o);let T=0;for(let L=0,O=-1/0;L<o;L++){const M=this._ids[L];this._dists[M]>O&&(N[T++]=M,O=this._dists[M])}this.hull=N.subarray(0,T),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(n_(b,v,$,C,A,E)){const N=m,T=$,L=C;m=x,$=A,C=E,x=N,A=T,E=L}const _=c$t(b,v,$,C,A,E);this._cx=_.x,this._cy=_.y;for(let N=0;N<o;N++)this._dists[N]=n5(t[2*N],t[2*N+1],_.x,_.y);B1(this._ids,this._dists,0,o-1),this._hullStart=p;let D=3;r[p]=n[x]=m,r[m]=n[p]=x,r[x]=n[m]=p,i[p]=0,i[m]=1,i[x]=2,s.fill(-1),s[this._hashKey(b,v)]=p,s[this._hashKey($,C)]=m,s[this._hashKey(A,E)]=x,this.trianglesLen=0,this._addTriangle(p,m,x,-1,-1,-1);for(let N=0,T,L;N<this._ids.length;N++){const O=this._ids[N],M=t[2*O],R=t[2*O+1];if(N>0&&Math.abs(M-T)<=_ie&&Math.abs(R-L)<=_ie||(T=M,L=R,O===p||O===m||O===x))continue;let P=0;for(let V=0,X=this._hashKey(M,R);V<this._hashSize&&(P=s[(X+V)%this._hashSize],!(P!==-1&&P!==r[P]));V++);P=n[P];let j=P,z;for(;z=r[j],!n_(M,R,t[2*j],t[2*j+1],t[2*z],t[2*z+1]);)if(j=z,j===P){j=-1;break}if(j===-1)continue;let q=this._addTriangle(j,O,r[j],-1,-1,i[j]);i[O]=this._legalize(q+2),i[j]=q,D++;let H=r[j];for(;z=r[H],n_(M,R,t[2*H],t[2*H+1],t[2*z],t[2*z+1]);)q=this._addTriangle(H,O,z,i[O],-1,i[H]),i[O]=this._legalize(q+2),r[H]=H,D--,H=z;if(j===P)for(;z=n[j],n_(M,R,t[2*z],t[2*z+1],t[2*j],t[2*j+1]);)q=this._addTriangle(z,O,j,-1,i[j],i[z]),this._legalize(q+2),i[z]=q,r[j]=j,D--,j=z;this._hullStart=n[O]=j,r[j]=n[H]=O,r[O]=H,s[this._hashKey(M,R)]=O,s[this._hashKey(t[2*j],t[2*j+1])]=j}this.hull=new Uint32Array(D);for(let N=0,T=this._hullStart;N<D;N++)this.hull[N]=T,T=r[T];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(a$t(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let s=0,o=0;for(;;){const a=r[t],u=t-t%3;if(o=u+(t+2)%3,a===-1){if(s===0)break;t=t_[--s];continue}const l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,d=n[o],h=n[t],p=n[c],m=n[f];if(u$t(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*m],i[2*m+1])){n[t]=m,n[a]=d;const b=r[f];if(b===-1){let $=this._hullStart;do{if(this._hullTri[$]===f){this._hullTri[$]=t;break}$=this._hullPrev[$]}while($!==this._hullStart)}this._link(t,b),this._link(a,r[o]),this._link(o,f);const v=l+(a+1)%3;s<t_.length&&(t_[s++]=v)}else{if(s===0)break;t=t_[--s]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function a$t(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function n5(e,t,n,r){const i=e-n,s=t-r;return i*i+s*s}function r5(e,t,n,r,i,s){const o=(r-t)*(i-e),a=(n-e)*(s-t);return Math.abs(o-a)>=33306690738754716e-32*Math.abs(o+a)?o-a:0}function n_(e,t,n,r,i,s){return(r5(i,s,e,t,n,r)||r5(e,t,n,r,i,s)||r5(n,r,i,s,e,t))<0}function u$t(e,t,n,r,i,s,o,a){const u=e-o,l=t-a,c=n-o,f=r-a,d=i-o,h=s-a,p=u*u+l*l,m=c*c+f*f,x=d*d+h*h;return u*(f*x-m*h)-l*(c*x-m*d)+p*(c*h-f*d)<0}function l$t(e,t,n,r,i,s){const o=n-e,a=r-t,u=i-e,l=s-t,c=o*o+a*a,f=u*u+l*l,d=.5/(o*l-a*u),h=(l*c-a*f)*d,p=(o*f-u*c)*d;return h*h+p*p}function c$t(e,t,n,r,i,s){const o=n-e,a=r-t,u=i-e,l=s-t,c=o*o+a*a,f=u*u+l*l,d=.5/(o*l-a*u),h=e+(l*c-a*f)*d,p=t+(o*f-u*c)*d;return{x:h,y:p}}function B1(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const s=e[i],o=t[s];let a=i-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{const i=n+r>>1;let s=n+1,o=r;g2(e,i,s),t[e[n]]>t[e[r]]&&g2(e,n,r),t[e[s]]>t[e[r]]&&g2(e,s,r),t[e[n]]>t[e[s]]&&g2(e,n,s);const a=e[s],u=t[a];for(;;){do s++;while(t[e[s]]<u);do o--;while(t[e[o]]>u);if(o<s)break;g2(e,s,o)}e[n+1]=e[o],e[o]=a,r-s+1>=o-n?(B1(e,t,s,r),B1(e,t,n,o-1)):(B1(e,t,n,o-1),B1(e,t,s,r))}}function g2(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function f$t(e){return e[0]}function d$t(e){return e[1]}const Tie=1e-6;class Ng{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,s=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>Tie||Math.abs(this._y1-s)>Tie)&&(this._+="L"+i+","+s),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=s}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class B8{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let h$t=class{constructor(t,[n,r,i,s]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((s=+s)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=s,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,s=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,p=0,m=r.length,x,b;h<m;h+=3,p+=2){const v=r[h]*2,$=r[h+1]*2,C=r[h+2]*2,S=t[v],A=t[v+1],E=t[$],_=t[$+1],D=t[C],N=t[C+1],T=E-S,L=_-A,O=D-S,M=N-A,R=T*T+L*L,P=O*O+M*M,j=(T*M-L*O)*2;if(!j)x=(S+D)/2-1e8*M,b=(A+N)/2+1e8*O;else if(Math.abs(j)<1e-8)x=(S+D)/2,b=(A+N)/2;else{const z=1/j;x=S+(M*R-L*P)*z,b=A+(T*P-O*R)*z}s[p]=x,s[p+1]=b}let o=n[n.length-1],a,u=o*4,l,c=t[2*o],f,d=t[2*o+1];i.fill(0);for(let h=0;h<n.length;++h)o=n[h],a=u,l=c,f=d,u=o*4,c=t[2*o],d=t[2*o+1],i[a+2]=i[u]=f-d,i[a+3]=i[u+1]=c-l}render(t){const n=t==null?t=new Ng:void 0,{delaunay:{halfedges:r,inedges:i,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,m=o[h],x=o[h+1],b=o[p],v=o[p+1];this._renderSegment(m,x,b,v,t)}let u,l=s[s.length-1];for(let c=0;c<s.length;++c){u=l,l=s[c];const f=Math.floor(i[l]/3)*2,d=o[f],h=o[f+1],p=u*4,m=this._project(d,h,a[p+2],a[p+3]);m&&this._renderSegment(d,h,m[0],m[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Ng:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new Ng:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&n.lineTo(i[o],i[o+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new B8;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,s){let o;const a=this._regioncode(t,n),u=this._regioncode(r,i);a===0&&u===0?(s.moveTo(t,n),s.lineTo(r,i)):(o=this._clipSegment(t,n,r,i,a,u))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i){e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,u=i.length;a<u;a+=2)if(n[s]==i[a]&&n[s+1]==i[a+1]&&n[(s+2)%o]==i[(a+u-2)%u]&&n[(s+3)%o]==i[(a+u-1)%u]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:s}}=this,o=r[t];if(o===-1)return null;const a=[];let u=o;do{const l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3===2?u-2:u+1,s[u]!==t)break;u=i[u]}while(u!==o&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let i=null,s,o,a=n[r-2],u=n[r-1],l,c=this._regioncode(a,u),f,d;for(let h=0;h<r;h+=2)if(s=a,o=u,a=n[h],u=n[h+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=d,d=0,i?i.push(a,u):i=[a,u];else{let p,m,x,b,v;if(l===0){if((p=this._clipSegment(s,o,a,u,l,c))===null)continue;[m,x,b,v]=p}else{if((p=this._clipSegment(a,u,s,o,c,l))===null)continue;[b,v,m,x]=p,f=d,d=this._edgecode(m,x),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(m,x):i=[m,x]}f=d,d=this._edgecode(b,v),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(b,v):i=[b,v]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,s,o){for(;;){if(s===0&&o===0)return[t,n,r,i];if(s&o)return null;let a,u,l=s||o;l&8?(a=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):l&4?(a=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):l&2?(u=n+(i-n)*(this.xmax-t)/(r-t),a=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),a=this.xmin),s?(t=a,n=u,s=this._regioncode(t,n)):(r=a,i=u,o=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,s,o){let a=Array.from(n),u;if((u=this._project(a[0],a[1],r,i))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,i,s){for(;n!==r;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(i[s]!==o||i[s+1]!==a)&&this.contains(t,o,a)&&(i.splice(s,0,o,a),s+=2)}if(i.length>4)for(let o=0;o<i.length;o+=2){const a=(o+2)%i.length,u=(o+4)%i.length;(i[o]===i[a]&&i[a]===i[u]||i[o+1]===i[a+1]&&i[a+1]===i[u+1])&&(i.splice(a,2),o-=2)}return s}_project(t,n,r,i){let s=1/0,o,a,u;if(i<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/i)<s&&(u=this.ymin,a=t+(s=o)*r)}else if(i>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/i)<s&&(u=this.ymax,a=t+(s=o)*r)}if(r>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/r)<s&&(a=this.xmax,u=n+(s=o)*i)}else if(r<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/r)<s&&(a=this.xmin,u=n+(s=o)*i)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}};const p$t=2*Math.PI,y1=Math.pow;function g$t(e){return e[0]}function m$t(e){return e[1]}function y$t(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],s=2*t[r+1],o=2*t[r+2];if((n[o]-n[i])*(n[s+1]-n[i+1])-(n[s]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}function x$t(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class SG{static from(t,n=g$t,r=m$t,i){return new SG("length"in t?b$t(t,n,r,i):Float64Array.from(v$t(t,n,r,i)))}constructor(t){this._delaunator=new IN(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&y$t(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=x$t(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new IN(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=s[u%3===2?u-2:u+1];(r[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=i.length;u<l;++u)a[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],o[i[0]]=1,i.length===2&&(o[i[1]]=0))}voronoi(t){return new h$t(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:s,triangles:o,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3===2?l-2:l+1,o[l]!==t)return;if(l=s[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let s;for(;(s=this._step(r,t,n))>=0&&s!==r&&s!==i;)r=s;return s}_step(t,n,r){const{inedges:i,hull:s,_hullIndex:o,halfedges:a,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=y1(n-l[t*2],2)+y1(r-l[t*2+1],2);const d=i[t];let h=d;do{let p=u[h];const m=y1(n-l[p*2],2)+y1(r-l[p*2+1],2);if(m<f&&(f=m,c=p),h=h%3===2?h-2:h+1,u[h]!==t)break;if(h=a[h],h===-1){if(h=s[(o[t]+1)%s.length],h!==p&&y1(n-l[h*2],2)+y1(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new Ng:void 0,{points:r,halfedges:i,triangles:s}=this;for(let o=0,a=i.length;o<a;++o){const u=i[o];if(u<o)continue;const l=s[o]*2,c=s[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new Ng:void 0,{points:i}=this;for(let s=0,o=i.length;s<o;s+=2){const a=i[s],u=i[s+1];t.moveTo(a+n,u),t.arc(a,u,n,0,p$t)}return r&&r.value()}renderHull(t){const n=t==null?t=new Ng:void 0,{hull:r,points:i}=this,s=r[0]*2,o=r.length;t.moveTo(i[s],i[s+1]);for(let a=1;a<o;++a){const u=2*r[a];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new B8;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new Ng:void 0,{points:i,triangles:s}=this,o=s[t*=3]*2,a=s[t+1]*2,u=s[t+2]*2;return n.moveTo(i[o],i[o+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new B8;return this.renderTriangle(t,n),n.value()}}function b$t(e,t,n,r){const i=e.length,s=new Float64Array(i*2);for(let o=0;o<i;++o){const a=e[o];s[o*2]=t.call(r,a,o,e),s[o*2+1]=n.call(r,a,o,e)}return s}function*v$t(e,t,n,r){let i=0;for(const s of e)yield t.call(r,s,i,e),yield n.call(r,s,i,e),++i}function kG(e){xe.call(this,null,e)}kG.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const w$t=[-1e5,-1e5,1e5,1e5];ze(kG,xe,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:w$t;const s=this.value=SG.from(r,e.x,e.y).voronoi(i);for(let o=0,a=r.length;o<a;++o){const u=s.cellPolygon(o);r[o][n]=u?$$t(u):null}return t.reflow(e.modified()).modifies(n)}});function $$t(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}const C$t=Object.freeze(Object.defineProperty({__proto__:null,voronoi:kG},Symbol.toStringTag,{value:"Module"}));function Mb(e,t,n){return e.fields=t||[],e.fname=n,e}function S$t(e){return e.length===1?k$t(e[0]):E$t(e)}const k$t=e=>function(t){return t[e]},E$t=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function ST(e){throw Error(e)}function A$t(e){const t=[],n=e.length;let r=null,i=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=a+1,r=u):u==="."&&!i?a>o?l():o=a+1:u==="["?(a>o&&l(),i=o=a+1):u==="]"&&(i||ST("Access path missing open bracket: "+e),i>0&&l(),i=0,o=a+1)}return i&&ST("Access path missing closing bracket: "+e),r&&ST("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function _$t(e,t,n){const r=A$t(e);return e=r.length===1?r[0]:e,Mb(S$t(r),[e],e)}_$t("id");Mb(e=>e,[],"identity");Mb(()=>0,[],"zero");Mb(()=>1,[],"one");Mb(()=>!0,[],"true");Mb(()=>!1,[],"false");var Kwe=Array.isArray;function T$t(e){return e[e.length-1]}function I$t(e){return e==null||e===""?null:+e}function N$t(e){return e!=null?Kwe(e)?e:[e]:[]}function z8(e){return typeof e=="function"}function D$t(e){return z8(e)?e:()=>e}function F$t(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function R$t(e,t){let n=0,r,i,s,o;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=o=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>o&&(o=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=o=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>o&&(o=i))}return[s,o]}function O$t(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),F$t(r,n)}function M$t(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function ww(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function L$t(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function EG(e){let t,n,r;e.length!==2?(t=ww,n=(a,u)=>ww(e(a),u),r=(a,u)=>e(a)-u):(t=e===ww||e===L$t?e:P$t,n=e,r=e);function i(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){const f=i(a,u,l,c-1);return f>l&&r(a[f-1],u)>-r(a[f],u)?f-1:f}return{left:i,center:o,right:s}}function P$t(){return 0}function Qwe(e){return e===null?NaN:+e}const B$t=EG(ww),Cm=B$t.right;EG(Qwe).center;const z$t=Math.sqrt(50),U$t=Math.sqrt(10),j$t=Math.sqrt(2);function NN(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=z$t?10:s>=U$t?5:s>=j$t?2:1;let a,u,l;return i<0?(l=Math.pow(10,-i)/o,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,i)*o,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?NN(e,t,n*2):[a,u,l]}function U8(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,o]=r?NN(t,e,n):NN(e,t,n);if(!(s>=i))return[];const a=s-i+1,u=new Array(a);if(r)if(o<0)for(let l=0;l<a;++l)u[l]=(s-l)/-o;else for(let l=0;l<a;++l)u[l]=(s-l)*o;else if(o<0)for(let l=0;l<a;++l)u[l]=(i+l)/-o;else for(let l=0;l<a;++l)u[l]=(i+l)*o;return u}function j8(e,t,n){return t=+t,e=+e,n=+n,NN(e,t,n)[2]}function W8(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?j8(t,e,n):j8(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function W$t(e,t,n=Qwe){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(i-s)}}function V$t(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function mc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function pp(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Iie=Symbol("implicit");function AG(){var e=new mI,t=[],n=[],r=Iie;function i(s){let o=e.get(s);if(o===void 0){if(r!==Iie)return r;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new mI;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return AG(t,n).unknown(r)},mc.apply(i,arguments),i}function Zwe(e,t,n,r,i){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*r+o*i)/6}function Jwe(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],o=r>0?e[r-1]:2*i-s,a=r<t-1?e[r+2]:2*s-i;return Zwe((n-r/t)*t,o,i,s,a)}}function e$e(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],s=e[r%t],o=e[(r+1)%t],a=e[(r+2)%t];return Zwe((n-r/t)*t,i,s,o,a)}}const iO=e=>()=>e;function t$e(e,t){return function(n){return e+n*t}}function q$t(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function sO(e,t){var n=t-e;return n?t$e(e,n>180||n<-180?n-360*Math.round(n/360):n):iO(isNaN(e)?t:e)}function G$t(e){return(e=+e)==1?gi:function(t,n){return n-t?q$t(t,n,e):iO(isNaN(t)?n:t)}}function gi(e,t){var n=t-e;return n?t$e(e,n):iO(isNaN(e)?t:e)}const V8=function e(t){var n=G$t(t);function r(i,s){var o=n((i=Ro(i)).r,(s=Ro(s)).r),a=n(i.g,s.g),u=n(i.b,s.b),l=gi(i.opacity,s.opacity);return function(c){return i.r=o(c),i.g=a(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function n$e(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Ro(t[o]),r[o]=a.r||0,i[o]=a.g||0,s[o]=a.b||0;return r=e(r),i=e(i),s=e(s),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=s(u),a+""}}}var H$t=n$e(Jwe),X$t=n$e(e$e);function _G(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function r$e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Y$t(e,t){return(r$e(t)?_G:i$e)(e,t)}function i$e(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=g0(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function s$e(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function $u(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function o$e(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=g0(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var q8=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,i5=new RegExp(q8.source,"g");function K$t(e){return function(){return e}}function Q$t(e){return function(t){return e(t)+""}}function a$e(e,t){var n=q8.lastIndex=i5.lastIndex=0,r,i,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(r=q8.exec(e))&&(i=i5.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,u.push({i:o,x:$u(r,i)})),n=i5.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?Q$t(u[0].x):K$t(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function g0(e,t){var n=typeof t,r;return t==null||n==="boolean"?iO(t):(n==="number"?$u:n==="string"?(r=Nf(t))?(t=r,V8):a$e:t instanceof Nf?V8:t instanceof Date?s$e:r$e(t)?_G:Array.isArray(t)?i$e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?o$e:$u)(e,t)}function Z$t(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function J$t(e,t){var n=sO(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function oO(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Nie=180/Math.PI,G8={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function u$e(e,t,n,r,i,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*Nie,skewX:Math.atan(u)*Nie,scaleX:o,scaleY:a}}var r_;function eCt(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?G8:u$e(t.a,t.b,t.c,t.d,t.e,t.f)}function tCt(e){return e==null||(r_||(r_=document.createElementNS("http://www.w3.org/2000/svg","g")),r_.setAttribute("transform",e),!(e=r_.transform.baseVal.consolidate()))?G8:(e=e.matrix,u$e(e.a,e.b,e.c,e.d,e.e,e.f))}function l$e(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,c,f,d,h,p){if(l!==f||c!==d){var m=h.push("translate(",null,t,null,n);p.push({i:m-4,x:$u(l,f)},{i:m-2,x:$u(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:$u(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function a(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:$u(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var m=h.push(i(h)+"scale(",null,",",null,")");p.push({i:m-4,x:$u(l,f)},{i:m-2,x:$u(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,m=d.length,x;++p<m;)f[(x=d[p]).i]=x.x(h);return f.join("")}}}var nCt=l$e(eCt,"px, ","px)","deg)"),rCt=l$e(tCt,", ",")",")"),iCt=1e-12;function Die(e){return((e=Math.exp(e))+1/e)/2}function sCt(e){return((e=Math.exp(e))-1/e)/2}function oCt(e){return((e=Math.exp(2*e))-1)/(e+1)}const aCt=function e(t,n,r){function i(s,o){var a=s[0],u=s[1],l=s[2],c=o[0],f=o[1],d=o[2],h=c-a,p=f-u,m=h*h+p*p,x,b;if(m<iCt)b=Math.log(d/l)/t,x=function(E){return[a+E*h,u+E*p,l*Math.exp(t*E*b)]};else{var v=Math.sqrt(m),$=(d*d-l*l+r*m)/(2*l*n*v),C=(d*d-l*l-r*m)/(2*d*n*v),S=Math.log(Math.sqrt($*$+1)-$),A=Math.log(Math.sqrt(C*C+1)-C);b=(A-S)/t,x=function(E){var _=E*b,D=Die(S),N=l/(n*v)*(D*oCt(t*_+S)-sCt(S));return[a+N*h,u+N*p,l*D/Die(t*_+S)]}}return x.duration=b*1e3*t/Math.SQRT2,x}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return e(o,a,u)},i}(Math.SQRT2,2,4);function c$e(e){return function(t,n){var r=e((t=Nh(t)).h,(n=Nh(n)).h),i=gi(t.s,n.s),s=gi(t.l,n.l),o=gi(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const uCt=c$e(sO);var lCt=c$e(gi);function cCt(e,t){var n=gi((e=Dh(e)).l,(t=Dh(t)).l),r=gi(e.a,t.a),i=gi(e.b,t.b),s=gi(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=s(o),e+""}}function f$e(e){return function(t,n){var r=e((t=Fh(t)).h,(n=Fh(n)).h),i=gi(t.c,n.c),s=gi(t.l,n.l),o=gi(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=i(a),t.l=s(a),t.opacity=o(a),t+""}}}const fCt=f$e(sO);var dCt=f$e(gi);function d$e(e){return function t(n){n=+n;function r(i,s){var o=e((i=mm(i)).h,(s=mm(s)).h),a=gi(i.s,s.s),u=gi(i.l,s.l),l=gi(i.opacity,s.opacity);return function(c){return i.h=o(c),i.s=a(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}const hCt=d$e(sO);var pCt=d$e(gi);function TG(e,t){t===void 0&&(t=e,e=g0);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(o){var a=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return s[a](o-a)}}function gCt(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}const mCt=Object.freeze(Object.defineProperty({__proto__:null,interpolate:g0,interpolateArray:Y$t,interpolateBasis:Jwe,interpolateBasisClosed:e$e,interpolateCubehelix:hCt,interpolateCubehelixLong:pCt,interpolateDate:s$e,interpolateDiscrete:Z$t,interpolateHcl:fCt,interpolateHclLong:dCt,interpolateHsl:uCt,interpolateHslLong:lCt,interpolateHue:J$t,interpolateLab:cCt,interpolateNumber:$u,interpolateNumberArray:_G,interpolateObject:o$e,interpolateRgb:V8,interpolateRgbBasis:H$t,interpolateRgbBasisClosed:X$t,interpolateRound:oO,interpolateString:a$e,interpolateTransformCss:nCt,interpolateTransformSvg:rCt,interpolateZoom:aCt,piecewise:TG,quantize:gCt},Symbol.toStringTag,{value:"Module"}));function yCt(e){return function(){return e}}function H8(e){return+e}var Fie=[0,1];function Eo(e){return e}function X8(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:yCt(isNaN(t)?NaN:.5)}function xCt(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function bCt(e,t,n){var r=e[0],i=e[1],s=t[0],o=t[1];return i<r?(r=X8(i,r),s=n(o,s)):(r=X8(r,i),s=n(s,o)),function(a){return s(r(a))}}function vCt(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=X8(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var u=Cm(e,a,1,r)-1;return s[u](i[u](a))}}function bk(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function aO(){var e=Fie,t=Fie,n=g0,r,i,s,o=Eo,a,u,l;function c(){var d=Math.min(e.length,t.length);return o!==Eo&&(o=xCt(e[0],e[d-1])),a=d>2?vCt:bCt,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?s:(u||(u=a(e.map(r),t,n)))(r(o(d)))}return f.invert=function(d){return o(i((l||(l=a(t,e.map(r),$u)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,H8),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=oO,c()},f.clamp=function(d){return arguments.length?(o=d?!0:Eo,c()):o!==Eo},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return r=d,i=h,c()}}function h$e(){return aO()(Eo,Eo)}function p$e(e,t,n,r){var i=W8(e,t,n),s;switch(r=ym(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=RV(i,o))&&(r.precision=s),FR(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=OV(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=FV(i))&&(r.precision=s-(r.type==="%")*2);break}}return Db(r)}function m0(e){var t=e.domain;return e.ticks=function(n){var r=t();return U8(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return p$e(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,o=r[i],a=r[s],u,l,c=10;for(a<o&&(l=o,o=a,a=l,l=i,i=s,s=l);c-- >0;){if(l=j8(o,a,n),l===u)return r[i]=o,r[s]=a,t(r);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function g$e(){var e=h$e();return e.copy=function(){return bk(e,g$e())},mc.apply(e,arguments),m0(e)}function m$e(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,H8),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return m$e(e).unknown(t)},e=arguments.length?Array.from(e,H8):[0,1],m0(n)}function y$e(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],o;return s<i&&(o=n,n=r,r=o,o=i,i=s,s=o),e[n]=t.floor(i),e[r]=t.ceil(s),e}function Rie(e){return Math.log(e)}function Oie(e){return Math.exp(e)}function wCt(e){return-Math.log(-e)}function $Ct(e){return-Math.exp(-e)}function CCt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function SCt(e){return e===10?CCt:e===Math.E?Math.exp:t=>Math.pow(e,t)}function kCt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Mie(e){return(t,n)=>-e(-t,n)}function IG(e){const t=e(Rie,Oie),n=t.domain;let r=10,i,s;function o(){return i=kCt(r),s=SCt(r),n()[0]<0?(i=Mie(i),s=Mie(s),e(wCt,$Ct)):e(Rie,Oie),t}return t.base=function(a){return arguments.length?(r=+a,o()):r},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const u=n();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let d=i(l),h=i(c),p,m;const x=a==null?10:+a;let b=[];if(!(r%1)&&h-d<x){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1;p<r;++p)if(m=d<0?p/s(-d):p*s(d),!(m<l)){if(m>c)break;b.push(m)}}else for(;d<=h;++d)for(p=r-1;p>=1;--p)if(m=d>0?p/s(-d):p*s(d),!(m<l)){if(m>c)break;b.push(m)}b.length*2<x&&(b=U8(l,c,x))}else b=U8(d,h,Math.min(h-d,x)).map(s);return f?b.reverse():b},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=r===10?"s":","),typeof u!="function"&&(!(r%1)&&(u=ym(u)).precision==null&&(u.trim=!0),u=Db(u)),a===1/0)return u;const l=Math.max(1,r*a/t.ticks().length);return c=>{let f=c/s(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=()=>n(y$e(n(),{floor:a=>s(Math.floor(i(a))),ceil:a=>s(Math.ceil(i(a)))})),t}function x$e(){const e=IG(aO()).domain([1,10]);return e.copy=()=>bk(e,x$e()).base(e.base()),mc.apply(e,arguments),e}function Lie(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Pie(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function NG(e){var t=1,n=e(Lie(t),Pie(t));return n.constant=function(r){return arguments.length?e(Lie(t=+r),Pie(t)):t},m0(n)}function b$e(){var e=NG(aO());return e.copy=function(){return bk(e,b$e()).constant(e.constant())},mc.apply(e,arguments)}function Bie(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ECt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ACt(e){return e<0?-e*e:e*e}function DG(e){var t=e(Eo,Eo),n=1;function r(){return n===1?e(Eo,Eo):n===.5?e(ECt,ACt):e(Bie(n),Bie(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},m0(t)}function FG(){var e=DG(aO());return e.copy=function(){return bk(e,FG()).exponent(e.exponent())},mc.apply(e,arguments),e}function _Ct(){return FG.apply(null,arguments).exponent(.5)}function v$e(){var e=[],t=[],n=[],r;function i(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=W$t(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?r:t[Cm(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ww),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(r=o,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return v$e().domain(e).range(t).unknown(r)},mc.apply(s,arguments)}function w$e(){var e=0,t=1,n=1,r=[.5],i=[0,1],s;function o(u){return u!=null&&u<=u?i[Cm(r,u,0,n)]:s}function a(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},o.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,a()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return r.slice()},o.copy=function(){return w$e().domain([e,t]).range(i).unknown(s)},mc.apply(m0(o),arguments)}function $$e(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[Cm(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return $$e().domain(e).range(t).unknown(n)},mc.apply(i,arguments)}const s5=new Date,o5=new Date;function ii(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,a)=>{const u=[];if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;let l;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},i.filter=s=>ii(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(i.count=(s,o)=>(s5.setTime(+s),o5.setTime(+o),e(s5),e(o5),Math.floor(n(s5,o5))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?o=>r(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const Gy=ii(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Gy.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ii(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Gy);Gy.range;const hf=1e3,Da=hf*60,pf=Da*60,Rf=pf*24,RG=Rf*7,zie=Rf*30,a5=Rf*365,gf=ii(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*hf)},(e,t)=>(t-e)/hf,e=>e.getUTCSeconds());gf.range;const uO=ii(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*hf)},(e,t)=>{e.setTime(+e+t*Da)},(e,t)=>(t-e)/Da,e=>e.getMinutes());uO.range;const lO=ii(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Da)},(e,t)=>(t-e)/Da,e=>e.getUTCMinutes());lO.range;const cO=ii(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*hf-e.getMinutes()*Da)},(e,t)=>{e.setTime(+e+t*pf)},(e,t)=>(t-e)/pf,e=>e.getHours());cO.range;const fO=ii(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*pf)},(e,t)=>(t-e)/pf,e=>e.getUTCHours());fO.range;const Z1=ii(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Da)/Rf,e=>e.getDate()-1);Z1.range;const $w=ii(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Rf,e=>e.getUTCDate()-1);$w.range;const C$e=ii(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Rf,e=>Math.floor(e/Rf));C$e.range;function y0(e){return ii(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Da)/RG)}const dO=y0(0),TCt=y0(1),ICt=y0(2),NCt=y0(3),DCt=y0(4),FCt=y0(5),RCt=y0(6);dO.range;TCt.range;ICt.range;NCt.range;DCt.range;FCt.range;RCt.range;function x0(e){return ii(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/RG)}const hO=x0(0),OCt=x0(1),MCt=x0(2),LCt=x0(3),PCt=x0(4),BCt=x0(5),zCt=x0(6);hO.range;OCt.range;MCt.range;LCt.range;PCt.range;BCt.range;zCt.range;const P$=ii(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());P$.range;const B$=ii(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());B$.range;const vk=ii(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());vk.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ii(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});vk.range;const wk=ii(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());wk.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ii(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});wk.range;function S$e(e,t,n,r,i,s){const o=[[gf,1,hf],[gf,5,5*hf],[gf,15,15*hf],[gf,30,30*hf],[s,1,Da],[s,5,5*Da],[s,15,15*Da],[s,30,30*Da],[i,1,pf],[i,3,3*pf],[i,6,6*pf],[i,12,12*pf],[r,1,Rf],[r,2,2*Rf],[n,1,RG],[t,1,zie],[t,3,3*zie],[e,1,a5]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=EG(([,,x])=>x).right(o,d);if(h===o.length)return e.every(W8(l/a5,c/a5,f));if(h===0)return Gy.every(Math.max(W8(l,c,f),1));const[p,m]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(m)}return[a,u]}const[UCt,jCt]=S$e(wk,B$,hO,C$e,fO,lO),[WCt,VCt]=S$e(vk,P$,dO,Z1,cO,uO);function qCt(e){return new Date(e)}function GCt(e){return e instanceof Date?+e:+new Date(+e)}function OG(e,t,n,r,i,s,o,a,u,l){var c=h$e(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),m=l("%I:%M"),x=l("%I %p"),b=l("%a %d"),v=l("%b %d"),$=l("%B"),C=l("%Y");function S(A){return(u(A)<A?h:a(A)<A?p:o(A)<A?m:s(A)<A?x:r(A)<A?i(A)<A?b:v:n(A)<A?$:C)(A)}return c.invert=function(A){return new Date(f(A))},c.domain=function(A){return arguments.length?d(Array.from(A,GCt)):d().map(qCt)},c.ticks=function(A){var E=d();return e(E[0],E[E.length-1],A??10)},c.tickFormat=function(A,E){return E==null?S:l(E)},c.nice=function(A){var E=d();return(!A||typeof A.range!="function")&&(A=t(E[0],E[E.length-1],A??10)),A?d(y$e(E,A)):c},c.copy=function(){return bk(c,OG(e,t,n,r,i,s,o,a,u,l))},c}function HCt(){return mc.apply(OG(WCt,VCt,vk,P$,dO,Z1,cO,uO,gf,RR).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function XCt(){return mc.apply(OG(UCt,jCt,wk,B$,hO,$w,fO,lO,gf,OR).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function pO(){var e=0,t=1,n,r,i,s,o=Eo,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(i===0?.5:(f=(s(f)-n)*i,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),r=s(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(g0),l.rangeRound=c(oO),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return s=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function gp(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function MG(){var e=m0(pO()(Eo));return e.copy=function(){return gp(e,MG())},pp.apply(e,arguments)}function k$e(){var e=IG(pO()).domain([1,10]);return e.copy=function(){return gp(e,k$e()).base(e.base())},pp.apply(e,arguments)}function E$e(){var e=NG(pO());return e.copy=function(){return gp(e,E$e()).constant(e.constant())},pp.apply(e,arguments)}function LG(){var e=DG(pO());return e.copy=function(){return gp(e,LG()).exponent(e.exponent())},pp.apply(e,arguments)}function YCt(){return LG.apply(null,arguments).exponent(.5)}function gO(){var e=0,t=.5,n=1,r=1,i,s,o,a,u,l=Eo,c,f=!1,d;function h(m){return isNaN(m=+m)?d:(m=.5+((m=+c(m))-s)*(r*m<r*s?a:u),l(f?Math.max(0,Math.min(1,m)):m))}h.domain=function(m){return arguments.length?([e,t,n]=m,i=c(e=+e),s=c(t=+t),o=c(n=+n),a=i===s?0:.5/(s-i),u=s===o?0:.5/(o-s),r=s<i?-1:1,h):[e,t,n]},h.clamp=function(m){return arguments.length?(f=!!m,h):f},h.interpolator=function(m){return arguments.length?(l=m,h):l};function p(m){return function(x){var b,v,$;return arguments.length?([b,v,$]=x,l=TG(m,[b,v,$]),h):[l(0),l(.5),l(1)]}}return h.range=p(g0),h.rangeRound=p(oO),h.unknown=function(m){return arguments.length?(d=m,h):d},function(m){return c=m,i=m(e),s=m(t),o=m(n),a=i===s?0:.5/(s-i),u=s===o?0:.5/(o-s),r=s<i?-1:1,h}}function A$e(){var e=m0(gO()(Eo));return e.copy=function(){return gp(e,A$e())},pp.apply(e,arguments)}function _$e(){var e=IG(gO()).domain([.1,1,10]);return e.copy=function(){return gp(e,_$e()).base(e.base())},pp.apply(e,arguments)}function T$e(){var e=NG(gO());return e.copy=function(){return gp(e,T$e()).constant(e.constant())},pp.apply(e,arguments)}function PG(){var e=DG(gO());return e.copy=function(){return gp(e,PG()).exponent(e.exponent())},pp.apply(e,arguments)}function KCt(){return PG.apply(null,arguments).exponent(.5)}const BG="year",zG="quarter",UG="month",jG="week",WG="date",VG="day",qG="dayofyear",GG="hours",HG="minutes",XG="seconds",YG="milliseconds",QCt=[BG,zG,UG,jG,WG,VG,qG,GG,HG,XG,YG];QCt.reduce((e,t,n)=>(e[t]=1+n,e),{});BG+"",zG+"",P$.every(3),UG+"",jG+"",WG+"",VG+"",qG+"",GG+"",HG+"",XG+"",YG+"";BG+"",zG+"",B$.every(3),UG+"",jG+"",WG+"",VG+"",qG+"",GG+"",HG+"",XG+"",YG+"";function ZCt(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const JCt="identity",KG="linear",Hy="log",QG="pow",ZG="sqrt",JG="symlog",eSt="time",tSt="utc",Lb="sequential",$k="diverging",Uie="quantile",nSt="quantize",rSt="threshold",iSt="ordinal",sSt="point",oSt="band",aSt="bin-ordinal",Di="continuous",mO="discrete",yO="discretizing",Yu="interpolating",I$e="temporal";function uSt(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function lSt(e){return function(t){const n=e.range();let r=t[0],i=t[1],s=-1,o,a,u,l;for(i<r&&(a=r,r=i,i=a),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(s<0&&(s=u),o=u);if(!(s<0))return r=e.invertExtent(n[s]),i=e.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function eH(){const e=AG().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,s,o=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=ZCt(f,a,u);let m=r[d-0];i=(h-m)/(p||1),o&&(i=Math.floor(i)),m+=(h-m-i*(f-a))*l,s=i*(1-a),o&&(m=Math.round(m),s=Math.round(s));const x=V$t(f).map(b=>m+i*b);return n(d?x.reverse():x)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let m=+f[0],x=+f[1],b,v,$;if(!(m!==m||x!==x)&&(x<m&&($=m,m=x,x=$),!(x<h[0]||m>r[1-d])))return b=Math.max(0,Cm(h,m)-1),v=m===x?b:Cm(h,x)-1,m-h[b]>s+1e-10&&++b,d&&($=b,b=p-v,v=p-$),b>v?void 0:t().slice(b,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return eH().domain(t()).range(r).round(o).paddingInner(a).paddingOuter(u).align(l)},c()}function N$e(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return N$e(t())},e}function cSt(){return N$e(eH().paddingInner(1))}var fSt=Array.prototype.map;function dSt(e){return fSt.call(e,I$t)}const hSt=Array.prototype.slice;function D$e(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(Cm(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=dSt(r),n):e.slice()},n.range=function(r){return arguments.length?(t=hSt.call(r),n):t.slice()},n.tickFormat=function(r,i){return p$e(e[0],T$t(e),r??10,i)},n.copy=function(){return D$e().domain(n.domain()).range(n.range())},n}const Y8=new Map,pSt=Symbol("vega_scale");function gSt(e){return e[pSt]=!0,e}function mSt(e,t,n){const r=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?uSt(s):s.invertExtent?lSt(s):void 0),s.type=e,gSt(s)};return r.metadata=M$t(N$t(n)),r}function Rn(e,t,n){return arguments.length>1?(Y8.set(e,mSt(e,t,n)),this):ySt(e)?Y8.get(e):void 0}Rn(JCt,m$e);Rn(KG,g$e,Di);Rn(Hy,x$e,[Di,Hy]);Rn(QG,FG,Di);Rn(ZG,_Ct,Di);Rn(JG,b$e,Di);Rn(eSt,HCt,[Di,I$e]);Rn(tSt,XCt,[Di,I$e]);Rn(Lb,MG,[Di,Yu]);Rn(`${Lb}-${KG}`,MG,[Di,Yu]);Rn(`${Lb}-${Hy}`,k$e,[Di,Yu,Hy]);Rn(`${Lb}-${QG}`,LG,[Di,Yu]);Rn(`${Lb}-${ZG}`,YCt,[Di,Yu]);Rn(`${Lb}-${JG}`,E$e,[Di,Yu]);Rn(`${$k}-${KG}`,A$e,[Di,Yu]);Rn(`${$k}-${Hy}`,_$e,[Di,Yu,Hy]);Rn(`${$k}-${QG}`,PG,[Di,Yu]);Rn(`${$k}-${ZG}`,KCt,[Di,Yu]);Rn(`${$k}-${JG}`,T$e,[Di,Yu]);Rn(Uie,v$e,[yO,Uie]);Rn(nSt,w$e,yO);Rn(rSt,$$e,yO);Rn(aSt,D$e,[mO,yO]);Rn(iSt,AG,mO);Rn(oSt,eH,mO);Rn(sSt,cSt,mO);function ySt(e){return Y8.has(e)}function xSt(e,t,n){return TG(bSt("rgb",n),e)}function bSt(e,t){const n=mCt[vSt(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function vSt(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const wSt={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},$St={accent:Hye,category10:Gye,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:Xye,observable10:Yye,paired:Kye,pastel1:Qye,pastel2:Zye,set1:Jye,set2:exe,set3:txe,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function F$e(e){if(Kwe(e))return e;const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function R$e(e,t){for(const n in e)CSt(n,t(e[n]))}const jie={};R$e($St,F$e);R$e(wSt,e=>xSt(F$e(e)));function CSt(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(jie[e]=t,this):jie[e]}var SSt=Math.random,u5=Math.PI/180,rw=64,kT=2048;function kSt(){var e=[256,256],t,n,r,i,s,o,a,u=O$e,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(op()),m=NSt((e[0]>>5)*e[1]),x=null,b=l.length,v=-1,$=[],C=l.map(A=>({text:t(A),font:n(A),style:i(A),weight:s(A),rotate:o(A),size:~~(r(A)+1e-14),padding:a(A),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:A})).sort((A,E)=>E.size-A.size);++v<b;){var S=C[v];S.x=e[0]*(c()+.5)>>1,S.y=e[1]*(c()+.5)>>1,ESt(p,S,C,v),S.hasText&&h(m,S,x)&&($.push(S),x?_St(x,S):x=[{x:S.x+S.x0,y:S.y+S.y0},{x:S.x+S.x1,y:S.y+S.y1}],S.x-=e[0]>>1,S.y-=e[1]>>1)}return $};function d(p){p.width=p.height=1;var m=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(rw<<5)/m,p.height=kT/m;var x=p.getContext("2d");return x.fillStyle=x.strokeStyle="red",x.textAlign="center",{context:x,ratio:m}}function h(p,m,x){for(var b=m.x,v=m.y,$=Math.hypot(e[0],e[1]),C=u(e),S=c()<.5?1:-1,A=-S,E,_,D;(E=C(A+=S))&&(_=~~E[0],D=~~E[1],!(Math.min(Math.abs(_),Math.abs(D))>=$));)if(m.x=b+_,m.y=v+D,!(m.x+m.x0<0||m.y+m.y0<0||m.x+m.x1>e[0]||m.y+m.y1>e[1])&&(!x||!ASt(m,p,e[0]))&&(!x||TSt(m,x))){for(var N=m.sprite,T=m.width>>5,L=e[0]>>5,O=m.x-(T<<4),M=O&127,R=32-M,P=m.y1-m.y0,j=(m.y+m.y0)*L+(O>>5),z,q=0;q<P;q++){z=0;for(var H=0;H<=T;H++)p[j+H]|=z<<R|(H<T?(z=N[q*T+H])>>>M:0);j+=L}return m.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Yp(p),f):n},f.fontStyle=function(p){return arguments.length?(i=Yp(p),f):i},f.fontWeight=function(p){return arguments.length?(s=Yp(p),f):s},f.rotate=function(p){return arguments.length?(o=Yp(p),f):o},f.text=function(p){return arguments.length?(t=Yp(p),f):t},f.spiral=function(p){return arguments.length?(u=DSt[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=Yp(p),f):r},f.padding=function(p){return arguments.length?(a=Yp(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}function ESt(e,t,n,r){if(!t.sprite){var i=e.context,s=e.ratio;i.clearRect(0,0,(rw<<5)/s,kT/s);var o=0,a=0,u=0,l=n.length,c,f,d,h,p;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=i.measureText(t.text+"m").width*s,d=t.size<<1,t.rotate){var m=Math.sin(t.rotate*u5),x=Math.cos(t.rotate*u5),b=c*x,v=c*m,$=d*x,C=d*m;c=Math.max(Math.abs(b+C),Math.abs(b-C))+31>>5<<5,d=~~Math.max(Math.abs(v+$),Math.abs(v-$))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=rw<<5&&(o=0,a+=u,u=0),a+d>=kT)break;i.translate((o+(c>>1))/s,(a+(d>>1))/s),t.rotate&&i.rotate(t.rotate*u5),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var S=i.getImageData(0,0,(rw<<5)/s,kT/s).data,A=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)A[h]=0;if(o=t.xoff,o==null)return;a=t.yoff;var E=0,_=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var D=f*p+(h>>5),N=S[(a+p)*(rw<<5)+(o+h)<<2]?1<<31-h%32:0;A[D]|=N,E|=N}E?_=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+_,t.sprite=A.slice(0,(t.y1-t.y0)*f)}}}function ASt(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,s=e.x-(i<<4),o=s&127,a=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(s>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<a|(d<i?(c=r[f*i+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function _St(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function TSt(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function O$e(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function ISt(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function NSt(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Yp(e){return typeof e=="function"?e:function(){return e}}var DSt={archimedean:O$e,rectangular:ISt};const M$e=["x","y","font","fontSize","fontStyle","fontWeight","angle"],FSt=["text","font","rotate","fontSize","fontStyle","fontWeight"];function tH(e){xe.call(this,kSt(),e)}tH.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:M$e}]};O$t(tH,xe,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&ST("Wordcloud size dimensions must be non-zero.");function n(p){const m=e[p];return z8(m)&&t.modified(m.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||FSt.some(n)))return;const i=t.materialize(t.SOURCE).source,s=this.value,o=e.as||M$e;let a=e.fontSize||14,u;if(z8(a)?u=e.fontSizeRange:a=D$t(a),u){const p=a,m=Rn("sqrt")().domain(R$t(i,p)).range(u);a=x=>m(p(x))}i.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const l=s.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(SSt).layout(),c=s.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,m,x;p<h;++p)m=l[p],x=m.datum,x[o[0]]=m.x+f,x[o[1]]=m.y+d,x[o[2]]=m.font,x[o[3]]=m.size,x[o[4]]=m.style,x[o[5]]=m.weight,x[o[6]]=m.rotate;return t.reflow(r).modifies(o)}});const RSt=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:tH},Symbol.toStringTag,{value:"Module"})),OSt=e=>new Uint8Array(e),MSt=e=>new Uint16Array(e),Cw=e=>new Uint32Array(e);function LSt(){let e=8,t=[],n=Cw(0),r=i_(0,e),i=i_(0,e);return{data:()=>t,seen:()=>n=PSt(n,t.length),add(s){for(let o=0,a=t.length,u=s.length,l;o<u;++o)l=s[o],l._index=a++,t.push(l)},remove(s,o){const a=t.length,u=Array(a-s),l=t;let c,f,d;for(f=0;!o[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:s=>i[s]=r[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){r[s]|=o},clear(s,o){r[s]&=~o},resize(s,o){const a=r.length;(s>a||o>e)&&(e=Math.max(o,e),r=i_(s,e,r),i=i_(s,e))}}}function PSt(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function i_(e,t,n){const r=(t<257?OSt:t<65537?MSt:Cw)(e);return n&&r.set(n),r}function Wie(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,s){const o=this,a=o.bisect(o.range,i.value),u=i.index,l=a[0],c=a[1],f=u.length;let d;for(d=0;d<l;++d)s[u[d]]|=r;for(d=c;d<f;++d)s[u[d]]|=r;return o}}}function Vie(){let e=Cw(0),t=[],n=0;function r(a,u,l){if(!u.length)return[];const c=n,f=u.length,d=Cw(f);let h=Array(f),p,m,x;for(x=0;x<f;++x)h[x]=a(u[x]),d[x]=x;if(h=BSt(h,d),c)p=t,m=e,t=Array(c+f),e=Cw(c+f),zSt(l,p,m,c,h,d,f,t,e);else{if(l>0)for(x=0;x<f;++x)d[x]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(a,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function s(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function o(a,u){let l;return u?l=u.length:(u=t,l=n),[eot(u,a[0],0,l),Ah(u,a[1],0,l)]}return{insert:r,remove:i,bisect:o,reindex:s,index:()=>e,size:()=>n}}function BSt(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],s=e[r];return i<s?-1:i>s?1:0}),rot(e,t)}function zSt(e,t,n,r,i,s,o,a,u){let l=0,c=0,f;for(f=0;l<r&&c<o;++f)t[l]<i[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=i[c],u[f]=s[c++]+e);for(;l<r;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)a[f]=i[c],u[f]=s[c]+e}function nH(e){xe.call(this,LSt(),e),this._indices=null,this._dims=null}nH.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};ze(nH,xe,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},s=this._dims=[],o=r.length;let a=0,u,l;for(;a<o;++a)u=n[a].fname,l=i[u]||(i[u]=Vie()),s.push(Wie(l,a,r[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,s=this._indices,o=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let m,x,b,v,$,C,S,A,E;if(l.set(u),t.rem.length&&($=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(C={},v=t.mod,S=0,A=v.length;S<A;++S)C[v[S]._index]=1;for(S=0;S<h;++S)E=r[S],(!o[S]||e.modified("fields",S)||t.modified(E.fields))&&(b=E.fname,(m=p[b])||(s[b]=x=Vie(),p[b]=m=x.insert(E,t.source,0)),o[S]=Wie(x,S,i[S]).onAdd(m,u));for(S=0,A=a.data().length;S<A;++S)$[S]||(l[S]!==u[S]?f.push(S):C[S]&&u[S]!==c&&d.push(S));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,s=this._dims,o=this._indices,a=e.fields,u={},l=n.add,c=i.size()+r.length,f=s.length;let d=i.size(),h,p,m;i.resize(c,f),i.add(r);const x=i.curr(),b=i.prev(),v=i.all();for(h=0;h<f;++h)p=a[h].fname,m=u[p]||(u[p]=o[p].insert(a[h],r,d)),s[h].onAdd(m,x);for(;d<c;++d)b[d]=v,x[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),s=r.all(),o=e.mod;let a,u,l;for(a=0,u=o.length;a<u;++a)l=o[a]._index,i[l]!==s&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,s=i.curr(),o=i.prev(),a=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=p=s[h],s[h]=a,p!==a&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const s=i.remove(t,n);for(const o in r)r[o].reindex(s)})},update(e,t,n){const r=this._dims,i=e.query,s=t.stamp,o=r.length;let a=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,a=0;l<o;++l)e.modified("query",l)&&(a|=r[l].one,this.incrementAll(r[l],i[l],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,r){const i=this.value,s=i.seen(),o=i.curr(),a=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],m=e.one;let x,b,v;if(f<h)for(x=f,b=Math.min(h,d);x<b;++x)v=u[x],s[v]!==n&&(a[v]=o[v],s[v]=n,r.push(v)),o[v]^=m;else if(f>h)for(x=h,b=Math.min(f,p);x<b;++x)v=u[x],s[v]!==n&&(a[v]=o[v],s[v]=n,r.push(v)),o[v]^=m;if(d>p)for(x=Math.max(f,p),b=d;x<b;++x)v=u[x],s[v]!==n&&(a[v]=o[v],s[v]=n,r.push(v)),o[v]^=m;else if(d<p)for(x=Math.max(h,d),b=p;x<b;++x)v=u[x],s[v]!==n&&(a[v]=o[v],s[v]=n,r.push(v)),o[v]^=m;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,s=i.curr(),o=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one;let p,m,x;if(l<f)for(p=l,m=Math.min(f,c);p<m;++p)x=o[p],s[x]^=h,n.push(x);else if(l>f)for(p=f,m=Math.min(l,d);p<m;++p)x=o[p],s[x]^=h,r.push(x);if(c>d)for(p=Math.max(l,d),m=c;p<m;++p)x=o[p],s[x]^=h,n.push(x);else if(c<d)for(p=Math.max(f,c),m=d;p<m;++p)x=o[p],s[x]^=h,r.push(x);e.range=t.slice()}});function rH(e){xe.call(this,null,e)}rH.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};ze(rH,xe,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if(!(i&n))return t.StopPropagation;const s=t.fork(t.ALL),o=r.data(),a=r.curr(),u=r.prev(),l=c=>a[c]&n?null:o[c];return s.filter(s.MOD,l),i&i-1?(s.filter(s.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?o[c]:null}),s.filter(s.REM,c=>{const f=a[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(s.filter(s.ADD,l),s.filter(s.REM,c=>(a[c]&n)===i?o[c]:null)),s.filter(s.SOURCE,c=>l(c._index))}});const USt=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:nH,resolvefilter:rH},Symbol.toStringTag,{value:"Module"}));function Pb(e,t,n){return e.fields=t||[],e.fname=n,e}function jSt(e){return e.length===1?WSt(e[0]):VSt(e)}const WSt=e=>function(t){return t[e]},VSt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function ds(e){throw Error(e)}function qSt(e){const t=[],n=e.length;let r=null,i=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=a+1,r=u):u==="."&&!i?a>o?l():o=a+1:u==="["?(a>o&&l(),i=o=a+1):u==="]"&&(i||ds("Access path missing open bracket: "+e),i>0&&l(),i=0,o=a+1)}return i&&ds("Access path missing closing bracket: "+e),r&&ds("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function L$e(e,t,n){const r=qSt(e);return e=r.length===1?r[0]:e,Pb(jSt(r),[e],e)}L$e("id");const iH=Pb(e=>e,[],"identity");Pb(()=>0,[],"zero");Pb(()=>1,[],"one");const P$e=Pb(()=>!0,[],"true");Pb(()=>!1,[],"false");var Of=Array.isArray;function DN(e){return e===Object(e)}function Uh(e){return e[e.length-1]}function sH(e){return e==null||e===""?null:+e}const B$e=e=>t=>e*Math.exp(t),z$e=e=>t=>Math.log(e*t),U$e=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),j$e=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,FN=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function xO(e,t,n,r){const i=n(e[0]),s=n(Uh(e)),o=(s-i)*t;return[r(i-o),r(s-o)]}function GSt(e,t){return xO(e,t,sH,iH)}function HSt(e,t){var n=Math.sign(e[0]);return xO(e,t,z$e(n),B$e(n))}function XSt(e,t,n){return xO(e,t,FN(n),FN(1/n))}function YSt(e,t,n){return xO(e,t,U$e(n),j$e(n))}function bO(e,t,n,r,i){const s=r(e[0]),o=r(Uh(e)),a=t!=null?r(t):(s+o)/2;return[i(a+(s-a)*n),i(a+(o-a)*n)]}function KSt(e,t,n){return bO(e,t,n,sH,iH)}function QSt(e,t,n){const r=Math.sign(e[0]);return bO(e,t,n,z$e(r),B$e(r))}function ZSt(e,t,n,r){return bO(e,t,n,FN(r),FN(1/r))}function JSt(e,t,n,r){return bO(e,t,n,U$e(r),j$e(r))}function ekt(e){return 1+~~(new Date(e).getMonth()/3)}function tkt(e){return 1+~~(new Date(e).getUTCMonth()/3)}function qie(e){return e!=null?Of(e)?e:[e]:[]}function nkt(e,t,n){let r=e[0],i=e[1],s;return i<r&&(s=i,i=r,r=s),s=i-r,s>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-s),r+s]}function RN(e){return typeof e=="function"}function oH(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function rkt(e,t){let n=0,r,i,s,o;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(s=o=i;n<r;++n)i=e[n],i!=null&&(i<s&&(s=i),i>o&&(o=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(s=o=i;n<r;++n)i=t(e[n]),i!=null&&(i<s&&(s=i),i>o&&(o=i))}return[s,o]}const ikt=Object.prototype.hasOwnProperty;function Yd(e,t){return ikt.call(e,t)}function skt(e,t,n,r,i,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],u=Uh(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=o?r:c<=o?i:s}function okt(e,t,n,r){let i=t[0],s=t[t.length-1],o;return i>s&&(o=i,i=s,s=o),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function akt(e){return typeof e=="boolean"}function W$e(e){return Object.prototype.toString.call(e)==="[object Date]"}function V$e(e){return typeof e=="number"}function ukt(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Bb(e){return typeof e=="string"}function lkt(e,t){const n=e[0],r=Uh(e),i=+t;return i?i===1?r:n+i*(r-n):n}function s_(e,t){let n="";for(;--t>=0;)n+=e;return n}function ckt(e,t,n,r){const i=n||" ",s=e+"",o=t-s.length;return o<=0?s:r==="left"?s_(i,o)+s:r==="center"?s_(i,~~(o/2))+s+s_(i,Math.ceil(o/2)):s+s_(i,o)}function fkt(e){return e&&Uh(e)-e[0]||0}function z$(e){return Of(e)?"["+e.map(z$)+"]":DN(e)||Bb(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function dkt(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const hkt=e=>V$e(e)||W$e(e)?e:Date.parse(e);function pkt(e,t){return t=t||hkt,e==null||e===""?null:t(e)}function gkt(e){return e==null||e===""?null:e+""}function Gie(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function mkt(e,t,n,r){const i=r??"…",s=e+"",o=s.length,a=Math.max(0,t-i.length);return o<=t?s:n==="left"?i+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+i+s.slice(o-~~(a/2)):s.slice(0,a)+i}const ykt="RawCode",Xy="Literal",xkt="Property",bkt="Identifier",vkt="ArrayExpression",wkt="BinaryExpression",q$e="CallExpression",$kt="ConditionalExpression",Ckt="LogicalExpression",Skt="MemberExpression",kkt="ObjectExpression",Ekt="UnaryExpression";function Ku(e){this.type=e}Ku.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=Akt(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function Akt(e){switch(e.type){case vkt:return e.elements;case wkt:case Ckt:return[e.left,e.right];case q$e:return[e.callee].concat(e.arguments);case $kt:return[e.test,e.consequent,e.alternate];case Skt:return[e.object,e.property];case kkt:return e.properties;case xkt:return[e.key,e.value];case Ekt:return[e.argument];case bkt:case Xy:case ykt:default:return[]}}var yc,nt,ve,bs,wn,vO=1,Ck=2,Sm=3,mp=4,wO=5,b0=6,po=7,Sk=8,_kt=9;yc={};yc[vO]="Boolean";yc[Ck]="<end>";yc[Sm]="Identifier";yc[mp]="Keyword";yc[wO]="Null";yc[b0]="Numeric";yc[po]="Punctuator";yc[Sk]="String";yc[_kt]="RegularExpression";var Tkt="ArrayExpression",Ikt="BinaryExpression",Nkt="CallExpression",Dkt="ConditionalExpression",G$e="Identifier",Fkt="Literal",Rkt="LogicalExpression",Okt="MemberExpression",Mkt="ObjectExpression",Lkt="Property",Pkt="UnaryExpression",mi="Unexpected token %0",Bkt="Unexpected number",zkt="Unexpected string",Ukt="Unexpected identifier",jkt="Unexpected reserved word",Wkt="Unexpected end of input",K8="Invalid regular expression",l5="Invalid regular expression: missing /",H$e="Octal literals are not allowed in strict mode.",Vkt="Duplicate data property in object literal not allowed in strict mode",zi="ILLEGAL",U$="Disabled.",qkt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Gkt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function $O(e,t){if(!e)throw new Error("ASSERT: "+t)}function Kc(e){return e>=48&&e<=57}function aH(e){return"0123456789abcdefABCDEF".includes(e)}function Sw(e){return"01234567".includes(e)}function Hkt(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function j$(e){return e===10||e===13||e===8232||e===8233}function kk(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&qkt.test(String.fromCharCode(e))}function ON(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Gkt.test(String.fromCharCode(e))}const Xkt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function X$e(){for(;ve<bs;){const e=nt.charCodeAt(ve);if(Hkt(e)||j$(e))++ve;else break}}function Q8(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)ve<bs&&aH(nt[ve])?(r=nt[ve++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):on({},mi,zi);return String.fromCharCode(i)}function Ykt(){var e,t,n,r;for(e=nt[ve],t=0,e==="}"&&on({},mi,zi);ve<bs&&(e=nt[ve++],!!aH(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&on({},mi,zi),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function Y$e(){var e,t;for(e=nt.charCodeAt(ve++),t=String.fromCharCode(e),e===92&&(nt.charCodeAt(ve)!==117&&on({},mi,zi),++ve,e=Q8("u"),(!e||e==="\\"||!kk(e.charCodeAt(0)))&&on({},mi,zi),t=e);ve<bs&&(e=nt.charCodeAt(ve),!!ON(e));)++ve,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),nt.charCodeAt(ve)!==117&&on({},mi,zi),++ve,e=Q8("u"),(!e||e==="\\"||!ON(e.charCodeAt(0)))&&on({},mi,zi),t+=e);return t}function Kkt(){var e,t;for(e=ve++;ve<bs;){if(t=nt.charCodeAt(ve),t===92)return ve=e,Y$e();if(ON(t))++ve;else break}return nt.slice(e,ve)}function Qkt(){var e,t,n;return e=ve,t=nt.charCodeAt(ve)===92?Y$e():Kkt(),t.length===1?n=Sm:Xkt.hasOwnProperty(t)?n=mp:t==="null"?n=wO:t==="true"||t==="false"?n=vO:n=Sm,{type:n,value:t,start:e,end:ve}}function c5(){var e=ve,t=nt.charCodeAt(ve),n,r=nt[ve],i,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ve,{type:po,value:String.fromCharCode(t),start:e,end:ve};default:if(n=nt.charCodeAt(ve+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ve+=2,{type:po,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:ve};case 33:case 61:return ve+=2,nt.charCodeAt(ve)===61&&++ve,{type:po,value:nt.slice(e,ve),start:e,end:ve}}}if(o=nt.substr(ve,4),o===">>>=")return ve+=4,{type:po,value:o,start:e,end:ve};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return ve+=3,{type:po,value:s,start:e,end:ve};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".includes(r)||i==="=>")return ve+=2,{type:po,value:i,start:e,end:ve};if(i==="//"&&on({},mi,zi),"<>=!+-*%&|^/".includes(r))return++ve,{type:po,value:r,start:e,end:ve};on({},mi,zi)}function Zkt(e){let t="";for(;ve<bs&&aH(nt[ve]);)t+=nt[ve++];return t.length===0&&on({},mi,zi),kk(nt.charCodeAt(ve))&&on({},mi,zi),{type:b0,value:parseInt("0x"+t,16),start:e,end:ve}}function Jkt(e){let t="0"+nt[ve++];for(;ve<bs&&Sw(nt[ve]);)t+=nt[ve++];return(kk(nt.charCodeAt(ve))||Kc(nt.charCodeAt(ve)))&&on({},mi,zi),{type:b0,value:parseInt(t,8),octal:!0,start:e,end:ve}}function Hie(){var e,t,n;if(n=nt[ve],$O(Kc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=ve,e="",n!=="."){if(e=nt[ve++],n=nt[ve],e==="0"){if(n==="x"||n==="X")return++ve,Zkt(t);if(Sw(n))return Jkt(t);n&&Kc(n.charCodeAt(0))&&on({},mi,zi)}for(;Kc(nt.charCodeAt(ve));)e+=nt[ve++];n=nt[ve]}if(n==="."){for(e+=nt[ve++];Kc(nt.charCodeAt(ve));)e+=nt[ve++];n=nt[ve]}if(n==="e"||n==="E")if(e+=nt[ve++],n=nt[ve],(n==="+"||n==="-")&&(e+=nt[ve++]),Kc(nt.charCodeAt(ve)))for(;Kc(nt.charCodeAt(ve));)e+=nt[ve++];else on({},mi,zi);return kk(nt.charCodeAt(ve))&&on({},mi,zi),{type:b0,value:parseFloat(e),start:t,end:ve}}function eEt(){var e="",t,n,r,i,s=!1;for(t=nt[ve],$O(t==="'"||t==='"',"String literal must starts with a quote"),n=ve,++ve;ve<bs;)if(r=nt[ve++],r===t){t="";break}else if(r==="\\")if(r=nt[ve++],!r||!j$(r.charCodeAt(0)))switch(r){case"u":case"x":nt[ve]==="{"?(++ve,e+=Ykt()):e+=Q8(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Sw(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),ve<bs&&Sw(nt[ve])&&(s=!0,i=i*8+"01234567".indexOf(nt[ve++]),"0123".includes(r)&&ve<bs&&Sw(nt[ve])&&(i=i*8+"01234567".indexOf(nt[ve++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&nt[ve]===`
`&&++ve;else{if(j$(r.charCodeAt(0)))break;e+=r}return t!==""&&on({},mi,zi),{type:Sk,value:e,octal:s,start:n,end:ve}}function tEt(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";on({},K8)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{on({},K8)}try{return new RegExp(e,t)}catch{return null}}function nEt(){var e,t,n,r,i;for(e=nt[ve],$O(e==="/","Regular expression literal must start with a slash"),t=nt[ve++],n=!1,r=!1;ve<bs;)if(e=nt[ve++],t+=e,e==="\\")e=nt[ve++],j$(e.charCodeAt(0))&&on({},l5),t+=e;else if(j$(e.charCodeAt(0)))on({},l5);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||on({},l5),i=t.substr(1,t.length-2),{value:i,literal:t}}function rEt(){var e,t,n;for(t="",n="";ve<bs&&(e=nt[ve],!!ON(e.charCodeAt(0)));)++ve,e==="\\"&&ve<bs?on({},mi,zi):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&on({},K8,n),{value:n,literal:t}}function iEt(){var e,t,n,r;return wn=null,X$e(),e=ve,t=nEt(),n=rEt(),r=tEt(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:ve}}function sEt(e){return e.type===Sm||e.type===mp||e.type===vO||e.type===wO}function K$e(){if(X$e(),ve>=bs)return{type:Ck,start:ve,end:ve};const e=nt.charCodeAt(ve);return kk(e)?Qkt():e===40||e===41||e===59?c5():e===39||e===34?eEt():e===46?Kc(nt.charCodeAt(ve+1))?Hie():c5():Kc(e)?Hie():c5()}function vo(){const e=wn;return ve=e.end,wn=K$e(),ve=e.end,e}function Q$e(){const e=ve;wn=K$e(),ve=e}function oEt(e){const t=new Ku(Tkt);return t.elements=e,t}function Xie(e,t,n){const r=new Ku(e==="||"||e==="&&"?Rkt:Ikt);return r.operator=e,r.left=t,r.right=n,r}function aEt(e,t){const n=new Ku(Nkt);return n.callee=e,n.arguments=t,n}function uEt(e,t,n){const r=new Ku(Dkt);return r.test=e,r.consequent=t,r.alternate=n,r}function uH(e){const t=new Ku(G$e);return t.name=e,t}function iw(e){const t=new Ku(Fkt);return t.value=e.value,t.raw=nt.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Yie(e,t,n){const r=new Ku(Okt);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function lEt(e){const t=new Ku(Mkt);return t.properties=e,t}function Kie(e,t,n){const r=new Ku(Lkt);return r.key=t,r.value=n,r.kind=e,r}function cEt(e,t){const n=new Ku(Pkt);return n.operator=e,n.argument=t,n.prefix=!0,n}function on(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(s,o)=>($O(o<r.length,"Message reference must be in range"),r[o]));throw n=new Error(i),n.index=ve,n.description=i,n}function CO(e){e.type===Ck&&on(e,Wkt),e.type===b0&&on(e,Bkt),e.type===Sk&&on(e,zkt),e.type===Sm&&on(e,Ukt),e.type===mp&&on(e,jkt),on(e,mi,e.value)}function vs(e){const t=vo();(t.type!==po||t.value!==e)&&CO(t)}function jn(e){return wn.type===po&&wn.value===e}function f5(e){return wn.type===mp&&wn.value===e}function fEt(){const e=[];for(ve=wn.start,vs("[");!jn("]");)jn(",")?(vo(),e.push(null)):(e.push(km()),jn("]")||vs(","));return vo(),oEt(e)}function Qie(){ve=wn.start;const e=vo();return e.type===Sk||e.type===b0?(e.octal&&on(e,H$e),iw(e)):uH(e.value)}function dEt(){var e,t,n,r;if(ve=wn.start,e=wn,e.type===Sm)return n=Qie(),vs(":"),r=km(),Kie("init",n,r);if(e.type===Ck||e.type===po)CO(e);else return t=Qie(),vs(":"),r=km(),Kie("init",t,r)}function hEt(){var e=[],t,n,r,i={},s=String;for(ve=wn.start,vs("{");!jn("}");)t=dEt(),t.key.type===G$e?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?on({},Vkt):i[r]=!0,e.push(t),jn("}")||vs(",");return vs("}"),lEt(e)}function pEt(){vs("(");const e=lH();return vs(")"),e}const gEt={if:1};function mEt(){var e,t,n;if(jn("("))return pEt();if(jn("["))return fEt();if(jn("{"))return hEt();if(e=wn.type,ve=wn.start,e===Sm||gEt[wn.value])n=uH(vo().value);else if(e===Sk||e===b0)wn.octal&&on(wn,H$e),n=iw(vo());else{if(e===mp)throw new Error(U$);e===vO?(t=vo(),t.value=t.value==="true",n=iw(t)):e===wO?(t=vo(),t.value=null,n=iw(t)):jn("/")||jn("/=")?(n=iw(iEt()),Q$e()):CO(vo())}return n}function yEt(){const e=[];if(vs("("),!jn(")"))for(;ve<bs&&(e.push(km()),!jn(")"));)vs(",");return vs(")"),e}function xEt(){ve=wn.start;const e=vo();return sEt(e)||CO(e),uH(e.value)}function bEt(){return vs("."),xEt()}function vEt(){vs("[");const e=lH();return vs("]"),e}function wEt(){var e,t,n;for(e=mEt();;)if(jn("."))n=bEt(),e=Yie(".",e,n);else if(jn("("))t=yEt(),e=aEt(e,t);else if(jn("["))n=vEt(),e=Yie("[",e,n);else break;return e}function Zie(){const e=wEt();if(wn.type===po&&(jn("++")||jn("--")))throw new Error(U$);return e}function ET(){var e,t;if(wn.type!==po&&wn.type!==mp)t=Zie();else{if(jn("++")||jn("--"))throw new Error(U$);if(jn("+")||jn("-")||jn("~")||jn("!"))e=vo(),t=ET(),t=cEt(e.value,t);else{if(f5("delete")||f5("void")||f5("typeof"))throw new Error(U$);t=Zie()}}return t}function Jie(e){let t=0;if(e.type!==po&&e.type!==mp)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function $Et(){var e,t,n,r,i,s,o,a,u,l;if(e=wn,u=ET(),r=wn,i=Jie(r),i===0)return u;for(r.prec=i,vo(),t=[e,wn],o=ET(),s=[u,r,o];(i=Jie(wn))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=Xie(a,u,o),s.push(n);r=vo(),r.prec=i,s.push(r),t.push(wn),n=ET(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=Xie(s[l-1].value,s[l-2],n),l-=2;return n}function km(){var e,t,n;return e=$Et(),jn("?")&&(vo(),t=km(),vs(":"),n=km(),e=uEt(e,t,n)),e}function lH(){const e=km();if(jn(","))throw new Error(U$);return e}function CEt(e){nt=e,ve=0,bs=nt.length,wn=null,Q$e();const t=lH();if(wn.type!==Ck)throw new Error("Unexpect token after expression.");return t}var Z$e={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function J$e(e){function t(o,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,u){return l=>t(o,l,a,u)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&ds("Missing arguments to clamp function."),o.length>3&&ds("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&ds("Missing arguments to if function."),o.length>3&&ds("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function SEt(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function kEt(e){e=e||{};const t=e.allowed?Gie(e.allowed):{},n=e.forbidden?Gie(e.forbidden):{},r=e.constants||Z$e,i=(e.functions||J$e)(f),s=e.globalvar,o=e.fieldvar,a=RN(s)?s:p=>`${s}["${p}"]`;let u={},l={},c=0;function f(p){if(Bb(p))return p;const m=d[p.type];return m==null&&ds("Unsupported type: "+p.type),m(p)}const d={Literal:p=>p.raw,Identifier:p=>{const m=p.name;return c>0?m:Yd(n,m)?ds("Illegal identifier: "+m):Yd(r,m)?r[m]:Yd(t,m)?m:(u[m]=1,a(m))},MemberExpression:p=>{const m=!p.computed,x=f(p.object);m&&(c+=1);const b=f(p.property);return x===o&&(l[SEt(b)]=1),m&&(c-=1),x+(m?"."+b:"["+b+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&ds("Illegal callee type: "+p.callee.type);const m=p.callee.name,x=p.arguments,b=Yd(i,m)&&i[m];return b||ds("Unrecognized function: "+m),RN(b)?b(x):b+"("+x.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const m=f(p.key);return c-=1,m+":"+f(p.value)}};function h(p){const m={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},m}return h.functions=i,h.constants=r,h}function d5(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function EEt(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function AEt(e){let t,n,r;e.length!==2?(t=d5,n=(a,u)=>d5(e(a),u),r=(a,u)=>e(a)-u):(t=e===d5||e===EEt?e:_Et,n=e,r=e);function i(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){const f=i(a,u,l,c-1);return f>l&&r(a[f-1],u)>-r(a[f],u)?f-1:f}return{left:i,center:o,right:s}}function _Et(){return 0}function TEt(e,...t){e=new yI(e),t=t.map(IEt);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function IEt(e){return e instanceof yI?e:new yI(e)}function NEt(...e){const t=new yI;for(const n of e)for(const r of n)t.add(r);return t}function zb(e,t,n){return e.fields=t||[],e.fname=n,e}function DEt(e){return e.length===1?FEt(e[0]):REt(e)}const FEt=e=>function(t){return t[e]},REt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function AT(e){throw Error(e)}function OEt(e){const t=[],n=e.length;let r=null,i=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=a+1,r=u):u==="."&&!i?a>o?l():o=a+1:u==="["?(a>o&&l(),i=o=a+1):u==="]"&&(i||AT("Access path missing open bracket: "+e),i>0&&l(),i=0,o=a+1)}return i&&AT("Access path missing closing bracket: "+e),r&&AT("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function cH(e,t,n){const r=OEt(e);return e=r.length===1?r[0]:e,zb(DEt(r),[e],e)}cH("id");zb(e=>e,[],"identity");zb(()=>0,[],"zero");zb(()=>1,[],"one");zb(()=>!0,[],"true");zb(()=>!1,[],"false");var Z8=Array.isArray;function MEt(e){return e[e.length-1]}function Dg(e){return e==null||e===""?null:+e}function ese(e){return e!=null?Z8(e)?e:[e]:[]}function LEt(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}const PEt=Object.prototype.hasOwnProperty;function tse(e,t){return PEt.call(e,t)}function o_(e,t,n,r){let i=t[0],s=t[t.length-1],o;return i>s&&(o=i,i=s,s=o),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=s:e<s)}function h5(e){return Object.prototype.toString.call(e)==="[object Date]"}const BEt="Literal";var xc,zEt=1,UEt=2,jEt=3,WEt=4,VEt=5,qEt=6,GEt=7,HEt=8,XEt=9;xc={};xc[zEt]="Boolean";xc[UEt]="<end>";xc[jEt]="Identifier";xc[WEt]="Keyword";xc[VEt]="Null";xc[qEt]="Numeric";xc[GEt]="Punctuator";xc[HEt]="String";xc[XEt]="RegularExpression";const nse=Symbol("vega_selection_getter");function eCe(e){return(!e.getter||!e.getter[nse])&&(e.getter=cH(e.field),e.getter[nse]=!0),e.getter}const fH="intersect",rse="union",YEt="vlMulti",KEt="vlPoint",ise="or",QEt="and",bl="_vgsid_",W$=cH(bl),ZEt="E",JEt="R",eAt="R-E",tAt="R-LE",nAt="R-RE",MN="index:unit";function sse(e,t){for(var n=t.fields,r=t.values,i=n.length,s=0,o,a;s<i;++s)if(a=n[s],o=eCe(a)(e),h5(o)&&(o=Dg(o)),h5(r[s])&&(r[s]=Dg(r[s])),Z8(r[s])&&h5(r[s][0])&&(r[s]=r[s].map(Dg)),a.type===ZEt){if(Z8(r[s])?r[s].indexOf(o)<0:o!==r[s])return!1}else if(a.type===JEt){if(!o_(o,r[s]))return!1}else if(a.type===nAt){if(!o_(o,r[s],!0,!1))return!1}else if(a.type===eAt){if(!o_(o,r[s],!1,!1))return!1}else if(a.type===tAt&&!o_(o,r[s],!1,!0))return!1;return!0}function rAt(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],s=r?r[MN]&&r[MN].value:void 0,o=n===fH,a=i.length,u=0,l,c,f,d,h;u<a;++u)if(l=i[u],s&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=sse(t,l),c[d]=h?-1:++f,h&&s.size===1)return!0;if(!h&&f===s.get(d).count)return!1}else if(h=sse(t,l),o^h)return h;return a&&o}const tCe=AEt(W$),iAt=tCe.left,sAt=tCe.right;function oAt(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],s=r?r[MN]&&r[MN].value:void 0,o=n===fH,a=W$(t),u=iAt(i,a);if(u===i.length||W$(i[u])!==a)return!1;if(s&&o){if(s.size===1)return!0;if(sAt(i,a)-u<s.size)return!1}return!0}function aAt(e,t){return e.map(n=>LEt(t.fields?{values:t.fields.map(r=>eCe(r)(n.datum))}:{[bl]:W$(n.datum)},t))}function uAt(e,t,n,r){for(var i=this.context.data[e],s=i?i.values.value:[],o={},a={},u={},l,c,f,d,h,p,m,x,b,v,$=s.length,C=0,S,A;C<$;++C)if(l=s[C],d=l.unit,c=l.fields,f=l.values,c&&f){for(S=0,A=c.length;S<A;++S)h=c[S],m=o[h.field]||(o[h.field]={}),x=m[d]||(m[d]=[]),u[h.field]=b=h.type.charAt(0),v=p5[`${b}_union`],m[d]=v(x,ese(f[S]));n&&(x=a[d]||(a[d]=[]),x.push(ese(f).reduce((E,_,D)=>(E[c[D].field]=_,E),{})))}else h=bl,p=W$(l),m=o[h]||(o[h]={}),x=m[d]||(m[d]=[]),x.push(p),n&&(x=a[d]||(a[d]=[]),x.push({[bl]:p}));if(t=t||rse,o[bl]?o[bl]=p5[`${bl}_${t}`](...Object.values(o[bl])):Object.keys(o).forEach(E=>{o[E]=Object.keys(o[E]).map(_=>o[E][_]).reduce((_,D)=>_===void 0?D:p5[`${u[E]}_${t}`](_,D))}),s=Object.keys(a),n&&s.length){const E=r?KEt:YEt;o[E]=t===rse?{[ise]:s.reduce((_,D)=>(_.push(...a[D]),_),[])}:{[QEt]:s.map(_=>({[ise]:a[_]}))}}return o}var p5={[`${bl}_union`]:NEt,[`${bl}_intersect`]:TEt,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Dg(t[0]),r=Dg(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Dg(t[0]),r=Dg(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const lAt=":",cAt="@";function dH(e,t,n,r){t[0].type!==BEt&&AT("First argument to selection functions must be a string literal.");const i=t[0].value,s=t.length>=2&&MEt(t).value,o="unit",a=cAt+o,u=lAt+i;s===fH&&!tse(r,a)&&(r[a]=n.getData(i).indataRef(n,o)),tse(r,u)||(r[u]=n.getData(i).tuplesRef())}function nCe(e){const t=this.context.data[e];return t?t.values.value:[]}function fAt(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function dAt(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(P$e).insert(t)),1}function hAt(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const Ek=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},pAt=Ek("format"),rCe=Ek("timeFormat"),gAt=Ek("utcFormat"),mAt=Ek("timeParse"),yAt=Ek("utcParse"),a_=new Date(2e3,0,1);function SO(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(a_.setYear(2e3),a_.setMonth(e),a_.setDate(t),rCe.call(this,a_,n))}function xAt(e){return SO.call(this,e,1,"%B")}function bAt(e){return SO.call(this,e,1,"%b")}function vAt(e){return SO.call(this,0,2+e,"%A")}function wAt(e){return SO.call(this,0,2+e,"%a")}const $At=":",CAt="@",J8="%",iCe="$";function hH(e,t,n,r){t[0].type!==Xy&&ds("First argument to data functions must be a string literal.");const i=t[0].value,s=$At+i;if(!Yd(s,r))try{r[s]=n.getData(i).tuplesRef()}catch{}}function SAt(e,t,n,r){t[0].type!==Xy&&ds("First argument to indata must be a string literal."),t[1].type!==Xy&&ds("Second argument to indata must be a string literal.");const i=t[0].value,s=t[1].value,o=CAt+s;Yd(o,r)||(r[o]=n.getData(i).indataRef(n,s))}function Ao(e,t,n,r){if(t[0].type===Xy)ose(n,r,t[0].value);else for(e in n.scales)ose(n,r,e)}function ose(e,t,n){const r=J8+n;if(!Yd(t,r))try{t[r]=e.scaleRef(n)}catch{}}function Gf(e,t){let n;return RN(e)?e:Bb(e)?(n=t.scales[e])&&n.value:void 0}function kAt(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=Ao,n._range=Ao,n._scale=Ao;const r=i=>"_["+(i.type===Xy?z$(J8+i.value):z$(J8)+"+"+e(i))+"]";return{_bandwidth:i=>`this.__bandwidth(${r(i[0])})`,_range:i=>`${r(i[0])}.range()`,_scale:i=>`${r(i[0])}(${e(i[1])})`}}function pH(e,t){return function(n,r,i){if(n){const s=Gf(n,(i||this).context);return s&&s.path[e](r)}else return t(r)}}const EAt=pH("area",m0t),AAt=pH("bounds",v0t),_At=pH("centroid",E0t);function TAt(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function gH(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function IAt(){return gH(this.context.dataflow,"warn",arguments)}function NAt(){return gH(this.context.dataflow,"info",arguments)}function DAt(){return gH(this.context.dataflow,"debug",arguments)}function g5(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function e7(e){const t=Ro(e),n=g5(t.r),r=g5(t.g),i=g5(t.b);return .2126*n+.7152*r+.0722*i}function FAt(e,t){const n=e7(e),r=e7(t),i=Math.max(n,r),s=Math.min(n,r);return(i+.05)/(s+.05)}function RAt(){const e=[].slice.call(arguments);return e.unshift({}),oH(...e)}function sCe(e,t){return e===t||e!==e&&t!==t?!0:Of(e)?Of(t)&&e.length===t.length?OAt(e,t):!1:DN(e)&&DN(t)?oCe(e,t):!1}function OAt(e,t){for(let n=0,r=e.length;n<r;++n)if(!sCe(e[n],t[n]))return!1;return!0}function oCe(e,t){for(const n in e)if(!sCe(e[n],t[n]))return!1;return!0}function ase(e){return t=>oCe(e,t)}function MAt(e,t,n,r,i,s){const o=this.context.dataflow,a=this.context.data[e],u=a.input,l=o.stamp();let c=a.changes,f,d;if(o._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(a.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{a.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?P$e:Of(n)||q3(n)?n:ase(n),c.remove(f)),t&&c.insert(t),r&&(f=ase(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in s)c.modify(i,d,s[d]);return 1}function LAt(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function PAt(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const use={};function BAt(e,t){const n=use[t]||(use[t]=L$e(t));return Of(e)?e.map(n):n(e)}function mH(e){return Of(e)||ArrayBuffer.isView(e)?e:null}function yH(e){return mH(e)||(Bb(e)?e:null)}function zAt(e,...t){return mH(e).join(...t)}function UAt(e,...t){return yH(e).indexOf(...t)}function jAt(e,...t){return yH(e).lastIndexOf(...t)}function WAt(e,...t){return yH(e).slice(...t)}function VAt(e,t,n){return RN(n)&&ds("Function argument passed to replace."),String(e).replace(t,n)}function qAt(e){return mH(e).slice().reverse()}function GAt(e,t,n){return VV(e||0,t||0,n||0)}function HAt(e,t){const n=Gf(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function XAt(e,t){const n=Gf(e,(t||this).context);return n?n.copy():void 0}function YAt(e,t){const n=Gf(e,(t||this).context);return n?n.domain():[]}function KAt(e,t,n){const r=Gf(e,(n||this).context);return r?Of(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function QAt(e,t){const n=Gf(e,(t||this).context);return n&&n.range?n.range():[]}function ZAt(e,t,n){const r=Gf(e,(n||this).context);return r?r(t):void 0}function JAt(e,t,n,r,i){e=Gf(e,(i||this).context);const s=Z2e(t,n);let o=e.domain(),a=o[0],u=Uh(o),l=iH;return u-a?l=Mbe(e,a,u):e=(e.interpolator?hn("sequential")().interpolator(e.interpolator()):hn("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(o=e.ticks(+r||15),a!==o[0]&&o.unshift(a),u!==Uh(o)&&o.push(u)),o.forEach(c=>s.stop(l(c),e(c))),s}function e_t(e,t,n){const r=Gf(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function t_t(e){let t=null;return function(n){return n?F$(n,t=t||jy(e)):e}}const aCe=e=>e.data;function uCe(e,t){const n=nCe.call(t,e);return n.root&&n.root.lookup||{}}function n_t(e,t,n){const r=uCe(e,this),i=r[t],s=r[n];return i&&s?i.path(s).map(aCe):void 0}function r_t(e,t){const n=uCe(e,this)[t];return n?n.ancestors().map(aCe):void 0}const lCe=()=>typeof window<"u"&&window||null;function i_t(){const e=lCe();return e?e.screen:{}}function s_t(){const e=lCe();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function o_t(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function a_t(e,t,n){if(!e)return[];const[r,i]=e,s=new Qs().set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return jwe(o,s,u_t(t))}function u_t(e){let t=null;if(e){const n=qie(e.marktype),r=qie(e.markname);t=i=>(!n.length||n.some(s=>i.marktype===s))&&(!r.length||r.some(s=>i.name===s))}return t}const V$={random(){return Uu()},cumulativeNormal:K3,cumulativeLogNormal:Lj,cumulativeUniform:Uj,densityNormal:Dj,densityLogNormal:Mj,densityUniform:zj,quantileNormal:Q3,quantileLogNormal:Pj,quantileUniform:jj,sampleNormal:Y3,sampleLogNormal:Oj,sampleUniform:Bj,isArray:Of,isBoolean:akt,isDate:W$e,isDefined(e){return e!==void 0},isNumber:V$e,isObject:DN,isRegExp:ukt,isString:Bb,isTuple:q3,isValid(e){return e!=null&&e===e},toBoolean:dkt,toDate:pkt,toNumber:sH,toString:gkt,indexof:UAt,join:zAt,lastindexof:jAt,replace:VAt,reverse:qAt,slice:WAt,flush:skt,lerp:lkt,merge:RAt,pad:ckt,peek:Uh,pluck:BAt,span:fkt,inrange:okt,truncate:mkt,rgb:Ro,lab:Dh,hcl:Fh,hsl:Nh,luminance:e7,contrast:FAt,sequence:ta,format:pAt,utcFormat:gAt,utcParse:yAt,utcOffset:H0e,utcSequence:K0e,timeFormat:rCe,timeParse:mAt,timeOffset:G0e,timeSequence:Y0e,timeUnitSpecifier:O0e,monthFormat:xAt,monthAbbrevFormat:bAt,dayFormat:vAt,dayAbbrevFormat:wAt,quarter:ekt,utcquarter:tkt,week:L0e,utcweek:z0e,dayofyear:M0e,utcdayofyear:B0e,warn:IAt,info:NAt,debug:DAt,extent:rkt,inScope:TAt,intersect:a_t,clampRange:nkt,pinchDistance:LAt,pinchAngle:PAt,screen:i_t,containerSize:o_t,windowSize:s_t,bandspace:GAt,setdata:dAt,pathShape:t_t,panLinear:GSt,panLog:HSt,panPow:XSt,panSymlog:YSt,zoomLinear:KSt,zoomLog:QSt,zoomPow:ZSt,zoomSymlog:JSt,encode:hAt,modify:MAt},l_t=["view","item","group","xy","x","y"],c_t="event.vega.",cCe="this.",xH={},fCe={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${z$(iCe+e)}]`,functions:f_t,constants:Z$e,visitors:xH},dCe=kEt(fCe);function f_t(e){const t=J$e(e);l_t.forEach(n=>t[n]=c_t+n);for(const n in V$)t[n]=cCe+n;return oH(t,kAt(e,V$,xH)),t}function Br(e,t,n){return arguments.length===1?V$[e]:(V$[e]=t,n&&(xH[e]=n),dCe.functions[e]=cCe+e,this)}Br("bandwidth",HAt,Ao);Br("copy",XAt,Ao);Br("domain",YAt,Ao);Br("range",QAt,Ao);Br("invert",KAt,Ao);Br("scale",ZAt,Ao);Br("gradient",JAt,Ao);Br("geoArea",EAt,Ao);Br("geoBounds",AAt,Ao);Br("geoCentroid",_At,Ao);Br("geoShape",e_t,Ao);Br("indata",fAt,SAt);Br("data",nCe,hH);Br("treePath",n_t,hH);Br("treeAncestors",r_t,hH);Br("vlSelectionTest",rAt,dH);Br("vlSelectionIdTest",oAt,dH);Br("vlSelectionResolve",uAt,dH);Br("vlSelectionTuples",aAt);function nc(e,t){const n={};let r;try{e=Bb(e)?e:z$(e)+"",r=CEt(e)}catch{ds("Expression parse error: "+e)}r.visit(s=>{if(s.type!==q$e)return;const o=s.callee.name,a=fCe.visitors[o];a&&a(o,s.arguments,t,n)});const i=dCe(r);return i.globals.forEach(s=>{const o=iCe+s;!Yd(n,o)&&t.getSignal(s)&&(n[o]=t.signalRef(s))}),{$expr:oH({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function bc(e,t,n){return e.fields=t||[],e.fname=n,e}function d_t(e){return e==null?null:e.fields}function hCe(e){return e.length===1?h_t(e[0]):p_t(e)}const h_t=e=>function(t){return t[e]},p_t=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Gg(e){throw Error(e)}function pCe(e){const t=[],n=e.length;let r=null,i=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=a+1,r=u):u==="."&&!i?a>o?l():o=a+1:u==="["?(a>o&&l(),i=o=a+1):u==="]"&&(i||Gg("Access path missing open bracket: "+e),i>0&&l(),i=0,o=a+1)}return i&&Gg("Access path missing closing bracket: "+e),r&&Gg("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function bH(e,t,n){const r=pCe(e);return e=r.length===1?r[0]:e,bc((n&&n.get||hCe)(r),[e],t||e)}bH("id");bc(e=>e,[],"identity");bc(()=>0,[],"zero");bc(()=>1,[],"one");const g_t=bc(()=>!0,[],"true");bc(()=>!1,[],"false");var vH=Array.isArray;function wH(e){return e===Object(e)}function q$(e){return e!=null?vH(e)?e:[e]:[]}function m_t(e){return typeof e=="function"}const y_t="descending";function x_t(e,t,n){n=n||{},t=q$(t)||[];const r=[],i=[],s={},o=n.comparator||b_t;return q$(e).forEach((a,u)=>{a!=null&&(r.push(t[u]===y_t?-1:1),i.push(a=m_t(a)?a:bH(a,null,n)),(d_t(a)||[]).forEach(l=>s[l]=1))}),i.length===0?null:bc(o(i,r),Object.keys(s))}const gCe=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),b_t=(e,t)=>e.length===1?v_t(e[0],t[0]):w_t(e,t,e.length),v_t=(e,t)=>function(n,r){return gCe(e(n),e(r))*t},w_t=(e,t,n)=>(t.push(0),function(r,i){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=gCe(s(r),s(i));return o*t[a]}),$_t=Object.prototype.hasOwnProperty;function C_t(e,t){return $_t.call(e,t)}function S_t(e){return typeof e=="string"}function k_t(e,t,n){e&&(e=t?q$(e).map(a=>a.replace(/\\(.)/g,"$1")):q$(e));const r=e&&e.length,i=n&&n.get||hCe,s=a=>i(t?[a]:pCe(a));let o;if(!r)o=function(){return""};else if(r===1){const a=s(e[0]);o=function(u){return""+a(u)}}else{const a=e.map(s);o=function(u){let l=""+a[0](u),c=0;for(;++c<r;)l+="|"+a[c](u);return l}}return bc(o,e,"key")}function t7(e){return vH(e)?"["+e.map(t7)+"]":wH(e)||S_t(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function mCe(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function E_t(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const A_t=mCe(["rule"]),lse=mCe(["group","image","rect"]);function __t(e,t){let n="";return A_t[t]||(e.x2&&(e.x?(lse[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(lse[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function $H(e){return(e+"").toLowerCase()}function T_t(e){return $H(e)==="operator"}function I_t(e){return $H(e)==="collect"}function m2(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function N_t(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `}var D_t={operator:(e,t)=>m2(e,["_"],t.code),parameter:(e,t)=>m2(e,["datum","_"],t.code),event:(e,t)=>m2(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return m2(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const s in r){const o="o["+t7(s)+"]";i+=`$=${r[s].code};if(${o}!==$)${o}=$,m=1;`}return i+=__t(r,n),i+="return m;",m2(e,["item","_"],i)},codegen:{get(e){const t=`[${e.map(t7).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const r=(s,o)=>{const a=t[o];let u,l;return s.path?(u=`a${s.path}`,l=`b${s.path}`):((n=n||{})["f"+o]=s,u=`this.f${o}(a)`,l=`this.f${o}(b)`),N_t(u,l,-a,a)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function F_t(e){const t=this;T_t(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function R_t(e){const t=this;if(e.params){const n=t.get(e.id);n||Gg("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function O_t(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=vH(i)?i.map(s=>cse(s,n,t)):cse(i,n,t)}return t}function cse(e,t,n){if(!e||!wH(e))return e;for(let r=0,i=fse.length,s;r<i;++r)if(s=fse[r],C_t(e,s.key))return s.parse(e,t,n);return e}var fse=[{key:"$ref",parse:M_t},{key:"$key",parse:P_t},{key:"$expr",parse:L_t},{key:"$field",parse:B_t},{key:"$encode",parse:U_t},{key:"$compare",parse:z_t},{key:"$context",parse:j_t},{key:"$subflow",parse:W_t},{key:"$tupleid",parse:V_t}];function M_t(e,t){return t.get(e.$ref)||Gg("Operator not defined: "+e.$ref)}function L_t(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=bc(t.parameterExpression(e.$expr),e.$fields))}function P_t(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=k_t(e.$key,e.$flat,t.expr.codegen))}function B_t(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=bH(e.$field,e.$name,t.expr.codegen))}function z_t(e,t){const n="c:"+e.$compare+"_"+e.$order,r=q$(e.$compare).map(i=>i&&i.$tupleid?dt:i);return t.fn[n]||(t.fn[n]=x_t(r,e.$order,t.expr.codegen))}function U_t(e,t){const n=e.$encode,r={};for(const i in n){const s=n[i];r[i]=bc(t.encodeExpression(s.$expr),s.$fields),r[i].output=s.$output}return r}function j_t(e,t){return t}function W_t(e,t){const n=e.$subflow;return function(r,i,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(s),a.detachSubflow=()=>t.detach(o),a}}function V_t(){return dt}function q_t(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(s=>t.get(s)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(s=>t.get(s)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&Gg("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function G_t(e){var t=this,n=wH(n=e.source)?n.$ref:n,r=t.get(n),i=null,s=e.update,o=void 0;r||Gg("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,r,i,s,o)}const H_t={skip:!0};function X_t(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(r[s]=o.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(i[s]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function Y_t(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(s=>{n.update(t.signals[s],i[s],H_t)}),Object.keys(r||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(g_t).insert(r[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}function yCe(e,t,n,r){return new xCe(e,t,n,r)}function xCe(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||D_t,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function dse(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}xCe.prototype=dse.prototype={fork(){const e=new dse(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),I_t(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(r.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),r.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[$H(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:E_t,parseOperator:F_t,parseOperatorParameters:R_t,parseParameters:O_t,parseStream:q_t,parseUpdate:G_t,getState:X_t,setState:Y_t};function K_t(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),bCe(t,e.description()))}function bCe(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Q_t(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const m5="default";function Z_t(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:m5,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,s=i?Hn(i)?i:i.user:m5,o=r.item&&r.item.cursor||null;return i&&s===i.user&&o==i.item?i:{user:s,item:o}}),e.add(null,function(n){let r=n.cursor,i=this.value;return Hn(r)||(i=r.item,r=r.user),n7(e,r&&r!==m5?r:i||r),i},{cursor:t})}function n7(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function LN(e,t){var n=e._runtime.data;return Nt(n,t)||ke("Unrecognized data set: "+t),n[t]}function J_t(e,t){return arguments.length<2?LN(this,e).values.value:kO.call(this,e,t0().remove(xb).insert(t))}function kO(e,t){u0e(t)||ke("Second argument to changes must be a changeset.");const n=LN(this,e);return n.modified=!0,this.pulse(n.input,t)}function eTt(e,t){return kO.call(this,e,t0().insert(t))}function tTt(e,t){return kO.call(this,e,t0().remove(t))}function vCe(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function wCe(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function EO(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function nTt(e){var t=EO(e),n=vCe(e),r=wCe(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(s){e.error(s)}})}function rTt(e,t,n){var r=e._renderer,i=r&&r.canvas(),s,o,a;return i&&(a=EO(e),o=t.changedTouches?t.changedTouches[0]:t,s=nO(o,i),s[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=iTt(e,n,s),t}function iTt(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(o){var a=r,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;Hn(o)&&(o=i(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:Ua(e),item:Ua(t||{}),group:i,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}const hse="view",sTt="timer",oTt="window",aTt={trap:!1};function uTt(e){const t=qt({defaults:{}},e),n=(r,i)=>{i.forEach(s=>{Rt(r[s])&&(r[s]=Tf(r[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function $Ce(e,t,n,r){e._eventListeners.push({type:n,sources:It(t),handler:r})}function lTt(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function u_(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||Wt(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function cTt(e,t,n){var r=this,i=new X3(n),s=function(l,c){r.runAsync(null,()=>{e===hse&&lTt(r,t)&&l.preventDefault(),i.receive(rTt(r,l,c))})},o;if(e===sTt)u_(r,"timer",t)&&r.timer(s,t);else if(e===hse)u_(r,"view",t)&&r.addEventListener(t,s,aTt);else if(e===oTt?u_(r,"window",t)&&typeof window<"u"&&(o=[window]):typeof document<"u"&&u_(r,"selector",t)&&(o=document.querySelectorAll(e)),!o)r.warn("Can not resolve event source: "+e);else{for(var a=0,u=o.length;a<u;++a)o[a].addEventListener(t,s);$Ce(r,o,t,s)}return i}function pse(e){return e.item}function gse(e){return e.item.mark.source}function mse(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function fTt(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",pse),gse,mse(e)),this.on(this.events("view","mouseout",pse),gse,mse(t)),this}function dTt(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,s;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(s=n[r],i=s.sources.length;--i>=0;)s.sources[i].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this}function na(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const hTt="vega-bind",pTt="vega-bind-name",gTt="vega-bind-radio";function mTt(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,o)})}},r.debounce&&(i.update=gme(r.debounce,i.update))),(r.input==null&&r.element?yTt:bTt)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function yTt(e,t,n,r){const i=n.event||"input",s=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,s),$Ce(r,t,i,s),e.set=o=>{t.value=o,t.dispatchEvent(xTt(i))}}function xTt(e){return typeof Event<"u"?new Event(e):{type:e}}function bTt(e,t,n,r){const i=r.signal(n.signal),s=na("div",{class:hTt}),o=n.input==="radio"?s:s.appendChild(na("label"));o.appendChild(na("span",{class:pTt},n.name||n.signal)),t.appendChild(s);let a=vTt;switch(n.input){case"checkbox":a=wTt;break;case"select":a=$Tt;break;case"radio":a=CTt;break;case"range":a=STt;break}a(e,o,n,i)}function vTt(e,t,n,r){const i=na("input");for(const s in n)s!=="signal"&&s!=="element"&&i.setAttribute(s==="input"?"type":s,n[s]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=s=>i.value=s}function wTt(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const s=na("input",i);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function $Tt(e,t,n,r){const i=na("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const u={value:o};PN(o,r)&&(u.selected=!0),i.appendChild(na("option",u,(s[a]||o)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=o=>{for(let a=0,u=n.options.length;a<u;++a)if(PN(n.options[a],o)){i.selectedIndex=a;return}}}function CTt(e,t,n,r){const i=na("span",{class:gTt}),s=n.labels||[];t.appendChild(i),e.elements=n.options.map((o,a)=>{const u={type:"radio",name:n.signal,value:o};PN(o,r)&&(u.checked=!0);const l=na("input",u);l.addEventListener("change",()=>e.update(o));const c=na("label",{},(s[a]||o)+"");return c.prepend(l),i.appendChild(c),l}),e.set=o=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)PN(a[l].value,o)&&(a[l].checked=!0)}}function STt(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,s=n.min||Math.min(0,i,+r)||0,o=n.step||_h(s,i,100),a=na("input",{type:"range",name:n.signal,min:s,max:i,step:o});a.value=r;const u=na("span",{},+r);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function PN(e,t){return e===t||e+""==t+""}function CCe(e,t,n,r,i,s){return t=t||new r(e.loader()),t.initialize(n,vCe(e),wCe(e),EO(e),i,s).background(e.background())}function CH(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function kTt(e,t,n,r){const i=new r(e.loader(),CH(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,EO(e),e);return t&&t.handlers().forEach(s=>{i.on(s.type,s.handler)}),i}function ETt(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,s=rO(r);e=n._el=e?y5(n,e,!0):null,K_t(n),s||n.error("Unrecognized renderer type: "+r);const o=s.handler||xk,a=e?s.renderer:s.headless;return n._renderer=a?CCe(n,n._renderer,e,a):null,n._handler=kTt(n,n._handler,e,o),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=y5(n,t,!0):e.appendChild(na("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=y5(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{mTt(n,u.element||t,u)})),n}function y5(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const y2=e=>+e||0,ATt=e=>({top:e,bottom:e,left:e,right:e});function yse(e){return Wt(e)?{top:y2(e.top),bottom:y2(e.bottom),left:y2(e.left),right:y2(e.right)}:ATt(y2(e))}async function SH(e,t,n,r){const i=rO(t),s=i&&i.headless;return s||ke("Unrecognized renderer type: "+t),await e.runAsync(),CCe(e,null,null,s,n,r).renderAsync(e._scenegraph.root)}async function _Tt(e,t){e!==Hd.Canvas&&e!==Hd.SVG&&e!==Hd.PNG&&ke("Unrecognized image type: "+e);const n=await SH(this,e,t);return e===Hd.SVG?TTt(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function TTt(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function ITt(e,t){return(await SH(this,Hd.Canvas,e,t)).canvas()}async function NTt(e){return(await SH(this,Hd.SVG,e)).svg()}function DTt(e,t,n){return yCe(e,my,V$,n).parse(t)}function FTt(e){var t=this._runtime.scales;return Nt(t,e)||ke("Unrecognized scale or projection: "+e),t[e].value}var SCe="width",kCe="height",kH="padding",xse={skip:!0};function ECe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===kH?r.left+r.right:0)}function ACe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===kH?r.top+r.bottom:0)}function RTt(e){var t=e._signals,n=t[SCe],r=t[kCe],i=t[kH];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=ECe(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=ACe(e,a.size),s()},{size:r});const o=e.add(null,s,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}function OTt(e,t,n,r,i,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal(SCe,n,xse),o._resizeWidth.skip(!0)),o.height()!==r&&(a=1,o.signal(kCe,r,xse),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==i[0]||o._origin[1]!==i[1])&&(o._resize=1,o._origin=i),a&&o.run("enter"),s&&o.runAfter(u=>u.resize())},!1,1)}function MTt(e){return this._runtime.getState(e||{data:LTt,signals:PTt,recurse:!0})}function LTt(e,t){return t.modified&&Rt(t.input.value)&&e.indexOf("_:vega:_")}function PTt(e,t){return!(e==="parent"||t instanceof my.proxy)}function BTt(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function zTt(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(Eyt(n,t))}function UTt(e,t,n,r){const i=e.element();i&&i.setAttribute("title",jTt(r))}function jTt(e){return e==null?"":Rt(e)?_Ce(e):Wt(e)&&!P3(e)?WTt(e):e+""}function WTt(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(Rt(n)?_Ce(n):TCe(n))}).join(`
`)}function _Ce(e){return"["+e.map(TCe).join(", ")+"]"}function TCe(e){return Rt(e)?"[…]":Wt(e)&&!P3(e)?"{…}":e}function ICe(e,t){const n=this;if(t=t||{},X1.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=qt({},e.locale,t.locale);n.locale(V2e(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Hd.Canvas,n._scenegraph=new cG;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||UTt,n._redraw=!0,n._handler=new xk().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=uTt(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=DTt(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:qt({},s)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=ECe(n,n._width),n._viewHeight=ACe(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,RTt(n),Q_t(n),Z_t(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function l_(e,t){return Nt(e._signals,t)?e._signals[t]:ke("Unrecognized signal name: "+St(t))}function NCe(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function bse(e,t,n,r){let i=NCe(n,r);return i||(i=CH(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function vse(e,t,n){const r=NCe(t,n);return r&&t._targets.remove(r),e}ze(ICe,X1,{async evaluate(e,t,n){if(await X1.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,nTt(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&sT(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&bCe(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=l_(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",yse(e)):yse(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(rO(e)||ke("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(X1.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(l_(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:OTt,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=CH(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,s;--r>=0;)if(s=n[r].type,i=n[r].handler,e===s&&(t===i||t===i.raw)){this._handler.off(s,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return bse(this,e,l_(this,e),t)},removeSignalListener(e,t){return vse(this,l_(this,e),t)},addDataListener(e,t){return bse(this,e,LN(this,e).values,t)},removeDataListener(e,t){return vse(this,LN(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=n7(this,null);this._globalCursor=!!e,t&&n7(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:zTt,events:cTt,finalize:dTt,hover:fTt,data:J_t,change:kO,insert:eTt,remove:tTt,scale:FTt,initialize:ETt,toImageURL:_Tt,toCanvas:ITt,toSVG:NTt,getState:MTt,setState:BTt});const VTt="view",BN="[",zN="]",DCe="{",FCe="}",qTt=":",RCe=",",GTt="@",HTt=">",XTt=/[[\]{}]/,YTt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let OCe,MCe;function KTt(e,t,n){return OCe=t||VTt,MCe=YTt,LCe(e.trim()).map(r7)}function QTt(e){return MCe[e]}function kw(e,t,n,r,i){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;i&&i.indexOf(a)>=0?--o:r&&r.indexOf(a)>=0&&++o}return t}function LCe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=kw(e,i,RCe,BN+DCe,zN+FCe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function r7(e){return e[0]==="["?ZTt(e):JTt(e)}function ZTt(e){const t=e.length;let n=1,r;if(n=kw(e,n,zN,BN,zN),n===t)throw"Empty between selector: "+e;if(r=LCe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==HTt)throw"Expected '>' after between selector: "+e;r=r.map(r7);const i=r7(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function JTt(e){const t={source:OCe},n=[];let r=[0,0],i=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===FCe){if(a=e.lastIndexOf(DCe),a>=0){try{r=eIt(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===GTt&&(i=++a),u=kw(e,a,qTt),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=kw(e,a,BN),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=kw(e,a,zN),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==BN)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||XTt.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],i?t.markname=n[0].slice(1):QTt(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function eIt(e){const t=e.split(RCe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function tIt(e){return Wt(e)?e:{type:e||"pad"}}const x2=e=>+e||0,nIt=e=>({top:e,bottom:e,left:e,right:e});function rIt(e){return Wt(e)?e.signal?e:{top:x2(e.top),bottom:x2(e.bottom),left:x2(e.left),right:x2(e.right)}:nIt(x2(e))}const yi=e=>Wt(e)&&!Rt(e)?qt({},e):{value:e};function wse(e,t,n,r){return n!=null?(Wt(n)&&!Rt(n)||Rt(n)&&n.length&&Wt(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function qi(e,t,n){for(const r in t)wse(e,r,t[r]);for(const r in n)wse(e,r,n[r],"update")}function Ub(e,t,n){for(const r in t)n&&Nt(n,r)||(e[r]=qt(e[r]||{},t[r]));return e}function F1(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const EH="mark",AH="frame",_H="scope",iIt="axis",sIt="axis-domain",oIt="axis-grid",aIt="axis-label",uIt="axis-tick",lIt="axis-title",cIt="legend",fIt="legend-band",dIt="legend-entry",hIt="legend-gradient",PCe="legend-label",pIt="legend-symbol",gIt="legend-title",mIt="title",yIt="title-text",xIt="title-subtitle";function bIt(e,t,n,r,i){const s={},o={};let a,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!F1(u,e)&&x5(s,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===AH?i.group:n===EH?qt({},i.mark,i[t]):null;for(u in c)l=F1(u,e)||(u==="fill"||u==="stroke")&&(F1("fill",e)||F1("stroke",e)),l||x5(s,u,c[u]);It(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)F1(h,e)||x5(s,h,d[h])}),e=qt({},e);for(u in s)c=s[u],c.signal?(a=a||{})[u]=c:o[u]=c;return e.enter=qt(o,e.enter),a&&(e.update=qt(a,e.update)),e}function x5(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const BCe=e=>Hn(e)?St(e):e.signal?`(${e.signal})`:zCe(e);function AO(e){if(e.gradient!=null)return wIt(e);let t=e.signal?`(${e.signal})`:e.color?vIt(e.color):e.field!=null?zCe(e.field):e.value!==void 0?St(e.value):void 0;return e.scale!=null&&(t=$It(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${_T(e.exponent)})`),e.mult!=null&&(t+=`*${_T(e.mult)}`),e.offset!=null&&(t+=`+${_T(e.offset)}`),e.round&&(t=`round(${t})`),t}const c_=(e,t,n,r)=>`(${e}(${[t,n,r].map(AO).join(",")})+'')`;function vIt(e){return e.c?c_("hcl",e.h,e.c,e.l):e.h||e.s?c_("hsl",e.h,e.s,e.l):e.l||e.a?c_("lab",e.l,e.a,e.b):e.r||e.g||e.b?c_("rgb",e.r,e.g,e.b):null}function wIt(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:St(n));for(;t.length&&An(t)==null;)t.pop();return t.unshift(BCe(e.gradient)),`gradient(${t.join(",")})`}function _T(e){return Wt(e)?"("+AO(e)+")":e}function zCe(e){return UCe(Wt(e)?e:{datum:e})}function UCe(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):ke("Invalid field reference: "+St(e));return e.signal||(r=Hn(r)?D3(r).map(St).join("]["):UCe(r)),t+"["+r+"]"}function $It(e,t){const n=BCe(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+_T(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function CIt(e){let t="";return e.forEach(n=>{const r=AO(n);t+=n.test?`(${n.test})?${r}:`:r}),An(t)===":"&&(t+="null"),t}function jCe(e,t,n,r,i,s){const o={};s=s||{},s.encoders={$encode:o},e=bIt(e,t,n,r,i.config);for(const a in e)o[a]=SIt(e[a],t,s,i);return s}function SIt(e,t,n,r){const i={},s={};for(const o in e)e[o]!=null&&(i[o]=EIt(kIt(e[o]),r,n,s));return{$expr:{marktype:t,channels:i},$fields:Object.keys(s),$output:Object.keys(e)}}function kIt(e){return Rt(e)?CIt(e):AO(e)}function EIt(e,t,n,r){const i=nc(e,t);return i.$fields.forEach(s=>r[s]=1),qt(n,i.$params),i.$expr}const AIt="outer",_It=["value","update","init","react","bind"];function $se(e,t){ke(e+' for "outer" push: '+St(t))}function WCe(e,t){const n=e.name;if(e.push===AIt)t.signals[n]||$se("No prior signal definition",n),_It.forEach(r=>{e[r]!==void 0&&$se("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function i7(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function _O(e,t,n,r){return new i7(e,t,n,r)}function UN(e,t){return _O("operator",e,t)}function ft(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function G$(e,t){return t?{$field:e,$name:t}:{$field:e}}const s7=G$("key");function Cse(e,t){return{$compare:e,$order:t}}function TIt(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const IIt="ascending",NIt="descending";function DIt(e){return Wt(e)?(e.order===NIt?"-":"+")+TO(e.op,e.field):""}function TO(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const TH="scope",o7="view";function Kr(e){return e&&e.signal}function FIt(e){return e&&e.expr}function TT(e){if(Kr(e))return!0;if(Wt(e)){for(const t in e)if(TT(e[t]))return!0}return!1}function mu(e,t){return e??t}function Hg(e){return e&&e.signal||e}const Sse="timer";function H$(e,t){return(e.merge?OIt:e.stream?MIt:e.type?LIt:ke("Invalid stream specification: "+St(e)))(e,t)}function RIt(e){return e===TH?o7:e||o7}function OIt(e,t){const n=e.merge.map(i=>H$(i,t)),r=IH({merge:n},e,t);return t.addStream(r).id}function MIt(e,t){const n=H$(e.stream,t),r=IH({stream:n},e,t);return t.addStream(r).id}function LIt(e,t){let n;e.type===Sse?(n=t.event(Sse,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(RIt(e.source),e.type);const r=IH({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function IH(e,t,n){let r=t.between;return r&&(r.length!==2&&ke('Stream "between" parameter must have 2 entries: '+St(t)),e.between=[H$(r[0],n),H$(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(PIt(t.marktype,t.markname,t.markrole)),t.source===TH&&r.push("inScope(event.item)"),r.length&&(e.filter=nc("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function PIt(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const BIt={code:"_.$value",ast:{type:"Identifier",value:"value"}};function zIt(e,t,n){const r=e.encode,i={target:n};let s=e.events,o=e.update,a=[];s||ke("Signal update missing events specification."),Hn(s)&&(s=KTt(s,t.isSubscope()?TH:o7)),s=It(s).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[jIt(a)]),s.length&&a.push(s.length>1?{merge:s}:s[0]),r!=null&&(o&&ke("Signal encode and update are mutually exclusive."),o="encode(item(),"+St(r)+")"),i.update=Hn(o)?nc(o,t):o.expr!=null?nc(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:BIt,$params:{$value:t.signalRef(o.signal)}}:ke("Invalid signal update specification."),e.force&&(i.options={force:!0}),a.forEach(u=>t.addUpdate(qt(UIt(u,t),i)))}function UIt(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):H$(e,t)}}function jIt(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function WIt(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?ke("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=nc(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>zIt(i,t,n.id))}const _n=e=>(t,n,r)=>_O(e,n,t||void 0,r),VCe=_n("aggregate"),VIt=_n("axisticks"),qCe=_n("bound"),Qu=_n("collect"),kse=_n("compare"),qIt=_n("datajoin"),GCe=_n("encode"),GIt=_n("expression"),HIt=_n("facet"),XIt=_n("field"),YIt=_n("key"),KIt=_n("legendentries"),QIt=_n("load"),ZIt=_n("mark"),JIt=_n("multiextent"),eNt=_n("multivalues"),tNt=_n("overlap"),nNt=_n("params"),HCe=_n("prefacet"),rNt=_n("projection"),iNt=_n("proxy"),sNt=_n("relay"),XCe=_n("render"),oNt=_n("scale"),v0=_n("sieve"),aNt=_n("sortitems"),YCe=_n("viewlayout"),uNt=_n("values");let lNt=0;const KCe={min:"min",max:"max",count:"sum"};function cNt(e,t){const n=e.type||"linear";Ibe(n)||ke("Unrecognized scale type: "+St(n)),t.addScale(e.name,{type:n,domain:void 0})}function fNt(e,t){const n=t.getScale(e.name).params;let r;n.domain=QCe(e.domain,e,t),e.range!=null&&(n.range=JCe(e,t,n)),e.interpolate!=null&&wNt(e.interpolate,n),e.nice!=null&&(n.nice=vNt(e.nice)),e.bins!=null&&(n.bins=bNt(e.bins,t));for(r in e)Nt(n,r)||r==="name"||(n[r]=Fa(e[r],t))}function Fa(e,t){return Wt(e)?e.signal?t.signalRef(e.signal):ke("Unsupported object: "+St(e)):e}function IT(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Fa(n,t))}function IO(e){ke("Can not find data set: "+St(e))}function QCe(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&ke("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(Rt(e)?dNt:e.fields?pNt:hNt)(e,t,n)}function dNt(e,t,n){return e.map(r=>Fa(r,n))}function hNt(e,t,n){const r=n.getData(e.data);return r||IO(e.data),Oy(t.type)?r.valuesRef(n,e.field,ZCe(e.sort,!1)):Fbe(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function pNt(e,t,n){const r=e.data,i=e.fields.reduce((s,o)=>(o=Hn(o)?{data:r,field:o}:Rt(o)||o.signal?gNt(o,n):o,s.push(o),s),[]);return(Oy(t.type)?mNt:Fbe(t.type)?yNt:xNt)(e,n,i)}function gNt(e,t){const n="_:vega:_"+lNt++,r=Qu({});if(Rt(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+St(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,v0({})]),{data:n,field:"data"}}function mNt(e,t,n){const r=ZCe(e.sort,!0);let i,s;const o=n.map(l=>{const c=t.getData(l.data);return c||IO(l.data),c.countsRef(t,l.field,r)}),a={groupby:s7,pulse:o};r&&(i=r.op||"count",s=r.field?TO(i,r.field):"count",a.ops=[KCe[i]],a.fields=[t.fieldRef(s)],a.as=[s]),i=t.add(VCe(a));const u=t.add(Qu({pulse:ft(i)}));return s=t.add(uNt({field:s7,sort:t.sortRef(r),pulse:ft(u)})),ft(s)}function ZCe(e,t){return e&&(!e.field&&!e.op?Wt(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?ke("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!KCe[e.op]&&ke("Multiple domain scales can not be sorted using "+e.op)),e}function yNt(e,t,n){const r=n.map(i=>{const s=t.getData(i.data);return s||IO(i.data),s.domainRef(t,i.field)});return ft(t.add(eNt({values:r})))}function xNt(e,t,n){const r=n.map(i=>{const s=t.getData(i.data);return s||IO(i.data),s.extentRef(t,i.field)});return ft(t.add(JIt({extents:r})))}function bNt(e,t){return e.signal||Rt(e)?IT(e,t):t.objectProperty(e)}function vNt(e){return Wt(e)?{interval:Fa(e.interval),step:Fa(e.step)}:Fa(e)}function wNt(e,t){t.interpolate=Fa(e.type||e),e.gamma!=null&&(t.interpolateGamma=Fa(e.gamma))}function JCe(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Hn(i)){if(r&&Nt(r,i))return e=qt({},e,{range:r[i]}),JCe(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Oy(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:ke("Unrecognized scale range value: "+St(i))}else if(i.scheme){n.scheme=Rt(i.scheme)?IT(i.scheme,t):Fa(i.scheme,t),i.extent&&(n.schemeExtent=IT(i.extent,t)),i.count&&(n.schemeCount=Fa(i.count,t));return}else if(i.step){n.rangeStep=Fa(i.step,t);return}else{if(Oy(e.type)&&!Rt(i))return QCe(i,e,t);Rt(i)||ke("Unsupported range type: "+St(i))}return i.map(s=>(Rt(s)?IT:Fa)(s,t))}function $Nt(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=a7(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=a7(n[i],i,t));t.addProjection(e.name,r)}function a7(e,t,n){return Rt(e)?e.map(r=>a7(r,t,n)):Wt(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:ke("Unsupported parameter object: "+St(e)):e}const Zu="top",jb="left",Wb="right",jh="bottom",eSe="center",CNt="vertical",SNt="start",kNt="middle",ENt="end",u7="index",NH="label",ANt="offset",Yy="perc",_Nt="perc2",La="value",Ak="guide-label",DH="guide-title",TNt="group-title",INt="group-subtitle",Ese="symbol",NT="gradient",l7="discrete",c7="size",NNt="shape",DNt="fill",FNt="stroke",RNt="strokeWidth",ONt="strokeDash",MNt="opacity",FH=[c7,NNt,DNt,FNt,RNt,ONt,MNt],_k={name:1,style:1,interactive:1},Qt={value:0},Pa={value:1},NO="group",tSe="rect",RH="rule",LNt="symbol",w0="text";function X$(e){return e.type=NO,e.interactive=e.interactive||!1,e}function jo(e,t){const n=(r,i)=>mu(e[r],mu(t[r],i));return n.isVertical=r=>CNt===mu(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>mu(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>mu(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>mu(e.columns,mu(t.columns,+n.isVertical(!0))),n}function nSe(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function PNt(e,t,n){const r=t.config.style[n];return r&&r[e]}function DO(e,t,n){return`item.anchor === '${SNt}' ? ${e} : item.anchor === '${ENt}' ? ${t} : ${n}`}const OH=DO(St(jb),St(Wb),St(eSe));function BNt(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},Wt(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function rSe(e,t){return t?e?Wt(e)?Object.assign({},e,{offset:rSe(e.offset,t)}):{value:e,offset:t}:t:e}function ua(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Ub(e.encode,t,_k)):e.interactive=!1,e}function zNt(e,t,n,r){const i=jo(e,n),s=i.isVertical(),o=i.gradientThickness(),a=i.gradientLength();let u,l,c,f,d;s?(l=[0,1],c=[0,0],f=o,d=a):(l=[0,0],c=[1,0],f=a,d=o);const h={enter:u={opacity:Qt,x:Qt,y:Qt,width:yi(f),height:yi(d)},update:qt({},u,{opacity:Pa,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Qt}};return qi(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),ua({type:tSe,role:hIt,encode:h},r)}function UNt(e,t,n,r,i){const s=jo(e,n),o=s.isVertical(),a=s.gradientThickness(),u=s.gradientLength();let l,c,f,d,h="";o?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:Qt,fill:{scale:t,field:La}};p[l]={signal:h+"datum."+Yy,mult:u},p[c]=Qt,p[f]={signal:h+"datum."+_Nt,mult:u},p[d]=yi(a);const m={enter:p,update:qt({},p,{opacity:Pa}),exit:{opacity:Qt}};return qi(m,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),ua({type:tSe,role:fIt,key:La,from:i,encode:m},r)}const jNt=`datum.${Yy}<=0?"${jb}":datum.${Yy}>=1?"${Wb}":"${eSe}"`,WNt=`datum.${Yy}<=0?"${jh}":datum.${Yy}>=1?"${Zu}":"${kNt}"`;function Ase(e,t,n,r){const i=jo(e,t),s=i.isVertical(),o=yi(i.gradientThickness()),a=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:Qt},update:c={opacity:Pa,text:{field:NH}},exit:{opacity:Qt}};return qi(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:mu(e.labelLimit,t.gradientLabelLimit)}),s?(l.align={value:"left"},l.baseline=c.baseline={signal:WNt},f="y",d="x",h="1-"):(l.align=c.align={signal:jNt},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+Yy,mult:a},l[d]=c[d]=o,o.offset=mu(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+u7}:void 0,ua({type:w0,role:PCe,style:Ak,key:La,from:r,encode:p,overlap:u},n)}function VNt(e,t,n,r,i){const s=jo(e,t),o=n.entries,a=!!(o&&o.interactive),u=o?o.name:void 0,l=s("clipHeight"),c=s("symbolOffset"),f={data:"value"},d=`(${i}) ? datum.${ANt} : datum.${c7}`,h=l?yi(l):{field:c7},p=`datum.${u7}`,m=`max(1, ${i})`;let x,b,v,$,C;h.mult=.5,x={enter:b={opacity:Qt,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Pa,x:b.x,y:b.y},exit:{opacity:Qt}};let S=null,A=null;e.fill||(S=t.symbolBaseFillColor,A=t.symbolBaseStrokeColor),qi(x,{fill:s("symbolFillColor",S),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",A),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),FH.forEach(N=>{e[N]&&(v[N]=b[N]={scale:e[N],field:La})});const E=ua({type:LNt,role:pIt,key:La,from:f,clip:l?!0:void 0,encode:x},n.symbols),_=yi(c);_.offset=s("labelOffset"),x={enter:b={opacity:Qt,x:{signal:d,offset:_},y:h},update:v={opacity:Pa,text:{field:NH},x:b.x,y:b.y},exit:{opacity:Qt}},qi(x,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const D=ua({type:w0,role:PCe,style:Ak,key:La,from:f,encode:x},n.labels);return x={enter:{noBound:{value:!l},width:Qt,height:l?yi(l):Qt,opacity:Qt},exit:{opacity:Qt},update:v={opacity:Pa,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?($=`ceil(item.mark.items.length / ${m})`,v.row.signal=`${p}%${$}`,v.column.signal=`floor(${p} / ${$})`,C={field:["row",p]}):(v.row.signal=`floor(${p} / ${m})`,v.column.signal=`${p} % ${m}`,C={field:p}),v.column.signal=`(${i})?${v.column.signal}:${p}`,r={facet:{data:r,name:"value",groupby:u7}},X$({role:_H,from:r,encode:Ub(x,o,_k),marks:[E,D],name:u,interactive:a,sort:C})}function qNt(e,t){const n=jo(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const MH='item.orient === "left"',LH='item.orient === "right"',FO=`(${MH} || ${LH})`,GNt=`datum.vgrad && ${FO}`,HNt=DO('"top"','"bottom"','"middle"'),XNt=DO('"right"','"left"','"center"'),YNt=`datum.vgrad && ${LH} ? (${XNt}) : (${FO} && !(datum.vgrad && ${MH})) ? "left" : ${OH}`,KNt=`item._anchor || (${FO} ? "middle" : "start")`,QNt=`${GNt} ? (${MH} ? -90 : 90) : 0`,ZNt=`${FO} ? (datum.vgrad ? (${LH} ? "bottom" : "top") : ${HNt}) : "top"`;function JNt(e,t,n,r){const i=jo(e,t),s={enter:{opacity:Qt},update:{opacity:Pa,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Qt}};return qi(s,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:KNt},angle:{signal:QNt},align:{signal:YNt},baseline:{signal:ZNt},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),ua({type:w0,role:gIt,style:DH,from:r,encode:s},n)}function eDt(e,t){let n;return Wt(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+_se(e.path)+")":e.sphere&&(n="geoShape("+_se(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function _se(e){return Wt(e)&&e.signal?e.signal:St(e)}function iSe(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===NO?_H:t||EH}function tDt(e){return{marktype:e.type,name:e.name||void 0,role:e.role||iSe(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function nDt(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function PH(e,t){const n=f0e(e.type);n||ke("Unrecognized transform type: "+St(e.type));const r=_O(n.type.toLowerCase(),null,sSe(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function sSe(e,t,n){const r={},i=e.params.length;for(let s=0;s<i;++s){const o=e.params[s];r[o.name]=rDt(o,t,n)}return r}function rDt(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return iDt(e,t,n);if(i===void 0){e.required&&ke("Missing required "+St(t.type)+" parameter: "+St(e.name));return}else{if(r==="param")return sDt(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!Kr(i)?i.map(s=>Tse(e,s,n)):Tse(e,i,n)}function Tse(e,t,n){const r=e.type;if(Kr(t))return Nse(r)?ke("Expression references can not be signals."):b5(r)?n.fieldRef(t):Dse(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||b5(r);return i&&oDt(t)?n.exprRef(t.expr,t.as):i&&aDt(t)?G$(t.field,t.as):Nse(r)?nc(t,n):uDt(r)?ft(n.getData(t).values):b5(r)?G$(t):Dse(r)?n.compareRef(t):t}}function iDt(e,t,n){return Hn(t.from)||ke('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function sDt(e,t,n){const r=t[e.name];return e.array?(Rt(r)||ke("Expected an array of sub-parameters. Instead: "+St(r)),r.map(i=>Ise(e,i,n))):Ise(e,r,n)}function Ise(e,t,n){const r=e.params.length;let i;for(let o=0;o<r;++o){i=e.params[o];for(const a in i.key)if(i.key[a]!==t[a]){i=null;break}if(i)break}i||ke("Unsupported parameter: "+St(t));const s=qt(sSe(i,t,n),i.key);return ft(n.add(nNt(s)))}const oDt=e=>e&&e.expr,aDt=e=>e&&e.field,uDt=e=>e==="data",Nse=e=>e==="expr",b5=e=>e==="field",Dse=e=>e==="compare";function lDt(e,t,n){let r,i,s,o,a;return e?(r=e.facet)&&(t||ke("Only group marks can be faceted."),r.field!=null?o=a=DT(r,n):(e.data?a=ft(n.getData(e.data).aggregate):(s=PH(qt({type:"aggregate",groupby:It(r.groupby)},r.aggregate),n),s.params.key=n.keyRef(r.groupby),s.params.pulse=DT(r,n),o=a=ft(n.add(s))),i=n.keyRef(r.groupby,!0))):o=ft(n.add(Qu(null,[{}]))),o||(o=DT(e,n)),{key:i,pulse:o,parent:a}}function DT(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ft(t.getData(e.data).output)}function Em(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Em.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let s=t[0],o=null,a=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=ft(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(o=t[a]);return new Em(e,s,i,r,o)};function oSe(e){return Hn(e)?e:null}function Fse(e,t,n){const r=TO(n.op,n.field);let i;if(t.ops){for(let s=0,o=t.as.length;s<o;++s)if(t.as[s]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function b2(e,t,n,r,i,s,o){const a=t[n]||(t[n]={}),u=DIt(s);let l=oSe(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){const d=s?{field:s7,pulse:t.countsRef(e,i,s)}:{field:e.fieldRef(i),pulse:ft(t.output)};u&&(d.sort=e.sortRef(s)),f=e.add(_O(r,void 0,d)),o&&(t.index[i]=f),c=ft(f),l!=null&&(a[l]=c)}return c}Em.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),s=oSe(t);let o,a,u;return s!=null&&(e=r.scope,o=i[s]),o?n&&n.field&&Fse(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ft(r.output)},n&&n.field&&Fse(e,u,n),a=e.add(VCe(u)),o=e.add(Qu({pulse:ft(a)})),o={agg:a,ref:ft(o)},s!=null&&(i[s]=o)),o.ref},tuplesRef(){return ft(this.values)},extentRef(e,t){return b2(e,this,"extent","extent",t,!1)},domainRef(e,t){return b2(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return b2(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return b2(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return b2(e,this,"indata","tupleindex",t,!0,!0)}};function cDt(e,t,n){const r=e.from.facet,i=r.name,s=DT(r,t);let o;r.name||ke("Facet must have a name: "+St(r)),r.data||ke("Facet must reference a data set: "+St(r)),r.field?o=t.add(HCe({field:t.fieldRef(r.field),pulse:s})):r.groupby?o=t.add(HIt({key:t.keyRef(r.groupby),group:ft(t.proxy(n.parent)),pulse:s})):ke("Facet must specify groupby or field: "+St(r));const a=t.fork(),u=a.add(Qu()),l=a.add(v0({pulse:ft(u)}));a.addData(i,new Em(a,u,u,l)),a.addSignal("parent",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}function fDt(e,t,n){const r=t.add(HCe({pulse:n.pulse})),i=t.fork();i.add(v0()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function aSe(e,t,n){const r=e.remove,i=e.insert,s=e.toggle,o=e.modify,a=e.values,u=t.add(UN()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,s,o,a].map(f=>f??"null").join(",")+"),0)",c=nc(l,t);u.update=c.$expr,u.params=c.$params}function RO(e,t){const n=iSe(e),r=e.type===NO,i=e.from&&e.from.facet,s=e.overlap;let o=e.layout||n===_H||n===AH,a,u,l,c,f,d,h;const p=n===EH||o||i,m=lDt(e.from,r,t);u=t.add(qIt({key:m.key||(e.key?G$(e.key):void 0),pulse:m.pulse,clean:!r}));const x=ft(u);u=l=t.add(Qu({pulse:x})),u=t.add(ZIt({markdef:tDt(e),interactive:nDt(e.interactive,t),clip:eDt(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ft(u)}));const b=ft(u);u=c=t.add(GCe(jCe(e.encode,e.type,n,e.style,t,{mod:!1,pulse:b}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(A=>{const E=PH(A,t),_=E.metadata;(_.generates||_.changes)&&ke("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),E.params.pulse=ft(u),t.add(u=E)}),e.sort&&(u=t.add(aNt({sort:t.compareRef(e.sort),pulse:ft(u)})));const v=ft(u);(i||o)&&(o=t.add(YCe({layout:t.objectProperty(e.layout),legends:t.legends,mark:b,pulse:v})),d=ft(o));const $=t.add(qCe({mark:b,pulse:d||v}));h=ft($),r&&(p&&(a=t.operators,a.pop(),o&&a.pop()),t.pushState(v,d||h,x),i?cDt(e,t,m):p?fDt(e,t,m):t.parse(e),t.popState(),p&&(o&&a.push(o),a.push($))),s&&(h=dDt(s,h,t));const C=t.add(XCe({pulse:h})),S=t.add(v0({pulse:ft(C)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Em(t,l,C,S)),e.on&&e.on.forEach(A=>{(A.insert||A.remove||A.toggle)&&ke("Marks only support modify triggers."),aSe(A,t,f)}))}function dDt(e,t,n){const r=e.method,i=e.bound,s=e.separation,o={separation:Kr(s)?n.signalRef(s.signal):s,method:Kr(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),i){const a=i.tolerance;o.boundTolerance=Kr(a)?n.signalRef(a.signal):+a,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient}return ft(n.add(tNt(o)))}function hDt(e,t){const n=t.config.legend,r=e.encode||{},i=jo(e,n),s=r.legend||{},o=s.name||void 0,a=s.interactive,u=s.style,l={};let c=0,f,d,h;FH.forEach($=>e[$]?(l[$]=e[$],c=c||e[$]):0),c||ke("Missing valid scale for legend.");const p=pDt(e,t.scaleType(c)),m={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&i.isVertical()},x=ft(t.add(Qu(null,[m]))),b={enter:{x:{value:0},y:{value:0}}},v=ft(t.add(KIt(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===NT?(h=[zNt(e,c,n,r.gradient),Ase(e,n,r.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${Hg(i.gradientLength())})/100))`)):p===l7?h=[UNt(e,c,n,r.gradient,v),Ase(e,n,r.labels,v)]:(f=qNt(e,n),h=[VNt(e,n,r,v,Hg(f.columns))],d.size=yDt(e,t,h[0].marks)),h=[X$({role:dIt,from:x,encode:b,marks:h,layout:f,interactive:a})],m.title&&h.push(JNt(e,n,r.title,x)),RO(X$({role:cIt,from:x,encode:Ub(mDt(i,e,n),s,_k),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:a,style:u}),t)}function pDt(e,t){let n=e.type||Ese;return!e.type&&gDt(e)===1&&(e.fill||e.stroke)&&(n=YV(t)?NT:zz(t)?l7:Ese),n!==NT?n:zz(t)?l7:NT}function gDt(e){return FH.reduce((t,n)=>t+(e[n]?1:0),0)}function mDt(e,t,n){const r={enter:{},update:{}};return qi(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function yDt(e,t,n){const r=Hg(Rse("size",e,n)),i=Hg(Rse("strokeWidth",e,n)),s=Hg(xDt(n[1].encode,t,Ak));return nc(`max(ceil(sqrt(${r})+${i}),${s})`,t)}function Rse(e,t,n){return t[e]?`scale("${t[e]}",datum)`:nSe(e,n[0].encode)}function xDt(e,t,n){return nSe("fontSize",e)||PNt("fontSize",t,n)}const bDt=`item.orient==="${jb}"?-90:item.orient==="${Wb}"?90:0`;function vDt(e,t){e=Hn(e)?{text:e}:e;const n=jo(e,t.config.title),r=e.encode||{},i=r.group||{},s=i.name||void 0,o=i.interactive,a=i.style,u=[],l={},c=ft(t.add(Qu(null,[l])));return u.push(CDt(e,n,wDt(e),c)),e.subtitle&&u.push(SDt(e,n,r.subtitle,c)),RO(X$({role:mIt,from:c,encode:$Dt(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:o,style:a}),t)}function wDt(e){const t=e.encode;return t&&t.title||qt({name:e.name,interactive:e.interactive,style:e.style},t)}function $Dt(e,t){const n={enter:{},update:{}};return qi(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:OH},angle:{signal:bDt},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Ub(n,t,_k)}function CDt(e,t,n,r){const i={value:0},s=e.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return qi(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),ua({type:w0,role:yIt,style:TNt,from:r,encode:o},n)}function SDt(e,t,n,r){const i={value:0},s=e.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return qi(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),ua({type:w0,role:xIt,style:INt,from:r,encode:o},n)}function kDt(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(PH(r,t))}),e.on&&e.on.forEach(r=>{aSe(r,t,e.name)}),t.addDataPipeline(e.name,EDt(e,t,n))}function EDt(e,t,n){const r=[];let i=null,s=!1,o=!1,a,u,l,c,f;for(e.values?Kr(e.values)||TT(e.format)?(r.push(Ose(t,e)),r.push(i=Kp())):r.push(i=Kp({$ingest:e.values,$format:e.format})):e.url?TT(e.url)||TT(e.format)?(r.push(Ose(t,e)),r.push(i=Kp())):r.push(i=Kp({$request:e.url,$format:e.format})):e.source&&(i=a=It(e.source).map(d=>ft(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=Kp()),r.push(c),f.generates&&(o=!0),f.modifies&&!o&&(s=!0),f.source?i=c:f.changes&&(i=null);return a&&(l=a.length-1,r[0]=sNt({derive:s,pulse:l?a:a[0]}),(s||l)&&r.splice(1,0,Kp())),i||r.push(Kp()),r.push(v0({})),r}function Kp(e){const t=Qu({},e);return t.metadata={source:!0},t}function Ose(e,t){return QIt({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const uSe=e=>e===jh||e===Zu,OO=(e,t,n)=>Kr(e)?IDt(e.signal,t,n):e===jb||e===Zu?t:n,xi=(e,t,n)=>Kr(e)?_Dt(e.signal,t,n):uSe(e)?t:n,Du=(e,t,n)=>Kr(e)?TDt(e.signal,t,n):uSe(e)?n:t,lSe=(e,t,n)=>Kr(e)?NDt(e.signal,t,n):e===Zu?{value:t}:{value:n},ADt=(e,t,n)=>Kr(e)?DDt(e.signal,t,n):e===Wb?{value:t}:{value:n},_Dt=(e,t,n)=>cSe(`${e} === '${Zu}' || ${e} === '${jh}'`,t,n),TDt=(e,t,n)=>cSe(`${e} !== '${Zu}' && ${e} !== '${jh}'`,t,n),IDt=(e,t,n)=>BH(`${e} === '${jb}' || ${e} === '${Zu}'`,t,n),NDt=(e,t,n)=>BH(`${e} === '${Zu}'`,t,n),DDt=(e,t,n)=>BH(`${e} === '${Wb}'`,t,n),cSe=(e,t,n)=>(t=t!=null?yi(t):t,n=n!=null?yi(n):n,Mse(t)&&Mse(n)?(t=t?t.signal||St(t.value):null,n=n?n.signal||St(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[qt({test:e},t)].concat(n||[])),Mse=e=>e==null||Object.keys(e).length===1,BH=(e,t,n)=>({signal:`${e} ? (${z1(t)}) : (${z1(n)})`}),FDt=(e,t,n,r,i)=>({signal:(r!=null?`${e} === '${jb}' ? (${z1(r)}) : `:"")+(n!=null?`${e} === '${jh}' ? (${z1(n)}) : `:"")+(i!=null?`${e} === '${Wb}' ? (${z1(i)}) : `:"")+(t!=null?`${e} === '${Zu}' ? (${z1(t)}) : `:"")+"(null)"}),z1=e=>Kr(e)?e.signal:e==null?null:St(e),RDt=(e,t)=>t===0?0:Kr(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},J1=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function x1(e,t,n,r){let i;if(t&&Nt(t,e))return t[e];if(Nt(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[DH][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[Ak][i]}return null}function Lse(e){const t={};for(const n of e)if(n)for(const r in n)t[r]=1;return Object.keys(t)}function ODt(e,t){var n=t.config,r=n.style,i=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,a,u,l;if(Kr(o)){const f=Lse([n.axisX,n.axisY]),d=Lse([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(l of f)a[l]=xi(o,x1(l,n.axisX,i,r),x1(l,n.axisY,i,r));u={};for(l of d)u[l]=FDt(o.signal,x1(l,n.axisTop,i,r),x1(l,n.axisBottom,i,r),x1(l,n.axisLeft,i,r),x1(l,n.axisRight,i,r))}else a=o===Zu||o===jh?n.axisX:n.axisY,u=n["axis"+o[0].toUpperCase()+o.slice(1)];return a||u||s?qt({},i,a,u,s):i}function MDt(e,t,n,r){const i=jo(e,t),s=e.orient;let o,a;const u={enter:o={opacity:Qt},update:a={opacity:Pa},exit:{opacity:Qt}};qi(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=Pse(e,0),c=Pse(e,1);return o.x=a.x=xi(s,l,Qt),o.x2=a.x2=xi(s,c),o.y=a.y=Du(s,l,Qt),o.y2=a.y2=Du(s,c),ua({type:RH,role:sIt,from:r,encode:u},n)}function Pse(e,t){return{scale:e.scale,range:t}}function LDt(e,t,n,r,i){const s=jo(e,t),o=e.orient,a=e.gridScale,u=OO(o,1,-1),l=PDt(e.offset,u);let c,f,d;const h={enter:c={opacity:Qt},update:d={opacity:Pa},exit:f={opacity:Qt}};qi(h,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const p={scale:e.scale,field:La,band:i.band,extra:i.extra,offset:i.offset,round:s("tickRound")},m=xi(o,{signal:"height"},{signal:"width"}),x=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},b=a?{scale:a,range:1,mult:u,offset:l}:qt(m,{mult:u,offset:l});return c.x=d.x=xi(o,p,x),c.y=d.y=Du(o,p,x),c.x2=d.x2=Du(o,b),c.y2=d.y2=xi(o,b),f.x=xi(o,p),f.y=Du(o,p),ua({type:RH,role:oIt,key:La,from:r,encode:h},n)}function PDt(e,t){if(t!==1)if(!Wt(e))e=Kr(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=qt({},e);for(;n.mult!=null;)if(Wt(n.mult))n=n.mult=qt({},n.mult);else return n.mult=Kr(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function BDt(e,t,n,r,i,s){const o=jo(e,t),a=e.orient,u=OO(a,-1,1);let l,c,f;const d={enter:l={opacity:Qt},update:f={opacity:Pa},exit:c={opacity:Qt}};qi(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=yi(i);h.mult=u;const p={scale:e.scale,field:La,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")};return f.y=l.y=xi(a,Qt,p),f.y2=l.y2=xi(a,h),c.x=xi(a,p),f.x=l.x=Du(a,Qt,p),f.x2=l.x2=Du(a,h),c.y=Du(a,p),ua({type:RH,role:uIt,key:La,from:r,encode:d},n)}function v5(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function zDt(e,t,n,r,i,s){const o=jo(e,t),a=e.orient,u=e.scale,l=OO(a,-1,1),c=Hg(o("labelFlush")),f=Hg(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");let p=c===0||!!c,m;const x=yi(i);x.mult=l,x.offset=yi(o("labelPadding")||0),x.offset.mult=l;const b={scale:u,field:La,band:.5,offset:rSe(s.offset,o("labelOffset"))},v=xi(a,p?v5(u,c,'"left"','"right"','"center"'):{value:"center"},ADt(a,"left","right")),$=xi(a,lSe(a,"bottom","top"),p?v5(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),C=v5(u,c,`-(${f})`,f,0);p=p&&f;const S={opacity:Qt,x:xi(a,b,x),y:Du(a,b,x)},A={enter:S,update:m={opacity:Pa,text:{field:NH},x:S.x,y:S.y,align:v,baseline:$},exit:{opacity:Qt,x:S.x,y:S.y}};qi(A,{dx:!d&&p?xi(a,C):null,dy:!h&&p?Du(a,C):null}),qi(A,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});const E=o("labelBound");let _=o("labelOverlap");return _=_||E?{separation:o("labelSeparation"),method:_,order:"datum.index",bound:E?{scale:u,orient:a,tolerance:E}:null}:void 0,m.align!==v&&(m.align=J1(m.align,v)),m.baseline!==$&&(m.baseline=J1(m.baseline,$)),ua({type:w0,role:aIt,style:Ak,key:La,from:r,encode:A,overlap:_},n)}function UDt(e,t,n,r){const i=jo(e,t),s=e.orient,o=OO(s,-1,1);let a,u;const l={enter:a={opacity:Qt,anchor:yi(i("titleAnchor",null)),align:{signal:OH}},update:u=qt({},a,{opacity:Pa,text:yi(e.title)}),exit:{opacity:Qt}},c={signal:`lerp(range("${e.scale}"), ${DO(0,1,.5)})`};return u.x=xi(s,c),u.y=Du(s,c),a.angle=xi(s,Qt,RDt(o,90)),a.baseline=xi(s,lSe(s,jh,Zu),{value:jh}),u.angle=a.angle,u.baseline=a.baseline,qi(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),jDt(i,s,l,n),l.update.align=J1(l.update.align,a.align),l.update.angle=J1(l.update.angle,a.angle),l.update.baseline=J1(l.update.baseline,a.baseline),ua({type:w0,role:lIt,style:DH,from:r,encode:l},n)}function jDt(e,t,n,r){const i=(a,u)=>a!=null?(n.update[u]=J1(yi(a),n.update[u]),!1):!F1(u,r),s=i(e("titleX"),"x"),o=i(e("titleY"),"y");n.enter.auto=o===s?yi(o):xi(t,yi(o),yi(s))}function WDt(e,t){const n=ODt(e,t),r=e.encode||{},i=r.axis||{},s=i.name||void 0,o=i.interactive,a=i.style,u=jo(e,n),l=BNt(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ft(t.add(Qu({},[c]))),d=ft(t.add(VIt({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(LDt(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(BDt(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(zDt(e,n,r.labels,d,p,l))),c.domain&&h.push(MDt(e,n,r.domain,f)),c.title&&h.push(UDt(e,n,r.title,f)),RO(X$({role:iIt,from:f,encode:Ub(VDt(u,e),i,_k),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:s,interactive:o,style:a}),t)}function VDt(e,t){const n={enter:{},update:{}};return qi(n,{orient:e("orient"),offset:e("offset")||0,position:mu(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function fSe(e,t,n){const r=It(e.signals),i=It(e.scales);return n||r.forEach(s=>WCe(s,t)),It(e.projections).forEach(s=>$Nt(s,t)),i.forEach(s=>cNt(s,t)),It(e.data).forEach(s=>kDt(s,t)),i.forEach(s=>fNt(s,t)),(n||r).forEach(s=>WIt(s,t)),It(e.axes).forEach(s=>WDt(s,t)),It(e.marks).forEach(s=>RO(s,t)),It(e.legends).forEach(s=>hDt(s,t)),e.title&&vDt(e.title,t),t.parseLambdas(),t}const qDt=e=>Ub({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function GDt(e,t){const n=t.config,r=ft(t.root=t.add(UN())),i=HDt(e,n);i.forEach(l=>WCe(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(Qu()),o=t.add(GCe(jCe(qDt(e.encode),NO,AH,e.style,t,{pulse:ft(s)}))),a=t.add(YCe({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ft(o)}));t.operators.pop(),t.pushState(ft(o),ft(a),null),fSe(e,t,i),t.operators.push(a);let u=t.add(qCe({mark:r,pulse:ft(a)}));return u=t.add(XCe({pulse:ft(u)})),u=t.add(v0({pulse:ft(u)})),t.addData("root",new Em(t,s,s,u)),t}function v2(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function HDt(e,t){const n=o=>mu(e[o],t[o]),r=[v2("background",n("background")),v2("autosize",tIt(n("autosize"))),v2("padding",rIt(n("padding"))),v2("width",n("width")||0),v2("height",n("height")||0)],i=r.reduce((o,a)=>(o[a.name]=a,o),{}),s={};return It(e.signals).forEach(o=>{Nt(i,o.name)?o=qt(i[o.name],o):r.push(o),s[o.name]=o}),It(t.signals).forEach(o=>{!Nt(s,o.name)&&!Nt(i,o.name)&&r.push(o)}),r}function dSe(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Bse(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}dSe.prototype=Bse.prototype={parse(e){return fSe(e,this)},fork(){return new Bse(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof i7?ft(e):e;return this.add(iNt({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,s){let o,a;r&&(o=r.data||(r.data={}),a=o[i]||(o[i]=[]),a.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ft(this.add(v0({pulse:e})))),this._parent.push(t),this._lookup.push(n?ft(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return An(this._parent)},encode(){return An(this._encode)},lookup(){return An(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Hn(e))return G$(e,t);e.signal||ke("Unsupported field reference: "+St(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ft(this.add(XIt(i)))}return r},compareRef(e){let t=!1;const n=s=>Kr(s)?(t=!0,this.signalRef(s.signal)):FIt(s)?(t=!0,this.exprRef(s.expr)):s,r=It(e.field).map(n),i=It(e.order).map(n);return t?ft(this.add(kse({fields:r,orders:i}))):Cse(r,i)},keyRef(e,t){let n=!1;const r=s=>Kr(s)?(n=!0,ft(i[s.signal])):s,i=this.signals;return e=It(e).map(r),n?ft(this.add(YIt({fields:e,flat:t}))):TIt(e,t)},sortRef(e){if(!e)return e;const t=TO(e.op,e.field),n=e.order||IIt;return n.signal?ft(this.add(kse({fields:t,orders:this.signalRef(n.signal)}))):Cse(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return Nt(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&ke("Duplicate signal name: "+St(e));const n=t instanceof i7?t:this.add(UN(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||ke("Unrecognized signal name: "+St(e)),this.signals[e]},signalRef(e){return this.signals[e]?ft(this.signals[e]):(Nt(this.lambdas,e)||(this.lambdas[e]=this.add(UN(null))),ft(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=nc(r,this),s=this.lambdas[r];s.params=i.$params,s.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Wt(e)?e:this.signalRef(e.signal||zH(e))},exprRef(e,t){const n={expr:nc(e,this)};return t&&(n.expr.$name=t),ft(this.add(GIt(n)))},addBinding(e,t){this.bindings||ke("Nested signals do not support binding: "+St(e)),this.bindings.push(qt({signal:e},t))},addScaleProj(e,t){Nt(this.scales,e)&&ke("Duplicate scale or projection name: "+St(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,oNt(t))},addProjection(e,t){this.addScaleProj(e,rNt(t))},getScale(e){return this.scales[e]||ke("Unrecognized scale name: "+St(e)),this.scales[e]},scaleRef(e){return ft(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Nt(this.data,e)&&ke("Duplicate data set name: "+St(e)),this.data[e]=t},getData(e){return this.data[e]||ke("Undefined data set name: "+St(e)),this.data[e]},addDataPipeline(e,t){return Nt(this.data,e)&&ke("Duplicate data set name: "+St(e)),this.addData(e,Em.fromEntries(this,t))}};function zH(e){return(Rt(e)?XDt:YDt)(e)}function XDt(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(Wt(i)?i.signal||zH(i):St(i))}return n+"]"}function YDt(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+St(r)+":"+(Wt(i)?i.signal||zH(i):St(i));return t+"}"}function KDt(){const e="sans-serif",r="#4c78a8",i="#000",s="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function QDt(e,t,n){return Wt(e)||ke("Input Vega specification must be an object."),t=F3(KDt(),t,e.config),GDt(e,new dSe(t,n)).toRuntime()}const ZDt="RawCode",JDt="Literal",eFt="Property",tFt="Identifier",nFt="ArrayExpression",rFt="BinaryExpression",iFt="CallExpression",sFt="ConditionalExpression",oFt="LogicalExpression",aFt="MemberExpression",uFt="ObjectExpression",lFt="UnaryExpression";function Ju(e){this.type=e}Ju.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=cFt(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function cFt(e){switch(e.type){case nFt:return e.elements;case rFt:case oFt:return[e.left,e.right];case iFt:return[e.callee].concat(e.arguments);case sFt:return[e.test,e.consequent,e.alternate];case aFt:return[e.object,e.property];case uFt:return e.properties;case eFt:return[e.key,e.value];case lFt:return[e.argument];case tFt:case JDt:case ZDt:default:return[]}}var vc,rt,we,ws,$n,MO=1,Tk=2,Am=3,yp=4,LO=5,$0=6,go=7,Ik=8,fFt=9;vc={};vc[MO]="Boolean";vc[Tk]="<end>";vc[Am]="Identifier";vc[yp]="Keyword";vc[LO]="Null";vc[$0]="Numeric";vc[go]="Punctuator";vc[Ik]="String";vc[fFt]="RegularExpression";var dFt="ArrayExpression",hFt="BinaryExpression",pFt="CallExpression",gFt="ConditionalExpression",hSe="Identifier",mFt="Literal",yFt="LogicalExpression",xFt="MemberExpression",bFt="ObjectExpression",vFt="Property",wFt="UnaryExpression",bi="Unexpected token %0",$Ft="Unexpected number",CFt="Unexpected string",SFt="Unexpected identifier",kFt="Unexpected reserved word",EFt="Unexpected end of input",f7="Invalid regular expression",w5="Invalid regular expression: missing /",pSe="Octal literals are not allowed in strict mode.",AFt="Duplicate data property in object literal not allowed in strict mode",Ui="ILLEGAL",Y$="Disabled.",_Ft=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),TFt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function PO(e,t){if(!e)throw new Error("ASSERT: "+t)}function Qc(e){return e>=48&&e<=57}function UH(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Ew(e){return"01234567".indexOf(e)>=0}function IFt(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function K$(e){return e===10||e===13||e===8232||e===8233}function Nk(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&_Ft.test(String.fromCharCode(e))}function jN(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&TFt.test(String.fromCharCode(e))}const NFt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function gSe(){for(;we<ws;){const e=rt.charCodeAt(we);if(IFt(e)||K$(e))++we;else break}}function d7(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)we<ws&&UH(rt[we])?(r=rt[we++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):an({},bi,Ui);return String.fromCharCode(i)}function DFt(){var e,t,n,r;for(e=rt[we],t=0,e==="}"&&an({},bi,Ui);we<ws&&(e=rt[we++],!!UH(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&an({},bi,Ui),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function mSe(){var e,t;for(e=rt.charCodeAt(we++),t=String.fromCharCode(e),e===92&&(rt.charCodeAt(we)!==117&&an({},bi,Ui),++we,e=d7("u"),(!e||e==="\\"||!Nk(e.charCodeAt(0)))&&an({},bi,Ui),t=e);we<ws&&(e=rt.charCodeAt(we),!!jN(e));)++we,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),rt.charCodeAt(we)!==117&&an({},bi,Ui),++we,e=d7("u"),(!e||e==="\\"||!jN(e.charCodeAt(0)))&&an({},bi,Ui),t+=e);return t}function FFt(){var e,t;for(e=we++;we<ws;){if(t=rt.charCodeAt(we),t===92)return we=e,mSe();if(jN(t))++we;else break}return rt.slice(e,we)}function RFt(){var e,t,n;return e=we,t=rt.charCodeAt(we)===92?mSe():FFt(),t.length===1?n=Am:NFt.hasOwnProperty(t)?n=yp:t==="null"?n=LO:t==="true"||t==="false"?n=MO:n=Am,{type:n,value:t,start:e,end:we}}function $5(){var e=we,t=rt.charCodeAt(we),n,r=rt[we],i,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++we,{type:go,value:String.fromCharCode(t),start:e,end:we};default:if(n=rt.charCodeAt(we+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return we+=2,{type:go,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:we};case 33:case 61:return we+=2,rt.charCodeAt(we)===61&&++we,{type:go,value:rt.slice(e,we),start:e,end:we}}}if(o=rt.substr(we,4),o===">>>=")return we+=4,{type:go,value:o,start:e,end:we};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return we+=3,{type:go,value:s,start:e,end:we};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return we+=2,{type:go,value:i,start:e,end:we};if(i==="//"&&an({},bi,Ui),"<>=!+-*%&|^/".indexOf(r)>=0)return++we,{type:go,value:r,start:e,end:we};an({},bi,Ui)}function OFt(e){let t="";for(;we<ws&&UH(rt[we]);)t+=rt[we++];return t.length===0&&an({},bi,Ui),Nk(rt.charCodeAt(we))&&an({},bi,Ui),{type:$0,value:parseInt("0x"+t,16),start:e,end:we}}function MFt(e){let t="0"+rt[we++];for(;we<ws&&Ew(rt[we]);)t+=rt[we++];return(Nk(rt.charCodeAt(we))||Qc(rt.charCodeAt(we)))&&an({},bi,Ui),{type:$0,value:parseInt(t,8),octal:!0,start:e,end:we}}function zse(){var e,t,n;if(n=rt[we],PO(Qc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=we,e="",n!=="."){if(e=rt[we++],n=rt[we],e==="0"){if(n==="x"||n==="X")return++we,OFt(t);if(Ew(n))return MFt(t);n&&Qc(n.charCodeAt(0))&&an({},bi,Ui)}for(;Qc(rt.charCodeAt(we));)e+=rt[we++];n=rt[we]}if(n==="."){for(e+=rt[we++];Qc(rt.charCodeAt(we));)e+=rt[we++];n=rt[we]}if(n==="e"||n==="E")if(e+=rt[we++],n=rt[we],(n==="+"||n==="-")&&(e+=rt[we++]),Qc(rt.charCodeAt(we)))for(;Qc(rt.charCodeAt(we));)e+=rt[we++];else an({},bi,Ui);return Nk(rt.charCodeAt(we))&&an({},bi,Ui),{type:$0,value:parseFloat(e),start:t,end:we}}function LFt(){var e="",t,n,r,i,s=!1;for(t=rt[we],PO(t==="'"||t==='"',"String literal must starts with a quote"),n=we,++we;we<ws;)if(r=rt[we++],r===t){t="";break}else if(r==="\\")if(r=rt[we++],!r||!K$(r.charCodeAt(0)))switch(r){case"u":case"x":rt[we]==="{"?(++we,e+=DFt()):e+=d7(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Ew(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),we<ws&&Ew(rt[we])&&(s=!0,i=i*8+"01234567".indexOf(rt[we++]),"0123".indexOf(r)>=0&&we<ws&&Ew(rt[we])&&(i=i*8+"01234567".indexOf(rt[we++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&rt[we]===`
`&&++we;else{if(K$(r.charCodeAt(0)))break;e+=r}return t!==""&&an({},bi,Ui),{type:Ik,value:e,octal:s,start:n,end:we}}function PFt(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";an({},f7)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{an({},f7)}try{return new RegExp(e,t)}catch{return null}}function BFt(){var e,t,n,r,i;for(e=rt[we],PO(e==="/","Regular expression literal must start with a slash"),t=rt[we++],n=!1,r=!1;we<ws;)if(e=rt[we++],t+=e,e==="\\")e=rt[we++],K$(e.charCodeAt(0))&&an({},w5),t+=e;else if(K$(e.charCodeAt(0)))an({},w5);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||an({},w5),i=t.substr(1,t.length-2),{value:i,literal:t}}function zFt(){var e,t,n;for(t="",n="";we<ws&&(e=rt[we],!!jN(e.charCodeAt(0)));)++we,e==="\\"&&we<ws?an({},bi,Ui):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&an({},f7,n),{value:n,literal:t}}function UFt(){var e,t,n,r;return $n=null,gSe(),e=we,t=BFt(),n=zFt(),r=PFt(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:we}}function jFt(e){return e.type===Am||e.type===yp||e.type===MO||e.type===LO}function ySe(){if(gSe(),we>=ws)return{type:Tk,start:we,end:we};const e=rt.charCodeAt(we);return Nk(e)?RFt():e===40||e===41||e===59?$5():e===39||e===34?LFt():e===46?Qc(rt.charCodeAt(we+1))?zse():$5():Qc(e)?zse():$5()}function wo(){const e=$n;return we=e.end,$n=ySe(),we=e.end,e}function xSe(){const e=we;$n=ySe(),we=e}function WFt(e){const t=new Ju(dFt);return t.elements=e,t}function Use(e,t,n){const r=new Ju(e==="||"||e==="&&"?yFt:hFt);return r.operator=e,r.left=t,r.right=n,r}function VFt(e,t){const n=new Ju(pFt);return n.callee=e,n.arguments=t,n}function qFt(e,t,n){const r=new Ju(gFt);return r.test=e,r.consequent=t,r.alternate=n,r}function jH(e){const t=new Ju(hSe);return t.name=e,t}function sw(e){const t=new Ju(mFt);return t.value=e.value,t.raw=rt.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function jse(e,t,n){const r=new Ju(xFt);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function GFt(e){const t=new Ju(bFt);return t.properties=e,t}function Wse(e,t,n){const r=new Ju(vFt);return r.key=t,r.value=n,r.kind=e,r}function HFt(e,t){const n=new Ju(wFt);return n.operator=e,n.argument=t,n.prefix=!0,n}function an(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(s,o)=>(PO(o<r.length,"Message reference must be in range"),r[o]));throw n=new Error(i),n.index=we,n.description=i,n}function BO(e){e.type===Tk&&an(e,EFt),e.type===$0&&an(e,$Ft),e.type===Ik&&an(e,CFt),e.type===Am&&an(e,SFt),e.type===yp&&an(e,kFt),an(e,bi,e.value)}function $s(e){const t=wo();(t.type!==go||t.value!==e)&&BO(t)}function Wn(e){return $n.type===go&&$n.value===e}function C5(e){return $n.type===yp&&$n.value===e}function XFt(){const e=[];for(we=$n.start,$s("[");!Wn("]");)Wn(",")?(wo(),e.push(null)):(e.push(_m()),Wn("]")||$s(","));return wo(),WFt(e)}function Vse(){we=$n.start;const e=wo();return e.type===Ik||e.type===$0?(e.octal&&an(e,pSe),sw(e)):jH(e.value)}function YFt(){var e,t,n,r;if(we=$n.start,e=$n,e.type===Am)return n=Vse(),$s(":"),r=_m(),Wse("init",n,r);if(e.type===Tk||e.type===go)BO(e);else return t=Vse(),$s(":"),r=_m(),Wse("init",t,r)}function KFt(){var e=[],t,n,r,i={},s=String;for(we=$n.start,$s("{");!Wn("}");)t=YFt(),t.key.type===hSe?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?an({},AFt):i[r]=!0,e.push(t),Wn("}")||$s(",");return $s("}"),GFt(e)}function QFt(){$s("(");const e=WH();return $s(")"),e}const ZFt={if:1};function JFt(){var e,t,n;if(Wn("("))return QFt();if(Wn("["))return XFt();if(Wn("{"))return KFt();if(e=$n.type,we=$n.start,e===Am||ZFt[$n.value])n=jH(wo().value);else if(e===Ik||e===$0)$n.octal&&an($n,pSe),n=sw(wo());else{if(e===yp)throw new Error(Y$);e===MO?(t=wo(),t.value=t.value==="true",n=sw(t)):e===LO?(t=wo(),t.value=null,n=sw(t)):Wn("/")||Wn("/=")?(n=sw(UFt()),xSe()):BO(wo())}return n}function e3t(){const e=[];if($s("("),!Wn(")"))for(;we<ws&&(e.push(_m()),!Wn(")"));)$s(",");return $s(")"),e}function t3t(){we=$n.start;const e=wo();return jFt(e)||BO(e),jH(e.value)}function n3t(){return $s("."),t3t()}function r3t(){$s("[");const e=WH();return $s("]"),e}function i3t(){var e,t,n;for(e=JFt();;)if(Wn("."))n=n3t(),e=jse(".",e,n);else if(Wn("("))t=e3t(),e=VFt(e,t);else if(Wn("["))n=r3t(),e=jse("[",e,n);else break;return e}function qse(){const e=i3t();if($n.type===go&&(Wn("++")||Wn("--")))throw new Error(Y$);return e}function FT(){var e,t;if($n.type!==go&&$n.type!==yp)t=qse();else{if(Wn("++")||Wn("--"))throw new Error(Y$);if(Wn("+")||Wn("-")||Wn("~")||Wn("!"))e=wo(),t=FT(),t=HFt(e.value,t);else{if(C5("delete")||C5("void")||C5("typeof"))throw new Error(Y$);t=qse()}}return t}function Gse(e){let t=0;if(e.type!==go&&e.type!==yp)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function s3t(){var e,t,n,r,i,s,o,a,u,l;if(e=$n,u=FT(),r=$n,i=Gse(r),i===0)return u;for(r.prec=i,wo(),t=[e,$n],o=FT(),s=[u,r,o];(i=Gse($n))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=Use(a,u,o),s.push(n);r=wo(),r.prec=i,s.push(r),t.push($n),n=FT(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=Use(s[l-1].value,s[l-2],n),l-=2;return n}function _m(){var e,t,n;return e=s3t(),Wn("?")&&(wo(),t=_m(),$s(":"),n=_m(),e=qFt(e,t,n)),e}function WH(){const e=_m();if(Wn(","))throw new Error(Y$);return e}function o3t(e){rt=e,we=0,ws=rt.length,$n=null,xSe();const t=WH();if($n.type!==Tk)throw new Error("Unexpect token after expression.");return t}var a3t={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function u3t(e){function t(o,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,u){return l=>t(o,l,a,u)}const r="new Date",i="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&ke("Missing arguments to clamp function."),o.length>3&&ke("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&ke("Missing arguments to if function."),o.length>3&&ke("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function l3t(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function c3t(e){e=e||{};const t=e.allowed?Tf(e.allowed):{},n=e.forbidden?Tf(e.forbidden):{},r=e.constants||a3t,i=(e.functions||u3t)(f),s=e.globalvar,o=e.fieldvar,a=xn(s)?s:p=>"".concat(s,'["').concat(p,'"]');let u={},l={},c=0;function f(p){if(Hn(p))return p;const m=d[p.type];return m==null&&ke("Unsupported type: "+p.type),m(p)}const d={Literal:p=>p.raw,Identifier:p=>{const m=p.name;return c>0?m:Nt(n,m)?ke("Illegal identifier: "+m):Nt(r,m)?r[m]:Nt(t,m)?m:(u[m]=1,a(m))},MemberExpression:p=>{const m=!p.computed,x=f(p.object);m&&(c+=1);const b=f(p.property);return x===o&&(l[l3t(b)]=1),m&&(c-=1),x+(m?"."+b:"["+b+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&ke("Illegal callee type: "+p.callee.type);const m=p.callee.name,x=p.arguments,b=Nt(i,m)&&i[m];return b||ke("Unrecognized function: "+m),xn(b)?b(x):b+"("+x.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const m=f(p.key);return c-=1,m+":"+f(p.value)}};function h(p){const m={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},m}return h.functions=i,h.constants=r,h}const f3t="view",WN="[",VN="]",bSe="{",vSe="}",d3t=":",wSe=",",h3t="@",p3t=">",g3t=/[[\]{}]/,m3t={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let $Se,CSe;function C0(e,t,n){return $Se=t||f3t,CSe=n||m3t,SSe(e.trim()).map(h7)}function y3t(e){return CSe[e]}function Aw(e,t,n,r,i){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;i&&i.indexOf(a)>=0?--o:r&&r.indexOf(a)>=0&&++o}return t}function SSe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=Aw(e,i,wSe,WN+bSe,VN+vSe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function h7(e){return e[0]==="["?x3t(e):b3t(e)}function x3t(e){const t=e.length;let n=1,r;if(n=Aw(e,n,VN,WN,VN),n===t)throw"Empty between selector: "+e;if(r=SSe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==p3t)throw"Expected '>' after between selector: "+e;r=r.map(h7);const i=h7(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function b3t(e){const t={source:$Se},n=[];let r=[0,0],i=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===vSe){if(a=e.lastIndexOf(bSe),a>=0){try{r=v3t(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===h3t&&(i=++a),u=Aw(e,a,d3t),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=Aw(e,a,WN),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=Aw(e,a,VN),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==WN)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||g3t.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],i?t.markname=n[0].slice(1):y3t(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function v3t(e){const t=e.split(wSe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}var w3t="vega",$3t="5.20.0",C3t="The Vega visualization grammar.",S3t=["vega","visualization","interaction","dataflow","library","data","d3"],k3t="BSD-3-Clause",E3t="UW Interactive Data Lab (http://idl.cs.washington.edu)",A3t="build/vega-node.js",_3t="build/vega.module.js",T3t="build/vega.min.js",I3t="build/vega.min.js",N3t="index.d.ts",D3t="vega/vega",F3t={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},R3t={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.3","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.3","vega-typings":"~0.20.0","vega-util":"~1.16.1","vega-view":"~5.10.0","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},O3t={"vega-schema":"*"},M3t="f262105e75449760b0f35fda70e6b576a31d68a4",L3t={name:w3t,version:$3t,description:C3t,keywords:S3t,license:k3t,author:E3t,main:A3t,module:_3t,unpkg:T3t,jsdelivr:I3t,types:N3t,repository:D3t,scripts:F3t,dependencies:R3t,devDependencies:O3t,gitHead:M3t};qt(my,Iat,Lpt,d0t,K1t,Vyt,i$t,Hxt,o$t,C$t,RSt,USt);const P3t=L3t.version,B3t=Object.freeze(Object.defineProperty({__proto__:null,Bounds:Qs,CanvasHandler:xk,CanvasRenderer:AN,DATE:Fo,DAY:fs,DAYOFYEAR:Ql,Dataflow:X1,Debug:ome,Error:rme,EventStream:X3,Gradient:Z2e,GroupItem:Xq,HOURS:oa,Handler:zh,Info:sme,Item:Hq,MILLISECONDS:ju,MINUTES:aa,MONTH:xs,Marks:Va,MultiPulse:Aj,None:nme,Operator:Nn,Parameters:H3,Pulse:rh,QUARTER:Do,RenderType:Hd,Renderer:gc,ResourceLoader:Yq,SECONDS:ja,SVGHandler:dG,SVGRenderer:xG,SVGStringRenderer:bG,Scenegraph:cG,TIME_UNITS:Gj,Transform:xe,View:ICe,WEEK:Hr,Warn:ime,YEAR:Vi,accessor:Qa,accessorFields:ms,accessorName:gr,array:It,ascending:L3,bandwidthNRD:Nj,bin:$0e,bootstrapCI:C0e,boundClip:Iwt,boundContext:pk,boundItem:D8,boundMark:ywe,boundStroke:p0,changeset:t0,clampRange:$nt,codegenExpression:c3t,compare:pme,constant:Ua,cumulativeLogNormal:Lj,cumulativeNormal:K3,cumulativeUniform:Uj,dayofyear:M0e,debounce:gme,defaultLocale:q2e,definition:f0e,densityLogNormal:Mj,densityNormal:Dj,densityUniform:zj,domChild:bo,domClear:Su,domCreate:qd,domFind:fG,dotbin:S0e,error:ke,expressionFunction:Br,extend:qt,extent:Ch,extentIndex:mme,falsy:kd,fastmap:bb,field:wh,flush:_nt,font:eO,fontFamily:yk,fontSize:pc,format:yT,formatLocale:xN,formats:Uq,hasOwnProperty:Nt,id:hnt,identity:za,inferType:H2e,inferTypes:X2e,ingest:dn,inherits:ze,inrange:Tnt,interpolate:KV,interpolateColors:UR,interpolateRange:Rbe,intersect:jwe,intersectBoxLine:P1,intersectPath:Kq,intersectPoint:Qq,intersectRule:owe,isArray:Rt,isBoolean:yme,isDate:P3,isFunction:xn,isIterable:xme,isNumber:dm,isObject:Wt,isRegExp:Int,isString:Hn,isTuple:q3,key:bme,lerp:Nnt,lineHeight:Ph,loader:jq,locale:V2e,logger:pnt,lruCache:vme,markup:yG,merge:wme,mergeConfig:F3,multiLineOffset:U2t,one:yb,pad:Fnt,panLinear:mnt,panLog:ynt,panPow:xnt,panSymlog:bnt,parse:QDt,parseExpression:o3t,parseSelector:C0,pathCurves:Vq,pathEqual:Gwe,pathParse:jy,pathRectangle:twe,pathRender:F$,pathSymbols:ewe,pathTrail:nwe,peek:An,point:nO,projection:cq,quantileLogNormal:Pj,quantileNormal:Q3,quantileUniform:jj,quantiles:Tj,quantizeInterpolator:Obe,quarter:vnt,quartiles:Ij,get random(){return Uu},randomInteger:lot,randomKDE:Rj,randomLCG:uot,randomLogNormal:E0e,randomMixture:A0e,randomNormal:Fj,randomUniform:_0e,read:svt,regressionExp:I0e,regressionLinear:Wj,regressionLoess:F0e,regressionLog:T0e,regressionPoly:D0e,regressionPow:N0e,regressionQuad:Vj,renderModule:rO,repeat:L2,resetDefaultLocale:Bbt,resetSVGClipId:iwe,resetSVGDefIds:Fwt,responseType:ivt,runtimeContext:yCe,sampleCurve:J3,sampleLogNormal:Oj,sampleNormal:Y3,sampleUniform:Bj,scale:hn,sceneEqual:vG,sceneFromJSON:bwe,scenePickVisit:wN,sceneToJSON:xwe,sceneVisit:Wu,sceneZOrder:Zq,scheme:QV,serializeXML:Rwe,setRandom:oot,span:B3,splitAccessPath:D3,stringValue:St,textMetrics:Pl,timeBin:J0e,timeFloor:W0e,timeFormatLocale:D$,timeInterval:Eb,timeOffset:G0e,timeSequence:Y0e,timeUnitSpecifier:O0e,timeUnits:Hj,toBoolean:$me,toDate:Cme,toNumber:$h,toSet:Tf,toString:Sme,transform:d0e,transforms:my,truncate:Ont,truthy:xb,tupleid:dt,typeParsers:E8,utcFloor:V0e,utcInterval:Ab,utcOffset:H0e,utcSequence:K0e,utcdayofyear:B0e,utcquarter:wnt,utcweek:z0e,version:P3t,visitArray:Mnt,week:L0e,writeConfig:R3,zero:Rd,zoomLinear:fme,zoomLog:dme,zoomPow:H6,zoomSymlog:hme},Symbol.toStringTag,{value:"Module"})),z3t="vega-lite",U3t='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',j3t="4.13.1",W3t=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],V3t="https://vega.github.io/vega-lite/",q3t="Vega-Lite is a concise high-level language for interactive visualization.",G3t="build/vega-lite.js",H3t="build/vega-lite.min.js",X3t="build/vega-lite.min.js",Y3t="build/src/index",K3t="build/src/index.d.ts",Q3t={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},Z3t={test:"test"},J3t={changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},eRt={type:"git",url:"https://github.com/vega/vega-lite.git"},tRt="BSD-3-Clause",nRt={url:"https://github.com/vega/vega-lite/issues"},rRt={"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},iRt={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},sRt={vega:"^5.12.1"},oRt={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1},aRt={name:z3t,author:U3t,version:j3t,collaborators:W3t,homepage:V3t,description:q3t,main:G3t,unpkg:H3t,jsdelivr:X3t,module:Y3t,types:K3t,bin:Q3t,directories:Z3t,scripts:J3t,repository:eRt,license:tRt,bugs:nRt,devDependencies:rRt,dependencies:iRt,peerDependencies:sRt,jest:oRt};function Vb(e,t,n){return e.fields=t||[],e.fname=n,e}function uRt(e){return e.length===1?lRt(e[0]):cRt(e)}const lRt=e=>function(t){return t[e]},cRt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function S5(e){throw Error(e)}function S0(e){var t=[],n=null,r=0,i=e.length,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<i;++a)if(u=e[a],u==="\\")s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(u===n)l(),n=null,r=-1;else{if(n)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,n=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||S5("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&S5("Access path missing closing bracket: "+e),n&&S5("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function fRt(e,t,n){const r=S0(e);return e=r.length===1?r[0]:e,Vb(uRt(r),[e],e)}var Dk=[];fRt("id");var dRt=Vb(function(e){return e},Dk,"identity");Vb(function(){return 0},Dk,"zero");Vb(function(){return 1},Dk,"one");Vb(function(){return!0},Dk,"true");Vb(function(){return!1},Dk,"false");function f_(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var hRt=1,kSe=2,pRt=3,gRt=4;function mRt(e,t){var n=e;return{level:function(r){return arguments.length?(n=+r,this):n},error:function(){return n>=hRt&&f_("error","ERROR",arguments),this},warn:function(){return n>=kSe&&f_("warn","WARN",arguments),this},info:function(){return n>=pRt&&f_("log","INFO",arguments),this},debug:function(){return n>=gRt&&f_("log","DEBUG",arguments),this}}}const yt=Array.isArray;function $i(e){return e===Object(e)}const Hse=e=>e!=="__proto__";function ESe(...e){return e.reduce((t,n)=>{for(var r in n)if(r==="signals")t.signals=yRt(t.signals,n.signals);else{var i=r==="legend"?{layout:1}:r==="style"?!0:null;VH(t,r,n[r],i)}return t},{})}function VH(e,t,n,r){if(Hse(t)){var i,s;if($i(n)&&!yt(n)){s=$i(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?VH(s,i,n[i]):Hse(i)&&(s[i]=n[i])}else e[t]=n}}function yRt(e,t){if(e==null)return t;const n={},r=[];function i(s){n[s.name]||(n[s.name]=1,r.push(s))}return t.forEach(i),e.forEach(i),r}function Er(e){return e!=null?yt(e)?e:[e]:[]}function xRt(e){return typeof e=="function"}const bRt=Object.prototype.hasOwnProperty;function Fg(e,t){return bRt.call(e,t)}function Fk(e){return typeof e=="boolean"}function Mr(e){return typeof e=="number"}function zt(e){return typeof e=="string"}function Zt(e){return yt(e)?"["+e.map(Zt)+"]":$i(e)||zt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function k0(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function ht(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var k5={exports:{}},Xse;function vRt(){return Xse||(Xse=1,function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch{r=function(){}}var i;try{i=Set}catch{i=function(){}}var s;try{s=Promise}catch{s=function(){}}function o(d,h,p,m,x){typeof h=="object"&&(p=h.depth,m=h.prototype,x=h.includeNonEnumerable,h=h.circular);var b=[],v=[],$=typeof Buffer<"u";typeof h>"u"&&(h=!0),typeof p>"u"&&(p=1/0);function C(S,A){if(S===null)return null;if(A===0)return S;var E,_;if(typeof S!="object")return S;if(n(S,r))E=new r;else if(n(S,i))E=new i;else if(n(S,s))E=new s(function(j,z){S.then(function(q){j(C(q,A-1))},function(q){z(C(q,A-1))})});else if(o.__isArray(S))E=[];else if(o.__isRegExp(S))E=new RegExp(S.source,f(S)),S.lastIndex&&(E.lastIndex=S.lastIndex);else if(o.__isDate(S))E=new Date(S.getTime());else{if($&&Buffer.isBuffer(S))return Buffer.allocUnsafe?E=Buffer.allocUnsafe(S.length):E=new Buffer(S.length),S.copy(E),E;n(S,Error)?E=Object.create(S):typeof m>"u"?(_=Object.getPrototypeOf(S),E=Object.create(_)):(E=Object.create(m),_=m)}if(h){var D=b.indexOf(S);if(D!=-1)return v[D];b.push(S),v.push(E)}n(S,r)&&S.forEach(function(j,z){var q=C(z,A-1),H=C(j,A-1);E.set(q,H)}),n(S,i)&&S.forEach(function(j){var z=C(j,A-1);E.add(z)});for(var N in S){var T;_&&(T=Object.getOwnPropertyDescriptor(_,N)),!(T&&T.set==null)&&(E[N]=C(S[N],A-1))}if(Object.getOwnPropertySymbols)for(var L=Object.getOwnPropertySymbols(S),N=0;N<L.length;N++){var O=L[N],M=Object.getOwnPropertyDescriptor(S,O);M&&!M.enumerable&&!x||(E[O]=C(S[O],A-1),M.enumerable||Object.defineProperty(E,O,{enumerable:!1}))}if(x)for(var R=Object.getOwnPropertyNames(S),N=0;N<R.length;N++){var P=R[N],M=Object.getOwnPropertyDescriptor(S,P);M&&M.enumerable||(E[P]=C(S[P],A-1),Object.defineProperty(E,P,{enumerable:!1}))}return E}return C(d,p)}o.clonePrototype=function(h){if(h===null)return null;var p=function(){};return p.prototype=h,new p};function a(d){return Object.prototype.toString.call(d)}o.__objToStr=a;function u(d){return typeof d=="object"&&a(d)==="[object Date]"}o.__isDate=u;function l(d){return typeof d=="object"&&a(d)==="[object Array]"}o.__isArray=l;function c(d){return typeof d=="object"&&a(d)==="[object RegExp]"}o.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return o.__getRegExpFlags=f,o}();e.exports&&(e.exports=t)}(k5)),k5.exports}var wRt=vRt();const $Rt=ox(wRt);var E5,Yse;function CRt(){return Yse||(Yse=1,E5=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(s=Object.keys(t),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var o=s[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}),E5}var SRt=CRt();const kRt=ox(SRt);var A5,Kse;function ERt(){return Kse||(Kse=1,A5=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(s){return function(o){return function(a,u){var l={key:a,value:o[a]},c={key:u,value:o[u]};return s(l,c)}}}(t.cmp),i=[];return function s(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var a,u;if(Array.isArray(o)){for(u="[",a=0;a<o.length;a++)a&&(u+=","),u+=s(o[a])||"null";return u+"]"}if(o===null)return"null";if(i.indexOf(o)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=i.push(o)-1,c=Object.keys(o).sort(r&&r(o));for(u="",a=0;a<c.length;a++){var f=c[a],d=s(o[f]);d&&(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return i.splice(l,1),"{"+u+"}"}}(e)}),A5}var ARt=ERt();const Q$=ox(ARt);function qH(e){return!!e.or}function GH(e){return!!e.and}function HH(e){return!!e.not}function RT(e,t){if(HH(e))RT(e.not,t);else if(GH(e))for(const n of e.and)RT(n,t);else if(qH(e))for(const n of e.or)RT(n,t);else t(e)}function OT(e,t){return HH(e)?{not:OT(e.not,t)}:GH(e)?{and:e.and.map(n=>OT(n,t))}:qH(e)?{or:e.or.map(n=>OT(n,t))}:t(e)}const Rk=kRt,Ut=$Rt;function Z$(e,t){const n={};for(const r of t)Fg(e,r)&&(n[r]=e[r]);return n}function bf(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>Q$(e)).join(",")})`};const Zn=Q$;function rn(e){if(Mr(e))return e;const t=zt(e)?e:Q$(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function Qse(e){return e===!1||e===null}function bt(e,t){return e.indexOf(t)>-1}function J$(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function ASe(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function _Rt(e,...t){for(const n of t)TRt(e,n??{});return e}function TRt(e,t){for(const n of Oe(t))VH(e,n,t[n],!0)}function Kd(e,t){const n=[],r={};let i;for(const s of e)i=t(s),!(i in r)&&(r[i]=1,n.push(s));return n}function IRt(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function _Se(e,t){for(const n of e)if(t.has(n))return!0;return!1}function Zse(e){const t=new Set;for(const n of e){const i=S0(n).map((o,a)=>a===0?o:`[${o}]`),s=i.map((o,a)=>i.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function TSe(e,t){return e===void 0||t===void 0?!0:_Se(Zse(e),Zse(t))}function Dn(e){return Oe(e).length===0}const Oe=Object.keys,ah=Object.values;function ISe(e){const t=[];for(const n in e)Fg(e,n)&&t.push({key:n,value:e[n]});return t}function qN(e){return e===!0||e===!1}function er(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function _w(e,t){return HH(e)?"!("+_w(e.not,t)+")":GH(e)?"("+e.and.map(n=>_w(n,t)).join(") && (")+")":qH(e)?"("+e.or.map(n=>_w(n,t)).join(") || (")+")":t(e)}function p7(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&p7(e[n],t)&&delete e[n],Dn(e)}function zO(e){return e.charAt(0).toUpperCase()+e.substr(1)}function NSe(e,t="datum"){const n=S0(e),r=[];for(let i=1;i<=n.length;i++){const s=`[${n.slice(0,i).map(Zt).join("][")}]`;r.push(`${t}${s}`)}return r.join(" && ")}function NRt(e,t="datum"){return`${t}[${Zt(S0(e).join("."))}]`}function DRt(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Wh(e){return`${S0(e).map(DRt).join("\\.")}`}function Ky(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function DSe(e){return`${S0(e).join(".")}`}function eC(e){return e?S0(e).length:0}function Lr(...e){for(const t of e)if(t!==void 0)return t}let FRt=42;function RRt(e){const t=++FRt;return e?String(e)+t:t}function ORt(e){return MRt(e)?e:`__${e}`}function MRt(e){return e.indexOf("__")===0}function GN(e){if(e!==void 0)return(e%360+360)%360}function XH(e){return Mr(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const Jse={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function YH(e){return e&&e.condition}const FSe=["domain","grid","labels","ticks","title"],LRt={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},RSe={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},PRt=Object.assign(Object.assign({},RSe),{style:1,labelExpr:1,encoding:1});function eoe(e){return!!PRt[e]}const no={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},OSe=no.arc,UO=no.area,jO=no.bar,BRt=no.image,WO=no.line,VO=no.point,zRt=no.rect,HN=no.rule,MSe=no.text,KH=no.tick,URt=no.trail,QH=no.circle,ZH=no.square,LSe=no.geoshape;function E0(e){return bt(["line","area","trail"],e)}function toe(e){return bt(["rect","bar","image","arc"],e)}const PSe=Oe(no);function rc(e){return e.type}k0(PSe);const jRt=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],WRt=["fill","fillOpacity"],VRt=[...jRt,...WRt],qRt={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},noe=Oe(qRt),GRt={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},HRt={color:"#4c78a8",invalid:"filter",timeUnitBand:1},XRt={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},BSe=5,YRt={binSpacing:1,continuousBandSize:BSe,timeUnitBandPosition:.5},KRt={binSpacing:0,continuousBandSize:BSe,timeUnitBandPosition:.5},QRt={thickness:1};function ZRt(e){return rc(e)?e.type:e}function Hf(e){return"mark"in e}class qO{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Hf(t)?ZRt(t.mark)===this.name:!1}}const JRt={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},eOt={count:1,min:1,max:1};function Vh(e){return!!e&&!!e.argmin}function A0(e){return!!e&&!!e.argmax}function JH(e){return zt(e)&&!!JRt[e]}const tOt=["count","valid","missing","distinct"];function zSe(e){return zt(e)&&bt(tOt,e)}function nOt(e){return zt(e)&&bt(["min","max"],e)}const rOt=["count","sum","distinct","valid","missing"],iOt=["mean","average","median","q1","q3","min","max"],sOt=k0(iOt),vf="row",wf="column",GO="facet",lr="x",Qr="y",el="x2",wc="y2",$c="radius",Xf="radius2",tl="theta",Yf="theta2",Cc="latitude",Sc="longitude",nl="latitude2",qa="longitude2",Mo="color",kc="fill",Ec="stroke",Lo="shape",Kf="size",_0="angle",Qf="opacity",xp="fillOpacity",bp="strokeOpacity",vp="strokeWidth",wp="strokeDash",Ok="text",Mk="order",Lk="detail",HO="key",Tm="tooltip",XO="href",YO="url",KO="description",oOt={x:1,y:1,x2:1,y2:1},USe={theta:1,theta2:1,radius:1,radius2:1};function jSe(e){return e in USe}const eX={longitude:1,longitude2:1,latitude:1,latitude2:1};function aOt(e){switch(e){case Cc:return"y";case nl:return"y2";case Sc:return"x";case qa:return"x2"}}function uOt(e){return e in eX}const lOt=Oe(eX),WSe=Object.assign(Object.assign(Object.assign(Object.assign({},oOt),USe),eX),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function ey(e){return e===Mo||e===kc||e===Ec}const VSe={row:1,column:1,facet:1},Ra=Oe(VSe),tX=Object.assign(Object.assign({},WSe),VSe),qSe=Oe(tX),cOt=ht(tX,["order","detail","tooltip"]),fOt=ht(cOt,["row","column","facet"]);function dOt(e){return!!fOt[e]}function GSe(e){return!!tX[e]}const hOt=[el,wc,nl,qa,Yf,Xf];function HSe(e){return T0(e)!==e}function T0(e){switch(e){case el:return lr;case wc:return Qr;case nl:return Cc;case qa:return Sc;case Yf:return tl;case Xf:return $c}return e}function qh(e){if(jSe(e))switch(e){case tl:return"startAngle";case Yf:return"endAngle";case $c:return"outerRadius";case Xf:return"innerRadius"}return e}function Ac(e){switch(e){case lr:return el;case Qr:return wc;case Cc:return nl;case Sc:return qa;case tl:return Yf;case $c:return Xf}}function _c(e){switch(e){case lr:case el:return"width";case Qr:case wc:return"height"}}function pOt(e){switch(e){case lr:return"xOffset";case Qr:return"yOffset";case el:return"x2Offset";case wc:return"y2Offset";case tl:return"thetaOffset";case $c:return"radiusOffset";case Yf:return"theta2Offset";case Xf:return"radius2Offset"}}const nX=ht(WSe,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),gOt=Oe(nX),$p={x:1,y:1},Ga=Oe($p);function ic(e){return e in $p}const rX={theta:1,radius:1},mOt=Oe(rX);function QO(e){return e==="width"?lr:Qr}const XSe=ht(nX,["text","tooltip","href","url","description","detail","key","order"]),yOt=Oe(XSe);function xOt(e){return!!nX[e]}function bOt(e){switch(e){case Mo:case kc:case Ec:case Kf:case Lo:case Qf:case vp:case wp:return!0;case xp:case bp:case _0:return!1}}const YSe=Object.assign(Object.assign(Object.assign({},$p),rX),XSe),ZO=Oe(YSe);function Cp(e){return!!YSe[e]}function vOt(e,t){return $Ot(e)[t]}const KSe={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},wOt=ht(KSe,["geoshape"]);function $Ot(e){switch(e){case Mo:case kc:case Ec:case KO:case Lk:case HO:case Tm:case XO:case Mk:case Qf:case xp:case bp:case vp:case GO:case vf:case wf:return KSe;case lr:case Qr:case Cc:case Sc:return wOt;case el:case wc:case nl:case qa:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Kf:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case wp:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Lo:return{point:"always",geoshape:"always"};case Ok:return{text:"always"};case _0:return{point:"always",square:"always",text:"always"};case YO:return{image:"always"};case tl:return{text:"always",arc:"always"};case $c:return{text:"always",arc:"always"};case Yf:case Xf:return{arc:"always"}}}function MT(e){switch(e){case lr:case Qr:case tl:case $c:case Kf:case _0:case vp:case Qf:case xp:case bp:case el:case wc:case Yf:case Xf:return;case GO:case vf:case wf:case Lo:case wp:case Ok:case Tm:case XO:case YO:case KO:return"discrete";case Mo:case kc:case Ec:return"flexible";case Cc:case Sc:case nl:case qa:case Lk:case HO:case Mk:return}}function QSe(e){return Fk(e)&&(e=sM(e,void 0)),"bin"+Oe(e).map(t=>JO(e[t])?er(`_${t}_${Object.entries(e[t])}`):er(`_${t}_${e[t]}`)).join("")}function Pn(e){return e===!0||Pk(e)&&!e.binned}function zs(e){return e==="binned"||Pk(e)&&e.binned===!0}function Pk(e){return $i(e)}function JO(e){return e==null?void 0:e.selection}function roe(e){switch(e){case vf:case wf:case Kf:case Mo:case kc:case Ec:case vp:case Qf:case xp:case bp:case Lo:return 6;case wp:return 4;default:return 10}}function iX(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const COt='Autosize "fit" only works for single views and layered views.';function ioe(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function soe(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function ooe(e){return e?`Dropping "fit-${e}" because spec has discrete ${_c(e)}.`:'Dropping "fit" because spec has discrete size.'}function aoe(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function SOt(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function kOt(e){return`The "nearest" transform is not supported for ${e} marks.`}function ZSe(e){return`Selection not supported for ${e} yet.`}function EOt(e){return`Cannot find a selection named "${e}".`}const AOt="Scale bindings are currently only supported for scales with unbinned, continuous domains.",_Ot="Legend bindings are only supported for selections over an individual field or encoding channel.";function TOt(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function IOt(e){return`Unknown repeated value "${e}".`}function uoe(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const NOt="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function DOt(e){return`Unrecognized parse "${e}".`}function loe(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function FOt(e){return`Ignoring an invalid transform: ${Zn(e)}.`}const ROt='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function coe(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function OOt(e){return`Layer's shared ${e.join(",")} channel ${e.length===1?"is":"are"} overriden.`}function MOt(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Zn(t)} is overridden by a child projection ${Zn(n)}.`}const LOt="Arc marks uses theta channel rather than angle, replacing angle with theta.";function POt(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Zn(n)}}.`}function JSe(e){return`Invalid field type "${e}".`}function BOt(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function zOt(e){return`Invalid aggregation operator "${e}".`}function UOt(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function eke(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function g7(e,t){return`Dropping ${Zn(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const jOt="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function eM(e,t,n){return`${e} dropped as it is incompatible with "${t}".`}function WOt(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function VOt(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function qOt(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function _5(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function GOt(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function HOt(e,t){return`Specified orient "${e}" overridden with "${t}".`}const XOt=`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`;function YOt(e){return`Cannot use the scale property "${e}" with non-color channel.`}function KOt(e){return`Using unaggregated domain with raw field has no effect (${Zn(e)}).`}function QOt(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function ZOt(e){return`Unaggregated domain is currently unsupported for log scale (${Zn(e)}).`}function JOt(e){return`Cannot apply size to non-oriented mark "${e}".`}function eMt(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function tMt(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function tke(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function nke(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function nMt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Zn(n)} and ${Zn(r)}). Using ${Zn(n)}.`}function rMt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${Zn(n)} and ${Zn(r)}). Using the union of the two domains.`}function iMt(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function sMt(e){return`Dropping sort property ${Zn(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const foe="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",oMt="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",aMt="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",uMt="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function lMt(e){return`Cannot stack "${e}" if there is already "${e}2".`}function cMt(e){return`Cannot stack non-linear scale (${e}).`}function fMt(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function XN(e,t){return`Invalid ${e}: ${Zn(t)}.`}function dMt(e){return`Dropping day from datetime ${Zn(e)} as day cannot be combined with other units.`}function hMt(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function pMt(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function gMt(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function mMt(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function doe(e){return`1D error band does not support ${e}.`}function rke(e){return`Channel ${e} is required for "binned" bin.`}function yMt(e){return`Domain for ${e} is required for threshold scale.`}const ike=mRt(kSe);let Qy=ike;function xMt(e){return Qy=e,Qy}function bMt(){return Qy=ike,Qy}function Fe(...e){Qy.warn(...e)}function vMt(...e){Qy.debug(...e)}function qb(e){if(e&&$i(e)){for(const t of oX)if(t in e)return!0}return!1}const ske=["january","february","march","april","may","june","july","august","september","october","november","december"],wMt=ske.map(e=>e.substr(0,3)),oke=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],$Mt=oke.map(e=>e.substr(0,3));function CMt(e){if(XH(e)&&(e=+e),Mr(e))return e>4&&Fe(XN("quarter",e)),e-1;throw new Error(XN("quarter",e))}function SMt(e){if(XH(e)&&(e=+e),Mr(e))return e-1;{const t=e.toLowerCase(),n=ske.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=wMt.indexOf(r);if(i!==-1)return i;throw new Error(XN("month",e))}}function kMt(e){if(XH(e)&&(e=+e),Mr(e))return e%7;{const t=e.toLowerCase(),n=oke.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=$Mt.indexOf(r);if(i!==-1)return i;throw new Error(XN("day",e))}}function sX(e,t){const n=[];if(t&&e.day!==void 0&&Oe(e).length>1&&(Fe(dMt(e)),e=Ut(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?SMt(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?CMt(e.quarter):e.quarter;n.push(Mr(r)?r*3:r+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?kMt(e.day):e.day;n.push(Mr(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i>"u"?0:i)}return n}function tC(e){const n=sX(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function EMt(e){const n=sX(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function AMt(e){const t=sX(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const ake={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},oX=Oe(ake);function _Mt(e){return!!ake[e]}function aX(e){return e.startsWith("utc")}function TMt(e){return e.substr(3)}const IMt={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function uX(e){const t=[];for(const n of oX)uke(e,n)&&t.push(n);return t}function uke(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function NMt(e,t,{end:n}={end:!1}){const r=NSe(t),i=aX(e)?"utc":"";function s(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let o;const a={};for(const u of oX)uke(e,u)&&(a[u]=s(u),o=u);return n&&(a[o]+="+1"),EMt(a)}function lke(e){if(!e)return;const t=uX(e);return`timeUnitSpecifier(${Q$(t)}, ${Q$(IMt)})`}function DMt(e,t,n){if(!e)return;const r=lke(e);return`${n||aX(e)?"utc":"time"}Format(${t}, ${r})`}function Zs(e){if(!e)return;let t;return zt(e)?t={unit:e}:$i(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),aX(t.unit)&&(t.utc=!0,t.unit=TMt(t.unit)),t}function FMt(e){const t=Zs(e),{utc:n}=t,r=ht(t,["utc"]);return r.unit?(n?"utc":"")+Oe(r).map(i=>er(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+Oe(r).map(i=>er(`_${i}_${r[i]}`)).join("")}function kt(e){return e&&!!e.signal}function Sp(e){return!!e.step}function RMt(e){return yt(e)?!1:"fields"in e&&!("data"in e)}function OMt(e){return yt(e)?!1:"fields"in e&&"data"in e}function Qd(e){return yt(e)?!1:"field"in e&&"data"in e}const MMt={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},LMt=Oe(MMt),PMt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},T5=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function BMt(e){return e==null?void 0:e.selection}function lX(e){return e&&!!e.field&&e.equal!==void 0}function cke(e){return e&&!!e.field&&e.lt!==void 0}function fke(e){return e&&!!e.field&&e.lte!==void 0}function dke(e){return e&&!!e.field&&e.gt!==void 0}function hke(e){return e&&!!e.field&&e.gte!==void 0}function cX(e){if(e&&e.field){if(yt(e.range)&&e.range.length===2)return!0;if(kt(e.range))return!0}return!1}function fX(e){return e&&!!e.field&&(yt(e.oneOf)||yt(e.in))}function zMt(e){return e&&!!e.field&&e.valid!==void 0}function pke(e){return fX(e)||lX(e)||cX(e)||cke(e)||dke(e)||fke(e)||hke(e)}function pl(e,t){return EX(e,{timeUnit:t,wrapTime:!0})}function UMt(e,t){return e.map(n=>pl(n,t))}function gke(e,t=!0){var n;const{field:r}=e,i=(n=Zs(e.timeUnit))===null||n===void 0?void 0:n.unit,s=i?"time("+NMt(i,r)+")":Be(e,{expr:"datum"});if(lX(e))return s+"==="+pl(e.equal,i);if(cke(e)){const o=e.lt;return`${s}<${pl(o,i)}`}else if(dke(e)){const o=e.gt;return`${s}>${pl(o,i)}`}else if(fke(e)){const o=e.lte;return`${s}<=${pl(o,i)}`}else if(hke(e)){const o=e.gte;return`${s}>=${pl(o,i)}`}else{if(fX(e))return`indexof([${UMt(e.oneOf,i).join(",")}], ${s}) !== -1`;if(zMt(e))return dX(s,e.valid);if(cX(e)){const{range:o}=e,a=kt(o)?{signal:`${o.signal}[0]`}:o[0],u=kt(o)?{signal:`${o.signal}[1]`}:o[1];if(a!==null&&u!==null&&t)return"inrange("+s+", ["+pl(a,i)+", "+pl(u,i)+"])";const l=[];return a!==null&&l.push(`${s} >= ${pl(a,i)}`),u!==null&&l.push(`${s} <= ${pl(u,i)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function dX(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function jMt(e){var t;return pke(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Zs(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const Gb={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},Im=Gb.quantitative,hX=Gb.ordinal,Zy=Gb.temporal,pX=Gb.nominal,Hb=Gb.geojson,WMt=Oe(Gb);function VMt(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Im:return"quantitative";case"t":case Zy:return"temporal";case"o":case hX:return"ordinal";case"n":case pX:return"nominal";case Hb:return"geojson"}}const _r={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},m7={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},qMt=Oe(m7);function GMt(e,t){const n=m7[e],r=m7[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const HMt={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function hoe(e){return HMt[e]}const mke=["linear","log","pow","sqrt","symlog","time","utc"],XMt=k0(mke),YMt=["linear","log","pow","sqrt","symlog"],KMt=k0(YMt);function QMt(e){return e in KMt}const ZMt=["quantile","quantize","threshold"],JMt=k0(ZMt),e4t=mke.concat(["quantile","quantize","threshold","sequential","identity"]),t4t=k0(e4t),n4t=["ordinal","bin-ordinal","point","band"],r4t=k0(n4t);function Po(e){return e in r4t}function Ha(e){return e in t4t}function Au(e){return e in XMt}function YN(e){return e in JMt}const i4t={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function s4t(e){return!zt(e)&&!!e.name}function yke(e){return e==null?void 0:e.selection}function o4t(e){return e&&e.unionWith}const a4t={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},u4t=ht(a4t,["type","domain","range","scheme"]),l4t=Oe(u4t);c4t();function xke(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!bt(["point","band","identity"],e);case"bins":return!bt(["point","band","identity","ordinal"],e);case"round":return Au(e)||e==="band"||e==="point";case"padding":return Au(e)||bt(["point","band"],e);case"paddingOuter":case"align":return bt(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return Au(e);case"nice":return Au(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Ha(e)&&!bt(["log","time","utc","threshold","quantile"],e)}}function bke(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return ey(e)?void 0:YOt(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function vke(e,t){return bt([hX,pX],t)?e===void 0||Po(e):t===Zy?bt([_r.TIME,_r.UTC,void 0],e):t===Im?bt([_r.LOG,_r.POW,_r.SQRT,_r.SYMLOG,_r.QUANTILE,_r.QUANTIZE,_r.THRESHOLD,_r.LINEAR,void 0],e):!0}function wke(e,t){if(!Cp(e))return!1;switch(e){case lr:case Qr:case tl:case $c:return Au(t)||bt(["band","point"],t);case Kf:case vp:case Qf:case xp:case bp:case _0:return Au(t)||YN(t)||bt(["band","point","ordinal"],t);case Mo:case kc:case Ec:return t!=="band";case wp:return t==="ordinal"||YN(t);case Lo:return t==="ordinal"}}function c4t(){var e;const t={};for(const n of qSe)for(const r of WMt)for(const i of qMt){const s=f4t(n,r);wke(n,i)&&vke(i,r)&&(t[s]=(e=t[s])!==null&&e!==void 0?e:[],t[s].push(i))}return t}function f4t(e,t){return e+"_"+t}function gX(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:s}=e,o=Cke(e);return qe(n)&&!zSe(n.aggregate)&&i&&Au(i.get("type"))&&i.get("zero")===!1?$ke({fieldDef:n,channel:t,markDef:r,ref:o,config:s}):o}function $ke({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return E0(n.type)||yn("invalid",n,i)===null?r:[d4t(e,t),r]}function d4t(e,t){const n=mX(e,!0),i=T0(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function mX(e,t=!0){return dX(zt(e)?e:Be(e,{expr:"datum"}),!t)}function h4t(e){const{datum:t}=e;return qb(t)?tC(t):`${JSON.stringify(t)}`}function Xg(e,t,n,r){const i={};if(t&&(i.scale=t),kp(e)){const{datum:s}=e;qb(s)?i.signal=tC(s):kt(s)?i.signal=s.signal:i.value=s}else i.field=Be(e,n);if(r){const{offset:s,band:o}=r;s&&(i.offset=s),o&&(i.band=o)}return i}function KN({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:s=.5}){const o=0<s&&s<1?"datum":void 0,a=Be(t,{expr:o,suffix:i}),u=n!==void 0?Be(n,{expr:o}):Be(t,{suffix:"end",expr:o}),l={};if(s===0||s===1){l.scale=e;const c=s===0?a:u;l.field=c}else{const c=`${s} * ${a} + ${1-s} * ${u}`;l.signal=`scale("${e}", ${c})`}return r&&(l.offset=r),l}function Cke({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l,band:c}){var f;if(t){if(_t(t)){if(la(t)){c=c??zk({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:a,config:i,isMidPoint:!0});const{bin:h,timeUnit:p,type:m}=t;if(Pn(h)||c&&p&&m===Zy)return a&&a.impute?Xg(t,s,{binSuffix:"mid"},{offset:u}):c?KN({scaleName:s,fieldOrDatumDef:t,band:c,offset:u}):Xg(t,s,Uk(t,e)?{binSuffix:"range"}:{},{offset:u});if(zs(h)){if(qe(n))return KN({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:u});Fe(rke(e===lr?el:wc))}}const d=o==null?void 0:o.get("type");return Xg(t,s,Po(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c??t.band)!==null&&f!==void 0?f:.5:void 0})}else if(Mf(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},Tw(e,d)),h)}}return xRt(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function Tw(e,t){return bt(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:bt(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:Cr(t)}function Nm(e){return e&&e!=="number"&&e!=="time"}function Ske(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}const p4t=" – ";function yX({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:s}){var o,a;if(Nm(n))return xX({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:s});const u=kke(e,r,i);if(oM(e)){const l=m4t(u,qe(e)?(o=Zs(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0,t,s.timeFormat,CX(e)&&((a=e.scale)===null||a===void 0?void 0:a.type)===_r.UTC);return l?{signal:l}:void 0}if(t=_ke(Dd(e),t,s),qe(e)&&Pn(e.bin)){const l=Be(e,{expr:r,binSuffix:"end"});return{signal:tM(u,l,t,n,s)}}else return t||Dd(e)==="quantitative"?{signal:`${Tke(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function kke(e,t,n){return qe(e)?n?`${Be(e,{expr:t,suffix:"end"})}-${Be(e,{expr:t,suffix:"start"})}`:Be(e,{expr:t}):h4t(e)}function xX({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:s,field:o}){if(o=o??kke(e,r,i),qe(e)&&Pn(e.bin)){const a=Be(e,{expr:r,binSuffix:"end"});return{signal:tM(o,a,t,n,s)}}return{signal:Ske(n,o,t)}}function Eke(e,t,n,r,i,s){var o;if(!Nm(r)){if(oM(e)){const a=qe(e)?(o=Zs(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0;return g4t(n,a,i,s)}return _ke(t,n,i)}}function Ake(e,t,n){if(e&&(kt(e)||e==="number"||e==="time"))return e;if(oM(t)&&n!=="time"&&n!=="utc")return"time"}function _ke(e,t,n){if(zt(t))return t;if(e===Im)return n.numberFormat}function g4t(e,t,n,r){return e||(t?{signal:lke(t)}:r?void 0:n.timeFormat)}function Tke(e,t){return`format(${e}, "${t||""}")`}function poe(e,t,n,r){var i;return Nm(n)?Ske(n,e,t):Tke(e,(i=zt(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function tM(e,t,n,r,i){const s=poe(e,n,r,i),o=poe(t,n,r,i);return`${dX(e,!1)} ? "null" : ${s} + "${p4t}" + ${o}`}function m4t(e,t,n,r,i){return!t||n?(n=zt(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):DMt(t,e,i)}const nM="min",y4t={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function goe(e){return e in y4t}function Ike(e){return!!e&&!!e.encoding}function Bl(e){return!!e&&(e.op==="count"||!!e.field)}function Nke(e){return!!e&&yt(e)}function Bk(e){return"row"in e||"column"in e}function bX(e){return!!e&&"header"in e}function rM(e){return"facet"in e}function x4t(e){return e.selection}function b4t(e){return e&&!zt(e)&&"repeat"in e}function moe(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function Dke(e){return la(e)&&"sort"in e}function zk({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:i,config:s,isMidPoint:o}){if(_t(t)&&t.band!==void 0)return t.band;if(qe(t)){const{timeUnit:a,bin:u}=t;if(a&&!n)return o?Dm("timeUnitBandPosition",r,s):toe(r.type)?Dm("timeUnitBand",r,s):0;if(Pn(u))return toe(r.type)&&!o?1:.5}if((i==null?void 0:i.fieldChannel)===e&&o)return .5}function vX(e,t,n,r,i,s){return Pn(t.bin)||t.timeUnit&&la(t)&&t.type==="temporal"?!!zk({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:s}):!1}function wX(e){return!!e&&"condition"in e}function iM(e){const t=e&&e.condition;return!!t&&!yt(t)&&qe(t)}function $X(e){const t=e&&e.condition;return!!t&&!yt(t)&&_t(t)}function v4t(e){const t=e&&e.condition;return!!t&&(yt(t)||Mf(t))}function qe(e){return!!e&&(!!e.field||e.aggregate==="count")}function Dd(e){return e&&e.type}function kp(e){return!!e&&"datum"in e}function _l(e){return la(e)&&Mke(e)||y7(e)}function y7(e){return kp(e)&&Mr(e.datum)}function _t(e){return qe(e)||kp(e)}function la(e){return!!e&&("field"in e&&"type"in e||e.aggregate==="count")}function Mf(e){return e&&"value"in e&&"value"in e}function CX(e){return!!e&&("scale"in e||"sort"in e)}function SX(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Fke(e){return!!e&&"legend"in e}function Rke(e){return!!e&&("format"in e||"formatType"in e)}function w4t(e){return"op"in e}function Be(e,t={}){var n,r,i;let s=e.field;const o=t.prefix;let a=t.suffix,u="";if($4t(e))s=ORt("count");else{let l;if(!t.nofn)if(w4t(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Pn(c)?(l=QSe(c),a=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?A0(f)?(u=`["${s}"]`,s=`argmax_${f.argmax}`):Vh(f)?(u=`["${s}"]`,s=`argmin_${f.argmin}`):l=String(f):d&&(l=FMt(d),a=(!bt(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}l&&(s=s?`${l}_${s}`:l)}return a&&(s=`${s}_${a}`),o&&(s=`${o}_${s}`),t.forAs?DSe(s):t.expr?NRt(s,t.expr)+u:Wh(s)+u}function Oke(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return qe(e)&&!!e.bin;case"temporal":return!1}throw new Error(JSe(e.type))}function Mke(e){return!Oke(e)}function $4t(e){return e.aggregate==="count"}function C4t(e,t){var n;const{field:r,bin:i,timeUnit:s,aggregate:o}=e;if(o==="count")return t.countTitle;if(Pn(i))return`${r} (binned)`;if(s){const a=(n=Zs(s))===null||n===void 0?void 0:n.unit;if(a)return`${r} (${uX(a).join("-")})`}else if(o)return A0(o)?`${r} for max ${o.argmax}`:Vh(o)?`${r} for min ${o.argmin}`:`${zO(o)} of ${r}`;return r}function S4t(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(A0(t))return`${i} for argmax(${t.argmax})`;if(Vh(t))return`${i} for argmin(${t.argmin})`;const s=Zs(r),o=t||(s==null?void 0:s.unit)||(s==null?void 0:s.maxbins)&&"timeunit"||Pn(n)&&"bin";return o?o.toUpperCase()+"("+i+")":i}const Lke=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return S4t(e);default:return C4t(e,t)}};let Pke=Lke;function Bke(e){Pke=e}function k4t(){Bke(Lke)}function Yg(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,s;const a=((i=kX(e))!==null&&i!==void 0?i:{}).title;if(!qe(e))return a;const u=e,l=r?zke(u,t):void 0;return n?Lr(a,u.title,l):(s=a??u.title)!==null&&s!==void 0?s:l}function kX(e){if(SX(e)&&e.axis)return e.axis;if(Fke(e)&&e.legend)return e.legend;if(bX(e)&&e.header)return e.header}function zke(e,t){return Pke(e,t)}function QN(e){var t;if(Rke(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}else{const n=(t=kX(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function E4t(e,t){if(e.timeUnit)return"temporal";if(Pn(e.bin))return"quantitative";switch(MT(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function sc(e){if(qe(e))return e;if(iM(e))return e.condition}function Xr(e){if(_t(e))return e;if($X(e))return e.condition}function x7(e,t,n){if(zt(e)||Mr(e)||Fk(e)){const r=zt(e)?"string":Mr(e)?"number":"boolean";return Fe(POt(t,r,e)),{value:e}}return _t(e)?ZN(e,t,n):$X(e)?Object.assign(Object.assign({},e),{condition:ZN(e.condition,t,n)}):e}function ZN(e,t,n){if(Rke(e)){const{format:r,formatType:i}=e,s=ht(e,["format","formatType"]);if(Nm(i)&&!n.customFormatTypes)return Fe(coe(t)),ZN(s,t,n)}else{const r=SX(e)?"axis":Fke(e)?"legend":bX(e)?"header":null;if(r&&e[r]){const i=e[r],{format:s,formatType:o}=i,a=ht(i,["format","formatType"]);if(Nm(o)&&!n.customFormatTypes)return Fe(coe(t)),ZN(Object.assign(Object.assign({},e),{[r]:a}),t,n)}}return qe(e)?Uke(e,t):A4t(e)}function A4t(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Mr(n)?"quantitative":zt(n)?"nominal":qb(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function Uke(e,t){const{aggregate:n,timeUnit:r,bin:i,field:s}=e,o=Object.assign({},e);if(n&&!JH(n)&&!A0(n)&&!Vh(n)&&(Fe(zOt(n)),delete o.aggregate),r&&(o.timeUnit=Zs(r)),s&&(o.field=`${s}`),Pn(i)&&(o.bin=sM(i,t)),zs(i)&&!ic(t)&&Fe(`Channel ${t} should not be used with "binned" bin.`),la(o)){const{type:a}=o,u=VMt(a);a!==u&&(o.type=u),a!=="quantitative"&&zSe(n)&&(Fe(BOt(a,n)),o.type="quantitative")}else if(!HSe(t)){const a=E4t(o,t);Fe(UOt(t,a)),o.type=a}if(la(o)){const{compatible:a,warning:u}=_4t(o,t);a||Fe(u)}if(Dke(o)&&zt(o.sort)){const{sort:a}=o;if(goe(a))return Object.assign(Object.assign({},o),{sort:{encoding:a}});const u=a.substr(1);if(a.charAt(0)==="-"&&goe(u))return Object.assign(Object.assign({},o),{sort:{encoding:u,order:"descending"}})}if(bX(o)){const{header:a}=o,{orient:u}=a,l=ht(a,["orient"]);if(u)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},l),{labelOrient:a.labelOrient||u,titleOrient:a.titleOrient||u})})}return o}function sM(e,t){return Fk(e)?{maxbins:roe(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:roe(t)}):e}const Qp={compatible:!0};function _4t(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case vf:case wf:case GO:return Mke(e)?{compatible:!1,warning:VOt(t)}:Qp;case lr:case Qr:case Mo:case kc:case Ec:case Ok:case Lk:case HO:case Tm:case XO:case YO:case _0:case tl:case $c:case KO:return Qp;case Sc:case qa:case Cc:case nl:return n!==Im?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Qp;case Qf:case xp:case bp:case vp:case Kf:case Yf:case Xf:case el:case wc:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Qp;case wp:return bt(["ordinal","nominal"],e.type)?Qp:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case Lo:return bt(["ordinal","nominal","geojson"],e.type)?Qp:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case Mk:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Qp}}function oM(e){const{formatType:t}=QN(e);return t==="time"||!t&&T4t(e)}function T4t(e){return e&&(e.type==="temporal"||qe(e)&&!!e.timeUnit)}function EX(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var s;const o=t&&((s=Zs(t))===null||s===void 0?void 0:s.unit);let a=o||n==="temporal",u;return kt(e)?u=e.signal:qb(e)?(a=!0,u=tC(e)):(zt(e)||Mr(e))&&a&&(u=`datetime(${JSON.stringify(e)})`,_Mt(o)&&(Mr(e)&&e<1e4||zt(e)&&isNaN(Date.parse(e)))&&(u=tC({[o]:e}))),u?r&&a?`time(${u})`:u:i?void 0:JSON.stringify(e)}function jke(e,t){const{type:n}=e;return t.map(r=>{const i=EX(r,{timeUnit:qe(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function Uk(e,t){return Pn(e.bin)?Cp(t)&&bt(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function Wke(e){const{anchor:t,frame:n,offset:r,orient:i,color:s,subtitleColor:o,subtitleFont:a,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:d}=e,h=ht(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},h),s?{fill:s}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),x=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),a?{subtitleFont:a}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{}),b=Z$(p,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:p,subtitleMarkConfig:b,nonMark:m,subtitle:x}}function Fd(e){return zt(e)||yt(e)&&zt(e[0])}function Cr(e){return kt(e)?e:e!==void 0?{value:e}:void 0}function yoe(e){return kt(e)?e.signal:Zt(e.value)}function nC(e){return kt(e)?e.signal:e==null?null:Zt(e)}function I4t(e,t,n){for(const r of n){const i=Dm(r,t.markDef,t.config);i!==void 0&&(e[r]=Cr(i))}return e}function Vke(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function yn(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:s}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:s&&(!i||i===e)?void 0:Dm(e,t,n,r)}function Dm(e,t,n,{vgChannel:r}={}){return Lr(r?JN(e,t,n.style):void 0,JN(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function JN(e,t,n){return qke(e,Vke(t),n)}function qke(e,t,n){t=Er(t);let r;for(const i of t){const s=n[i];s&&s[e]!==void 0&&(r=s[e])}return r}function Gke(e,t){return Er(e).reduce((n,r)=>{var i;return n.field.push(Be(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function Hke(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(Rk(i,r))return;n.push(r)}),n}function Xke(e,t){return Rk(e,t)||!t?e:e?[...Er(e),...Er(t)].join(", "):t}function Yke(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Fd(n)||kt(n))&&(Fd(r)||kt(r)))return{explicit:e.explicit,value:Xke(n,r)};if(Fd(n)||kt(n))return{explicit:e.explicit,value:n};if(Fd(r)||kt(r))return{explicit:e.explicit,value:r};if(!Fd(n)&&!kt(n)&&!Fd(r)&&!kt(r))return{explicit:e.explicit,value:Hke(n,r)};throw new Error("It should never reach here")}function Kg(e,t){const n=e&&e[t];return n?yt(n)?J$(n,r=>!!r.field):qe(n)||iM(n):!1}function AX(e){return J$(qSe,t=>{if(Kg(e,t)){const n=e[t];if(yt(n))return J$(n,r=>!!r.aggregate);{const r=sc(n);return r&&!!r.aggregate}}return!1})}function _X(e,t){const n=[],r=[],i=[],s=[],o={};return TX(e,(a,u)=>{if(qe(a)){const{field:l,aggregate:c,bin:f,timeUnit:d}=a,h=ht(a,["field","aggregate","bin","timeUnit"]);if(c||d||f){const p=kX(a),m=p&&p.title;let x=Be(a,{forAs:!0});const b=Object.assign(Object.assign(Object.assign({},m?[]:{title:Yg(a,t,{allowDisabling:!0})}),h),{field:x});if(c){let v;if(A0(c)?(v="argmax",x=Be({op:"argmax",field:c.argmax},{forAs:!0}),b.field=`${x}.${l}`):Vh(c)?(v="argmin",x=Be({op:"argmin",field:c.argmin},{forAs:!0}),b.field=`${x}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const $={op:v,as:x};l&&($.field=l),s.push($)}}else if(n.push(x),la(a)&&Pn(f)){if(r.push({bin:f,field:l,as:x}),n.push(Be(a,{binSuffix:"end"})),Uk(a,u)&&n.push(Be(a,{binSuffix:"range"})),ic(u)){const v={field:x+"_end"};o[u+"2"]=v}b.bin="binned",HSe(u)||(b.type=Im)}else if(d){i.push({timeUnit:d,field:l,as:x});const v=la(a)&&a.type!==Zy&&"time";v&&(u===Ok||u===Tm?b.formatType=v:xOt(u)?b.legend=Object.assign({formatType:v},b.legend):ic(u)&&(b.axis=Object.assign({formatType:v},b.axis)))}o[u]=b}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:r,timeUnits:i,aggregate:s,groupby:n,encoding:o}}function N4t(e,t,n){const r=vOt(t,n);if(r){if(r==="binned"){const i=e[t===el?lr:Qr];return!!(qe(i)&&qe(e[t])&&zs(i.bin))}}else return!1;return!0}function D4t(e,t,n){const r=t.type;return Oe(e).reduce((i,s)=>{if(!GSe(s))return Fe(WOt(s)),i;const o=e[s];if(s==="angle"&&r==="arc"&&!e.theta&&(Fe(LOt),s=tl),!N4t(e,s,r))return Fe(eM(s,r)),i;if(s===Kf&&r==="line"){const a=sc(e[s]);if(a!=null&&a.aggregate)return Fe(jOt),i}if(s===Mo&&(t.filled?"fill"in e:"stroke"in e))return Fe(eke("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(s===Lk||s===Mk&&!yt(o)&&!Mf(o)||s===Tm&&yt(o))o&&(i[s]=Er(o).reduce((a,u)=>(qe(u)?a.push(Uke(u,s)):Fe(g7(u,s)),a),[]));else{if(s===Tm&&o===null)i[s]=null;else if(!qe(o)&&!kp(o)&&!Mf(o)&&!wX(o)&&!kt(o))return Fe(g7(o,s)),i;i[s]=x7(o,s,n)}return i},{})}function F4t(e){const t=[];for(const n of Oe(e))if(Kg(e,n)){const r=e[n],i=Er(r);for(const s of i)qe(s)?t.push(s):iM(s)&&t.push(s.condition)}return t}function TX(e,t,n){if(e)for(const r of Oe(e)){const i=e[r];if(yt(i))for(const s of i)t.call(n,s,r);else t.call(n,i,r)}}function Kke(e,t,n,r){return e?Oe(e).reduce((i,s)=>{const o=e[s];return yt(o)?o.reduce((a,u)=>t.call(r,a,u,s),i):t.call(r,i,o,s)},n):n}function Qke(e,t){return Oe(t).reduce((n,r)=>{switch(r){case lr:case Qr:case XO:case KO:case YO:case el:case wc:case tl:case Yf:case $c:case Xf:case Cc:case Sc:case nl:case qa:case Ok:case Lo:case _0:case Tm:return n;case Mk:if(e==="line"||e==="trail")return n;case Lk:case HO:{const i=t[r];if(yt(i)||qe(i))for(const s of Er(i))s.aggregate||n.push(Be(s,{}));return n}case Kf:if(e==="trail")return n;case Mo:case kc:case Ec:case Qf:case xp:case bp:case wp:case vp:{const i=sc(t[r]);return i&&!i.aggregate&&n.push(Be(i,{})),n}}},[])}function R4t(e){const{tooltip:t}=e,n=ht(e,["tooltip"]);if(!t)return{filteredEncoding:e};let r,i;if(yt(t)){for(const s of t)s.aggregate?(r||(r=[]),r.push(s)):(i||(i=[]),i.push(s));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return yt(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function b7(e,t,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map(({fieldPrefix:s,titlePrefix:o})=>{const a=r?` of ${t.field}`:"";return{field:s+t.field,type:t.type,title:kt(o)?{signal:o+`"${escape(a)}"`}:o+a}}),...F4t(n)]}}function Zke(e){const{axis:t,title:n,field:r}=e;return t&&t.title!==void 0?void 0:Lr(n,r)}function IX(e,t,n,r,i){const{scale:s,axis:o}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,aria:f,extraEncoding:d={}})=>{const h=Zke(n);return Jke(e,a,i,f,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},h!==void 0?{title:h}:{}),s!==void 0?{scale:s}:{}),o!==void 0?{axis:o}:{})},zt(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),r),d)})}}function Jke(e,t,n,r,i){const{clip:s,color:o,opacity:a}=e,u=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),s?{clip:s}:{}),o?{color:o}:{}),a?{opacity:a}:{}),rc(i.mark)?i.mark:{type:i.mark}),{style:`${u}-${t}`}),Fk(e[t])?{}:e[t]),r===!1?{aria:r}:{})})]:[]}function eEe(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",s=r[i],o=r[i+"2"],a=r[i+"Error"],u=r[i+"Error2"];return{continuousAxisChannelDef:d_(s,n),continuousAxisChannelDef2:d_(o,n),continuousAxisChannelDefError:d_(a,n),continuousAxisChannelDefError2:d_(u,n),continuousAxis:i}}function d_(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=ht(e,["aggregate"]);return n!==t&&Fe(gMt(n,t)),r}else return e}function tEe(e,t){const{mark:n,encoding:r}=e,{x:i,y:s}=r;if(_l(i)){if(_l(s)){const o=qe(i)&&i.aggregate,a=qe(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return rc(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(_l(s))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}const eD="boxplot",O4t=["box","median","outliers","rule","ticks"],M4t=new qO(eD,rEe);function nEe(e){return Mr(e)?"tukey":e}function rEe(e,{config:t}){var n,r;const{mark:i,encoding:s,selection:o,projection:a}=e,u=ht(e,["mark","encoding","selection","projection"]),l=rc(i)?i:{type:i};o&&Fe(ZSe("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=yn("size",l,t),d=nEe(c),{transform:h,continuousAxisChannelDef:p,continuousAxis:m,groupby:x,aggregate:b,encodingWithoutContinuousAxis:v,ticksOrient:$,boxOrient:C,customTooltipWithoutAggregatedField:S}=L4t(e,c,t),{color:A,size:E}=v,_=ht(v,["color","size"]),D=q=>IX(l,m,p,q,t.boxplot),N=D(_),T=D(v),L=D(Object.assign(Object.assign({},_),E?{size:E}:{})),O=b7([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],p,v),M={type:"tick",color:"black",opacity:1,orient:$,invalid:null},R=d==="min-max"?O:b7([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,v),P=[...N({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:R}),...N({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:R}),...N({partName:"ticks",mark:M,positionPrefix:"lower_whisker",aria:!1,extraEncoding:R}),...N({partName:"ticks",mark:M,positionPrefix:"upper_whisker",aria:!1,extraEncoding:R})],j=[...d!=="tukey"?P:[],...T({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:C,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:O}),...L({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},$i(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:$,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:O})];let z;if(d!=="min-max"){const q=`datum["lower_box_${p.field}"]`,H=`datum["upper_box_${p.field}"]`,V=`(${H} - ${q})`,X=`${q} - ${c} * ${V}`,re=`${H} + ${c} * ${V}`,le=`datum["${p.field}"]`,ue={joinaggregate:iEe(p.field),groupby:x};let be;d==="tukey"&&(be={transform:[{filter:`(${X} <= ${le}) && (${le} <= ${re})`},{aggregate:[{op:"min",field:p.field,as:"lower_whisker_"+p.field},{op:"max",field:p.field,as:"upper_whisker_"+p.field},{op:"min",field:"lower_box_"+p.field,as:"lower_box_"+p.field},{op:"max",field:"upper_box_"+p.field,as:"upper_box_"+p.field},...b],groupby:x}],layer:P});const _e=ht(_,["tooltip"]),{scale:Ne,axis:Y}=p,ae=Zke(p),he=Jke(l,"outliers",t.boxplot,!0,{transform:[{filter:`(${le} < ${X}) || (${le} > ${re})`}],mark:"point",encoding:Object.assign(Object.assign({[m]:Object.assign(Object.assign(Object.assign({field:p.field,type:p.type},ae!==void 0?{title:ae}:{}),Ne!==void 0?{scale:Ne}:{}),Y!==void 0?{axis:Y}:{})},_e),S?{tooltip:S}:{})})[0];he&&be?z={transform:[ue],layer:[he,be]}:he?(z=he,z.transform.unshift(ue)):be&&(z=be,z.transform.unshift(ue))}return z?Object.assign(Object.assign({},u),{layer:[z,{transform:h,layer:j}]}):Object.assign(Object.assign({},u),{transform:((r=u.transform)!==null&&r!==void 0?r:[]).concat(h),layer:j})}function iEe(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function L4t(e,t,n){const r=tEe(e,eD),{continuousAxisChannelDef:i,continuousAxis:s}=eEe(e,r,eD),o=i.field,a=nEe(t),u=[...iEe(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:(a==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:o,as:(a==="min-max"?"upper_whisker_":"max_")+o}],l=a==="min-max"||a==="tukey"?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:"iqr_"+o},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:"upper_whisker_"+o},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:"lower_whisker_"+o}],c=e.encoding,f=s;c[f];const d=ht(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=R4t(d),{bins:m,timeUnits:x,aggregate:b,groupby:v,encoding:$}=_X(p,n),C=r==="vertical"?"horizontal":"vertical",S=r;return{transform:[...m,...x,{aggregate:[...b,...u],groupby:v},...l],groupby:v,aggregate:b,continuousAxisChannelDef:i,continuousAxis:s,encodingWithoutContinuousAxis:$,ticksOrient:C,boxOrient:S,customTooltipWithoutAggregatedField:h}}const NX="errorbar",P4t=["ticks","rule"],B4t=new qO(NX,sEe);function sEe(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:u,tooltipEncoding:l}=oEe(e,NX,t),c=IX(a,i,r,s,t.errorbar),f={type:"tick",orient:o},d=[...c({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function z4t(e,t){const{encoding:n}=e;if(U4t(n))return{orient:tEe(e,t),inputType:"raw"};const r=j4t(n),i=W4t(n),s=n.x,o=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(_t(a)&&_t(u))throw new Error(`${t} cannot have both x2 and y2`);if(_t(a)){if(_l(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(_t(u)){if(_l(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(_t(u)&&!_t(a))throw new Error(`${t} cannot have xError2 without xError`);if(_t(c)&&!_t(l))throw new Error(`${t} cannot have yError2 without yError`);if(_t(a)&&_t(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(_t(a)){if(_l(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(_t(l)){if(_l(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function U4t(e){return(_t(e.x)||_t(e.y))&&!_t(e.x2)&&!_t(e.y2)&&!_t(e.xError)&&!_t(e.xError2)&&!_t(e.yError)&&!_t(e.yError2)}function j4t(e){return _t(e.x2)||_t(e.y2)}function W4t(e){return _t(e.xError)||_t(e.xError2)||_t(e.yError)||_t(e.yError2)}function oEe(e,t,n){var r;const{mark:i,encoding:s,selection:o,projection:a}=e,u=ht(e,["mark","encoding","selection","projection"]),l=rc(i)?i:{type:i};o&&Fe(ZSe(t));const{orient:c,inputType:f}=z4t(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:m,continuousAxis:x}=eEe(e,c,t),{errorBarSpecificAggregate:b,postAggregateCalculates:v,tooltipSummary:$,tooltipTitleWithFieldName:C}=V4t(l,d,h,p,m,f,t,n),S=s,A=x;S[A];const E=x==="x"?"x2":"y2";S[E];const _=x==="x"?"xError":"yError";S[_];const D=x==="x"?"xError2":"yError2";S[D];const N=ht(S,[typeof A=="symbol"?A:A+"",typeof E=="symbol"?E:E+"",typeof _=="symbol"?_:_+"",typeof D=="symbol"?D:D+""]),{bins:T,timeUnits:L,aggregate:O,groupby:M,encoding:R}=_X(N,n),P=[...O,...b],j=f!=="raw"?[]:M,z=b7($,d,R,C);return{transform:[...(r=u.transform)!==null&&r!==void 0?r:[],...T,...L,...P.length===0?[]:[{aggregate:P,groupby:j}],...v],groupby:j,continuousAxisChannelDef:d,continuousAxis:x,encodingWithoutContinuousAxis:R,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:z}}function V4t(e,t,n,r,i,s,o,a){let u=[],l=[];const c=t.field;let f,d=!1;if(s==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&Fe(pMt(h,p,o)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:"extent_"+c},{op:h,field:c,as:"center_"+c}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:zO(h)},{fieldPrefix:"upper_",titlePrefix:xoe(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:xoe(h,p,"-")}],d=!0;else{e.center&&e.extent&&Fe(mMt(e.extent,o));let m,x,b;p==="ci"?(m="mean",x="ci0",b="ci1"):(m="median",x="q1",b="q3"),u=[{op:x,field:c,as:"lower_"+c},{op:b,field:c,as:"upper_"+c},{op:m,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:Yg({field:c,aggregate:b,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Yg({field:c,aggregate:x,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Yg({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Fe(hMt(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Ky(Ky(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function xoe(e,t,n){return zO(e)+" "+n+" "+t}const DX="errorband",q4t=["band","borders"],G4t=new qO(DX,aEe);function aEe(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:u}=oEe(e,DX,t),l=o,c=IX(l,i,r,s,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign({},h),p)):l.interpolate?Fe(doe("interpolate")):l.tension&&Fe(doe("tension")),Object.assign(Object.assign({},a),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const uEe={};function FX(e,t,n){const r=new qO(e,t);uEe[e]={normalizer:r,parts:n}}function H4t(){return Oe(uEe)}FX(eD,rEe,O4t);FX(NX,sEe,P4t);FX(DX,aEe,q4t);const X4t=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],lEe=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Y4t={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},K4t={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},Q4t={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Jy="_vgsid_",Z4t={single:{on:"click",fields:[Jy],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[Jy],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function RX(e){return!!e&&(e==="legend"||!!e.legend)}function I5(e){return RX(e)&&$i(e)}function J4t(e){return aM(e)||MX(e)||OX(e)}function OX(e){return"concat"in e}function aM(e){return"vconcat"in e}function MX(e){return"hconcat"in e}function oc(e){return $i(e)&&e.step!==void 0}function boe(e){return e.view||e.width||e.height}const voe=20,eLt={align:1,bounds:1,center:1,columns:1,spacing:1},tLt=Oe(eLt);function nLt(e,t,n){var r,i;const s=n[t],o={},{spacing:a,columns:u}=s;a!==void 0&&(o.spacing=a),u!==void 0&&(rM(e)&&!Bk(e.facet)||OX(e))&&(o.columns=u),aM(e)&&(o.columns=1);for(const l of tLt)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];o[l]=Mr(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:a,column:(i=c.column)!==null&&i!==void 0?i:a}}else o[l]=e[l];return o}function v7(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function tD(e,t){const n=rC(e,t);return oc(n)?n.step:LX}function rC(e,t){var n;const r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return Lr(r,{step:e.step})}const LX=20,rLt={continuousWidth:200,continuousHeight:200,step:LX},iLt={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:rLt,mark:HRt,arc:{},area:{},bar:YRt,circle:{},geoshape:{},image:{},line:{},point:{},rect:KRt,rule:{color:"black"},square:{},text:{color:"black"},tick:QRt,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:i4t,projection:{},legend:K4t,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Z4t,style:{},title:{},facet:{spacing:voe},concat:{spacing:voe}},Vc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],woe={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},$oe={blue:Vc[0],orange:Vc[1],red:Vc[2],teal:Vc[3],green:Vc[4],yellow:Vc[5],purple:Vc[6],pink:Vc[7],brown:Vc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function sLt(e={}){return{signals:[{name:"color",value:$i(e)?Object.assign(Object.assign({},$oe),e):$oe}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function oLt(e){return{signals:[{name:"fontSize",value:$i(e)?Object.assign(Object.assign({},woe),e):woe}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function aLt(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function cEe(e={}){const{color:t,font:n,fontSize:r}=e,i=ht(e,["color","font","fontSize"]);return ESe({},iLt,n?aLt(n):{},t?sLt(t):{},r?oLt(r):{},i)}const uLt=["view",...PSe],lLt=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],cLt=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},GRt);function fLt(e){e=Ut(e);for(const t of lLt)delete e[t];if(e.axis)for(const t in e.axis)YH(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of X4t)delete e.legend[t];if(e.mark){for(const t of noe)delete e.mark[t];e.mark.tooltip&&$i(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of uLt){for(const r of noe)delete e[t][r];const n=cLt[t];if(n)for(const r of n)delete e[t][r];hLt(e,t)}for(const t of H4t())delete e[t];dLt(e);for(const t in e)$i(e[t])&&Dn(e[t])&&delete e[t];return Dn(e)?void 0:e}function dLt(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=Wke(e.title);Dn(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Dn(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Dn(r)?delete e.title:e.title=r}function hLt(e,t,n,r){const i=e[t];t==="view"&&(n="cell");const s=Object.assign(Object.assign({},i),e.style[n??t]);Dn(s)||(e.style[n??t]=s),delete e[t]}function uM(e){return"layer"in e}function pLt(e){return"repeat"in e}function gLt(e){return!yt(e.repeat)&&e.repeat.layer}class fEe{map(t,n){return rM(t)?this.mapFacet(t,n):pLt(t)?this.mapRepeat(t,n):MX(t)?this.mapHConcat(t,n):aM(t)?this.mapVConcat(t,n):OX(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(uM(t))return this.mapLayer(t,n);if(Hf(t))return this.mapUnit(t,n);throw new Error(iX(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=ht(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(s=>this.map(s,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const mLt={zero:1,center:1,normalize:1};function yLt(e){return e in mLt}const xLt=new Set([OSe,jO,UO,HN,VO,QH,ZH,WO,MSe,KH]),bLt=new Set([jO,UO,OSe]);function Coe(e,t){var n,r;const i=t==="x"?"y":"radius",s=e[t],o=e[i];if(qe(s)&&qe(o))if(Dd(s)==="quantitative"&&Dd(o)==="quantitative"){if(s.stack)return t;if(o.stack)return i;const a=qe(s)&&!!s.aggregate,u=qe(o)&&!!o.aggregate;if(a!==u)return a?t:i;{const l=(n=s.scale)===null||n===void 0?void 0:n.type,c=(r=o.scale)===null||r===void 0?void 0:r.type;if(l&&l!=="linear")return i;if(c&&c!=="linear")return t}}else{if(Dd(s)==="quantitative")return t;if(Dd(o)==="quantitative")return i}else{if(Dd(s)==="quantitative")return t;if(Dd(o)==="quantitative")return i}}function vLt(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function dEe(e,t,n={}){const r=rc(e)?e.type:e;if(!xLt.has(r))return null;const i=Coe(t,"x")||Coe(t,"theta");if(!i)return null;const s=t[i],o=qe(s)?Be(s,{}):void 0;let a=vLt(i),u=t[a],l=qe(u)?Be(u,{}):void 0;l===o&&(l=void 0,u=void 0,a=void 0);const c=gOt.reduce((d,h)=>{if(h!=="tooltip"&&Kg(t,h)){const p=t[h];for(const m of Er(p)){const x=sc(m);if(x.aggregate)continue;const b=Be(x,{});(!b||b!==l)&&d.push({channel:h,fieldDef:x})}}return d},[]);let f;if(s.stack!==void 0?Fk(s.stack)?f=s.stack?"zero":null:f=s.stack:c.length>0&&bLt.has(r)&&(f="zero"),!f||!yLt(f)||AX(t)&&c.length===0)return null;if(s.scale&&s.scale.type&&s.scale.type!==_r.LINEAR){if(n.disallowNonLinearStack)return null;Fe(cMt(s.scale.type))}return _t(t[Ac(i)])?(s.stack!==void 0&&Fe(lMt(i)),null):(qe(s)&&s.aggregate&&!bt(rOt,s.aggregate)&&Fe(fMt(s.aggregate)),{groupbyChannel:u?a:void 0,groupbyField:l,fieldChannel:i,impute:s.impute===null?!1:E0(r),stackBy:c,offset:f})}function wLt(e){const t=ht(e,["point","line"]);return Oe(t).length>1?t:t.type}function $Lt(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:bf(e[t],["point","line"])}));return e}function N5(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?$i(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?$i(t.point)?t.point:{}:void 0}function Soe(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class CLt{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Hf(t)){const{mark:r,encoding:i}=t,s=rc(r)?r:{type:r};switch(s.type){case"line":case"rule":case"trail":return!!N5(s,n[s.type],i);case"area":return!!N5(s,n[s.type],i)||!!Soe(s,n[s.type])}}return!1}run(t,n,r){const{config:i}=n,{selection:s,projection:o,encoding:a,mark:u}=t,l=ht(t,["selection","projection","encoding","mark"]),c=rc(u)?u:{type:u},f=N5(c,i[c.type],a),d=c.type==="area"&&Soe(c,i[c.type]),h=[Object.assign(Object.assign({},s?{selection:s}:{}),{mark:wLt(Object.assign(Object.assign({},c.type==="area"&&c.opacity===void 0&&c.fillOpacity===void 0?{opacity:.7}:{}),c)),encoding:bf(a,["shape"])})],p=dEe(c,a);let m=a;if(p){const{fieldChannel:x,offset:b}=p;m=Object.assign(Object.assign({},a),{[x]:Object.assign(Object.assign({},a[x]),b?{stack:b}:{})})}return d&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},Z$(c,["clip","interpolate","tension","tooltip"])),d),encoding:m})),f&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Z$(c,["clip","tooltip"])),f),encoding:m})),r(Object.assign(Object.assign({},l),{layer:h}),Object.assign(Object.assign({},n),{config:$Lt(i)}))}}class SLt{constructor(){this.name="RangeStep"}hasMatchingType(t){var n;if(Hf(t)&&t.encoding)for(const r of Ga){const i=t.encoding[r];if(i&&_t(i)&&!((n=i==null?void 0:i.scale)===null||n===void 0)&&n.rangeStep)return!0}return!1}run(t){var n;const r={};let i=Object.assign({},t.encoding);for(const s of Ga){const o=_c(s),a=i[s];if(a&&_t(a)&&!((n=a==null?void 0:a.scale)===null||n===void 0)&&n.rangeStep){const{scale:u}=a,l=ht(a,["scale"]),c=u,f=ht(c,["rangeStep"]);r[o]={step:u.rangeStep},Fe(XOt),i=Object.assign(Object.assign({},i),{[s]:Object.assign(Object.assign({},l),Dn(f)?{}:{scale:f})})}}return Object.assign(Object.assign(Object.assign({},r),t),{encoding:i})}}function kLt(e,t){return t?Bk(e)?pEe(e,t):hEe(e,t):e}function D5(e,t){return t?pEe(e,t):e}function w7(e,t,n){const r=t[e];if(b4t(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});Fe(IOt(r.repeat));return}return t}function hEe(e,t){if(e=w7("field",e,t),e!==void 0){if(e===null)return null;if(Dke(e)&&Bl(e.sort)){const n=w7("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function koe(e,t){if(qe(e))return hEe(e,t);{const n=w7("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function Eoe(e,t){if(_t(e)){const n=koe(e,t);if(n)return n;if(wX(e))return{condition:e.condition}}else{if($X(e)){const n=koe(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):ht(e,["condition"])}return e}}function pEe(e,t){const n={};for(const r in e)if(Fg(e,r)){const i=e[r];if(yt(i))n[r]=i.map(s=>Eoe(s,t)).filter(s=>s);else{const s=Eoe(i,t);s!==void 0&&(n[r]=s)}}return n}class ELt{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Hf(t)){const{encoding:n,mark:r}=t;if(r==="line")for(const i of hOt){const s=T0(i),o=n[s];if(n[i]&&(qe(o)&&!zs(o.bin)||kp(o)))return!0}}return!1}run(t,n,r){const{encoding:i}=t;return Fe(GOt(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:"rule"}),n)}}class ALt extends fEe{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[M4t,B4t,G4t,new CLt,new ELt,new SLt]}map(t,n){if(Hf(t)){const r=Kg(t.encoding,vf),i=Kg(t.encoding,wf),s=Kg(t.encoding,GO);if(r||i||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,s=Object.assign(Object.assign({},t),{encoding:D5(t.encoding,n.repeater)});if(r||i)return this.mapUnitWithParentEncodingOrProjection(s,n);const o=this.mapLayerOrUnit.bind(this);for(const a of this.nonFacetUnitNormalizers)if(a.hasMatchingType(s,n.config))return a.run(s,n,o);return s}mapRepeat(t,n){return gLt(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,s=ht(t,["repeat","spec"]),{row:o,column:a,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),a?{column:a}:{}),spec:{repeat:{layer:u},spec:i}}),n):Object.assign(Object.assign({},s),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=(i.name||"")+c+`child__layer_${er(f)}`,p=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return p.name=h,p})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:s,data:o}=t,a=ht(t,["repeat","spec","data"]);!yt(i)&&t.columns&&(t=bf(t,["columns"]),Fe(uoe("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!yt(i)&&i.row||[l?l.row:null],d=!yt(i)&&i.column||[l?l.column:null],h=yt(i)&&i||[l?l.repeat:null];for(const m of h)for(const x of f)for(const b of d){const v={repeat:m,row:x,column:b,layer:l.layer},$=(s.name||"")+c+"child__"+(yt(i)?`${er(m)}`:(i.row?`row_${er(x)}`:"")+(i.column?`column_${er(b)}`:"")),C=this.map(s,Object.assign(Object.assign({},n),{repeater:v,repeaterPrefix:$}));C.name=$,u.push(bf(C,["data"]))}const p=yt(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=s.data)!==null&&r!==void 0?r:o,align:"all"},a),{columns:p,concat:u})}mapFacet(t,n){const{facet:r}=t;return Bk(r)&&t.columns&&(t=bf(t,["columns"]),Fe(uoe("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:s,parentProjection:o,config:a}=n,u=_oe({parentProjection:o,projection:i}),l=Aoe({parentEncoding:s,encoding:D5(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:a})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:s,facet:o}=r,a=ht(r,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,selection:h,encoding:p}=t,m=ht(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:x,layout:b}=this.getFacetMappingAndLayout({row:i,column:s,facet:o},n),v=D5(a,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},m),b),{facet:x,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:v}),h?{selection:h}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:s,facet:o}=t;if(i||s){o&&Fe(qOt([...i?[vf]:[],...s?[wf]:[]]));const a={},u={};for(const l of[vf,wf]){const c=t[l];if(c){const f=ht(c,["align","center","spacing","columns"]);a[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&(u[d]=(r=u[d])!==null&&r!==void 0?r:{},u[d][l]=c[d])}}return{facetMapping:a,layout:u}}else{const{align:a,center:u,spacing:l,columns:c}=o,f=ht(o,["align","center","spacing","columns"]);return{facetMapping:kLt(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},a?{align:a}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,s=ht(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:a}=t,u=ht(t,["encoding","projection"]),l=Object.assign(Object.assign({},s),{parentEncoding:Aoe({parentEncoding:r,encoding:o}),parentProjection:_oe({parentProjection:i,projection:a})});return super.mapLayer(u,l)}}function Aoe(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const i=Oe(t).reduce((s,o)=>(n[o]&&s.push(o),s),[]);i.length>0&&Fe(OOt(i))}const r=Object.assign(Object.assign({},t??{}),n??{});return Dn(r)?void 0:r}function _oe(e){const{parentProjection:t,projection:n}=e;return t&&n&&Fe(MOt({parentProjection:t,projection:n})),n??t}function gEe(e,t){t===void 0&&(t=cEe(e.config));const n=TLt(e,t),{width:r,height:i}=e,s=ILt(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}const _Lt=new ALt;function TLt(e,t={}){return _Lt.map(e,{config:t})}function Toe(e){return zt(e)?{type:e}:e??{}}function ILt(e,t,n){let{width:r,height:i}=t;const s=Hf(e)||uM(e),o={};s?r=="container"&&i=="container"?(o.type="fit",o.contains="padding"):r=="container"?(o.type="fit-x",o.contains="padding"):i=="container"&&(o.type="fit-y",o.contains="padding"):(r=="container"&&(Fe(ioe("width")),r=void 0),i=="container"&&(Fe(ioe("height")),i=void 0));const a=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?Toe(n.autosize):{}),Toe(e.autosize));if(a.type==="fit"&&!s&&(Fe(COt),a.type="pad"),r=="container"&&!(a.type=="fit"||a.type=="fit-x")&&Fe(soe("width")),i=="container"&&!(a.type=="fit"||a.type=="fit-y")&&Fe(soe("height")),!Rk(a,{type:"pad"}))return a}function NLt(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function DLt(e){return e?`fit-${QO(e)}`:"fit"}const FLt=["background","padding"];function Ioe(e){return FLt.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}class Zf{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Zf(Ut(this.explicit),Ut(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return Lr(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of Oe(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function Rg(e){return{explicit:!0,value:e}}function Xo(e){return{explicit:!1,value:e}}function mEe(e){return(t,n,r,i)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:lM(t,n,r,i)}}function lM(e,t,n,r){return e.explicit&&t.explicit&&Fe(nMt(n,r,e.value,t.value)),e}function Gh(e,t,n,r,i=lM){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Rk(e.value,t.value)?e:i(e,t,n,r)}class RLt extends Zf{constructor(t={},n={},r=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function iC(e){return"url"in e}function nD(e){return"values"in e}function yEe(e){return"name"in e&&!iC(e)&&!nD(e)&&!Qg(e)}function Qg(e){return e&&(xEe(e)||bEe(e)||PX(e))}function xEe(e){return"sequence"in e}function bEe(e){return"sphere"in e}function PX(e){return"graticule"in e}const os="main",rD="raw";function vEe(e){return"filter"in e}function OLt(e){return(e==null?void 0:e.stop)!==void 0}function MLt(e){return"lookup"in e}function LLt(e){return"data"in e}function PLt(e){return"selection"in e}function BLt(e){return"pivot"in e}function zLt(e){return"density"in e}function ULt(e){return"quantile"in e}function jLt(e){return"regression"in e}function WLt(e){return"loess"in e}function VLt(e){return"sample"in e}function qLt(e){return"window"in e}function GLt(e){return"joinaggregate"in e}function HLt(e){return"flatten"in e}function XLt(e){return"calculate"in e}function YLt(e){return"bin"in e}function KLt(e){return"impute"in e}function QLt(e){return"timeUnit"in e}function ZLt(e){return"aggregate"in e}function JLt(e){return"stack"in e}function ePt(e){return"fold"in e}function tPt(e){return e.map(t=>vEe(t)?{filter:OT(t.filter,jMt)}:t)}function jk(e,t,n,r){const i=wX(t)&&t.condition,s=r(t);if(i){const a=Er(i).map(u=>{const l=r(u),c=x4t(u)?GEe(e,u.selection):aD(e,u.test);return Object.assign({test:c},l)});return{[n]:[...a,...s!==void 0?[s]:[]]}}else return s!==void 0?{[n]:s}:{}}function BX(e,t="text"){const n=e.encoding[t];return jk(e,n,t,r=>cM(r,e.config))}function cM(e,t,n="datum"){if(e){if(Mf(e))return Cr(e.value);if(_t(e)){const{format:r,formatType:i}=QN(e);return yX({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function wEe(e,t={}){const{encoding:n,markDef:r,config:i,stack:s}=e,o=n.tooltip;if(yt(o))return{tooltip:Noe({tooltip:o},s,i,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return jk(e,o,"tooltip",u=>{const l=cM(u,i,a);if(l)return l;if(u===null)return;let c=yn("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),zt(c))return{value:c};if($i(c))return c.content==="encoding"?Noe(n,s,i,t):{signal:a}})}}function $Ee(e,t,n,{reactiveGeom:r}={}){const i={},s=r?"datum.datum":"datum",o=[];function a(l,c){const f=T0(c),d=la(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=Er(Yg(d,n,{allowDisabling:!1})).join(", ");let p;if(ic(c)){const m=c==="x"?"x2":"y2",x=sc(e[m]);if(zs(d.bin)&&x){const b=Be(d,{expr:s}),v=Be(x,{expr:s}),{format:$,formatType:C}=QN(d);p=tM(b,v,$,C,n),i[m]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:b,formatType:v}=QN(d);p=yX({fieldOrDatumDef:d,format:b,formatType:v,expr:s,config:n,normalizeStack:!0}).signal}}p=p??cM(d,n,s).signal,o.push({channel:c,key:h,value:p})}TX(e,(l,c)=>{qe(l)?a(l,c):iM(l)&&a(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of o)!i[l]&&!u[c]&&(u[Zt(c)]=f);return u}function Noe(e,t,n,{reactiveGeom:r}={}){const i=$Ee(e,t,n,{reactiveGeom:r}),s=ISe(i).map(({key:o,value:a})=>`${o}: ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function nPt(e){const{markDef:t,config:n}=e,r=yn("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),rPt(e)),iPt(e))}function rPt(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=yn("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in PMt?{}:{ariaRoleDescription:{value:t}}}function iPt(e){const{encoding:t,markDef:n,config:r,stack:i}=e,s=t.description;if(s)return jk(e,s,"description",u=>cM(u,e.config));const o=yn("description",n,r);if(o!=null)return{description:Cr(o)};if(r.aria===!1)return{};const a=$Ee(t,i,r);if(!Dn(a))return{description:{signal:ISe(a).map(({key:u,value:l})=>`${u} + ": " + (${l})`).join(' + "; " + ')}}}function di(e,t,n={}){const{markDef:r,encoding:i,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:u}=n;a===void 0&&(u=u??yn(e,r,s,{vgChannel:o,ignoreVgConfig:!0}),u!==void 0&&(a=Cr(u)));const l=i[e];return jk(t,l,o??e,c=>Cke({channel:e,channelDef:c,markDef:r,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function CEe(e,t={filled:void 0}){var n,r,i,s;const{markDef:o,encoding:a,config:u}=e,{type:l}=o,c=(n=t.filled)!==null&&n!==void 0?n:yn("filled",o,u),f=bt(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(i=(r=yn(c===!0?"color":void 0,o,u,{vgChannel:"fill"}))!==null&&r!==void 0?r:u.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,h=(s=yn(c===!1?"color":void 0,o,u,{vgChannel:"stroke"}))!==null&&s!==void 0?s:u.mark[c===!1&&"color"],p=c?"fill":"stroke",m=Object.assign(Object.assign({},d?{fill:Cr(d)}:{}),h?{stroke:Cr(h)}:{});return o.color&&(c?o.fill:o.stroke)&&Fe(eke("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},m),di("color",e,{vgChannel:p,defaultValue:c?d:h})),di("fill",e,{defaultValue:a.fill?d:void 0})),di("stroke",e,{defaultValue:a.stroke?h:void 0}))}function sC(e,t){const n=pOt(e),r=t[n];if(r)return r}function hs(e,t,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:s,markDef:o,config:a,stack:u}=t,l=s[e],c=s[Ac(e)],f=t.scaleName(e),d=t.getScaleComponent(e),h=sC(e,o),p=zX({model:t,defaultPos:n,channel:e,scaleName:f,scale:d}),m=!l&&ic(e)&&(s.latitude||s.longitude)?{field:t.getName(e)}:sPt({channel:e,channelDef:l,channel2Def:c,markDef:o,config:a,isMidPoint:i,scaleName:f,scale:d,stack:u,offset:h,defaultRef:p});return m?{[r||e]:m}:void 0}function sPt(e){const{channel:t,channelDef:n,isMidPoint:r,scaleName:i,stack:s,offset:o,markDef:a,config:u}=e;if(_t(n)&&s&&t===s.fieldChannel){if(qe(n)){const l=zk({channel:t,fieldDef:n,isMidPoint:r,markDef:a,stack:s,config:u});if(l!==void 0)return KN({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:l,offset:o})}return Xg(n,i,{suffix:"end"},{offset:o})}return gX(e)}function zX({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:s,config:o}=e;return()=>{const a=T0(n),u=qh(n),l=yn(n,s,o,{vgChannel:u});if(l!==void 0)return Tw(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!bt([_r.LOG,_r.TIME,_r.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return a==="y"?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[_c(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const oPt={left:"x",center:"xc",right:"x2"},aPt={top:"y",middle:"yc",bottom:"y2"};function SEe(e,t,n,r="middle"){if(e==="radius"||e==="theta")return qh(e);const s=yn(e==="x"?"align":"baseline",t,n);return e==="x"?oPt[s||(r==="top"?"left":"center")]:aPt[s||r]}function iD(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?kEe(e,t,{defaultPos:n,defaultPos2:r}):hs(e,t,{defaultPos:n})}function kEe(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:s}=t,o=Ac(e),a=_c(e),u=uPt(t,r,o),l=u[a]?SEe(e,i,s):qh(e);return Object.assign(Object.assign({},hs(e,t,{defaultPos:n,vgChannel:l})),u)}function uPt(e,t,n){const{encoding:r,mark:i,markDef:s,stack:o,config:a}=e,u=T0(n),l=_c(n),c=qh(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),p=n in r||n in s?sC(n,e.markDef):sC(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude))return{[c]:{field:e.getName(n)}};const m=lPt({channel:n,channelDef:f,channel2Def:r[n],markDef:s,config:a,scaleName:d,scale:h,stack:o,offset:p,defaultRef:void 0});return m!==void 0?{[c]:m}:h_(n,s)||h_(n,{[n]:JN(n,s,a.style),[l]:JN(l,s,a.style)})||h_(n,a[i])||h_(n,a.mark)||{[c]:zX({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function lPt({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l}){return _t(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Xg(t,s,{suffix:"start"},{offset:u}):gX({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:r,config:i,offset:u,defaultRef:l})}function h_(e,t){const n=_c(e),r=qh(e);if(t[r]!==void 0)return{[r]:Tw(e,t[r])};if(t[e]!==void 0)return{[r]:Tw(e,t[e])};if(t[n])return{[n]:Tw(e,t[n])}}function Hh(e,t,n){var r,i,s,o;const{config:a,encoding:u,markDef:l,stack:c}=e,f=Ac(t),d=_c(t),h=u[t],p=u[f],m=e.getScaleComponent(t),x=m?m.get("type"):void 0,b=e.scaleName(t),v=l.orient,$=(i=(r=u[d])!==null&&r!==void 0?r:u.size)!==null&&i!==void 0?i:yn("size",l,a,{vgChannel:d}),C=n==="bar"&&(t==="x"?v==="vertical":v==="horizontal");if(qe(h)&&(Pn(h.bin)||zs(h.bin)||h.timeUnit&&!p)&&!$&&!Po(x)){const S=zk({channel:t,fieldDef:h,stack:c,markDef:l,config:a}),A=(s=e.component.axes[t])===null||s===void 0?void 0:s[0],E=(o=A==null?void 0:A.get("translate"))!==null&&o!==void 0?o:.5;return dPt({fieldDef:h,fieldDef2:p,channel:t,markDef:l,scaleName:b,band:S,axisTranslate:E,spacing:ic(t)?yn("binSpacing",l,a):void 0,reverse:m.get("reverse"),config:a})}else return(_t(h)&&Po(x)||C)&&!p?fPt(n,h,t,e):kEe(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function cPt(e,t,n,r,i,s){if(r){const u=r.get("type");if(u==="point"||u==="band"){if(i[e].discreteBandSize!==void 0)return{value:i[e].discreteBandSize};if(u===_r.POINT){const l=r.get("range");return Sp(l)&&Mr(l.step)?{value:l.step-2}:{value:LX-2}}else return{scale:n,band:s}}else return{value:i[e].continuousBandSize}}const o=tD(i.view,t),a=Lr(i[e].discreteBandSize,o-2);return a!==void 0?{value:a}:void 0}function fPt(e,t,n,r){var i;const{markDef:s,encoding:o,config:a,stack:u}=r,l=s.orient,c=r.scaleName(n),f=r.getScaleComponent(n),d=_c(n),h=Ac(n),p=l==="horizontal"&&n==="y"||l==="vertical"&&n==="x",m=yn(p?"size":d,s,a,{vgChannel:d});let x;(o.size||m!==void 0)&&(p?x=di("size",r,{vgChannel:d,defaultValue:m}):Fe(JOt(s.type)));const b=(i=_t(t)?zk({channel:n,fieldDef:t,markDef:s,stack:u,config:a}):void 0)!==null&&i!==void 0?i:1;x=x||{[d]:cPt(e,d,c,f,a,b)};const v=(f==null?void 0:f.get("type"))!=="band"||!("band"in x[d]),$=SEe(n,s,a,v?"middle":"top"),C=sC(n,s),S=gX({channel:n,channelDef:t,markDef:s,config:a,scaleName:c,scale:f,stack:u,offset:C,defaultRef:zX({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:f}),band:v?.5:(1-b)/2});if(d)return Object.assign({[$]:S},x);{const A=qh(h),E=x[d],_=C?Object.assign(Object.assign({},E),{offset:C}):E;return{[$]:S,[A]:yt(S)?[S[0],Object.assign(Object.assign({},S[1]),{offset:_})]:Object.assign(Object.assign({},S),{offset:_})}}}function w2(e,t,n,r,i){if(jSe(e))return 0;const s=e==="x"||e==="y2"?-t/2:t/2;if(kt(n)){const o=nC(i);return{signal:`${n.signal} ? ${r-s}${o?"-"+o:""} : ${r+s}${o?"+"+o:""}`}}else{if(kt(i)){const o=r+(n?-s:s);return{signal:`${o||""}${n?" - ":o?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-s:+i+s)}}function dPt({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:i,markDef:s,spacing:o=0,axisTranslate:a,reverse:u,config:l}){const c=Ac(n),f=qh(n),d=qh(c),h=sC(n,s);if(Pn(e.bin)||e.timeUnit)return{[d]:Doe({channel:n,fieldDef:e,scaleName:i,markDef:s,band:(1-r)/2,offset:w2(c,o,u,a,h),config:l}),[f]:Doe({channel:n,fieldDef:e,scaleName:i,markDef:s,band:1-(1-r)/2,offset:w2(n,o,u,a,h),config:l})};if(zs(e.bin)){const p=Xg(e,i,{},{offset:w2(c,o,u,a,h)});if(qe(t))return{[d]:p,[f]:Xg(t,i,{},{offset:w2(n,o,u,a,h)})};if(Pk(e.bin)&&e.bin.step)return{[d]:p,[f]:{signal:`scale("${i}", ${Be(e,{expr:"datum"})} + ${e.bin.step})`,offset:w2(n,o,u,a,h)}}}Fe(rke(c))}function Doe({channel:e,fieldDef:t,scaleName:n,markDef:r,band:i,offset:s,config:o}){const a=KN({scaleName:n,fieldOrDatumDef:t,band:i,offset:s});return $ke({fieldDef:t,channel:e,markDef:r,ref:a,config:o})}const hPt=new Set(["aria"]);function Ja(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?CEe(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},pPt(e.markDef,t)),Foe(e,"fill",n)),Foe(e,"stroke",r)),di("opacity",e)),di("fillOpacity",e)),di("strokeOpacity",e)),di("strokeWidth",e)),di("strokeDash",e)),wEe(e)),BX(e,"href")),nPt(e))}function Foe(e,t,n){const{config:r,mark:i,markDef:s}=e;if(yn("invalid",s,r)==="hide"&&n&&!E0(i)){const a=gPt(e,{invalid:!0,channels:ZO});if(a)return{[t]:[{test:a,value:null},...Er(n)]}}return n?{[t]:n}:{}}function pPt(e,t){return LMt.reduce((n,r)=>(!hPt.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=Cr(e[r])),n),{})}function gPt(e,{invalid:t=!1,channels:n}){const r=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const u=a.get("type"),l=e.vgField(o,{expr:"datum"});l&&Ha(u)&&(s[l]=!0)}return s},{}),i=Oe(r);if(i.length>0){const s=t?"||":"&&";return i.map(o=>mX(o,t)).join(` ${s} `)}}function UX(e){const{config:t,markDef:n}=e;if(yn("invalid",n,t)){const i=mPt(e,{channels:Ga});if(i)return{defined:{signal:i}}}return{}}function mPt(e,{invalid:t=!1,channels:n}){const r=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const u=a.get("type"),l=e.vgField(o,{expr:"datum"});l&&Ha(u)&&(s[l]=!0)}return s},{}),i=Oe(r);if(i.length>0){const s=t?"||":"&&";return i.map(o=>mX(o,t)).join(` ${s} `)}}function Roe(e,t){if(t!==void 0)return{[e]:Cr(t)}}const F5="voronoi",EEe={has:e=>e.type!=="interval"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(F5)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,s=e.mark;if(E0(s))return Fe(kOt(s)),n;const o={name:e.getName(F5),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},wEe(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?a=c:d.indexOf(F5)>=0&&(u=!0)}),u||n.splice(a+1,0,o),n}};class Tn{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class qs extends Tn{constructor(t,n,r,i){super(t,n),this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${RRt()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class zl extends Tn{constructor(t,n){super(t),this.formula=n}clone(){return new zl(null,Ut(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,s,o)=>{const{field:a,timeUnit:u}=s,l=hr(n)?n.encoding[Ac(o)]:void 0,c=hr(n)&&vX(o,s,l,n.stack,n.markDef,n.config);if(u){const f=Be(s,{forAs:!0});i[rn({as:f,field:a,timeUnit:u})]=Object.assign({as:f,field:a,timeUnit:u},c?{band:!0}:{})}return i},{});return Dn(r)?null:new zl(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,s=ht(r,["timeUnit"]),o=Zs(i),a=Object.assign(Object.assign({},s),{timeUnit:o});return new zl(t,{[rn(a)]:a})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)(!this.formula[n]||t.formula[n].band)&&(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(ah(this.formula).map(t=>t.as))}dependentFields(){return new Set(ah(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${rn(this.formula)}`}assemble(){const t=[];for(const n of ah(this.formula)){const{field:r,as:i,timeUnit:s}=n,o=Zs(s),{unit:a,utc:u}=o,l=ht(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Wh(r),type:"timeunit"},a?{units:uX(a)}:{}),u?{timezone:"utc"}:{}),l),{as:[i,`${i}_end`]}))}return t}}const Wk="_tuple_fields";class yPt{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const xPt={has:()=>!0,parse:(e,t,n)=>{var r,i,s;const o=t.name,a=(r=t.project)!==null&&r!==void 0?r:t.project=new yPt,u={},l={},c=new Set,f=(d,h)=>{const p=h==="visual"?d.channel:d.field;let m=er(`${o}_${p}`);for(let x=1;c.has(m);x++)m=er(`${o}_${p}_${x}`);return c.add(m),{[h]:m}};if(!n.fields&&!n.encodings){const d=e.config.selection[n.type];if(n.init)for(const h of Er(n.init))for(const p of Oe(h))dOt(p)?(n.encodings||(n.encodings=[])).push(p):n.type==="interval"?(Fe('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(p);else n.encodings=d.encodings,n.fields=d.fields}for(const d of(i=n.fields)!==null&&i!==void 0?i:[]){const h={type:"E",field:d};h.signals=Object.assign({},f(h,"data")),a.items.push(h),a.hasField[d]=h}for(const d of(s=n.encodings)!==null&&s!==void 0?s:[]){const h=e.fieldDef(d);if(h){let p=h.field;if(h.aggregate){Fe(SOt(d,h.aggregate));continue}else if(!p){Fe(aoe(d));continue}if(h.timeUnit){p=e.vgField(d);const m={timeUnit:h.timeUnit,as:p,field:h.field};l[rn(m)]=m}if(!u[p]){let m="E";if(t.type==="interval"){const b=e.getScaleComponent(d).get("type");Ha(b)&&(m="R")}else h.bin&&(m="R-RE");const x={field:p,channel:d,type:m};x.signals=Object.assign(Object.assign({},f(x,"data")),f(x,"visual")),a.items.push(u[p]=x),a.hasField[p]=a.hasChannel[d]=u[p]}}else Fe(aoe(d))}if(n.init){const d=h=>a.items.map(p=>h[p.channel]!==void 0?h[p.channel]:h[p.field]);if(n.type==="interval")t.init=d(n.init);else{const h=Er(n.init);t.init=h.map(d)}}Dn(l)||(a.timeUnit=new zl(null,l))},signals:(e,t,n)=>{const r=t.name+Wk;return n.filter(s=>s.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(s=>{const o=ht(s,["signals","hasLegend"]);return o.field=Wh(o.field),o})})}},AEe={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!RX(e.bind),parse:(e,t,n,r)=>{r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,s=t.bind,o=t.init&&t.init[0],a=EEe.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{var c,f;const d=er(`${r}_${u.field}`);n.filter(p=>p.name===d).length||n.unshift(Object.assign(Object.assign({name:d},o?{init:ex(o[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${Zt(u.field)}] : null`}]:[],bind:(f=(c=s[u.field])!==null&&c!==void 0?c:s[u.channel])!==null&&f!==void 0?f:s}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,s=n.filter(l=>l.name===r+ac)[0],o=r+Wk,a=i.items.map(l=>er(`${r}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(s.update=`${u} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},sD="_toggle",_Ee={has:e=>e.type==="multi"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+sD,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+ac,r=t.name+sD;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${$f(e)}}, `)+`${r} ? ${n} : null`}},bPt={has:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t,n)=>{n.clear&&(t.clear=zt(n.clear)?C0(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(AEe.has(t))for(const r of t.project.items){const i=n.findIndex(s=>s.name===er(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,s){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const i of t.project.items){const s=n.findIndex(o=>o.name===i.signals.visual);if(r(s,"[0, 0]"),s===-1){const o=n.findIndex(a=>a.name===i.signals.data);r(o,"null")}}else{let i=n.findIndex(s=>s.name===t.name+ac);r(i,"null"),_Ee.has(t)&&(i=n.findIndex(s=>s.name===t.name+sD),r(i,"false"))}return n}},Xh={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!Cp(i))continue;const s=e.getScaleComponent(i),o=s?s.get("type"):void 0;if(!s||!Ha(o)){Fe(AOt);continue}const a={selection:t.name,field:r.field};s.set("selectionExtent",a,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(o=>n.filter(a=>a.name===o.signals.data).length===0);if(!e.parent||C7(e)||r.length===0)return n;const i=n.filter(o=>o.name===t.name)[0];let s=i.update;if(s.indexOf(LEe)>=0)i.update=`{${r.map(o=>`${Zt(o.field)}: ${o.signals.data}`).join(", ")}}`;else{for(const o of r){const a=`${Zt(o.field)}: ${o.signals.data}`;s.indexOf(a)<0&&(s=`${s.substring(0,s.length-1)}, ${a}}`)}i.update=s}return n.concat(r.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!C7(e))for(const r of t.scales){const i=n.filter(s=>s.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function $7(e,t){return`domain(${Zt(e.scaleName(t))})`}function C7(e){var t;return e.parent&&Zb(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:C7(e.parent.parent))}const TEe={has:e=>{const t=e.resolve==="global"&&e.bind&&RX(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Jy;return t&&!n&&Fe(_Ot),t&&n},parse:(e,t,n,r)=>{var i;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=Er((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.indexOf(a)<0&&u.filter.push(a)}const s=I5(t.bind)?t.bind.legend:"click",o=zt(s)?C0(s,"view"):Er(s);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=I5(t.bind)&&t.bind.legend,s=o=>a=>{const u=Ut(a);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${er(o.field)}_legend`,u=`${r}_${a}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(s(`${a}_symbols`)).concat(i.merge.map(s(`${a}_labels`))).concat(i.merge.map(s(`${a}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,s=n.find(d=>d.name===r+ac),o=r+Wk,a=i.items.filter(d=>d.hasLegend).map(d=>er(`${r}_${er(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(s.update=l,delete s.value,delete s.on);const c=n.find(d=>d.name===r+sD),f=I5(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function vPt(e,t,n){var r;const i=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;I0(e,s=>{var o,a;const u=(o=s.project.hasField[i])!==null&&o!==void 0?o:s.project.hasChannel[t];if(u&&TEe.has(s)){const l=(a=n.get("selections"))!==null&&a!==void 0?a:[];l.push(s.name),n.set("selections",l,!1),u.hasLegend=!0}})}const IEe="_translate_anchor",NEe="_translate_delta",wPt={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=Xh.has(t),s=r+IEe,{x:o,y:a}=t.project.hasChannel;let u=C0(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+Iw,l))),n.push({name:s,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?", extent_x: "+(i?$7(e,lr):`slice(${o.signals.visual})`):"")+(a!==void 0?", extent_y: "+(i?$7(e,Qr):`slice(${a.signals.visual})`):"")+"}"}]},{name:r+NEe,value:{},on:[{events:u,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),o!==void 0&&Ooe(e,t,o,"width",n),a!==void 0&&Ooe(e,t,a,"height",n),n}};function Ooe(e,t,n,r,i){var s;const o=t.name,a=o+IEe,u=o+NEe,l=n.channel,c=Xh.has(t),f=i.filter(C=>C.name===n.signals[c?"data":"visual"])[0],d=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(l),p=h.get("type"),m=c&&l===lr?"-":"",x=`${a}.extent_${l}`,b=`${m}${u}.${l} / `+(c?`${d}`:`span(${x})`),$=`${c?p==="log"?"panLog":p==="pow"?"panPow":"panLinear":"panLinear"}(${x}, ${b}`+(c&&p==="pow"?`, ${(s=h.get("exponent"))!==null&&s!==void 0?s:1}`:"")+")";f.on.push({events:{signal:u},update:c?$:`clampRange(${$}, 0, ${d})`})}const DEe="_zoom_anchor",FEe="_zoom_delta",$Pt={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=Xh.has(t),s=r+FEe,{x:o,y:a}=t.project.hasChannel,u=Zt(e.scaleName(lr)),l=Zt(e.scaleName(Qr));let c=C0(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+Iw,f))),n.push({name:r+DEe,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&Moe(e,t,o,"width",n),a!==void 0&&Moe(e,t,a,"height",n),n}};function Moe(e,t,n,r,i){var s;const o=t.name,a=n.channel,u=Xh.has(t),l=i.filter(v=>v.name===n.signals[u?"data":"visual"])[0],c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(a),d=f.get("type"),h=u?$7(e,a):l.name,p=o+FEe,m=`${o}${DEe}.${a}`,b=`${u?d==="log"?"zoomLog":d==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${h}, ${m}, ${p}`+(u&&d==="pow"?`, ${(s=f.get("exponent"))!==null&&s!==void 0?s:1}`:"")+")";l.on.push({events:{signal:p},update:u?b:`clampRange(${b}, 0, ${c})`})}const CPt=[xPt,_Ee,Xh,TEe,wPt,$Pt,AEe,EEe,bPt];function fM(e,t){for(const n of CPt)n.has(e)&&t(n)}function ex(e,t=!0,n=dRt){if(yt(e)){const r=e.map(i=>ex(i,t,n));return t?`[${r.join(", ")}]`:r}else if(qb(e))return n(t?tC(e):AMt(e));return t?n(JSON.stringify(e)):e}function SPt(e,t){return I0(e,(n,r)=>{const i=n.name;let s=r.modifyExpr(e,n);t.push(...r.signals(e,n)),fM(n,o=>{o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(s=o.modifyExpr(e,n,s))}),t.push({name:i+RPt,on:[{events:{signal:n.name+ac},update:`modify(${Zt(n.name+Fm)}, ${s})`}]})}),jX(t)}function kPt(e,t){if(e.component.selection&&Oe(e.component.selection).length){const n=Zt(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:C0("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return jX(t)}function EPt(e,t){let n=!1;return I0(e,(r,i)=>{const s=r.name,o=Zt(s+Fm);if(t.filter(u=>u.name===s).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="multi"?", true)":")";t.push({name:r.name,update:`${LEe}(${o}, ${Zt(u)}${l}`})}n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),fM(r,u=>{u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))})}),n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),jX(t)}function APt(e,t){const n=[...t];return I0(e,r=>{const i={name:r.name+Fm};if(r.init){const o=r.project.items.map(u=>ht(u,["signals"])),a=r.init.map(u=>ex(u,!1));i.values=r.type==="interval"?[{unit:$f(e,{escape:!1}),fields:o,values:a}]:a.map(u=>({unit:$f(e,{escape:!1}),fields:o,values:u}))}n.filter(o=>o.name===r.name+Fm).length||n.push(i)}),n}function REe(e,t){return I0(e,(n,r)=>{t=r.marks?r.marks(e,n,t):t,fM(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function _Pt(e,t){for(const n of e.children)hr(n)&&(t=REe(n,t));return t}function TPt(e,t){const n=t.selection,r=e.getSelectionComponent(n,er(n));return{signal:HEe(r,t)}}function jX(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const Iw="_brush",S7="_scale_trigger",IPt={signals:(e,t)=>{const n=t.name,r=n+Wk,i=Xh.has(t),s=[],o=[],a=[];if(t.translate&&!i){const c=`!event.item || event.item.mark.name !== ${Zt(n+Iw)}`;OEe(t,(f,d)=>{var h;const p=Er((h=d.between[0].filter)!==null&&h!==void 0?h:d.between[0].filter=[]);return p.indexOf(c)<0&&p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==lr&&d!==Qr){Fe("Interval selections only support x and y encoding channels.");return}const h=t.init?t.init[f]:null,p=NPt(e,t,c,h),m=c.signals.data,x=c.signals.visual,b=Zt(e.scaleName(d)),v=e.getScaleComponent(d).get("type"),$=Ha(v)?"+":"";s.push(...p),o.push(m),a.push({scaleName:e.scaleName(d),expr:`(!isArray(${m}) || (${$}invert(${b}, ${x})[0] === ${$}${m}[0] && ${$}invert(${b}, ${x})[1] === ${$}${m}[1]))`})}),i||s.push({name:n+S7,value:{},on:[{events:a.map(c=>({scale:c.scaleName})),update:a.map(c=>c.expr).join(" && ")+` ? ${n+S7} : {}`}]});const u=t.init,l=`unit: ${$f(e)}, fields: ${r}, values`;return s.concat(Object.assign(Object.assign({name:n+ac},u?{init:`{${l}: ${ex(u)}}`}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+` ? {${l}: [${o}]} : null`}]}))},modifyExpr:(e,t)=>t.name+ac+", "+(t.resolve==="global"?"true":`{unit: ${$f(e)}}`),marks:(e,t,n)=>{const r=t.name,{x:i,y:s}=t.project.hasChannel,o=i&&i.signals.visual,a=s&&s.signals.visual,u=`data(${Zt(t.name+Fm)})`;if(Xh.has(t))return n;const l={x:i!==void 0?{signal:`${o}[0]`}:{value:0},y:s!==void 0?{signal:`${a}[0]`}:{value:0},x2:i!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const x of Oe(l))l[x]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${$f(e)}`},l[x]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,p=ht(c,["fill","fillOpacity","cursor"]),m=Oe(p).reduce((x,b)=>(x[b]=[{test:[i!==void 0&&`${o}[0] !== ${o}[1]`,s!==void 0&&`${a}[0] !== ${a}[1]`].filter(v=>v).join(" && "),value:p[b]},{value:null}],x),{});return[{name:r+Iw+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:r+Iw,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),m)}}]}};function NPt(e,t,n,r){const i=n.channel,s=n.signals.visual,o=n.signals.data,a=Xh.has(t),u=Zt(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=m=>`scale(${u}, ${m})`,d=e.getSizeSignalRef(i===lr?"width":"height").signal,h=`${i}(unit)`,p=OEe(t,(m,x)=>[...m,{events:x.between[0],update:`[${h}, ${h}]`},{events:x,update:`[${s}[0], clamp(${h}, 0, ${d})]`}]);return p.push({events:{signal:t.name+S7},update:Ha(c)?`[${f(`${o}[0]`)}, ${f(`${o}[1]`)}]`:"[0, 0]"}),a?[{name:o,on:[]}]:[Object.assign(Object.assign({name:s},r?{init:ex(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:ex(r)}:{}),{on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${u}, ${s})`}]})]}function OEe(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(Fe(`${r} is not an ordered event stream for interval selections.`),n),[])}function MEe(e,t){const n=t.name,r=n+Wk,i=t.project,s="(item().isVoronoi ? datum.datum : datum)",o=i.items.map(l=>{const c=e.fieldDef(l.channel);return c&&c.bin?`[${s}[${Zt(e.vgField(l.channel,{}))}], ${s}[${Zt(e.vgField(l.channel,{binSuffix:"end"}))}]]`:`${s}[${Zt(l.field)}]`}).join(", "),a=`unit: ${$f(e)}, fields: ${r}, values`,u=t.events;return[{name:n+ac,on:u?[{events:u,update:`datum && item().mark.marktype !== 'group' ? {${a}: [${o}]} : null`,force:!0}]:[]}]}const DPt={signals:MEe,modifyExpr:(e,t)=>t.name+ac+", "+(t.resolve==="global"?"null":`{unit: ${$f(e)}}`)},FPt={signals:MEe,modifyExpr:(e,t)=>t.name+ac+", "+(t.resolve==="global"?"true":`{unit: ${$f(e)}}`)},Fm="_store",ac="_tuple",RPt="_modify",LEe="vlSelectionResolve",OPt={single:FPt,multi:DPt,interval:IPt};function I0(e,t){const n=e.component.selection;if(n){for(const r of ah(n))if(t(r,OPt[r.type])===!0)break}}function MPt(e){let t=e.parent;for(;t&&!Ru(t);)t=t.parent;return t}function $f(e,{escape:t}={escape:!0}){let n=t?Zt(e.name):e.name;const r=MPt(e);if(r){const{facet:i}=r;for(const s of Ra)i[s]&&(n+=` + '__facet_${s}_' + (facet[${Zt(r.vgField(s))}])`)}return n}function WX(e){let t=!1;return I0(e,n=>{t=t||n.project.items.some(r=>r.field===Jy)}),t}const LPt="RawCode",PPt="Literal",BPt="Property",zPt="Identifier",UPt="ArrayExpression",jPt="BinaryExpression",WPt="CallExpression",VPt="ConditionalExpression",qPt="LogicalExpression",GPt="MemberExpression",HPt="ObjectExpression",XPt="UnaryExpression";function rl(e){this.type=e}rl.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=YPt(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function YPt(e){switch(e.type){case UPt:return e.elements;case jPt:case qPt:return[e.left,e.right];case WPt:return[e.callee].concat(e.arguments);case VPt:return[e.test,e.consequent,e.alternate];case GPt:return[e.object,e.property];case HPt:return e.properties;case BPt:return[e.key,e.value];case XPt:return[e.argument];case zPt:case PPt:case LPt:default:return[]}}var Tc,it,$e,Cs,Cn,dM=1,Vk=2,Rm=3,Ep=4,hM=5,N0=6,mo=7,qk=8,KPt=9;Tc={};Tc[dM]="Boolean";Tc[Vk]="<end>";Tc[Rm]="Identifier";Tc[Ep]="Keyword";Tc[hM]="Null";Tc[N0]="Numeric";Tc[mo]="Punctuator";Tc[qk]="String";Tc[KPt]="RegularExpression";var QPt="ArrayExpression",ZPt="BinaryExpression",JPt="CallExpression",eBt="ConditionalExpression",PEe="Identifier",tBt="Literal",nBt="LogicalExpression",rBt="MemberExpression",iBt="ObjectExpression",sBt="Property",oBt="UnaryExpression",ji="Unexpected token %0",aBt="Unexpected number",uBt="Unexpected string",lBt="Unexpected identifier",cBt="Unexpected reserved word",fBt="Unexpected end of input",k7="Invalid regular expression",R5="Invalid regular expression: missing /",BEe="Octal literals are not allowed in strict mode.",dBt="Duplicate data property in object literal not allowed in strict mode",ps="ILLEGAL",oC="Disabled.",hBt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),pBt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function pM(e,t){if(!e)throw new Error("ASSERT: "+t)}function Zc(e){return e>=48&&e<=57}function VX(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Nw(e){return"01234567".indexOf(e)>=0}function gBt(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function aC(e){return e===10||e===13||e===8232||e===8233}function Gk(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&hBt.test(String.fromCharCode(e))}function oD(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&pBt.test(String.fromCharCode(e))}var mBt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function zEe(){for(var e;$e<Cs&&(e=it.charCodeAt($e),gBt(e)||aC(e));)++$e}function E7(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)$e<Cs&&VX(it[$e])?(r=it[$e++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):fn({},ji,ps);return String.fromCharCode(i)}function yBt(){var e,t,n,r;for(e=it[$e],t=0,e==="}"&&fn({},ji,ps);$e<Cs&&(e=it[$e++],!!VX(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&fn({},ji,ps),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function UEe(){var e,t;for(e=it.charCodeAt($e++),t=String.fromCharCode(e),e===92&&(it.charCodeAt($e)!==117&&fn({},ji,ps),++$e,e=E7("u"),(!e||e==="\\"||!Gk(e.charCodeAt(0)))&&fn({},ji,ps),t=e);$e<Cs&&(e=it.charCodeAt($e),!!oD(e));)++$e,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),it.charCodeAt($e)!==117&&fn({},ji,ps),++$e,e=E7("u"),(!e||e==="\\"||!oD(e.charCodeAt(0)))&&fn({},ji,ps),t+=e);return t}function xBt(){var e,t;for(e=$e++;$e<Cs;){if(t=it.charCodeAt($e),t===92)return $e=e,UEe();if(oD(t))++$e;else break}return it.slice(e,$e)}function bBt(){var e,t,n;return e=$e,t=it.charCodeAt($e)===92?UEe():xBt(),t.length===1?n=Rm:mBt.hasOwnProperty(t)?n=Ep:t==="null"?n=hM:t==="true"||t==="false"?n=dM:n=Rm,{type:n,value:t,start:e,end:$e}}function O5(){var e=$e,t=it.charCodeAt($e),n,r=it[$e],i,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++$e,{type:mo,value:String.fromCharCode(t),start:e,end:$e};default:if(n=it.charCodeAt($e+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return $e+=2,{type:mo,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:$e};case 33:case 61:return $e+=2,it.charCodeAt($e)===61&&++$e,{type:mo,value:it.slice(e,$e),start:e,end:$e}}}if(o=it.substr($e,4),o===">>>=")return $e+=4,{type:mo,value:o,start:e,end:$e};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return $e+=3,{type:mo,value:s,start:e,end:$e};if(i=s.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return $e+=2,{type:mo,value:i,start:e,end:$e};if("<>=!+-*%&|^/".indexOf(r)>=0)return++$e,{type:mo,value:r,start:e,end:$e};fn({},ji,ps)}function vBt(e){for(var t="";$e<Cs&&VX(it[$e]);)t+=it[$e++];return t.length===0&&fn({},ji,ps),Gk(it.charCodeAt($e))&&fn({},ji,ps),{type:N0,value:parseInt("0x"+t,16),start:e,end:$e}}function wBt(e){for(var t="0"+it[$e++];$e<Cs&&Nw(it[$e]);)t+=it[$e++];return(Gk(it.charCodeAt($e))||Zc(it.charCodeAt($e)))&&fn({},ji,ps),{type:N0,value:parseInt(t,8),octal:!0,start:e,end:$e}}function Loe(){var e,t,n;if(n=it[$e],pM(Zc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=$e,e="",n!=="."){if(e=it[$e++],n=it[$e],e==="0"){if(n==="x"||n==="X")return++$e,vBt(t);if(Nw(n))return wBt(t);n&&Zc(n.charCodeAt(0))&&fn({},ji,ps)}for(;Zc(it.charCodeAt($e));)e+=it[$e++];n=it[$e]}if(n==="."){for(e+=it[$e++];Zc(it.charCodeAt($e));)e+=it[$e++];n=it[$e]}if(n==="e"||n==="E")if(e+=it[$e++],n=it[$e],(n==="+"||n==="-")&&(e+=it[$e++]),Zc(it.charCodeAt($e)))for(;Zc(it.charCodeAt($e));)e+=it[$e++];else fn({},ji,ps);return Gk(it.charCodeAt($e))&&fn({},ji,ps),{type:N0,value:parseFloat(e),start:t,end:$e}}function $Bt(){var e="",t,n,r,i,s=!1;for(t=it[$e],pM(t==="'"||t==='"',"String literal must starts with a quote"),n=$e,++$e;$e<Cs;)if(r=it[$e++],r===t){t="";break}else if(r==="\\")if(r=it[$e++],!r||!aC(r.charCodeAt(0)))switch(r){case"u":case"x":it[$e]==="{"?(++$e,e+=yBt()):e+=E7(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Nw(r)?(i="01234567".indexOf(r),i!==0&&(s=!0),$e<Cs&&Nw(it[$e])&&(s=!0,i=i*8+"01234567".indexOf(it[$e++]),"0123".indexOf(r)>=0&&$e<Cs&&Nw(it[$e])&&(i=i*8+"01234567".indexOf(it[$e++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&it[$e]===`
`&&++$e;else{if(aC(r.charCodeAt(0)))break;e+=r}return t!==""&&fn({},ji,ps),{type:qk,value:e,octal:s,start:n,end:$e}}function CBt(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(r,i){if(parseInt(i,16)<=1114111)return"x";fn({},k7)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{fn({},k7)}try{return new RegExp(e,t)}catch{return null}}function SBt(){var e,t,n,r,i;for(e=it[$e],pM(e==="/","Regular expression literal must start with a slash"),t=it[$e++],n=!1,r=!1;$e<Cs;)if(e=it[$e++],t+=e,e==="\\")e=it[$e++],aC(e.charCodeAt(0))&&fn({},R5),t+=e;else if(aC(e.charCodeAt(0)))fn({},R5);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||fn({},R5),i=t.substr(1,t.length-2),{value:i,literal:t}}function kBt(){var e,t,n;for(t="",n="";$e<Cs&&(e=it[$e],!!oD(e.charCodeAt(0)));)++$e,e==="\\"&&$e<Cs?fn({},ji,ps):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&fn({},k7,n),{value:n,literal:t}}function EBt(){var e,t,n,r;return Cn=null,zEe(),e=$e,t=SBt(),n=kBt(),r=CBt(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:$e}}function ABt(e){return e.type===Rm||e.type===Ep||e.type===dM||e.type===hM}function jEe(){var e;return zEe(),$e>=Cs?{type:Vk,start:$e,end:$e}:(e=it.charCodeAt($e),Gk(e)?bBt():e===40||e===41||e===59?O5():e===39||e===34?$Bt():e===46?Zc(it.charCodeAt($e+1))?Loe():O5():Zc(e)?Loe():O5())}function $o(){var e;return e=Cn,$e=e.end,Cn=jEe(),$e=e.end,e}function WEe(){var e;e=$e,Cn=jEe(),$e=e}function _Bt(e){var t=new rl(QPt);return t.elements=e,t}function Poe(e,t,n){var r=new rl(e==="||"||e==="&&"?nBt:ZPt);return r.operator=e,r.left=t,r.right=n,r}function TBt(e,t){var n=new rl(JPt);return n.callee=e,n.arguments=t,n}function IBt(e,t,n){var r=new rl(eBt);return r.test=e,r.consequent=t,r.alternate=n,r}function qX(e){var t=new rl(PEe);return t.name=e,t}function ow(e){var t=new rl(tBt);return t.value=e.value,t.raw=it.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Boe(e,t,n){var r=new rl(rBt);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function NBt(e){var t=new rl(iBt);return t.properties=e,t}function zoe(e,t,n){var r=new rl(sBt);return r.key=t,r.value=n,r.kind=e,r}function DBt(e,t){var n=new rl(oBt);return n.operator=e,n.argument=t,n.prefix=!0,n}function fn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(s,o){return pM(o<r.length,"Message reference must be in range"),r[o]});throw n=new Error(i),n.index=$e,n.description=i,n}function gM(e){e.type===Vk&&fn(e,fBt),e.type===N0&&fn(e,aBt),e.type===qk&&fn(e,uBt),e.type===Rm&&fn(e,lBt),e.type===Ep&&fn(e,cBt),fn(e,ji,e.value)}function Ss(e){var t=$o();(t.type!==mo||t.value!==e)&&gM(t)}function Vn(e){return Cn.type===mo&&Cn.value===e}function M5(e){return Cn.type===Ep&&Cn.value===e}function FBt(){var e=[];for($e=Cn.start,Ss("[");!Vn("]");)Vn(",")?($o(),e.push(null)):(e.push(Om()),Vn("]")||Ss(","));return $o(),_Bt(e)}function Uoe(){var e;return $e=Cn.start,e=$o(),e.type===qk||e.type===N0?(e.octal&&fn(e,BEe),ow(e)):qX(e.value)}function RBt(){var e,t,n,r;if($e=Cn.start,e=Cn,e.type===Rm)return n=Uoe(),Ss(":"),r=Om(),zoe("init",n,r);if(e.type===Vk||e.type===mo)gM(e);else return t=Uoe(),Ss(":"),r=Om(),zoe("init",t,r)}function OBt(){var e=[],t,n,r,i={},s=String;for($e=Cn.start,Ss("{");!Vn("}");)t=RBt(),t.key.type===PEe?n=t.key.name:n=s(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?fn({},dBt):i[r]=!0,e.push(t),Vn("}")||Ss(",");return Ss("}"),NBt(e)}function MBt(){var e;return Ss("("),e=GX(),Ss(")"),e}var LBt={if:1};function PBt(){var e,t,n;if(Vn("("))return MBt();if(Vn("["))return FBt();if(Vn("{"))return OBt();if(e=Cn.type,$e=Cn.start,e===Rm||LBt[Cn.value])n=qX($o().value);else if(e===qk||e===N0)Cn.octal&&fn(Cn,BEe),n=ow($o());else{if(e===Ep)throw new Error(oC);e===dM?(t=$o(),t.value=t.value==="true",n=ow(t)):e===hM?(t=$o(),t.value=null,n=ow(t)):Vn("/")||Vn("/=")?(n=ow(EBt()),WEe()):gM($o())}return n}function BBt(){var e=[];if(Ss("("),!Vn(")"))for(;$e<Cs&&(e.push(Om()),!Vn(")"));)Ss(",");return Ss(")"),e}function zBt(){var e;return $e=Cn.start,e=$o(),ABt(e)||gM(e),qX(e.value)}function UBt(){return Ss("."),zBt()}function jBt(){var e;return Ss("["),e=GX(),Ss("]"),e}function WBt(){var e,t,n;for(e=PBt();;)if(Vn("."))n=UBt(),e=Boe(".",e,n);else if(Vn("("))t=BBt(),e=TBt(e,t);else if(Vn("["))n=jBt(),e=Boe("[",e,n);else break;return e}function joe(){var e=WBt();if(Cn.type===mo&&(Vn("++")||Vn("--")))throw new Error(oC);return e}function LT(){var e,t;if(Cn.type!==mo&&Cn.type!==Ep)t=joe();else{if(Vn("++")||Vn("--"))throw new Error(oC);if(Vn("+")||Vn("-")||Vn("~")||Vn("!"))e=$o(),t=LT(),t=DBt(e.value,t);else{if(M5("delete")||M5("void")||M5("typeof"))throw new Error(oC);t=joe()}}return t}function Woe(e){var t=0;if(e.type!==mo&&e.type!==Ep)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function VBt(){var e,t,n,r,i,s,o,a,u,l;if(e=Cn,u=LT(),r=Cn,i=Woe(r),i===0)return u;for(r.prec=i,$o(),t=[e,Cn],o=LT(),s=[u,r,o];(i=Woe(Cn))>0;){for(;s.length>2&&i<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=Poe(a,u,o),s.push(n);r=$o(),r.prec=i,s.push(r),t.push(Cn),n=LT(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=Poe(s[l-1].value,s[l-2],n),l-=2;return n}function Om(){var e,t,n;return e=VBt(),Vn("?")&&($o(),t=Om(),Ss(":"),n=Om(),e=IBt(e,t,n)),e}function GX(){var e=Om();if(Vn(","))throw new Error(oC);return e}function qBt(e){it=e,$e=0,Cs=it.length,Cn=null,WEe();var t=GX();if(Cn.type!==Vk)throw new Error("Unexpect token after expression.");return t}function Xb(e,t,n){return e.fields=t||[],e.fname=n,e}function GBt(e){return e.length===1?HBt(e[0]):XBt(e)}const HBt=e=>function(t){return t[e]},XBt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function L5(e){throw Error(e)}function YBt(e){const t=[],n=e.length;let r=null,i=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=a+1,r=u):u==="."&&!i?a>o?l():o=a+1:u==="["?(a>o&&l(),i=o=a+1):u==="]"&&(i||L5("Access path missing open bracket: "+e),i>0&&l(),i=0,o=a+1)}return i&&L5("Access path missing closing bracket: "+e),r&&L5("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function KBt(e,t,n){const r=YBt(e);return e=r.length===1?r[0]:e,Xb(GBt(r),[e],e)}KBt("id");Xb(e=>e,[],"identity");Xb(()=>0,[],"zero");Xb(()=>1,[],"one");Xb(()=>!0,[],"true");Xb(()=>!1,[],"false");function A7(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...A7(e.object)),t.push(...A7(e.property))),t)}function VEe(e){return e.object.type==="MemberExpression"?VEe(e.object):e.object.name==="datum"}function qEe(e){const t=qBt(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&VEe(r)&&n.add(A7(r).slice(1).join("."))}),n}class Yb extends Tn{constructor(t,n,r){super(t),this.model=n,this.filter=r,this.expr=aD(this.model,this.filter,this),this._dependentFields=qEe(this.expr)}clone(){return new Yb(null,this.model,Ut(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function QBt(e,t){var n;const r={},i=e.config.selection;for(const s of Oe(t??{})){const o=Ut(t[s]),a=i[o.type],u=ht(a,["fields","encodings"]);for(const f in u)f==="encodings"&&o.fields||f==="fields"&&o.encodings||(f==="mark"&&(o[f]=Object.assign(Object.assign({},u[f]),o[f])),(o[f]===void 0||o[f]===!0)&&(o[f]=(n=u[f])!==null&&n!==void 0?n:o[f]));const l=er(s),c=r[l]=Object.assign(Object.assign({},o),{name:l,events:zt(o.on)?C0(o.on,"scope"):Ut(o.on)});fM(c,f=>{f.has(c)&&f.parse&&f.parse(e,c,o,t[s])})}return r}function GEe(e,t,n,r="datum"){const i=[];function s(a){const u=er(a),l=e.getSelectionComponent(u,a),c=Zt(u+Fm);if(l.project.timeUnit){const f=n??e.component.data.raw,d=l.project.timeUnit.clone();f.parent?d.insertAsParentOf(f):f.parent=d}return l.empty!=="none"&&i.push(c),`vlSelectionTest(${c}, ${r}`+(l.resolve==="global"?")":`, ${Zt(l.resolve)})`)}const o=_w(t,s);return(i.length?"!("+i.map(a=>`length(data(${a}))`).join(" || ")+") || ":"")+`(${o})`}function HEe(e,t){const n=t.encoding;let r=t.field;if(!n&&!r)r=e.project.items[0].field,e.project.items.length>1&&Fe(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Zt(r)}.`);else if(n&&!r){const i=e.project.items.filter(s=>s.channel===n);!i.length||i.length>1?(r=e.project.items[0].field,Fe((i.length?"Multiple ":"No ")+`matching ${Zt(n)} encoding found for selection ${Zt(t.selection)}. Using "field": ${Zt(r)}.`)):r=i[0].field}return`${e.name}[${Zt(r)}]`}function ZBt(e,t){I0(e,n=>{const r=n.name,i=e.getName(`lookup_${r}`);e.component.data.outputNodes[i]=n.materialized=new qs(new Yb(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)})}function aD(e,t,n){return _w(t,r=>zt(r)?r:BMt(r)?GEe(e,r.selection,n):gke(r))}function JBt(e,t){if(e)return yt(e)&&!Fd(e)?e.map(n=>zke(n,t)).join(", "):e}function P5(e,t,n,r){var i,s,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(s=e.encode[t])!==null&&s!==void 0?s:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function aw(e,t,n,r={header:!1}){var i,s;const o=e.combine(),{disable:a,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=o,h=ht(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(const p in h){const m=LRt[p],x=h[p];if(m&&m!==t&&m!=="both")delete h[p];else if(YH(x)){const{condition:b}=x,v=ht(x,["condition"]),$=Er(b),C=Jse[p];if(C){const{vgProp:S,part:A}=C,E=[...$.map(_=>{const{test:D}=_,N=ht(_,["test"]);return Object.assign({test:aD(null,D)},N)}),v];P5(h,A,S,E),delete h[p]}else if(C===null){const S={signal:$.map(A=>{const{test:E}=A,_=ht(A,["test"]);return`${aD(null,E)} ? ${yoe(_)} : `}).join("")+yoe(v)};h[p]=S}}else if(kt(x)){const b=Jse[p];if(b){const{vgProp:v,part:$}=b;P5(h,$,v,x),delete h[p]}}}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:p}=h.encode;h.encode=Object.assign({},p?{grid:p}:{}),Dn(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Lr(d,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let m=c;!((s=(i=h.encode)===null||i===void 0?void 0:i.labels)===null||s===void 0)&&s.update&&kt(h.encode.labels.update.text)&&(m=Ky(c,"datum.label",h.encode.labels.update.text.signal)),P5(h,"labels","text",{signal:m})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const m of FSe)e.hasAxisPart(m)||delete h.encode[m];Dn(h.encode)&&delete h.encode}const p=JBt(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},p?{title:p}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:Lr(d,0)})}}}function XEe(e){const{axes:t}=e.component,n=[];for(const r of Ga)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const s=r==="x"?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}}return n}function e5t(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>aw(i,"grid",t)),...r.map(i=>aw(i,"grid",t)),...n.map(i=>aw(i,"main",t)),...r.map(i=>aw(i,"main",t))].filter(i=>i)}const YEe={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},KEe={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},t5t=Oe(YEe),n5t=Oe(KEe);function Voe(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const s=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...Oe(o),...Oe(a)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${s}" ? ${nC(o[c])} : ${nC(a[c])}`};return l}return t[i]})])}function r5t(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:QMt(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",o=kt(n)?"axisOrient":"axis"+zO(n),a=[...i,...i.map(l=>s+l.substr(4))],u=["axis",o,s];return{vlOnlyAxisConfig:Voe(a,r,e,n),vgAxisConfig:Voe(u,r,e,n),axisConfigStyle:i5t([...u,...a],r)}}function i5t(e,t){var n;const r=[{}];for(const i of e){let s=(n=t[i])===null||n===void 0?void 0:n.style;if(s){s=Er(s);for(const o of s)r.push(t.style[o])}}return Object.assign.apply(null,r)}function _7(e,t,n,r={}){var i;const s=qke(e,n,t.style);if(s!==void 0)return{configFrom:"style",configValue:s};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[o])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:o,configValue:r[o][e]};return{}}const qoe={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return Eke(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return Ake(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return qe(e)&&zs(e.bin)?!1:(r=t.grid)!==null&&r!==void 0?r:s5t(n,e)},gridScale:({model:e,channel:t})=>o5t(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||ZEe(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||QEe(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:u5t(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:l5t(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var s;const o=e==="x"?"width":e==="y"?"height":void 0,a=o?t.getSizeSignalRef(o):void 0;return(s=n.tickCount)!==null&&s!==void 0?s:f5t({fieldOrDatumDef:r,scaleType:i,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=JEe(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),s=n==="x"?"x2":"y2",o=t.fieldDef(s);return Hke(i?[moe(i)]:[],qe(o)?[moe(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>d5t(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:h5t(n,t)}};function s5t(e,t){return!Po(e)&&qe(t)&&!Pn(t==null?void 0:t.bin)}function o5t(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function a5t(e,t,n,r,i){const s=t==null?void 0:t.labelAngle;if(s!==void 0)return kt(s)?s:GN(s);{const{configValue:o}=_7("labelAngle",e.config,t==null?void 0:t.style,i);return o!==void 0?GN(o):n===lr&&bt([pX,hX],r.type)?270:void 0}}function T7(e){return`(((${e.signal} % 360) + 360) % 360)`}function QEe(e,t,n,r){if(e!==void 0)if(n==="x"){if(kt(e)){const i=T7(e),s=kt(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(kt(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(kt(e)){const i=T7(e),s=kt(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(kt(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function ZEe(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,s=r?"bottom":"left";if(kt(e)){const o=T7(e),a=kt(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${i?"("+o+" + 90)":o} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${o} && ${o} < ${180+i}) === ${a} ? "left" : "right"`}}if((e+i)%180===0)return r?null:"center";if(kt(t)){const o=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${o} "${s}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===s)?"left":"right"}function u5t(e,t){if(t==="x"&&bt(["quantitative","temporal"],e))return!0}function l5t(e,t){if(e!=="nominal")return t==="log"?"greedy":!0}function c5t(e){return e==="x"?"bottom":"left"}function f5t({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!Po(t)&&t!=="log"){if(qe(e)){if(Pn(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&bt(["month","hours","day","quarter"],(i=Zs(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function JEe(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),s=r?r.title:void 0,o=i?i.title:void 0;if(s&&o)return Xke(s,o);if(s)return s;if(o)return o;if(s!==void 0)return s;if(o!==void 0)return o}function d5t(e,t){const n=e.values;if(yt(n))return jke(t,n);if(kt(n))return n}function h5t(e,t){return e==="rect"&&Oke(t)?1:0}class tx extends Tn{constructor(t,n){super(t),this.transform=n,this._dependentFields=qEe(this.transform.calculate)}clone(){return new tx(null,Ut(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(CX(r)&&Nke(r.sort)){const{field:s,timeUnit:o}=r,a=r.sort,u=a.map((l,c)=>`${gke({field:s,timeUnit:o,equal:l})} ? ${c} : `).join("")+a.length;t=new tx(t,{calculate:u,as:nx(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${rn(this.transform)}`}}function nx(e,t,n){return Be(e,Object.assign({prefix:t,suffix:"sort_index"},n??{}))}function mM(e,t){return bt(["top","bottom"],t)?"column":bt(["left","right"],t)||e==="row"?"row":"column"}function rx(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return Lr(((t==null?void 0:t.header)||{})[e],i[e],n.header[e])}function yM(e,t,n,r){const i={};for(const s of e){const o=rx(s,t,n,r);o!==void 0&&(i[s]=o)}return i}const HX=["row","column"],XX=["header","footer"];function p5t(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=yM(["titleAnchor","titleAngle","titleOrient"],i,r,t),u=mM(t,a),l=GN(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),tAe(l,u)),eAe(u,l,s)),nAe(r,i,t,t5t,YEe))}}function eAe(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=ZEe(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function tAe(e,t){const n=QEe(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function g5t(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of XX)if(n[i])for(const s of n[i]){const o=y5t(e,t,i,n,s);o!=null&&r.push(o)}return r}function m5t(e,t){var n;const{sort:r}=e;return Bl(r)?{field:Be(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:yt(r)?{field:nx(e,t,{expr:"datum"}),order:"ascending"}:{field:Be(e,{expr:"datum"}),order:r??"ascending"}}function I7(e,t,n){const{format:r,formatType:i,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:u}=yM(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),l=yX({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=mM(t,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?Ky(Ky(u,"datum.label",l),"datum.value",Be(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),tAe(s,c)),eAe(c,s,o)),nAe(n,e,t,n5t,KEe))}function y5t(e,t,n,r,i){if(i){let s=null;const{facetFieldDef:o}=r,a=e.config?e.config:void 0;if(o&&i.labels){const{labelOrient:f}=yM(["labelOrient"],o,a,t);(t==="row"&&!bt(["top","bottom"],f)||t==="column"&&!bt(["left","right"],f))&&(s=I7(o,t,a))}const u=Ru(e)&&!Bk(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(s||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:m5t(o,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),s?{title:s}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const x5t={column:{start:0,end:1},row:{start:1,end:0}};function b5t(e,t){return x5t[t][e]}function v5t(e,t){const n={};for(const r of Ra){const i=e[r];if(i!=null&&i.facetFieldDef){const{titleAnchor:s,titleOrient:o}=yM(["titleAnchor","titleOrient"],i.facetFieldDef,t,r),a=mM(r,o),u=b5t(s,a);u!==void 0&&(n[a]=u)}}return Dn(n)?void 0:n}function nAe(e,t,n,r,i){const s={};for(const o of r){if(!i[o])continue;const a=rx(o,t,e,n);a!==void 0&&(s[i[o]]=a)}return s}function YX(e){return[...p_(e,"width"),...p_(e,"height"),...p_(e,"childWidth"),...p_(e,"childHeight")]}function p_(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(Po(o)&&Sp(a)){const u=e.scaleName(n);return Ru(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[Goe(u,a)]:[Goe(u,a),{name:i,update:rAe(u,s,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const s=i.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",a=v7(e.config.view,s?"width":"height"),u=`isFinite(${o}) ? ${o} : ${a}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function Goe(e,t){return{name:e+"_step",value:t.step}}function rAe(e,t,n){const r=t.get("type"),i=t.get("padding"),s=Lr(t.get("paddingOuter"),i);let o=t.get("paddingInner");return o=r==="band"?o!==void 0?o:i:1,`bandspace(${n}, ${o}, ${s}) * ${e}_step`}function iAe(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function sAe(e,t){return Oe(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),jk(t,i,r,s=>kt(s)?s:{value:s.value}))},{})}function w5t(e,t){if(Zb(t)||Ru(t))return"shared";if(eY(t))return ic(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function KX(e,t){const n=e.scale[t],r=ic(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&Fe(iMt(t)),"independent"):e[r][t]||"shared"}const $5t=Object.assign(Object.assign({},Q4t),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),oAe=Oe($5t);class C5t extends Zf{}const Hoe={symbols:S5t,gradient:k5t,labels:E5t,entries:A5t};function S5t(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:s}){var o,a,u,l,c;if(s!=="symbol")return;const{markDef:f,encoding:d,config:h,mark:p}=n,m=f.filled&&p!=="trail";let x=Object.assign(Object.assign({},I4t({},n,VRt)),CEe(n,{filled:m}));const b=(o=aAe(d.opacity))!==null&&o!==void 0?o:f.opacity;if(x.fill){if(r==="fill"||m&&r===Mo)delete x.fill;else if(x.fill.field)i.get("symbolFillColor")?delete x.fill:(x.fill=Cr((a=h.legend.symbolBaseFillColor)!==null&&a!==void 0?a:"black"),x.fillOpacity=Cr(b??1));else if(yt(x.fill)){const v=(c=(l=N7((u=d.fill)!==null&&u!==void 0?u:d.color))!==null&&l!==void 0?l:f.fill)!==null&&c!==void 0?c:m&&f.color;v&&(x.fill=Cr(v))}}if(x.stroke){if(r==="stroke"||!m&&r===Mo)delete x.stroke;else if(x.stroke.field)delete x.stroke;else if(yt(x.stroke)){const v=Lr(N7(d.stroke||d.color),f.stroke,m?f.color:void 0);v&&(x.stroke={value:v})}}if(r!==Qf){const v=qe(t)&&lAe(n,i,t);v?x.opacity=[Object.assign({test:v},Cr(b??1)),Cr(h.legend.unselectedOpacity)]:b&&(x.opacity=Cr(b))}return x=Object.assign(Object.assign({},x),e),Dn(x)?void 0:x}function k5t(e,{model:t,legendType:n}){if(n!=="gradient")return;let r={};const i=aAe(t.encoding.opacity)||t.markDef.opacity;return i&&(r.opacity=Cr(i)),r=Object.assign(Object.assign({},r),e),Dn(r)?void 0:r}function E5t(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const s=n.legend(r)||{},o=n.config,a=qe(t)?lAe(n,i,t):void 0,u=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=s,f=Nm(c)?xX({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Dn(d)?void 0:d}function A5t(e,{legendCmpt:t}){const n=t.get("selections");return n!=null&&n.length?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function aAe(e){return uAe(e,(t,n)=>Math.max(t,n.value))}function N7(e){return uAe(e,(t,n)=>Lr(t,n.value))}function uAe(e,t){if(v4t(e))return Er(e.condition).reduce(t,e.value);if(Mf(e))return e.value}function lAe(e,t,n){const r=t.get("selections");if(!(r!=null&&r.length))return;const i=Zt(n.field);return r.map(s=>`(!length(data(${Zt(er(s)+Fm)})) || (${s}[${i}] && indexof(${s}[${i}], datum.value) >= 0))`).join(" || ")}const Xoe={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return Eke(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return Ake(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:R5t(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:O5t(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:T5t(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Yg(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(ey(n)&&Au(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>_5t(t,e)};function _5t(e,t){const n=e.values;if(yt(n))return jke(t,n);if(kt(n))return n}function T5t(e,t,n,r){var i;if(t!=="shape"){const s=(i=N7(n))!==null&&i!==void 0?i:r;if(s)return s}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function I5t(e){const{legend:t}=e;return Lr(t.type,N5t(e))}function N5t({channel:e,timeUnit:t,scaleType:n}){if(ey(e)){if(bt(["quarter","month","day"],t))return"symbol";if(Au(n))return"gradient"}return"symbol"}function D5t({legendConfig:e,legendType:t,orient:n,legend:r}){var i,s;return(s=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&s!==void 0?s:F5t(n,t)}function F5t(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function R5t({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(Au(i))return n==="horizontal"?r==="top"||r==="bottom"?Yoe(t,"width",o,s):o:Yoe(t,"height",u,a)}function Yoe(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function O5t(e){if(bt(["quantile","threshold","log"],e))return"greedy"}function cAe(e){const t=hr(e)?M5t(e):z5t(e);return e.component.legends=t,t}function M5t(e){const{encoding:t}=e,n={};for(const r of[Mo,...lEe]){const i=Xr(t[r]);!i||!e.getScaleComponent(r)||r===Lo&&qe(i)&&i.type===Hb||(n[r]=B5t(e,r))}return n}function L5t(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function P5t(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n!=null&&n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function B5t(e,t){var n,r,i;let s=e.legend(t);const{markDef:o,encoding:a,config:u}=e,l=u.legend,c=new C5t({},L5t(e,t));vPt(e,t,c);const f=s!==void 0?!s:l.disable;if(c.set("disable",f,s!==void 0),f)return c;s=s||{};const d=e.getScaleComponent(t).get("type"),h=Xr(a[t]),p=qe(h)?(n=Zs(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,m=s.orient||u.legend.orient||"right",x=I5t({legend:s,channel:t,timeUnit:p,scaleType:d}),b=D5t({legend:s,legendType:x,orient:m,legendConfig:l}),v={legend:s,channel:t,model:e,markDef:o,encoding:a,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:m,legendType:x,direction:b};for(const E of oAe){const _=E in Xoe?Xoe[E](v):s[E];if(_!==void 0){const D=P5t(_,E,s,e.fieldDef(t));(D||u.legend[E]===void 0)&&c.set(E,_,D)}}const $=(r=s==null?void 0:s.encoding)!==null&&r!==void 0?r:{},C=c.get("selections"),S={},A={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:x};for(const E of["labels","legend","title","symbols","gradient","entries"]){const _=sAe((i=$[E])!==null&&i!==void 0?i:{},e),D=E in Hoe?Hoe[E](_,A):_;D!==void 0&&!Dn(D)&&(S[E]=Object.assign(Object.assign(Object.assign({},C!=null&&C.length&&qe(h)?{name:`${er(h.field)}_legend_${E}`}:{}),C!=null&&C.length?{interactive:!!C}:{}),{update:D}))}return Dn(S)||c.set("encode",S,!!(s!=null&&s.encoding)),c}function z5t(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){cAe(r);for(const i of Oe(r.component.legends))n.legend[i]=KX(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=fAe(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of Oe(t))for(const i of e.children)i.component.legends[r]&&n.legend[r]==="shared"&&delete i.component.legends[r];return t}function fAe(e,t){var n,r,i,s;if(!e)return t.clone();const o=e.getWithExplicit("orient"),a=t.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;let u=!1;for(const l of oAe){const c=Gh(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return U5t(f,d);case"title":return Yke(f,d);case"type":return u=!0,Xo("symbol")}return lM(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(!((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0)&&r.gradient&&p7(e.implicit,["encode","gradient"]),!((s=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||s===void 0)&&s.gradient&&p7(e.explicit,["encode","gradient"])),e}function U5t(e,t){return t.value==="circle"?t:e}function Koe(e,t,n,r){var i,s,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(s=e.encode[t])!==null&&s!==void 0?s:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function dAe(e){const t=e.component.legends,n={};for(const i of Oe(t)){const s=e.getScaleComponent(i),o=Zn(s.get("domains"));if(n[o])for(const a of n[o])fAe(a,t[i])||n[o].push(t[i]);else n[o]=[t[i].clone()]}return ah(n).flat().map(i=>j5t(i,e.config)).filter(i=>i!==void 0)}function j5t(e,t){var n,r,i;const s=e.combine(),{disable:o,labelExpr:a,selections:u}=s,l=ht(s,["disable","labelExpr","selections"]);if(!o){if(t.aria===!1&&l.aria==null&&(l.aria=!1),!((n=l.encode)===null||n===void 0)&&n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of lEe)l[f]&&delete c[f]}if(l.title||delete l.title,a!==void 0){let c=a;!((i=(r=l.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0)&&i.update&&kt(l.encode.labels.update.text)&&(c=Ky(a,"datum.label",l.encode.labels.update.text.signal)),Koe(l,"labels","text",{signal:c})}for(const c in l){const f=l[c];if(kt(f)){const d=Y4t[c];if(d){const{vgProp:h,part:p}=d;Koe(l,p,h,f),delete l[c]}}}return l}}function W5t(e){return Zb(e)||eY(e)?V5t(e):hAe(e)}function V5t(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),hAe(e))}function hAe(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const u=kt(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return bt(o,u)||o.push(u),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const q5t=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class pAe extends Zf{constructor(t,n,r,i){super(Object.assign({},n),{name:t}),this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function gAe(e){e.component.projection=hr(e)?G5t(e):Y5t(e)}function G5t(e){var t;if(e.hasProjection){const n=e.specifiedProjection,r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=r?H5t(e):void 0;return new pAe(e.projectionName(!0),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n??{}),i,s)}}function H5t(e){const t=[],{encoding:n}=e;for(const r of[[Sc,Cc],[qa,nl]])(Xr(n[r[0]])||Xr(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Lo)&&e.typedFieldDef(Lo).type===Hb&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(os)),t}function X5t(e,t){const n=ASe(q5t,i=>!!(!Fg(e.explicit,i)&&!Fg(t.explicit,i)||Fg(e.explicit,i)&&Fg(t.explicit,i)&&Zn(e.get(i))===Zn(t.get(i))));if(Zn(e.size)===Zn(t.size)){if(n)return e;if(Zn(e.explicit)===Zn({}))return t;if(Zn(t.explicit)===Zn({}))return e}return null}function Y5t(e){if(e.children.length===0)return;let t;for(const r of e.children)gAe(r);const n=ASe(e.children,r=>{const i=r.component.projection;if(i)if(t){const s=X5t(t,i);return s&&(t=s),!!s}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new pAe(r,t.specifiedProjection,t.size,Ut(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&i.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),r),o.merged=!0)}return i}}function K5t(e,t,n,r){var i,s;if(Uk(t,n)){const o=hr(e)?(s=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&s!==void 0?s:{}:{},a=Be(t,{expr:"datum"}),u=Be(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Be(t,{binSuffix:"range",forAs:!0}),formula:tM(a,u,o.format,o.formatType,r)}}return{}}function mAe(e,t){return`${QSe(e)}_${t}`}function Q5t(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function QX(e,t,n){var r;const i=(r=sM(n,void 0))!==null&&r!==void 0?r:{},s=mAe(i,t);return e.getName(`${s}_bins`)}function Z5t(e){return"as"in e}function Qoe(e,t,n){let r,i;Z5t(e)?r=zt(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Be(e,{forAs:!0}),Be(e,{binSuffix:"end",forAs:!0})];const s=Object.assign({},sM(t,void 0)),o=mAe(s,e.field),{signal:a,extentSignal:u}=Q5t(n,o);if(JO(s.extent)){const c=s.extent,f=c.selection;i=HEe(n.getSelectionComponent(er(f),f),c),delete s.extent}const l=Object.assign(Object.assign(Object.assign({bin:s,field:e.field,as:[r]},a?{signal:a}:{}),u?{extentSignal:u}:{}),i?{span:i}:{});return{key:o,binComponent:l}}class Ul extends Tn{constructor(t,n){super(t),this.bins=n}clone(){return new Ul(null,Ut(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,s,o)=>{if(la(s)&&Pn(s.bin)){const{key:a,binComponent:u}=Qoe(s,s.bin,n);i[a]=Object.assign(Object.assign(Object.assign({},u),i[a]),K5t(n,s,o,n.config))}return i},{});return Dn(r)?null:new Ul(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:s}=Qoe(n,n.bin,r);return new Ul(t,{[i]:s})}merge(t,n){for(const r of Oe(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=Kd([...this.bins[r].as,...t.bins[r].as],rn)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(ah(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(ah(this.bins).map(t=>t.field))}hash(){return`Bin ${rn(this.bins)}`}assemble(){return ah(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,s=t.bin,{extent:o}=s,a=ht(s,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:Wh(t.field),as:r,signal:t.signal},JO(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),a);!o&&t.extentSignal&&(n.push({type:"extent",field:Wh(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:Be({field:r[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class ix extends Tn{constructor(t){super(null),t=t??{name:"source"};let n;if(Qg(t)||(n=t.format?Object.assign({},bf(t.format,["parse"])):{}),nD(t))this._data={values:t.values};else if(iC(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];bt(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else bEe(t)?this._data={values:[{type:"Sphere"}]}:(yEe(t)||Qg(t))&&(this._data={});this._generator=Qg(t),t.name&&(this._name=t.name),n&&!Dn(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function D7(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",t,n),!1;if(!D7(t.children))return!1}return!0}class Hk extends Tn{constructor(t,n){super(t),this.params=n}clone(){return new Hk(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${rn(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class Xk extends Tn{constructor(t,n){super(t),this.params=n}clone(){return new Xk(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${rn(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function xM(e){return e instanceof ix||e instanceof Hk||e instanceof Xk}class yAe{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class Jf extends yAe{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(xM(t))return!1;const n=t.parent,{continueFlag:r}=this.run(t);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class ZX extends yAe{}function J5t(e,t,n,r){const i=hr(r)?r.encoding[Ac(t)]:void 0;if(la(n)&&hr(r)&&vX(t,n,i,r.stack,r.markDef,r.config))e.add(Be(n,{})),e.add(Be(n,{suffix:"end"})),n.bin&&Uk(n,t)&&e.add(Be(n,{binSuffix:"range"}));else if(uOt(t)){const s=aOt(t);e.add(r.getName(s))}else e.add(Be(n));return e}function e6t(e,t){var n;for(const r of Oe(t)){const i=t[r];for(const s of Oe(i))r in e?e[r][s]=new Set([...(n=e[r][s])!==null&&n!==void 0?n:[],...i[s]]):e[r]={[s]:i[s]}}}class Fu extends Tn{constructor(t,n,r){super(t),this.dimensions=n,this.measures=r}clone(){return new Fu(null,new Set(this.dimensions),Ut(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(o=>{o.aggregate&&(r=!0)});const i={},s=new Set;return!r||(n.forEachFieldDef((o,a)=>{var u,l,c,f;const{aggregate:d,field:h}=o;if(d)if(d==="count")i["*"]=(u=i["*"])!==null&&u!==void 0?u:{},i["*"].count=new Set([Be(o,{forAs:!0})]);else{if(Vh(d)||A0(d)){const p=Vh(d)?"argmin":"argmax",m=d[p];i[m]=(l=i[m])!==null&&l!==void 0?l:{},i[m][p]=new Set([Be({op:p,field:m},{forAs:!0})])}else i[h]=(c=i[h])!==null&&c!==void 0?c:{},i[h][d]=new Set([Be(o,{forAs:!0})]);Cp(a)&&n.scaleDomain(a)==="unaggregated"&&(i[h]=(f=i[h])!==null&&f!==void 0?f:{},i[h].min=new Set([Be({field:h,aggregate:"min"},{forAs:!0})]),i[h].max=new Set([Be({field:h,aggregate:"max"},{forAs:!0})]))}else J5t(s,a,o,n)}),s.size+Oe(i).length===0)?null:new Fu(t,s,i)}static makeFromTransform(t,n){var r,i,s;const o=new Set,a={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?(a["*"]=(r=a["*"])!==null&&r!==void 0?r:{},a["*"].count=new Set([f||Be(u,{forAs:!0})])):(a[c]=(i=a[c])!==null&&i!==void 0?i:{},a[c][l]=new Set([f||Be(u,{forAs:!0})])))}for(const u of(s=n.groupby)!==null&&s!==void 0?s:[])o.add(u);return o.size+Oe(a).length===0?null:new Fu(t,o,a)}merge(t){return IRt(this.dimensions,t.dimensions)?(e6t(this.measures,t.measures),!0):(vMt("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Oe(this.measures)])}producedFields(){const t=new Set;for(const n of Oe(this.measures))for(const r of Oe(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${rn({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const s of Oe(this.measures))for(const o of Oe(this.measures[s]))for(const a of this.measures[s][o])r.push(a),t.push(o),n.push(s==="*"?null:Wh(s));return{type:"aggregate",groupby:[...this.dimensions].map(Wh),ops:t,fields:n,as:r}}}class Kb extends Tn{constructor(t,n,r,i){super(t),this.model=n,this.name=r,this.data=i;for(const s of Ra){const o=n.facet[s];if(o){const{bin:a,sort:u}=o;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[Be(o),...Pn(a)?[Be(o,{binSuffix:"end"})]:[]]},Bl(u)?{sortField:u}:yt(u)?{sortIndexField:nx(o,s)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Ra)this[n]&&(t+=` ${n.charAt(0)}:${rn(this[n])}`);return t}get fields(){var t;const n=[];for(const r of Ra)!((t=this[r])===null||t===void 0)&&t.fields&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Ra)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Ga){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),s=r.get("range");if(Po(i)&&Sp(s)){const o=bM(this.childModel,n),a=JX(o);a?t[n]=a:Fe(`Unknown field for ${n}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x"}[t],s=[],o=[],a=[];r&&r[i]&&(n?(s.push(`distinct_${r[i]}`),o.push("max")):(s.push(r[i]),o.push("distinct")),a.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=nM,field:f}=u;s.push(f),o.push(c),a.push(Be(u,{forAs:!0}))}else l&&(s.push(l),o.push("max"),a.push(l));return{name:this[t].name,source:n??this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},s.length?{fields:s,ops:o,as:a}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:s}=this.model.component,o=[],a={};for(const c of HX){for(const f of XX){const d=(n=s[c]&&s[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((r=h.axes)===null||r===void 0?void 0:r.length)>0){a[c]=!0;break}}if(a[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=a;return(u||l)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const r=[];let i=null;const s=this.getChildIndependentFieldsWithStep(),{column:o,row:a,facet:u}=this;if(o&&a&&(s.x||s.y)){i=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=s.x)!==null&&t!==void 0?t:[],(n=s.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[wf,vf])this[l]&&r.push(this.assembleRowColumnHeaderData(l,i,s));if(u){const l=this.assembleFacetHeaderData(s);l&&r.push(...l)}return r}}function Zoe(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function t6t(e,t){const n=NSe(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){const r=Zoe(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.indexOf("utc:")===0){const r=Zoe(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return Fe(DOt(t)),null}function n6t(e){const t={};return RT(e.filter,n=>{var r;if(pke(n)){let i=null;lX(n)?i=n.equal:cX(n)?i=n.range[0]:fX(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(qb(i)?t[n.field]="date":Mr(i)?t[n.field]="number":zt(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function r6t(e){const t={};function n(r){oM(r)?t[r.field]="date":r.type==="quantitative"&&nOt(r.aggregate)?t[r.field]="number":eC(r.field)>1?r.field in t||(t[r.field]="flatten"):CX(r)&&Bl(r.sort)&&eC(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((hr(e)||Ru(e))&&e.forEachFieldDef((r,i)=>{if(la(r))n(r);else{const s=T0(i),o=e.fieldDef(s);n(Object.assign(Object.assign({},r),{type:o.type}))}}),hr(e)){const{mark:r,markDef:i,encoding:s}=e;if(E0(r)&&!e.encoding.order){const o=i.orient==="horizontal"?"y":"x",a=s[o];qe(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function i6t(e){const t={};if(hr(e)&&e.component.selection)for(const n of Oe(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&eC(i.field)>1&&(t[i.field]="flatten")}return t}class gs extends Tn{constructor(t,n){super(t),this._parse=n}clone(){return new gs(null,Ut(this._parse))}hash(){return`Parse ${rn(this._parse)}`}static makeExplicit(t,n,r){let i={};const s=n.data;return!Qg(s)&&s&&s.format&&s.format.parse&&(i=s.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const a of Oe(r)){const u=i.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===r[a]||u.value==="derived"||r[a]==="flatten"?delete r[a]:Fe(loe(a,r[a],u.value)))}for(const a of Oe(n)){const u=i.get(a);u!==void 0&&(u===n[a]?delete n[a]:Fe(loe(a,n[a],u)))}const s=new Zf(n,r);i.copyAll(s);const o={};for(const a of Oe(s.combine())){const u=s.get(a);u!==null&&(o[a]=u)}return Oe(o).length===0||i.parseNothing?null:new gs(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of Oe(this._parse)){const r=this._parse[n];eC(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(Oe(this._parse))}dependentFields(){return new Set(Oe(this._parse))}assembleTransforms(t=!1){return Oe(this._parse).filter(n=>t?eC(n)>1:!0).map(n=>{const r=t6t(n,this._parse[n]);return r?{type:"formula",expr:r,as:DSe(n)}:null}).filter(n=>n!==null)}}class Yh extends Tn{clone(){return new Yh(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Jy])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Jy}}}class D0 extends Tn{constructor(t,n){super(t),this.transform=n}clone(){return new D0(null,Ut(this.transform))}addDimensions(t){this.transform.groupby=Kd(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Be(t)}hash(){return`JoinAggregateTransform ${rn(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const s of this.transform.joinaggregate)n.push(s.op),r.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}function s6t(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Be(r);return i&&t.push(i),t},[])}function o6t(e){return yt(e)&&e.every(t=>zt(t))&&e.length>1}class Cf extends Tn{constructor(t,n){super(t),this._stack=n}clone(){return new Cf(null,Ut(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:s,offset:o="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(Lr(f.order,"ascending"));const l={field:a,order:u};let c;return o6t(s)?c=s:zt(s)?c=[s,s+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new Cf(t,{stackField:r,groupby:i,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannel:s,fieldChannel:o,offset:a,impute:u}=r;let l;if(s){const h=i[s];l=sc(h)}const c=s6t(n),f=n.encoding.order;let d;return yt(f)||qe(f)?d=Gke(f):d=c.reduce((h,p)=>(h.field.push(p),h.order.push(o==="y"?"descending":"ascending"),h),{field:[],order:[]}),new Cf(t,{dimensionFieldDef:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${rn(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[Be(t,{binSuffix:"mid"})]:[Be(t,{}),Be(t,{binSuffix:"end"})]:[Be(t)]:r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:s,sort:o,offset:a,impute:u,as:l}=this._stack;if(u&&r){const{band:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+Be(r,{expr:"datum"})+`+${1-c}*`+Be(r,{expr:"datum",binSuffix:"end"}),as:Be(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...s,...n],key:Be(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:o,as:l,offset:a}),t}}class Qb extends Tn{constructor(t,n){super(t),this.transform=n}clone(){return new Qb(null,Ut(this.transform))}addDimensions(t){this.transform.groupby=Kd(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Be(t)}hash(){return`WindowTransform ${rn(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],s=[];for(const d of this.transform.window)r.push(d.op),i.push(this.getDefaultName(d)),s.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const o=this.transform.frame,a=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&r.every(d=>JH(d)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},a!==void 0?{groupby:a}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:s,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),a!==void 0?{groupby:a}:{}),o!==void 0?{frame:o}:{})}}class a6t extends Jf{run(t){const n=t.parent;if(t instanceof gs){if(xM(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof gs)this.setMutated(),n.merge(t);else{if(TSe(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class u6t extends ZX{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of Oe(r))r[i].length>1&&(this.setMutated(),this.mergeNodes(t,r[i]));for(const i of t.children)this.run(i);return this.mutatedFlag}}class l6t extends Jf{run(t){return t instanceof qs||t.numChildren()>0||t instanceof Kb?this.flags:(this.setMutated(),t.remove(),this.flags)}}class c6t extends Jf{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof zl){const n=t.producedFields();_Se(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class f6t extends Jf{run(t){this.setContinue();const r=t.parent.children.filter(s=>s instanceof zl),i=r.pop();for(const s of r)this.setMutated(),i.merge(s);return this.flags}}function d6t(e){function t(n){if(!(n instanceof Kb)){const r=n.clone();if(r instanceof qs){const i=R7+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof Fu||r instanceof Cf||r instanceof Qb||r instanceof D0)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function F7(e){if(e instanceof Kb)if(e.numChildren()===1&&!(e.children[0]instanceof qs)){const t=e.children[0];(t instanceof Fu||t instanceof Cf||t instanceof Qb||t instanceof D0)&&t.addDimensions(e.fields),t.swapWithParent(),F7(e)}else{const t=e.model.component.data.main;xAe(t);const n=d6t(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(F7)}function xAe(e){if(e instanceof qs&&e.type===os&&e.numChildren()===1){const t=e.children[0];t instanceof Kb||(t.swapWithParent(),xAe(e))}}class h6t extends ZX{constructor(){super()}run(t){t instanceof qs&&!t.isRequired()&&(this.setMutated(),t.remove());for(const n of t.children)this.run(n);return this.mutatedFlag}}class p6t extends ZX{constructor(t){super(),this.requiresSelectionId=t&&WX(t)}run(t){t instanceof Yh&&(this.requiresSelectionId&&(xM(t.parent)||t.parent instanceof Fu||t.parent instanceof gs)||(this.setMutated(),t.remove()));for(const n of t.children)this.run(n);return this.mutatedFlag}}class g6t extends Jf{run(t){const n=t.parent,r=[...n.children],i=n.children.filter(s=>s instanceof gs);if(n.numChildren()>1&&i.length>=1){const s={},o=new Set;for(const a of i){const u=a.parse;for(const l of Oe(u))l in s?s[l]!==u[l]&&o.add(l):s[l]=u[l]}for(const a of o)delete s[a];if(!Dn(s)){this.setMutated();const a=new gs(n,s);for(const u of r){if(u instanceof gs)for(const l of Oe(s))delete u.parse[l];n.removeChild(u),u.parent=a,u instanceof gs&&Oe(u.parse).length===0&&u.remove()}}}return this.setContinue(),this.flags}}class m6t extends Jf{run(t){const n=t.parent,r=n.children.filter(s=>s instanceof Fu),i={};for(const s of r){const o=rn(s.groupBy);o in i||(i[o]=[]),i[o].push(s)}for(const s of Oe(i)){const o=i[s];if(o.length>1){const a=o.pop();for(const u of o)a.merge(u)&&(n.removeChild(u),u.parent=a,u.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class y6t extends Jf{constructor(t){super(),this.model=t}run(t){const n=t.parent,r=!(xM(n)||n instanceof Yb||n instanceof gs||n instanceof Yh),i=[],s=[];for(const o of n.children)o instanceof Ul&&(r&&!TSe(n.producedFields(),o.dependentFields())?i.push(o):s.push(o));if(i.length>0){const o=i.pop();for(const a of i)o.merge(a,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof Ul?n.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(s.length>1){const o=s.pop();for(const a of s)o.merge(a,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class x6t extends Jf{run(t){const n=t.parent,r=[...n.children];if(!J$(r,a=>a instanceof qs)||n.numChildren()<=1)return this.setContinue(),this.flags;const s=[];let o;for(const a of r)if(a instanceof qs){let u=a;for(;u.numChildren()===1;){const l=u.children[0];if(l instanceof qs)u=l;else break}s.push(...u.children),o?(n.removeChild(a),a.parent=o.parent,o.parent.removeChild(o),o.parent=u,this.setMutated()):o=u}else s.push(a);if(s.length){this.setMutated();for(const a of s)a.parent.removeChild(a),a.parent=o}return this.setContinue(),this.flags}}const R7="scale_",g_=5;function Sd(e){const t=[];function n(r){if(r.numChildren()===0)t.push(r);else for(const i of r.children)n(i)}for(const r of e)n(r);return t}function b6t(e){return e}function cu(e,t){return t.map(r=>{if(e instanceof Jf){const i=e.optimizeNextFromLeaves(r);return e.reset(),i}else return e.run(r)}).some(b6t)}function Joe(e,t){let n=e.sources;const r=new Set;return r.add(cu(new h6t,n)),r.add(cu(new p6t(t),n)),n=n.filter(i=>i.numChildren()>0),r.add(cu(new l6t,Sd(n))),n=n.filter(i=>i.numChildren()>0),r.add(cu(new a6t,Sd(n))),r.add(cu(new y6t(t),Sd(n))),r.add(cu(new c6t,Sd(n))),r.add(cu(new g6t,Sd(n))),r.add(cu(new m6t,Sd(n))),r.add(cu(new f6t,Sd(n))),r.add(cu(new u6t,n)),r.add(cu(new x6t,Sd(n))),e.sources=n,r.has(!0)}function v6t(e,t){D7(e.sources);let n=0,r=0;for(let i=0;i<g_&&Joe(e,t);i++)n++;e.sources.map(F7);for(let i=0;i<g_&&Joe(e,t);i++)r++;D7(e.sources),Math.max(n,r)===g_&&Fe(`Maximum optimization runs(${g_}) reached.`)}class ra{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new ra(()=>t(n))}}function bAe(e){hr(e)?w6t(e):$6t(e)}function w6t(e){const t=e.component.scales;for(const n of Oe(t)){const r=S6t(e,n);if(t[n].setWithExplicit("domains",r),E6t(e,n),e.component.data.isFaceted){let s=e;for(;!Ru(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const a of r.value)Qd(a)&&(a.data=R7+a.data.replace(R7,""))}}}function $6t(e){for(const n of e.children)bAe(n);const t=e.component.scales;for(const n of Oe(t)){let r,i=null;for(const s of e.children){const o=s.component.scales[n];if(o){r===void 0?r=o.getWithExplicit("domains"):r=Gh(r,o.getWithExplicit("domains"),"domains","scale",O7);const a=o.get("selectionExtent");i&&a&&i.selection!==a.selection&&Fe("The same selection must be used to override scale domains in a layered view."),i=a}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function C6t(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:s}=eae(t,n);if(!i){Fe(s);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=eae(t,n);if(i)return"unaggregated"}return e}function S6t(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=C6t(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&Xr(r.x2)?Xr(r.x)?Gh(Ad(n,i,e,"x"),Ad(n,i,e,"x2"),"domain","scale",O7):Ad(n,i,e,"x2"):t==="y"&&Xr(r.y2)?Xr(r.y)?Gh(Ad(n,i,e,"y"),Ad(n,i,e,"y2"),"domain","scale",O7):Ad(n,i,e,"y2"):Ad(n,i,e,t)}function k6t(e,t,n){return e.map(r=>({signal:`{data: ${EX(r,{timeUnit:n,type:t})}}`}))}function B5(e,t,n){var r;const i=(r=Zs(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?k6t(e,t,i):[e]}function Ad(e,t,n,r){const{encoding:i}=n,s=Xr(i[r]),{type:o}=s,a=s.timeUnit;if(o4t(t)){const f=Ad(e,void 0,n,r),d=B5(t.unionWith,o,a);return Rg([...f.value,...d])}else{if(kt(t))return Rg([t]);if(t&&t!=="unaggregated"&&!yke(t))return Rg(B5(t,o,a))}const u=n.stack;if(u&&r===u.fieldChannel){if(u.offset==="normalize")return Xo([[0,1]]);const f=n.requestDataName(os);return Xo([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const l=Cp(r)&&qe(s)?A6t(n,r,e):void 0;if(kp(s)){const f=B5([s.datum],o,a);return Xo(f)}const c=s;if(t==="unaggregated"){const f=n.requestDataName(os),{field:d}=s;return Xo([{data:f,field:Be({field:d,aggregate:"min"})},{data:f,field:Be({field:d,aggregate:"max"})}])}else if(Pn(c.bin)){if(Po(e))return Xo(e==="bin-ordinal"?[]:[{data:qN(l)?n.requestDataName(os):n.requestDataName(rD),field:n.vgField(r,Uk(c,r)?{binSuffix:"range"}:{}),sort:l===!0||!$i(l)?{field:n.vgField(r,{}),op:"min"}:l}]);{const{bin:f}=c;if(Pn(f)){const d=QX(n,c.field,f);return Xo([new ra(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return Xo([{data:n.requestDataName(os),field:n.vgField(r,{})}])}}else if(c.timeUnit&&bt(["time","utc"],e)&&vX(r,c,hr(n)?n.encoding[Ac(r)]:void 0,n.stack,n.markDef,n.config)){const f=n.requestDataName(os);return Xo([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return Xo(l?[{data:qN(l)?n.requestDataName(os):n.requestDataName(rD),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(os),field:n.vgField(r)}])}function z5(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n??(t?"sum":nM)},r?{field:Wh(r)}:{}),i?{order:i}:{})}function E6t(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,s=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,o=yke(i)&&i,a=Pk(s)&&JO(s.extent)&&s.extent;(o||a)&&r.set("selectionExtent",o??a,!0)}function A6t(e,t,n){if(!Po(n))return;const r=e.fieldDef(t),i=r.sort;if(Nke(i))return{op:"min",field:nx(r,t),order:"ascending"};const{stack:s}=e,o=s?[...s.groupbyField?[s.groupbyField]:[],...s.stackBy.map(a=>a.fieldDef.field)]:void 0;if(Bl(i)){const a=s&&!bt(o,i.field);return z5(i,a)}else if(Ike(i)){const{encoding:a,order:u}=i,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=s&&!bt(o,f);if(Vh(c)||A0(c))return z5({field:Be(l),order:u},d);if(JH(c)||!c)return z5({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(bt(["ascending",void 0],i))return!0}}function eae(e,t){const{aggregate:n,type:r}=e;return n?zt(n)&&!sOt[n]?{valid:!1,reason:QOt(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:ZOt(e)}:{valid:!0}:{valid:!1,reason:KOt(e)}}function O7(e,t,n,r){return e.explicit&&t.explicit&&Fe(rMt(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function _6t(e){const t=Kd(e.map(o=>Qd(o)?ht(o,["sort"]):o),rn),n=Kd(e.map(o=>{if(Qd(o)){const a=o.sort;return a!==void 0&&!qN(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(o=>o!==void 0),rn);if(t.length===0)return;if(t.length===1){const o=e[0];if(Qd(o)&&n.length>0){let a=n[0];if(n.length>1)Fe(foe),a=!0;else if($i(a)&&"field"in a){const u=a.field;o.field===u&&(a=a.order?{order:a.order}:!0)}return Object.assign(Object.assign({},o),{sort:a})}return o}const r=Kd(n.map(o=>qN(o)||!("op"in o)||o.op in eOt?o:(Fe(sMt(o)),!0)),rn);let i;r.length===1?i=r[0]:r.length>1&&(Fe(foe),i=!0);const s=Kd(e.map(o=>Qd(o)?o.data:null),o=>o);return s.length===1&&s[0]!==null?Object.assign({data:s[0],fields:t.map(a=>a.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function JX(e){if(Qd(e)&&zt(e.field))return e.field;if(RMt(e)){let t;for(const n of e.fields)if(Qd(n)&&zt(n.field)){if(!t)t=n.field;else if(t!==n.field)return Fe(oMt),t}return Fe(aMt),t}else if(OMt(e)){Fe(uMt);const t=e.fields[0];return zt(t)?t:void 0}}function bM(e,t){const r=e.component.scales[t].get("domains").map(i=>(Qd(i)&&(i.data=e.lookupDataSource(i.data)),i));return _6t(r)}function vAe(e){return Zb(e)||eY(e)?e.children.reduce((t,n)=>t.concat(vAe(n)),tae(e)):tae(e)}function tae(e){return Oe(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:s,type:o,selectionExtent:a,domains:u,range:l,reverse:c}=i,f=ht(i,["name","type","selectionExtent","domains","range","reverse"]),d=T6t(i.range,s,n);let h;a&&(h=TPt(e,a));const p=bM(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:s,type:o},p?{domain:p}:{}),h?{domainRaw:h}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function T6t(e,t,n){return ic(n)&&Sp(e)?{step:{signal:t+"_step"}}:e}class wAe extends Zf{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:J$(this.get("domains"),t=>yt(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const I6t=["range","scheme"];function $Ae(e){return e==="x"?"width":e==="y"?"height":void 0}function N6t(e){const t=e.component.scales;for(const n of ZO){const r=t[n];if(!r)continue;const i=D6t(n,e);r.setWithExplicit("range",i)}}function nae(e,t){const n=e.fieldDef(t);if(n&&n.bin&&Pn(n.bin)){const r=QX(e,n.field,n.bin),i=$Ae(t),s=e.getName(i);return new ra(()=>{const o=e.getSignalName(r),a=`(${o}.stop - ${o}.start) / ${o}.step`;return`${e.getSignalName(s)} / (${a})`})}}function D6t(e,t){const n=t.specifiedScales[e],{size:r}=t,s=t.getScaleComponent(e).get("type");for(const o of I6t)if(n[o]!==void 0){const a=xke(s,o),u=bke(e,o);if(!a)Fe(tke(s,o,e));else if(u)Fe(u);else switch(o){case"range":return yt(n.range)&&ic(e)?Rg(n.range.map(l=>{if(l==="width"||l==="height"){const c=t.getName(l),f=t.getSignalName.bind(t);return ra.fromName(f,c)}return l})):Rg(n.range);case"scheme":return Rg(F6t(n[o]))}}if(e===lr||e===Qr){const o=e===lr?"width":"height",a=r[o];if(oc(a)){if(Po(s))return Rg({step:a.step});Fe(nke(o))}}return Xo(R6t(e,t))}function F6t(e){return s4t(e)?Object.assign({scheme:e.name},bf(e,["name"])):{scheme:e}}function R6t(e,t){const{size:n,config:r,mark:i,encoding:s}=t,o=t.getSignalName.bind(t),{type:a}=Xr(s[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case lr:case Qr:{if(bt(["point","band"],l)){if(e===lr&&!n.width){const p=rC(r.view,"width");if(oc(p))return p}else if(e===Qr&&!n.height){const p=rC(r.view,"height");if(oc(p))return p}}const d=$Ae(e),h=t.getName(d);return e===Qr&&Ha(l)?[ra.fromName(o,h),0]:[0,ra.fromName(o,h)]}case Kf:{const d=t.component.scales[e].get("zero"),h=CAe(i,d,r),p=L6t(i,n,t,r);return YN(l)?M6t(h,p,O6t(l,r,c,e)):[h,p]}case tl:return[0,Math.PI*2];case _0:return[0,360];case $c:return[0,new ra(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case vp:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case wp:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Lo:return"symbol";case Mo:case kc:case Ec:return l==="ordinal"?a==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case Qf:case xp:case bp:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function O6t(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&yt(n)?n.length+1:(Fe(yMt(r)),3)}}function M6t(e,t,n){const r=()=>{const i=nC(t),s=nC(e),o=`(${i} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${i} + ${o}, ${o})`};return kt(t)?new ra(r):{signal:r()}}function CAe(e,t,n){if(t)return kt(t)?{signal:`${t.signal} ? 0 : ${CAe(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(eM("size",e))}const rae=.95;function L6t(e,t,n,r){const i={x:nae(n,"x"),y:nae(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const s=iae(t,i,r.view);return Mr(s)?s-1:new ra(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const s=iae(t,i,r.view);return Mr(s)?Math.pow(rae*s,2):new ra(()=>`pow(${rae} * ${s.signal}, 2)`)}}throw new Error(eM("size",e))}function iae(e,t,n){const r=oc(e.width)?e.width.step:tD(n,"width"),i=oc(e.height)?e.height.step:tD(n,"height");return t.x||t.y?new ra(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function SAe(e,t){hr(e)?P6t(e,t):EAe(e,t)}function P6t(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:s,specifiedScales:o}=e;for(const a of Oe(n)){const u=o[a],l=n[a],c=e.getScaleComponent(a),f=Xr(i[a]),d=u[t],h=c.get("type"),p=c.get("padding"),m=c.get("paddingInner"),x=xke(h,t),b=bke(a,t);if(d!==void 0&&(x?b&&Fe(b):Fe(tke(h,t,a))),x&&b===void 0)if(d!==void 0)l.copyKeyFromObject(t,u);else{const v=t in sae?sae[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:m,domain:u.domain,markDef:s,config:r}):r.scale[t];v!==void 0&&l.set(t,v,!1)}}}const sae={bins:({model:e,fieldOrDatumDef:t})=>qe(t)?B6t(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>z6t(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>U6t(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>j6t(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>W6t(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:s})=>V6t(e,t,n,r.type,i,s.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=qe(e)?e.sort:void 0;return q6t(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>G6t(e,t,n,r,i)};function kAe(e){hr(e)?N6t(e):EAe(e,"range")}function EAe(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?kAe(r):SAe(r,t);for(const r of Oe(n)){let i;for(const s of e.children){const o=s.component.scales[r];if(o){const a=o.getWithExplicit(t);i=Gh(i,a,t,"scale",mEe((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function B6t(e,t){const n=t.bin;if(Pn(n)){const r=QX(e,t.field,n);return new ra(()=>e.getSignalName(r))}else if(zs(n)&&Pk(n)&&n.step!==void 0)return{step:n.step}}function z6t(e,t){if(bt([Mo,kc,Ec],e)&&t!=="nominal")return"hcl"}function U6t(e,t,n){var r;if(!(!((r=sc(n))===null||r===void 0)&&r.bin||bt([_r.TIME,_r.UTC],e)))return t in $p?!0:void 0}function j6t(e,t,n,r,i,s){if(e in $p){if(Au(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:a}=i;if(o==="bar"&&!(qe(r)&&(r.bin||r.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===_r.POINT)return n.pointPadding}}function W6t(e,t,n,r){if(e===void 0&&t in $p){const{bandPaddingInner:i,barBandPaddingInner:s,rectBandPaddingInner:o}=r;return Lr(i,n==="bar"?s:o)}}function V6t(e,t,n,r,i,s){if(e===void 0&&t in $p&&n===_r.BAND){const{bandPaddingOuter:o}=s;return Lr(o,kt(i)?{signal:`${i.signal}/2`}:i/2)}}function q6t(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Ha(e)&&t==="descending"?kt(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Ha(e)&&t==="descending")return!0}function G6t(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&Ha(i)){if(yt(n)){const o=n[0],a=n[n.length-1];if(o<=0&&a>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!YN(i))return!0;if(!(qe(t)&&t.bin)&&bt([...Ga,...mOt],e)){const{orient:o,type:a}=r;return!(bt(["bar","area","line","trail"],a)&&(o==="horizontal"&&e==="y"||o==="vertical"&&e==="x"))}return!1}function H6t(e,t,n,r){const i=X6t(t,n,r),{type:s}=e;return Cp(t)?s!==void 0?wke(t,s)?qe(n)&&!vke(s,n.type)?(Fe(tMt(s,i)),i):s:(Fe(eMt(t,s,i)),i):i:null}function X6t(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(ey(e)||MT(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&Fe(_5(e,"ordinal")),"ordinal";if(e in $p){if(bt(["rect","bar","image","rule"],n))return"band"}else if(n==="arc"&&e in rX)return"band";return t.band!==void 0||SX(t)&&(!((r=t.axis)===null||r===void 0)&&r.tickBand)?"band":"point";case"temporal":return ey(e)?"time":MT(e)==="discrete"?(Fe(_5(e,"temporal")),"ordinal"):qe(t)&&t.timeUnit&&Zs(t.timeUnit).utc?"utc":"time";case"quantitative":return ey(e)?qe(t)&&Pn(t.bin)?"bin-ordinal":"linear":MT(e)==="discrete"?(Fe(_5(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(JSe(t.type))}function Y6t(e,{ignoreRange:t}={}){AAe(e),bAe(e);for(const n of l4t)SAe(e,n);t||kAe(e)}function AAe(e){hr(e)?e.component.scales=K6t(e):e.component.scales=Z6t(e)}function K6t(e){const{encoding:t,mark:n}=e;return ZO.reduce((r,i)=>{const s=Xr(t[i]);if(s&&n===LSe&&i===Lo&&s.type===Hb)return r;let o=s&&s.scale;if(s&&o!==null&&o!==!1){o=o??{};const a=H6t(o,i,s,n);r[i]=new wAe(e.scaleName(i+"",!0),{value:a,explicit:o.type===a})}return r},{})}const Q6t=mEe((e,t)=>hoe(e)-hoe(t));function Z6t(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const s of e.children){AAe(s);for(const o of Oe(s.component.scales))if(i.scale[o]=(t=i.scale[o])!==null&&t!==void 0?t:w5t(o,e),i.scale[o]==="shared"){const a=r[o],u=s.component.scales[o].getWithExplicit("type");a?GMt(a.value,u.value)?r[o]=Gh(a,u,"type","scale",Q6t):(i.scale[o]="independent",delete r[o]):r[o]=u}}for(const s of Oe(r)){const o=e.scaleName(s,!0),a=r[s];n[s]=new wAe(o,a);for(const u of e.children){const l=u.component.scales[s];l&&(u.renameScale(l.get("name"),o),l.merged=!0)}}return n}class U5{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function hr(e){return(e==null?void 0:e.type)==="unit"}function Ru(e){return(e==null?void 0:e.type)==="facet"}function eY(e){return(e==null?void 0:e.type)==="concat"}function Zb(e){return(e==null?void 0:e.type)==="layer"}class tY{constructor(t,n,r,i,s,o,a){var u,l;this.type=n,this.parent=r,this.config=s,this.view=a,this.children=[],this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=r,this.config=s,this.name=(u=t.name)!==null&&u!==void 0?u:i,this.title=Fd(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new U5,this.projectionNameMap=r?r.projectionNameMap:new U5,this.signalNameMap=r?r.signalNameMap:new U5,this.data=t.data,this.description=t.description,this.transforms=tPt((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:nLt(t,n,s),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:rM(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new Zf,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Ut(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Y6t(this)}parseProjection(){gAe(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){cAe(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)===null||t===void 0?void 0:t.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(t){const n=ht(t,["style"]),r={};for(const i of Oe(n)){const s=n[i];s!==void 0&&(r[i]=Cr(s))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=Cr(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n??{}):Dn(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=ht(t,["spacing"]),{component:i,config:s}=this,o=v5t(i.layoutHeaders,s);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of Ra)t[r].title&&n.push(p5t(this,r));for(const r of HX)n=n.concat(g5t(this,r));return n}assembleAxes(){return e5t(this.component.axes,this.config)}assembleLegends(){return dAe(this)}assembleProjections(){return W5t(this)}assembleTitle(){var t,n,r;const i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:s}=i,o=ht(i,["encoding"]),a=Object.assign(Object.assign(Object.assign({},Wke(this.config.title).nonMark),o),s?{encode:{update:s}}:{});if(a.text)return bt(["unit","layer"],this.type)?bt(["middle",void 0],a.anchor)&&(a.frame=(n=a.frame)!==null&&n!==void 0?n:"group"):a.anchor=(r=a.anchor)!==null&&r!==void 0?r:"start",Dn(a)?void 0:a}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Ru(this.parent)?vAe(this):[];i.length>0&&(n.scales=i);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return er((this.name?this.name+"_":"")+t)}requestDataName(t){var n;const r=this.getName(t),i=this.component.data.outputNodeRefCounts;return i[r]=((n=i[r])!==null&&n!==void 0?n:0)+1,r}getSizeSignalRef(t){if(Ru(this.parent)){const n=iAe(t),r=QO(n),i=this.component.scales[r];if(i&&!i.merged){const s=i.get("type"),o=i.get("range");if(Po(s)&&Sp(o)){const a=i.get("name"),u=bM(this,r),l=JX(u);if(l){const c=Be({aggregate:"distinct",field:l},{expr:"datum"});return{signal:rAe(a,i,c)}}else return Fe(`Unknown field for ${r}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(GSe(t)&&Cp(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(EOt(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class _Ae extends tY{vgField(t,n={}){const r=this.fieldDef(t);if(r)return Be(r,n)}reduceFieldDef(t,n){return Kke(this.getMapping(),(r,i,s)=>{const o=sc(i);return o?t(r,o,s):r},n)}forEachFieldDef(t,n){TX(this.getMapping(),(r,i)=>{const s=sc(r);s&&t(s,i)},n)}}class vM extends Tn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Ut(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"value",(s=o[1])!==null&&s!==void 0?s:"density"]}clone(){return new vM(null,Ut(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${rn(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=ht(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class uC extends Tn{constructor(t,n){super(t),this.filter=n}clone(){return new uC(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:s}=n;if(yn("invalid",s,r)!=="filter")return null;const a=n.reduceFieldDef((u,l,c)=>{const f=Cp(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");Ha(d)&&l.aggregate!=="count"&&!E0(i)&&(u[l.field]=l)}return u},{});return Oe(a).length?new uC(t,a):null}dependentFields(){return new Set(Oe(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${rn(this.filter)}`}assemble(){const t=Oe(this.filter).reduce((n,r)=>{const i=this.filter[r],s=Be(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):i.type==="quantitative"&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class wM extends Tn{constructor(t,n){super(t),this.transform=n,this.transform=Ut(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((s,o)=>{var a;return(a=i[o])!==null&&a!==void 0?a:s})}clone(){return new wM(this.parent,Ut(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${rn(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class $M extends Tn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Ut(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"key",(s=o[1])!==null&&s!==void 0?s:"value"]}clone(){return new $M(null,Ut(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${rn(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class ty extends Tn{constructor(t,n,r,i){super(t),this.fields=n,this.geojson=r,this.signal=i}clone(){return new ty(null,Ut(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[Sc,Cc],[qa,nl]]){const s=i.map(o=>{const a=Xr(n.encoding[o]);return qe(a)?a.field:kp(a)?{expr:`${a.datum}`}:Mf(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new ty(t,s,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(Lo)){const i=n.typedFieldDef(Lo);i.type===Hb&&(t=new ty(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(zt);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${rn(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class lC extends Tn{constructor(t,n,r,i){super(t),this.projection=n,this.fields=r,this.as=i}clone(){return new lC(null,this.projection,Ut(this.fields),Ut(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[Sc,Cc],[qa,nl]]){const i=r.map(o=>{const a=Xr(n.encoding[o]);return qe(a)?a.field:kp(a)?{expr:`${a.datum}`}:Mf(a)?{expr:`${a.value}`}:void 0}),s=r[0]===qa?"2":"";(i[0]||i[1])&&(t=new lC(t,n.projectionName(),i,[n.getName("x"+s),n.getName("y"+s)]))}return t}dependentFields(){return new Set(this.fields.filter(zt))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${rn(this.fields)} ${rn(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Zg extends Tn{constructor(t,n){super(t),this.transform=n}clone(){return new Zg(null,Ut(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new Zg(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,s=r.y;if(qe(i)&&qe(s)){const o=i.impute?i:s.impute?s:void 0;if(o===void 0)return;const a=i.impute?s:s.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=Qke(n.mark,r);return new Zg(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:a.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${rn(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:s,value:o,frame:a=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:OLt(r)?this.processSequence(r):r}:{}),{method:"value"}),s?{groupby:s}:{}),{value:!i||i==="value"?o:null});if(i&&i!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:a,ignorePeers:!1},s?{groupby:s}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class CM extends Tn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Ut(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(s=o[1])!==null&&s!==void 0?s:n.loess]}clone(){return new CM(null,Ut(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${rn(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=ht(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class cC extends Tn{constructor(t,n,r){super(t),this.transform=n,this.secondary=r}clone(){return new cC(null,Ut(this.transform),this.secondary)}static make(t,n,r,i){const s=n.component.data.sources,{from:o}=r;let a=null;if(LLt(o)){let u=NAe(o.data,s);u||(u=new ix(o.data),s.push(u));const l=n.getName(`lookup_${i}`);a=new qs(u,l,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(PLt(o)){const u=o.selection;if(r=Object.assign({as:u},r),a=n.getSelectionComponent(er(u),u).materialized,!a)throw new Error(TOt(u))}return new cC(t,r,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Er(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${rn({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Er(this.transform.as)}:{});else{let n=this.transform.as;zt(n)||(Fe(ROt),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class SM extends Tn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Ut(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"prob",(s=o[1])!==null&&s!==void 0?s:"value"]}clone(){return new SM(null,Ut(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${rn(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=ht(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}class kM extends Tn{constructor(t,n){var r,i,s;super(t),this.transform=n,this.transform=Ut(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(s=o[1])!==null&&s!==void 0?s:n.regression]}clone(){return new kM(null,Ut(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${rn(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=ht(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class EM extends Tn{constructor(t,n){super(t),this.transform=n}clone(){return new EM(null,Ut(this.transform))}addDimensions(t){var n;this.transform.groupby=Kd(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${rn(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:s}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),s!==void 0?{op:s}:{}),r!==void 0?{groupby:r}:{})}}class AM extends Tn{constructor(t,n){super(t),this.transform=n}clone(){return new AM(null,Ut(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${rn(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function TAe(e){let t=0;function n(r,i){var s;if(r instanceof ix&&!r.isGenerator&&!iC(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof gs&&(r.parent instanceof ix&&!i.source?(i.format=Object.assign(Object.assign({},(s=i.format)!==null&&s!==void 0?s:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof Kb){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source;for(const o of r.assemble())e.push(o);return}switch((r instanceof Hk||r instanceof Xk||r instanceof uC||r instanceof Yb||r instanceof tx||r instanceof lC||r instanceof ty||r instanceof Fu||r instanceof cC||r instanceof Qb||r instanceof D0||r instanceof $M||r instanceof wM||r instanceof vM||r instanceof CM||r instanceof SM||r instanceof kM||r instanceof Yh||r instanceof AM||r instanceof EM)&&i.transform.push(r.assemble()),(r instanceof Ul||r instanceof zl||r instanceof Zg||r instanceof Cf)&&i.transform.push(...r.assemble()),r instanceof qs&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof qs?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof qs&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const a of r.children)n(a,{name:null,source:o,transform:[]});break}}}return n}function J6t(e){const t=[],n=TAe(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function ezt(e,t){var n,r;const i=[],s=TAe(i);let o=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${o++}`);const l=u.assemble();s(u,l)}for(const u of i)u.transform.length===0&&delete u.transform;let a=0;for(const[u,l]of i.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&i.splice(a++,0,i.splice(u,1)[0]);for(const u of i)for(const l of(r=u.transform)!==null&&r!==void 0?r:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of i)u.name in t&&(u.values=t[u.name]);return i}function tzt(e){return e==="top"||e==="left"||kt(e)?"header":"footer"}function nzt(e){for(const t of Ra)rzt(e,t);oae(e,"x"),oae(e,"y")}function rzt(e,t){var n;const{facet:r,config:i,child:s,component:o}=e;if(e.channelHasField(t)){const a=r[t],u=rx("title",null,i,t);let l=Yg(a,i,{allowDisabling:!0,includeDefault:u===void 0||!!u});s.component.layoutHeaders[t].title&&(l=yt(l)?l.join(", "):l,l+=" / "+s.component.layoutHeaders[t].title,s.component.layoutHeaders[t].title=null);const c=rx("labelOrient",a,i,t),f=(n=a.header)!==null&&n!==void 0?n:{},d=Lr(f.labels,i.header.labels,!0),h=bt(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:l,facetFieldDef:a,[h]:t==="facet"?[]:[IAe(e,t,d)]}}}function IAe(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function oae(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:s}=e.component;if(s.axis[t]=KX(s,t),s.axis[t]==="shared"){const o=t==="x"?"column":"row",a=i[o];for(const u of r.component.axes[t]){const l=tzt(u.get("orient"));a[l]=(n=a[l])!==null&&n!==void 0?n:[IAe(e,o,!1)];const c=aw(u,"main",e.config,{header:!0});c&&a[l][0].axes.push(c),u.mainExtracted=!0}}}}function izt(e){nY(e),uD(e,"width"),uD(e,"height")}function szt(e){nY(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";uD(e,t),uD(e,n)}function nY(e){for(const t of e.children)t.parseLayoutSize()}function uD(e,t){const n=iAe(t),r=QO(n),i=e.component.resolve,s=e.component.layoutSize;let o;for(const a of e.children){const u=a.component.layoutSize.getWithExplicit(n),l=i.scale[r];if(l==="independent"&&u.value==="step"){o=void 0;break}if(o){if(l==="independent"&&o.value!==u.value){o=void 0;break}o=Gh(o,u,n,"")}else o=u}if(o){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(t,o)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function ozt(e){const{size:t,component:n}=e;for(const r of Ga){const i=_c(r);if(t[i]){const s=t[i];n.layoutSize.set(i,oc(s)?"step":s,!0)}else{const s=azt(e,i);n.layoutSize.set(i,s,!1)}}}function azt(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const s=i.get("type"),o=i.get("range");if(Po(s)){const a=rC(r.view,t);return Sp(o)||oc(a)?"step":a}else return v7(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return v7(r.view,t);{const s=rC(r.view,t);return oc(s)?s.step:s}}}function M7(e,t,n){return Be(t,Object.assign({suffix:`by_${Be(e)}`},n??{}))}class Dw extends _Ae{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve),this.child=oY(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet,i)}initFacet(t,n){return Bk(t)?Kke(t,(r,i,s)=>bt([vf,wf],s)?i.field===void 0?(Fe(g7(i,s)),r):(r[s]=x7(i,s,n),r):(Fe(eM(s,"facet")),r),{}):{facet:x7(t,"facet",n)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=_M(this),this.child.parseData()}parseLayoutSize(){nY(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),nzt(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const s of Ra)for(const o of XX){const a=this.component.layoutHeaders[s],u=a[o],{facetFieldDef:l}=a;if(l){const c=rx("titleOrient",l,this.config,s);if(bt(["right","bottom"],c)){const f=mM(s,c);i.titleAnchor=(t=i.titleAnchor)!==null&&t!==void 0?t:{},i.titleAnchor[f]="end"}}if(u!=null&&u[0]){const c=s==="row"?"height":"width",f=o==="header"?"headerBand":"footerBand";s!=="facet"&&!this.child.component.layoutSize.get(c)&&(i[f]=(n=i[f])!==null&&n!==void 0?n:{},i[f][s]=.5),a.title&&(i.offset=(r=i.offset)!==null&&r!==void 0?r:{},i.offset[s==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Dw))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof Dw?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Be(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof Dw){if(this.child.channelHasField("column")){const i=Be(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Ga){const s=this.child.component.scales[i];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(Po(o)&&Sp(a)){const u=bM(this.child,i),l=JX(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):Fe(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of Ra){const f=this.facet[c];if(f){u.push(Be(f));const{bin:d,sort:h}=f;if(Pn(d)&&u.push(Be(f,{binSuffix:"end"})),Bl(h)){const{field:p,op:m=nM}=h,x=M7(f,h);r&&i?(s.push(x),o.push("max"),a.push(x)):(s.push(p),o.push(m),a.push(x))}else if(yt(h)){const p=nx(f,c);s.push(p),o.push("max"),a.push(p)}}}const l=!!r&&!!i;return Object.assign({name:t,data:n,groupby:u},l||s.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),s.length?{fields:s,ops:o,as:a}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?Bl(r.sort)?[M7(r,r.sort,{expr:"datum"})]:yt(r.sort)?[nx(r,t,{expr:"datum"})]:[Be(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(Bl(i)?i.order:!yt(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return I7(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const i of HX)if(t[i]){const s=rx("labelOrient",t[i],n,i);if(bt(r[i],s))return I7(t[i],i,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=J6t(n),i=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},s?{title:s}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:Ra.map(u=>this.facetSortFields(u)).flat(),order:Ra.map(u=>this.facetSortOrder(u)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(kPt(this,[])))]}getMapping(){return this.facet}}function uzt(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const s of[n,r])if(Bl(s.sort)){const{field:o,op:a=nM}=s.sort;e=i=new D0(e,{joinaggregate:[{op:a,field:o,as:M7(s,s.sort,{forAs:!0})}],groupby:[Be(s)]})}return i}return null}function NAe(e,t){var n,r,i,s,o,a,u,l,c,f;for(const d of t){const h=d.data;if(!(e.name&&d.hasName()&&e.name!==d.dataName)&&!(!((n=e.format)===null||n===void 0)&&n.mesh&&(!((r=h.format)===null||r===void 0)&&r.feature))&&!((!((i=e.format)===null||i===void 0)&&i.feature||!((s=h.format)===null||s===void 0)&&s.feature)&&((o=e.format)===null||o===void 0?void 0:o.feature)!==((a=h.format)===null||a===void 0?void 0:a.feature))&&!((!((u=e.format)===null||u===void 0)&&u.mesh||!((l=h.format)===null||l===void 0)&&l.mesh)&&((c=e.format)===null||c===void 0?void 0:c.mesh)!==((f=h.format)===null||f===void 0?void 0:f.mesh))){if(nD(e)&&nD(h)){if(Rk(e.values,h.values))return d}else if(iC(e)&&iC(h)){if(e.url===h.url)return d}else if(yEe(e)&&e.name===d.dataName)return d}}return null}function lzt(e,t){if(e.data||!e.parent){if(e.data===null){const r=new ix({values:[]});return t.push(r),r}const n=NAe(e.data,t);if(n)return Qg(e.data)||(n.data.format=_Rt({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new ix(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function czt(e,t,n){var r,i;let s=0;for(const o of t.transforms){let a,u;if(XLt(o))u=e=new tx(e,o),a="derived";else if(vEe(o)){const l=n6t(o);u=e=(r=gs.makeWithAncestors(e,{},l,n))!==null&&r!==void 0?r:e,e=new Yb(e,t,o.filter)}else if(YLt(o))u=e=Ul.makeFromTransform(e,o,t),a="number";else if(QLt(o))a="date",n.getWithExplicit(o.field).value===void 0&&(e=new gs(e,{[o.field]:a}),n.set(o.field,a,!1)),u=e=zl.makeFromTransform(e,o);else if(ZLt(o))u=e=Fu.makeFromTransform(e,o),a="number",WX(t)&&(e=new Yh(e));else if(MLt(o))u=e=cC.make(e,t,o,s++),a="derived";else if(qLt(o))u=e=new Qb(e,o),a="number";else if(GLt(o))u=e=new D0(e,o),a="number";else if(JLt(o))u=e=Cf.makeFromTransform(e,o),a="derived";else if(ePt(o))u=e=new $M(e,o),a="derived";else if(HLt(o))u=e=new wM(e,o),a="derived";else if(BLt(o))u=e=new EM(e,o),a="derived";else if(VLt(o))e=new AM(e,o);else if(KLt(o))u=e=Zg.makeFromTransform(e,o),a="derived";else if(zLt(o))u=e=new vM(e,o),a="derived";else if(ULt(o))u=e=new SM(e,o),a="derived";else if(jLt(o))u=e=new kM(e,o),a="derived";else if(WLt(o))u=e=new CM(e,o),a="derived";else{Fe(FOt(o));continue}if(u&&a!==void 0)for(const l of(i=u.producedFields())!==null&&i!==void 0?i:[])n.set(l,a,!1)}return e}function _M(e){var t,n,r,i,s,o,a,u,l,c;let f=lzt(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,p=e.parent?e.parent.component.data.ancestorParse.clone():new RLt,m=e.data;Qg(m)?(xEe(m)?f=new Xk(f,m.sequence):PX(m)&&(f=new Hk(f,m.graticule)),p.parseNothing=!0):((t=m==null?void 0:m.format)===null||t===void 0?void 0:t.parse)===null&&(p.parseNothing=!0),f=(n=gs.makeExplicit(f,e,p))!==null&&n!==void 0?n:f,f=new Yh(f);const x=e.parent&&Zb(e.parent);(hr(e)||Ru(e))&&x&&(f=(r=Ul.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=czt(f,e,p));const b=i6t(e),v=r6t(e);f=(i=gs.makeWithAncestors(f,{},Object.assign(Object.assign({},b),v),p))!==null&&i!==void 0?i:f,hr(e)&&(f=ty.parseAll(f,e),f=lC.parseAll(f,e)),(hr(e)||Ru(e))&&(x||(f=(s=Ul.makeFromEncoding(f,e))!==null&&s!==void 0?s:f),f=(o=zl.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=tx.parseAllForSortIndex(f,e));const $=e.getName(rD),C=new qs(f,$,rD,h);if(d[$]=C,f=C,hr(e)){const _=Fu.makeFromEncoding(f,e);_&&(f=_,WX(e)&&(f=new Yh(f))),f=(a=Zg.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=(u=Cf.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}hr(e)&&(f=(l=uC.make(f,e))!==null&&l!==void 0?l:f);const S=e.getName(os),A=new qs(f,S,os,h);d[S]=A,f=A,hr(e)&&ZBt(e,A);let E=null;if(Ru(e)){const _=e.getName("facet");f=(c=uzt(f,e.facet))!==null&&c!==void 0?c:f,E=new Kb(f,e,_,A.getSource()),d[_]=E}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:C,main:A,facetRoot:E,ancestorParse:p})}class fzt extends tY{constructor(t,n,r,i){var s,o,a,u;super(t,"concat",n,r,i,t.resolve),(((o=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||o===void 0?void 0:o.x)==="shared"||((u=(a=t.resolve)===null||a===void 0?void 0:a.axis)===null||u===void 0?void 0:u.y)==="shared")&&Fe(NOt),this.children=this.getChildren(t).map((l,c)=>oY(l,this,this.getName("concat_"+c),void 0,i))}parseData(){this.component.data=_M(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Oe(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return aM(t)?t.vconcat:MX(t)?t.hconcat:t.concat}parseLayoutSize(){szt(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=YX(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function dzt(e){return e===!1||e===null}const hzt=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},RSe),{labelExpr:1,encode:1}),DAe=Oe(hzt);class rY extends Zf{constructor(t={},n={},r=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new rY(Ut(this.explicit),Ut(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!dzt(this.get(t))}hasOrientSignalRef(){return kt(this.explicit.orient)}}function pzt(e,t,n){var r;const{encoding:i,config:s}=e,o=(r=Xr(i[t]))!==null&&r!==void 0?r:Xr(i[Ac(t)]),a=e.axis(t)||{},{format:u,formatType:l}=a;return Nm(l)?Object.assign({text:xX({fieldOrDatumDef:o,field:"datum.value",format:u,formatType:l,config:s})},n):n}function gzt(e){return Ga.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[$zt(n,e)]),t),{})}const mzt={bottom:"top",top:"bottom",left:"right",right:"left"};function yzt(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const s of e.children){s.parseAxesAndHeaders();for(const o of Oe(s.component.axes))r.axis[o]=KX(e.component.resolve,o),r.axis[o]==="shared"&&(n[o]=xzt(n[o],s.component.axes[o]),n[o]||(r.axis[o]="independent",delete n[o]))}for(const s of Ga){for(const o of e.children)if(o.component.axes[s]){if(r.axis[s]==="independent"){n[s]=((t=n[s])!==null&&t!==void 0?t:[]).concat(o.component.axes[s]);for(const a of o.component.axes[s]){const{value:u,explicit:l}=a.getWithExplicit("orient");if(!kt(u)){if(i[u]>0&&!l){const c=mzt[u];i[u]>i[c]&&a.set("orient",c,!1)}i[u]++}}}delete o.component.axes[s]}if(r.axis[s]==="independent"&&n[s]&&n[s].length>1)for(const o of n[s])o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function xzt(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],s=t[r];if(!!i!=!!s)return;if(i&&s){const o=i.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[r]=bzt(i,s)}}}else return t.map(n=>n.clone());return e}function bzt(e,t){for(const n of DAe){const r=Gh(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,s)=>{switch(n){case"title":return Yke(i,s);case"gridScale":return{explicit:i.explicit,value:Lr(i.value,s.value)}}return lM(i,s,n,"axis")});e.setWithExplicit(n,r)}return e}function vzt(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(kt(n.labelAngle)?n.labelAngle:GN(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===JEe(r,i))return!0}return e===n[t]}const wzt=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function $zt(e,t){var n,r,i;let s=t.axis(e);const o=new rY,a=Xr(t.encoding[e]),{mark:u,config:l}=t,c=(s==null?void 0:s.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=l.axis)===null||r===void 0?void 0:r.orient)||c5t(e),f=t.getScaleComponent(e).get("type"),d=r5t(e,f,c,t.config),h=s!==void 0?!s:_7("disable",l,s==null?void 0:s.style,d).configValue;if(o.set("disable",h,s!==void 0),h)return o;s=s||{};const p=a5t(t,s,e,a,d),m={fieldOrDatumDef:a,axis:s,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:u,config:l};for(const v of DAe){const $=v in qoe?qoe[v](m):eoe(v)?s[v]:void 0,C=$!==void 0,S=vzt($,v,s,t,e);if(C&&S)o.set(v,$,S);else{const{configValue:A=void 0,configFrom:E=void 0}=eoe(v)&&v!=="values"?_7(v,t.config,s.style,d):{},_=A!==void 0;C&&!_?o.set(v,$,S):(E!=="vgAxisConfig"||wzt.has(v)&&_||YH(A)||kt(A))&&o.set(v,A,!1)}}const x=(i=s.encoding)!==null&&i!==void 0?i:{},b=FSe.reduce((v,$)=>{var C;if(!o.hasAxisPart($))return v;const S=sAe((C=x[$])!==null&&C!==void 0?C:{},t),A=$==="labels"?pzt(t,e,S):S;return A!==void 0&&!Dn(A)&&(v[$]={update:A}),v},{});return Dn(b)||o.set("encode",b,!!s.encoding||s.labelAngle!==void 0),o}function Czt({encoding:e,size:t}){for(const n of Ga){const r=_c(n);oc(t[r])&&_l(e[n])&&(delete t[r],Fe(nke(r)))}return t}function Szt(e,t,n,{graticule:r}){const i=rc(e)?Object.assign({},e):{type:e},s=yn("orient",i,n);if(i.orient=_zt(i.type,t,s),s!==void 0&&s!==i.orient&&Fe(HOt(i.orient,s)),i.type==="bar"&&i.orient){const l=yn("cornerRadiusEnd",i,n);if(l!==void 0){const c=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:XRt[i.orient];for(const f of c)i[f]=l;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return yn("opacity",i,n)===void 0&&(i.opacity=Ezt(i.type,t)),i.filled===void 0&&(i.filled=r?!1:Azt(i,n)),yn("cursor",i,n)===void 0&&(i.cursor=kzt(i,t,n)),i}function kzt(e,t,n){return t.href||e.href||yn("href",e,n)?"pointer":e.cursor}function Ezt(e,t){if(bt([VO,KH,QH,ZH],e)&&!AX(t))return .7}function Azt(e,t){const n=Dm("filled",e,t),r=e.type;return Lr(n,r!==VO&&r!==WO&&r!==HN)}function _zt(e,t,n){switch(e){case VO:case QH:case ZH:case MSe:case zRt:case BRt:return}const{x:r,y:i,x2:s,y2:o}=t;switch(e){case jO:if(qe(r)&&(zs(r.bin)||qe(i)&&i.aggregate&&!r.aggregate))return"vertical";if(qe(i)&&(zs(i.bin)||qe(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s&&(qe(r)&&r.type===Im&&!Pn(r.bin)||y7(r)))return"horizontal";if(!o&&(qe(i)&&i.type===Im&&!Pn(i.bin)||y7(i)))return"vertical"}case HN:if(s&&!(qe(r)&&zs(r.bin))&&o&&!(qe(i)&&zs(i.bin)))return;case UO:if(o)return qe(i)&&zs(i.bin)?"horizontal":"vertical";if(s)return qe(r)&&zs(r.bin)?"vertical":"horizontal";if(e===HN){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case WO:case KH:{const a=_l(r),u=_l(i);if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u){const l=r,c=i,f=l.type===Zy,d=c.type===Zy;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}}return"vertical"}const Tzt={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),hs("x",e,{defaultPos:"mid"})),hs("y",e,{defaultPos:"mid"})),Hh(e,"radius","arc")),Hh(e,"theta","arc"))},Izt={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),iD("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),iD("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),UX(e))},Nzt={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Hh(e,"x","bar")),Hh(e,"y","bar"))},Dzt={vgMark:"shape",encodeEntry:e=>Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&qe(n)&&n.type===Hb?{field:Be(n,{expr:"datum"})}:{})]}},Fzt={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Hh(e,"x","image")),Hh(e,"y","image")),BX(e,"url"))},Rzt={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),hs("x",e,{defaultPos:"mid"})),hs("y",e,{defaultPos:"mid"})),di("size",e,{vgChannel:"strokeWidth"})),UX(e))},Ozt={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),hs("x",e,{defaultPos:"mid"})),hs("y",e,{defaultPos:"mid"})),di("size",e)),UX(e))};function iY(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),hs("x",e,{defaultPos:"mid"})),hs("y",e,{defaultPos:"mid"})),di("size",e)),di("angle",e)),Mzt(e,n,t))}function Mzt(e,t,n){return n?{shape:{value:n}}:di("shape",e)}const Lzt={vgMark:"symbol",encodeEntry:e=>iY(e)},Pzt={vgMark:"symbol",encodeEntry:e=>iY(e,"circle")},Bzt={vgMark:"symbol",encodeEntry:e=>iY(e,"square")},zzt={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Hh(e,"x","rect")),Hh(e,"y","rect"))},Uzt={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),iD("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),iD("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),di("size",e,{vgChannel:"strokeWidth"}))}},jzt={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ja(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),hs("x",e,{defaultPos:"mid"})),hs("y",e,{defaultPos:"mid"})),BX(e)),di("size",e,{vgChannel:"fontSize"})),di("angle",e)),Roe("align",Wzt(e.markDef,n,t))),Roe("baseline",Vzt(e.markDef,n,t))),hs("radius",e,{defaultPos:null,isMidPoint:!0})),hs("theta",e,{defaultPos:null,isMidPoint:!0}))}};function Wzt(e,t,n){if(yn("align",e,n)===void 0)return"center"}function Vzt(e,t,n){if(yn("baseline",e,n)===void 0)return"middle"}const qzt={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",s=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ja(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),hs("x",e,{defaultPos:"mid",vgChannel:"xc"})),hs("y",e,{defaultPos:"mid",vgChannel:"yc"})),di("size",e,{defaultValue:Gzt(e),vgChannel:i})),{[s]:Cr(yn("thickness",n,t))})}};function Gzt(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,s=i==="horizontal"?"width":"height",o=e.getScaleComponent(i==="horizontal"?"x":"y"),a=(t=yn("size",r,n,{vgChannel:s}))!==null&&t!==void 0?t:n.tick.bandSize;if(a!==void 0)return a;{const u=o?o.get("range"):void 0;return u&&Sp(u)&&Mr(u.step)?u.step*3/4:tD(n.view,s)*3/4}}const m_={arc:Tzt,area:Izt,bar:Nzt,circle:Pzt,geoshape:Dzt,image:Fzt,line:Rzt,point:Lzt,rect:zzt,rule:Uzt,square:Bzt,text:jzt,tick:qzt,trail:Ozt};function Hzt(e){return bt([WO,UO,URt],e.mark)?Xzt(e):bt([jO],e.mark)?Yzt(e):lD(e)}const aae="faceted_path_";function Xzt(e){const t=Qke(e.mark,e.encoding),n=lD(e,{fromPrefix:t.length>0?aae:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:aae+e.requestDataName(os),data:e.requestDataName(os),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}const uae="stack_group_";function Yzt(e){const t=T5.some(n=>yn(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){const[n]=lD(e,{fromPrefix:uae}),r=e.scaleName(e.stack.fieldChannel),i=(f={})=>e.vgField(e.stack.fieldChannel,f),s=(f,d)=>{const h=[i({prefix:"min",suffix:"start",expr:d}),i({prefix:"max",suffix:"start",expr:d}),i({prefix:"min",suffix:"end",expr:d}),i({prefix:"max",suffix:"end",expr:d})];return`${f}(${h.map(p=>`scale('${r}',${p})`).join(",")})`};let o,a;e.stack.fieldChannel==="x"?(o=Object.assign(Object.assign({},Z$(n.encode.update,["y","yc","y2","height",...T5])),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},bf(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},Z$(n.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},bf(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const f of T5){const d=Dm(f,e.markDef,e.config);n.encode.update[f]?(o[f]=n.encode.update[f],delete n.encode.update[f]):d&&(o[f]=Cr(d)),d&&(n.encode.update[f]={value:0})}const u=e.fieldDef(e.stack.groupbyChannel),l=Be(u)?[Be(u)]:[];return(u!=null&&u.bin||u!=null&&u.timeUnit)&&l.push(Be(u,{binSuffix:"end"})),o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,d)=>{if(n.encode.update[d])return Object.assign(Object.assign({},f),{[d]:n.encode.update[d]});{const h=Dm(d,e.markDef,e.config);return h!==void 0?Object.assign(Object.assign({},f),{[d]:Cr(h)}):f}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(os),name:uae+e.requestDataName(os),groupby:l,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[n]}]}]}else return lD(e)}function Kzt(e){const{encoding:t,stack:n,mark:r,markDef:i,config:s}=e,o=t.order;if(!(!yt(o)&&Mf(o)&&Qse(o.value)||!o&&Qse(yn("order",i,s)))){if((yt(o)||qe(o))&&!n)return Gke(o,{expr:"datum"});if(E0(r)){const a=i.orient==="horizontal"?"y":"x",u=t[a];if(qe(u)){const l=u.sort;if(yt(l))return{field:Be(u,{prefix:a,suffix:"sort_index",expr:"datum"})};if(Bl(l))return{field:Be({aggregate:AX(e.encoding)?l.op:void 0,field:l.field},{expr:"datum"})};if(Ike(l)){const c=e.fieldDef(l.encoding);return{field:Be(c,{expr:"datum"}),order:l.order}}else return l===null?void 0:{field:Be(u,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function lD(e,t={fromPrefix:""}){const{mark:n,markDef:r,config:i}=e,s=Lr(r.clip,Qzt(e),Zzt(e)),o=Vke(r),a=e.encoding.key,u=Kzt(e),l=Jzt(e),c=yn("aria",r,i),f=m_[n].postEncodingTransform?m_[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:m_[n].vgMark},s?{clip:!0}:{}),{style:o}),a?{key:a.field}:{}),u?{sort:u}:{}),l||{}),c===!1?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(os)},encode:{update:m_[n].encodeEntry(e)}}),f?{transform:f}:{})]}function Qzt(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function Zzt(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function Jzt(e){if(!e.component.selection)return null;const t=Oe(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=Oe(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}class FAe extends _Ae{constructor(t,n,r,i={},s){var o,a;super(t,"unit",n,r,s,void 0,boe(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const u=rc(t.mark)?t.mark.type:t.mark;this.markDef=Szt(t.mark,(o=t.encoding)!==null&&o!==void 0?o:{},s,{graticule:t.data&&PX(t.data)});const l=this.encoding=D4t((a=t.encoding)!==null&&a!==void 0?a:{},this.markDef,s);this.size=Czt({encoding:l,size:boe(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=dEe(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegend(l),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,n=this.mark===LSe,r=t&&lOt.some(i=>_t(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return ZO.reduce((r,i)=>{var s;const o=Xr(n[i]);return o&&(r[i]=(s=o.scale)!==null&&s!==void 0?s:{}),r},{})}initAxes(t){return Ga.reduce((n,r)=>{const i=t[r];if(_t(i)||r===lr&&_t(t.x2)||r===Qr&&_t(t.y2)){const s=_t(i)?i.axis:void 0;n[r]=s&&Object.assign({},s)}return n},{})}initLegend(t){return yOt.reduce((n,r)=>{const i=Xr(t[r]);if(i&&bOt(r)){const s=i.legend;n[r]=s&&Object.assign({},s)}return n},{})}parseData(){this.component.data=_M(this)}parseLayoutSize(){ozt(this)}parseSelections(){this.component.selection=QBt(this,this.selection)}parseMarkGroup(){this.component.mark=Hzt(this)}parseAxesAndHeaders(){this.component.axes=gzt(this)}assembleSelectionTopLevelSignals(t){return EPt(this,t)}assembleSignals(){return[...XEe(this),...SPt(this,[])]}assembleSelectionData(t){return APt(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return YX(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!Zb(this.parent))&&(n=REe(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Kg(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return sc(n)}typedFieldDef(t){const n=this.fieldDef(t);return la(n)?n:null}}class sY extends tY{constructor(t,n,r,i,s){super(t,"layer",n,r,s,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((a,u)=>{if(uM(a))return new sY(a,this,this.getName("layer_"+u),o,s);if(Hf(a))return new FAe(a,this,this.getName("layer_"+u),o,s);throw new Error(iX(a))})}parseData(){this.component.data=_M(this);for(const t of this.children)t.parseData()}parseLayoutSize(){izt(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Oe(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){yzt(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),XEe(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),YX(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return _Pt(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),dAe(this))}}function oY(e,t,n,r,i){if(rM(e))return new Dw(e,t,n,i);if(uM(e))return new sY(e,t,n,r,i);if(Hf(e))return new FAe(e,t,n,r,i);if(J4t(e))return new fzt(e,t,n,i);throw new Error(iX(e))}function e8t(e,t={}){t.logger&&xMt(t.logger),t.fieldTitle&&Bke(t.fieldTitle);try{const n=cEe(ESe(t.config,e.config)),r=gEe(e,n),i=oY(r,null,"",void 0,n);return i.parse(),v6t(i.component.data,i),{spec:n8t(i,t8t(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&bMt(),t.fieldTitle&&k4t()}}function t8t(e,t,n,r){const i=r.component.layoutSize.get("width"),s=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):zt(t)&&(t={type:t}),i&&s&&NLt(t.type)){if(i==="step"&&s==="step")Fe(ooe()),t.type="pad";else if(i==="step"||s==="step"){const o=i==="step"?"width":"height";Fe(ooe(QO(o)));const a=o==="width"?"height":"width";t.type=DLt(a)}}return Object.assign(Object.assign(Object.assign({},Oe(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),Ioe(n)),Ioe(e))}function n8t(e,t,n={},r){const i=e.config?fLt(e.config):void 0,s=[].concat(e.assembleSelectionData([]),ezt(e.component.data,n)),o=e.assembleProjections(),a=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();return c=c.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),a?{title:a}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:s}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}class r8t extends fEe{mapUnit(t,{config:n}){if(t.encoding){const{encoding:r,transform:i}=t,{bins:s,timeUnits:o,aggregate:a,groupby:u,encoding:l}=_X(r,n),c=[...i||[],...s,...o,...a.length===0?[]:[{aggregate:a,groupby:u}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:l})}else return t}}const i8t=new r8t;function s8t(e,t){return i8t.map(e,{config:t})}const o8t=aRt.version,a8t=Object.freeze(Object.defineProperty({__proto__:null,compile:e8t,extractTransforms:s8t,normalize:gEe,version:o8t},Symbol.toStringTag,{value:"Module"}));function RAe(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var u8t="vega-themes",l8t="2.15.0",c8t="Themes for stylized Vega and Vega-Lite visualizations.",f8t=["vega","vega-lite","themes","style"],d8t="BSD-3-Clause",h8t={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},p8t=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],g8t="build/vega-themes.js",m8t="build/vega-themes.module.js",y8t="build/vega-themes.min.js",x8t="build/vega-themes.min.js",b8t="build/vega-themes.module.d.ts",v8t={type:"git",url:"https://github.com/vega/vega-themes.git"},w8t=["src","build"],$8t={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",format:"eslint . --fix",lint:"eslint .",release:"release-it"},C8t={"@babel/core":"^7.24.6","@babel/plugin-transform-runtime":"^7.24.6","@babel/preset-env":"^7.24.6","@babel/preset-typescript":"^7.24.6","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@typescript-eslint/eslint-plugin":"^7.11.0","@typescript-eslint/parser":"^7.11.0","browser-sync":"^3.0.2",concurrently:"^8.2.2",eslint:"^8.45.0","eslint-config-prettier":"^9.1.0","eslint-plugin-prettier":"^5.1.3","gh-pages":"^6.1.1",prettier:"^3.2.5","release-it":"^17.3.0",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-ts":"^3.4.5",typescript:"^5.4.5",vega:"^5.25.0","vega-lite":"^5.9.3"},S8t={vega:"*","vega-lite":"*"},k8t={},E8t={name:u8t,version:l8t,description:c8t,keywords:f8t,license:d8t,author:h8t,contributors:p8t,main:g8t,module:m8t,unpkg:y8t,jsdelivr:x8t,types:b8t,repository:v8t,files:w8t,scripts:$8t,devDependencies:C8t,peerDependencies:S8t,dependencies:k8t};const b1="#fff",lae="#888",A8t={background:"#333",view:{stroke:lae},title:{color:b1,subtitleColor:b1},style:{"guide-label":{fill:b1},"guide-title":{fill:b1}},axis:{domainColor:b1,gridColor:lae,tickColor:b1}},Zp="#4572a7",_8t={background:"#fff",arc:{fill:Zp},area:{fill:Zp},line:{stroke:Zp,strokeWidth:2},path:{stroke:Zp},rect:{fill:Zp},shape:{stroke:Zp},symbol:{fill:Zp,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Jp="#30a2da",j5="#cbcbcb",T8t="#999",I8t="#333",cae="#f0f0f0",fae="#333",N8t={arc:{fill:Jp},area:{fill:Jp},axis:{domainColor:j5,grid:!0,gridColor:j5,gridWidth:1,labelColor:T8t,labelFontSize:10,titleColor:I8t,tickColor:j5,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:cae,group:{fill:cae},legend:{labelColor:fae,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:fae,titleFontSize:14,titlePadding:10},line:{stroke:Jp,strokeWidth:2},path:{stroke:Jp,strokeWidth:.5},rect:{fill:Jp},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Jp},bar:{binSpacing:2,fill:Jp,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},eg="#000",D8t={group:{fill:"#e5e5e5"},arc:{fill:eg},area:{fill:eg},line:{stroke:eg},path:{stroke:eg},rect:{fill:eg},shape:{stroke:eg},symbol:{fill:eg,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},F8t=22,R8t="normal",dae="Benton Gothic, sans-serif",hae=11.5,O8t="normal",tg="#82c6df",W5="Benton Gothic Bold, sans-serif",pae="normal",gae=13,$2={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},M8t={background:"#ffffff",title:{anchor:"start",color:"#000000",font:W5,fontSize:F8t,fontWeight:R8t},arc:{fill:tg},area:{fill:tg},line:{stroke:tg,strokeWidth:2},path:{stroke:tg},rect:{fill:tg},shape:{stroke:tg},symbol:{fill:tg,size:30},axis:{labelFont:dae,labelFontSize:hae,labelFontWeight:O8t,titleFont:W5,titleFontSize:gae,titleFontWeight:pae},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:dae,labelFontSize:hae,symbolType:"square",titleFont:W5,titleFontSize:gae,titleFontWeight:pae},range:{category:$2["category-6"],diverging:$2["fireandice-6"],heatmap:$2["fire-7"],ordinal:$2["fire-7"],ramp:$2["fire-7"]}},ng="#ab5787",y_="#979797",L8t={background:"#f9f9f9",arc:{fill:ng},area:{fill:ng},line:{stroke:ng},path:{stroke:ng},rect:{fill:ng},shape:{stroke:ng},symbol:{fill:ng,size:30},axis:{domainColor:y_,domainWidth:.5,gridWidth:.2,labelColor:y_,tickColor:y_,tickWidth:.2,titleColor:y_},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},rg="#3e5c69",P8t={background:"#fff",arc:{fill:rg},area:{fill:rg},line:{stroke:rg},path:{stroke:rg},rect:{fill:rg},shape:{stroke:rg},symbol:{fill:rg},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Ca="#1696d2",mae="#000000",B8t="#FFFFFF",x_="Lato",V5="Lato",z8t="Lato",U8t="#DEDDDD",j8t=18,C2={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},W8t={background:B8t,title:{anchor:"start",fontSize:j8t,font:x_},axisX:{domain:!0,domainColor:mae,domainWidth:1,grid:!1,labelFontSize:12,labelFont:V5,labelAngle:0,tickColor:mae,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:x_},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:U8t,gridWidth:1,labelFontSize:12,labelFont:V5,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:x_,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:V5,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:x_,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:C2["six-groups-cat-1"],diverging:C2["diverging-colors"],heatmap:C2["diverging-colors"],ordinal:C2["six-groups-seq"],ramp:C2["shades-blue"]},area:{fill:Ca},rect:{fill:Ca},line:{color:Ca,stroke:Ca,strokeWidth:5},trail:{color:Ca,stroke:Ca,strokeWidth:0,size:1},path:{stroke:Ca,strokeWidth:.5},point:{filled:!0},text:{font:z8t,color:Ca,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Ca,stroke:null}},arc:{fill:Ca},shape:{stroke:Ca},symbol:{fill:Ca,size:30}},ig="#3366CC",yae="#ccc",b_="Arial, sans-serif",V8t={arc:{fill:ig},area:{fill:ig},path:{stroke:ig},rect:{fill:ig},shape:{stroke:ig},symbol:{stroke:ig},circle:{fill:ig},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:b_,fontSize:12},"guide-title":{font:b_,fontSize:12},"group-title":{font:b_,fontSize:12}},title:{font:b_,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:yae,tickColor:yae,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},aY=e=>e*(1/3+1),xae=aY(9),bae=aY(10),vae=aY(12),S2="Segoe UI",wae="wf_standard-font, helvetica, arial, sans-serif",$ae="#252423",k2="#605E5C",Cae="transparent",q8t="#C8C6C4",hu="#118DFF",G8t="#12239E",H8t="#E66C37",X8t="#6B007B",Y8t="#E044A7",K8t="#744EC2",Q8t="#D9B300",Z8t="#D64550",OAe=hu,MAe="#DEEFFF",Sae=[MAe,OAe],J8t=[MAe,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",OAe],e7t={view:{stroke:Cae},background:Cae,font:S2,header:{titleFont:wae,titleFontSize:vae,titleColor:$ae,labelFont:S2,labelFontSize:bae,labelColor:k2},axis:{ticks:!1,grid:!1,domain:!1,labelColor:k2,labelFontSize:xae,titleFont:wae,titleColor:$ae,titleFontSize:vae,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:q8t,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:hu},line:{stroke:hu,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:S2,fontSize:xae,fill:k2},arc:{fill:hu},area:{fill:hu,line:!0,opacity:.6},path:{stroke:hu},rect:{fill:hu},point:{fill:hu,filled:!0,size:75},shape:{stroke:hu},symbol:{fill:hu,strokeWidth:1.5,size:50},legend:{titleFont:S2,titleFontWeight:"bold",titleColor:k2,labelFont:S2,labelFontSize:bae,labelColor:k2,symbolType:"circle",symbolSize:75},range:{category:[hu,G8t,H8t,X8t,Y8t,K8t,Q8t,Z8t],diverging:Sae,heatmap:Sae,ordinal:J8t}},q5='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',t7t='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',G5=400,v_={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},n7t=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],r7t=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function TM({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",r=v_.gridBg[e],i=v_.textPrimary[e],s=v_.textSecondary[e],o=n==="dark"?n7t:r7t,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:q5,fontWeight:600},axis:{labelColor:s,labelFontSize:12,labelFont:t7t,labelFontWeight:G5,titleColor:i,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:v_.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:q5,fill:s,fontWeight:G5},"guide-title":{font:q5,fill:s,fontWeight:G5}},range:{category:o,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const i7t=TM({theme:"white",background:"#ffffff"}),s7t=TM({theme:"g10",background:"#f4f4f4"}),o7t=TM({theme:"g90",background:"#262626"}),a7t=TM({theme:"g100",background:"#161616"}),u7t=E8t.version,l7t=Object.freeze(Object.defineProperty({__proto__:null,carbong10:s7t,carbong100:a7t,carbong90:o7t,carbonwhite:i7t,dark:A8t,excel:_8t,fivethirtyeight:N8t,ggplot2:D8t,googlecharts:V8t,latimes:M8t,powerbi:e7t,quartz:L8t,urbaninstitute:W8t,version:u7t,vox:P8t},Symbol.toStringTag,{value:"Module"}));var c7t=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const LAe="vg-tooltip-element",f7t={offsetX:10,offsetY:10,id:LAe,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:d7t,maxDepth:2};function d7t(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function h7t(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return c7t.toString().replace(LAe,e)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function p7t(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function g7t(e,t,n){if(Rt(e))return`[${e.map(r=>t(Hn(r)?r:kae(r,n))).join(", ")}]`;if(Wt(e)){let r="";const i=e,{title:s,image:o}=i,a=p7t(i,["title","image"]);s&&(r+=`<h2>${t(s)}</h2>`),o&&(r+=`<img src="${t(o)}">`);const u=Object.keys(a);if(u.length>0){r+="<table>";for(const l of u){let c=a[l];c!==void 0&&(Wt(c)&&(c=kae(c,n)),r+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function m7t(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function kae(e,t){return JSON.stringify(e,m7t(t))}function y7t(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let s=e.clientY+r;return s+t.height>window.innerHeight&&(s=+e.clientY-r-t.height),{x:i,y:s}}class x7t{constructor(t){this.options=Object.assign(Object.assign({},f7t),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=h7t(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=g7t(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:a}=y7t(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${a}px; left: ${o}px`)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function cD(e,t,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?s(c.value):i(c.value).then(a,u)}l((r=r.apply(e,[])).next())})}function b7t(e,t,n){const r=e.open(t),i=1e4,s=250,{origin:o}=new URL(t);let a=~~(i/s);function u(c){c.source===r&&(a=0,e.removeEventListener("message",u,!1))}e.addEventListener("message",u,!1);function l(){a<=0||(r.postMessage(n,o),setTimeout(l,s),a-=1)}setTimeout(l,s)}var v7t=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper {
    width: 100%;
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function PAe(e,...t){for(const n of t)w7t(e,n);return e}function w7t(e,t){for(const n of Object.keys(t))R3(e,n,t[n],!0)}var H5;const Jc=B3t;let sx=a8t;const w_=typeof window<"u"?window:void 0;sx===void 0&&(!((H5=w_==null?void 0:w_.vl)===null||H5===void 0)&&H5.compile)&&(sx=w_.vl);const BAe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},$7t={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},uw={vega:"Vega","vega-lite":"Vega-Lite"},fD={vega:Jc.version,"vega-lite":sx?sx.version:"not available"},C7t={vega:e=>e,"vega-lite":(e,t)=>sx.compile(e,{config:t}).spec},S7t=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,k7t="chart-wrapper";function E7t(e){return typeof e=="function"}function Eae(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,s=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(i+e+s),o.document.title=`${uw[r]} JSON Source`}function zAe(e,t){var n;if(e.$schema){const r=RAe(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${uw[r.library]}, but mode argument sets ${(n=uw[t])!==null&&n!==void 0?n:t}.`);const i=r.library;return eme.satisfies(fD[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${uw[i]} ${r.version}, but the current version of ${uw[i]} is v${fD[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function A7t(e){return!!(e&&"load"in e)}function Aae(e){return A7t(e)?e:Jc.loader(e)}function _ae(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function _7t(e,t,n={}){var r,i,s;return cD(this,void 0,void 0,function*(){let o,a;Hn(t)?(a=Aae(n.loader),o=JSON.parse(yield a.load(t))):o=t;const u=_ae(o).loader;(!a||u)&&(a=Aae((r=n.loader)!==null&&r!==void 0?r:u));const l=yield Tae(_ae(o),a),c=yield Tae(n,a),f=Object.assign(Object.assign({},PAe(c,l)),{config:F3((i=c.config)!==null&&i!==void 0?i:{},(s=l.config)!==null&&s!==void 0?s:{})});return yield I7t(e,o,f,a)})}function Tae(e,t){var n;return cD(this,void 0,void 0,function*(){const r=Hn(e.config)?JSON.parse(yield t.load(e.config)):(n=e.config)!==null&&n!==void 0?n:{},i=Hn(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})})}function T7t(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function I7t(e,t,n={},r){var i,s,o,a,u,l;return cD(this,void 0,void 0,function*(){const c=n.theme?F3(l7t[n.theme],(i=n.config)!==null&&i!==void 0?i:{}):n.config,f=yme(n.actions)?n.actions:PAe({},BAe,(s=n.actions)!==null&&s!==void 0?s:{}),d=Object.assign(Object.assign({},$7t),n.i18n),h=(o=n.renderer)!==null&&o!==void 0?o:"canvas",p=(a=n.logLevel)!==null&&a!==void 0?a:Jc.Warn,m=(u=n.downloadFileName)!==null&&u!==void 0?u:"visualization",x=typeof e=="string"?document.querySelector(e):e;if(!x)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const T="vega-embed-style",{root:L,rootContainer:O}=T7t(x);if(!L.getElementById(T)){const M=document.createElement("style");M.id=T,M.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?v7t.toString():n.defaultStyle,O.appendChild(M)}}const b=zAe(t,n.mode);let v=C7t[b](t,c);if(b==="vega-lite"&&v.$schema){const T=RAe(v.$schema);eme.satisfies(fD.vega,`^${T.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${T.version}, but current version is v${fD.vega}.`)}x.classList.add("vega-embed"),f&&x.classList.add("has-actions"),x.innerHTML="";let $=x;if(f){const T=document.createElement("div");T.classList.add(k7t),x.appendChild(T),$=T}const C=n.patch;C&&(C instanceof Function?v=C(v):v=E3(v,C,!0,!1).newDocument),n.formatLocale&&Jc.formatLocale(n.formatLocale),n.timeFormatLocale&&Jc.timeFormatLocale(n.timeFormatLocale);const{ast:S}=n,A=Jc.parse(v,b==="vega-lite"?{}:c,{ast:S}),E=new(n.viewClass||Jc.View)(A,Object.assign({loader:r,logLevel:p,renderer:h},S?{expr:Jc.expressionInterpreter}:{}));if(n.tooltip!==!1){let T;E7t(n.tooltip)?T=n.tooltip:T=new x7t(n.tooltip===!0?{}:n.tooltip).call,E.tooltip(T)}let{hover:_}=n;if(_===void 0&&(_=b==="vega"),_){const{hoverSet:T,updateSet:L}=typeof _=="boolean"?{}:_;E.hover(T,L)}n&&(n.width!=null&&E.width(n.width),n.height!=null&&E.height(n.height),n.padding!=null&&E.padding(n.padding)),yield E.initialize($,n.bind).runAsync();let D;if(f!==!1){let T=x;if(n.defaultStyle!==!1){const O=document.createElement("details");O.title=d.CLICK_TO_VIEW_ACTIONS,x.append(O),T=O;const M=document.createElement("summary");M.innerHTML=S7t,O.append(M),D=R=>{O.contains(R.target)||O.removeAttribute("open")},document.addEventListener("click",D)}const L=document.createElement("div");if(T.append(L),L.classList.add("vega-actions"),f===!0||f.export!==!1){for(const O of["svg","png"])if(f===!0||f.export===!0||f.export[O]){const M=d[`${O.toUpperCase()}_ACTION`],R=document.createElement("a");R.text=M,R.href="#",R.target="_blank",R.download=`${m}.${O}`,R.addEventListener("mousedown",function(P){return cD(this,void 0,void 0,function*(){P.preventDefault();const j=yield E.toImageURL(O,n.scaleFactor);this.href=j})}),L.append(R)}}if(f===!0||f.source!==!1){const O=document.createElement("a");O.text=d.SOURCE_ACTION,O.href="#",O.addEventListener("click",function(M){var R,P;Eae(QL(t),(R=n.sourceHeader)!==null&&R!==void 0?R:"",(P=n.sourceFooter)!==null&&P!==void 0?P:"",b),M.preventDefault()}),L.append(O)}if(b==="vega-lite"&&(f===!0||f.compiled!==!1)){const O=document.createElement("a");O.text=d.COMPILED_ACTION,O.href="#",O.addEventListener("click",function(M){var R,P;Eae(QL(v),(R=n.sourceHeader)!==null&&R!==void 0?R:"",(P=n.sourceFooter)!==null&&P!==void 0?P:"","vega"),M.preventDefault()}),L.append(O)}if(f===!0||f.editor!==!1){const O=(l=n.editorUrl)!==null&&l!==void 0?l:"https://vega.github.io/editor/",M=document.createElement("a");M.text=d.EDITOR_ACTION,M.href="#",M.addEventListener("click",function(R){b7t(window,O,{config:c,mode:b,renderer:h,spec:QL(t)}),R.preventDefault()}),L.append(M)}}function N(){D&&document.removeEventListener("click",D),E.finalize()}return{view:E,spec:t,vgSpec:v,finalize:N}})}const N7t=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_ACTIONS:BAe,default:_7t,guessMode:zAe,vega:Jc,get vegaLite(){return sx}},Symbol.toStringTag,{value:"Module"})),Jb=Lm(N7t);var v1={},Me={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var X5,Iae;function uY(){if(Iae)return X5;Iae=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function r(s){if(s==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(s)}function i(){try{if(!Object.assign)return!1;var s=new String("abc");if(s[5]="de",Object.getOwnPropertyNames(s)[0]==="5")return!1;for(var o={},a=0;a<10;a++)o["_"+String.fromCharCode(a)]=a;var u=Object.getOwnPropertyNames(o).map(function(c){return o[c]});if(u.join("")!=="0123456789")return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(c){l[c]=c}),Object.keys(Object.assign({},l)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return X5=i()?Object.assign:function(s,o){for(var a,u=r(s),l,c=1;c<arguments.length;c++){a=Object(arguments[c]);for(var f in a)t.call(a,f)&&(u[f]=a[f]);if(e){l=e(a);for(var d=0;d<l.length;d++)n.call(a,l[d])&&(u[l[d]]=a[l[d]])}}return u},X5}var $_={},Nae;function D7t(){if(Nae)return $_;Nae=1,Object.defineProperty($_,"__esModule",{value:!0}),$_.StyleSheet=c;var e=uY(),t=n(e);function n(f){return f&&f.__esModule?f:{default:f}}function r(f){if(Array.isArray(f)){for(var d=0,h=Array(f.length);d<f.length;d++)h[d]=f[d];return h}else return Array.from(f)}function i(f){return f[f.length-1]}function s(f){if(f.sheet)return f.sheet;for(var d=0;d<document.styleSheets.length;d++)if(document.styleSheets[d].ownerNode===f)return document.styleSheets[d]}var o=typeof window<"u",a=!1,u=function(){if(o){var f=document.createElement("div");return f.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",f.getElementsByTagName("i").length===1}}();function l(){var f=document.createElement("style");return f.type="text/css",f.setAttribute("data-glamor",""),f.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(f),f}function c(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=f.speedy,h=d===void 0?!a:d,p=f.maxLength,m=p===void 0?o&&u?4e3:65e3:p;this.isSpeedy=h,this.sheet=void 0,this.tags=[],this.maxLength=m,this.ctr=0}return(0,t.default)(c.prototype,{getSheet:function(){return s(i(this.tags))},inject:function(){var d=this;if(this.injected)throw new Error("already injected stylesheet!");o?this.tags[0]=l():this.sheet={cssRules:[],insertRule:function(p){d.sheet.cssRules.push({cssText:p})}},this.injected=!0},speedy:function(d){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+d+") earlier in your app, or call flush() before speedy("+d+")");this.isSpeedy=!!d},_insert:function(d){try{var h=this.getSheet();h.insertRule(d,d.indexOf("@import")!==-1?0:h.cssRules.length)}catch{}},insert:function(d){if(o)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(d);else if(d.indexOf("@import")!==-1){var h=i(this.tags);h.insertBefore(document.createTextNode(d),h.firstChild)}else i(this.tags).appendChild(document.createTextNode(d));else this.sheet.insertRule(d,d.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,o&&this.ctr%this.maxLength===0&&this.tags.push(l()),this.ctr-1},delete:function(d){return this.replace(d,"")},flush:function(){o?(this.tags.forEach(function(d){return d.parentNode.removeChild(d)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!o)return this.sheet.cssRules;var d=[];return this.tags.forEach(function(h){return d.splice.apply(d,[d.length,0].concat(r(Array.from(s(h).cssRules))))}),d}}),$_}var w1={},Y5,Dae;function F7t(){if(Dae)return Y5;Dae=1;var e=/-(.)/g;function t(n){return n.replace(e,function(r,i){return i.toUpperCase()})}return Y5=t,Y5}var K5,Fae;function R7t(){if(Fae)return K5;Fae=1;var e=F7t(),t=/^-ms-/;function n(r){return e(r.replace(t,"ms-"))}return K5=n,K5}var C_={},S_={},Rae;function O7t(){if(Rae)return S_;Rae=1,Object.defineProperty(S_,"__esModule",{value:!0});var e={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function t(s,o){return s+o.charAt(0).toUpperCase()+o.substring(1)}var n=["Webkit","ms","Moz","O"];Object.keys(e).forEach(function(s){n.forEach(function(o){e[t(o,s)]=e[s]})});var r={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},i={isUnitlessNumber:e,shorthandPropertyExpansions:r};return S_.default=i,S_}var Q5,Oae;function M7t(){if(Oae)return Q5;Oae=1;function e(n){return function(){return n}}var t=function(){};return t.thatReturns=e,t.thatReturnsFalse=e(!1),t.thatReturnsTrue=e(!0),t.thatReturnsNull=e(null),t.thatReturnsThis=function(){return this},t.thatReturnsArgument=function(n){return n},Q5=t,Q5}var Z5,Mae;function UAe(){if(Mae)return Z5;Mae=1;var e=M7t(),t=e;return Z5=t,Z5}var Lae;function L7t(){if(Lae)return C_;Lae=1,Object.defineProperty(C_,"__esModule",{value:!0});var e=O7t(),t=r(e),n=UAe();r(n);function r(o){return o&&o.__esModule?o:{default:o}}var i=t.default.isUnitlessNumber;function s(o,a,u){var l=a==null||typeof a=="boolean"||a==="";if(l)return"";var c=isNaN(a);return c||a===0||i.hasOwnProperty(o)&&i[o]?""+a:(typeof a=="string"&&(a=a.trim()),a+"px")}return C_.default=s,C_}var J5,Pae;function P7t(){if(Pae)return J5;Pae=1;var e=/([A-Z])/g;function t(n){return n.replace(e,"-$1").toLowerCase()}return J5=t,J5}var e6,Bae;function B7t(){if(Bae)return e6;Bae=1;var e=P7t(),t=/^ms-/;function n(r){return e(r).replace(t,"-ms-")}return e6=n,e6}var t6,zae;function z7t(){if(zae)return t6;zae=1;function e(t){var n={};return function(r){return n.hasOwnProperty(r)||(n[r]=t.call(this,r)),n[r]}}return t6=e,t6}var Uae;function jAe(){if(Uae)return w1;Uae=1,Object.defineProperty(w1,"__esModule",{value:!0}),w1.processStyleName=void 0,w1.createMarkupForStyles=c;var e=R7t();u(e);var t=L7t(),n=u(t),r=B7t(),i=u(r),s=z7t(),o=u(s),a=UAe();u(a);function u(f){return f&&f.__esModule?f:{default:f}}var l=w1.processStyleName=(0,o.default)(i.default);function c(f,d){var h="";for(var p in f){var m=p.indexOf("--")===0;if(f.hasOwnProperty(p)&&p!=="label"){var x=f[p];x!=null&&(m?h+=p+":"+x+";":(h+=l(p)+":",h+=(0,n.default)(p,x,d)+";"))}}return h||null}return w1}var k_={},jae;function U7t(){if(jae)return k_;jae=1,Object.defineProperty(k_,"__esModule",{value:!0});var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s};k_.default=i;function t(s){return s==null||s===!1||(typeof s>"u"?"undefined":e(s))==="object"&&Object.keys(s).length===0}function n(s){if(t(s))return null;if((typeof s>"u"?"undefined":e(s))!=="object")return s;for(var o={},a=Object.keys(s),u=!1,l=0;l<a.length;l++){var c=s[a[l]],f=i(c);(f===null||f!==c)&&(u=!0),f!==null&&(o[a[l]]=f)}return Object.keys(o).length===0?null:u?o:s}function r(s){var o=!1,a=[];return s.forEach(function(u){var l=i(u);(l===null||l!==u)&&(o=!0),l!==null&&a.push(l)}),a.length==0?null:o?a:s}function i(s){return Array.isArray(s)?r(s):n(s)}return k_}var sg={},E_={},A_={exports:{}},Wae;function j7t(){return Wae||(Wae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],s=["Webkit","Moz"],o=["Webkit","ms"],a=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:s,userSelect:a,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:a,breakBefore:a,breakInside:a,columnCount:s,columnFill:s,columnGap:s,columnRule:s,columnRuleColor:s,columnRuleStyle:s,columnRuleWidth:s,columns:s,columnSpan:s,columnWidth:s,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:a,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default}(A_,A_.exports)),A_.exports}var __={exports:{}},T_={exports:{}},Vae;function WAe(){return Vae||(Vae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r){return r.charAt(0).toUpperCase()+r.slice(1)}e.exports=t.default}(T_,T_.exports)),T_.exports}var qae;function W7t(){return qae||(qae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=WAe(),r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function s(o,a,u){if(o.hasOwnProperty(a))for(var l=o[a],c=0,f=l.length;c<f;++c)u[l[c]+(0,r.default)(a)]=u[a]}e.exports=t.default}(__,__.exports)),__.exports}var I_={exports:{}},Gae;function V7t(){return Gae||(Gae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i,s,o,a){for(var u=0,l=r.length;u<l;++u){var c=r[u](i,s,o,a);if(c)return c}}e.exports=t.default}(I_,I_.exports)),I_.exports}var N_={exports:{}},Hae;function q7t(){return Hae||(Hae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function i(s,o){if(s==="cursor"&&r.hasOwnProperty(o))return n.map(function(a){return a+o})}e.exports=t.default}(N_,N_.exports)),N_.exports}var D_={exports:{}},F_={exports:{}},Xae;function Yk(){return Xae||(Xae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=/-webkit-|-moz-|-ms-/;function r(i){return typeof i=="string"&&n.test(i)}e.exports=t.default}(F_,F_.exports)),F_.exports}var Yae;function G7t(){return Yae||(Yae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Yk(),r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}var s=["-webkit-",""];function o(a,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("cross-fade(")>-1)return s.map(function(l){return u.replace(/cross-fade\(/g,l+"cross-fade(")})}e.exports=t.default}(D_,D_.exports)),D_.exports}var R_={exports:{}},Kae;function H7t(){return Kae||(Kae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Yk(),r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}var s=["-webkit-",""];function o(a,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("filter(")>-1)return s.map(function(l){return u.replace(/filter\(/g,l+"filter(")})}e.exports=t.default}(R_,R_.exports)),R_.exports}var O_={exports:{}},Qae;function X7t(){return Qae||(Qae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function r(i,s){if(i==="display"&&n.hasOwnProperty(s))return n[s]}e.exports=t.default}(O_,O_.exports)),O_.exports}var M_={exports:{}},Zae;function Y7t(){return Zae||(Zae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function i(s,o,a){s==="flexDirection"&&typeof o=="string"&&(o.indexOf("column")>-1?a.WebkitBoxOrient="vertical":a.WebkitBoxOrient="horizontal",o.indexOf("reverse")>-1?a.WebkitBoxDirection="reverse":a.WebkitBoxDirection="normal"),r.hasOwnProperty(s)&&(a[r[s]]=n[o]||o)}e.exports=t.default}(M_,M_.exports)),M_.exports}var L_={exports:{}},Jae;function K7t(){return Jae||(Jae=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=Yk(),r=i(n);function i(u){return u&&u.__esModule?u:{default:u}}var s=["-webkit-","-moz-",""],o=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function a(u,l){if(typeof l=="string"&&!(0,r.default)(l)&&o.test(l))return s.map(function(c){return c+l})}e.exports=t.default}(L_,L_.exports)),L_.exports}var P_={exports:{}},eue;function Q7t(){return eue||(eue=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=Yk(),r=i(n);function i(a){return a&&a.__esModule?a:{default:a}}var s=["-webkit-",""];function o(a,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("image-set(")>-1)return s.map(function(l){return u.replace(/image-set\(/g,l+"image-set(")})}e.exports=t.default}(P_,P_.exports)),P_.exports}var B_={exports:{}},tue;function Z7t(){return tue||(tue=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i){if(r==="position"&&i==="sticky")return["-webkit-sticky","sticky"]}e.exports=t.default}(B_,B_.exports)),B_.exports}var z_={exports:{}},nue;function J7t(){return nue||(nue=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function s(o,a){if(r.hasOwnProperty(o)&&i.hasOwnProperty(a))return n.map(function(u){return u+a})}e.exports=t.default}(z_,z_.exports)),z_.exports}var U_={exports:{}},j_={exports:{}},e9t=/[A-Z]/g,t9t=/^ms-/,n6={};function n9t(e){return"-"+e.toLowerCase()}function r9t(e){if(n6.hasOwnProperty(e))return n6[e];var t=e.replace(e9t,n9t);return n6[e]=t9t.test(t)?"-"+t:t}const i9t=Object.freeze(Object.defineProperty({__proto__:null,default:r9t},Symbol.toStringTag,{value:"Module"})),s9t=Lm(i9t);var rue;function o9t(){return rue||(rue=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=s9t,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function s(o){return(0,r.default)(o)}e.exports=t.default}(j_,j_.exports)),j_.exports}var iue;function a9t(){return iue||(iue=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var n=o9t(),r=u(n),i=Yk(),s=u(i),o=WAe(),a=u(o);function u(h){return h&&h.__esModule?h:{default:h}}var l={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function f(h,p){if((0,s.default)(h))return h;for(var m=h.split(/,(?![^()]*(?:\([^()]*\))?\))/g),x=0,b=m.length;x<b;++x){var v=m[x],$=[v];for(var C in p){var S=(0,r.default)(C);if(v.indexOf(S)>-1&&S!=="order")for(var A=p[C],E=0,_=A.length;E<_;++E)$.unshift(v.replace(S,c[A[E]]+S))}m[x]=$.join(",")}return m.join(",")}function d(h,p,m,x){if(typeof p=="string"&&l.hasOwnProperty(h)){var b=f(p,x),v=b.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(C){return!/-moz-|-ms-/.test(C)}).join(",");if(h.indexOf("Webkit")>-1)return v;var $=b.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(C){return!/-webkit-|-ms-/.test(C)}).join(",");return h.indexOf("Moz")>-1?$:(m["Webkit"+(0,a.default)(h)]=v,m["Moz"+(0,a.default)(h)]=$,b)}}e.exports=t.default}(U_,U_.exports)),U_.exports}var sue;function u9t(){if(sue)return E_;sue=1,Object.defineProperty(E_,"__esModule",{value:!0}),E_.default=O;var e=j7t(),t=N(e),n=W7t(),r=N(n),i=V7t(),s=N(i),o=q7t(),a=N(o),u=G7t(),l=N(u),c=H7t(),f=N(c),d=X7t(),h=N(d),p=Y7t(),m=N(p),x=K7t(),b=N(x),v=Q7t(),$=N(v),C=Z7t(),S=N(C),A=J7t(),E=N(A),_=a9t(),D=N(_);function N(M){return M&&M.__esModule?M:{default:M}}var T=[l.default,a.default,f.default,m.default,b.default,$.default,S.default,E.default,D.default,h.default],L=t.default.prefixMap;function O(M){for(var R in M){var P=M[R],j=(0,s.default)(T,R,P,M,L);j&&(M[R]=j),(0,r.default)(L,R,M)}return M}return E_}var oue;function l9t(){if(oue)return sg;oue=1,Object.defineProperty(sg,"__esModule",{value:!0});var e=Object.assign||function(d){for(var h=1;h<arguments.length;h++){var p=arguments[h];for(var m in p)Object.prototype.hasOwnProperty.call(p,m)&&(d[m]=p[m])}return d};sg.PluginSet=a,sg.fallbacks=u,sg.contentWrap=c,sg.prefixes=f;var t=uY(),n=o(t),r=jAe(),i=u9t(),s=o(i);function o(d){return d&&d.__esModule?d:{default:d}}function a(d){this.fns=d||[]}(0,n.default)(a.prototype,{add:function(){for(var h=this,p=arguments.length,m=Array(p),x=0;x<p;x++)m[x]=arguments[x];m.forEach(function(b){h.fns.indexOf(b)>=0||(h.fns=[b].concat(h.fns))})},remove:function(h){this.fns=this.fns.filter(function(p){return p!==h})},clear:function(){this.fns=[]},transform:function(h){return this.fns.reduce(function(p,m){return m(p)},h)}});function u(d){var h=Object.keys(d.style).map(function(x){return Array.isArray(d.style[x])}).indexOf(!0)>=0;if(h){var p=d.style,m=Object.keys(p).reduce(function(x,b){return x[b]=Array.isArray(p[b])?p[b].join("; "+(0,r.processStyleName)(b)+": "):p[b],x},{});return(0,n.default)({},d,{style:m})}return d}var l=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];function c(d){if(d.style.content){var h=d.style.content;return l.indexOf(h)>=0||/^(attr|calc|counters?|url)\(/.test(h)||h.charAt(0)===h.charAt(h.length-1)&&(h.charAt(0)==='"'||h.charAt(0)==="'")?d:e({},d,{style:e({},d.style,{content:'"'+h+'"'})})}return d}function f(d){return(0,n.default)({},d,{style:(0,s.default)(e({},d.style))})}return sg}var W_={},aue;function c9t(){if(aue)return W_;aue=1,Object.defineProperty(W_,"__esModule",{value:!0}),W_.default=e;function e(i,s){for(var o=1540483477,a=24,u=s^i.length,l=i.length,c=0;l>=4;){var f=t(i,c);f=r(f,o),f^=f>>>a,f=r(f,o),u=r(u,o),u^=f,c+=4,l-=4}switch(l){case 3:u^=n(i,c),u^=i.charCodeAt(c+2)<<16,u=r(u,o);break;case 2:u^=n(i,c),u=r(u,o);break;case 1:u^=i.charCodeAt(c),u=r(u,o);break}return u^=u>>>13,u=r(u,o),u^=u>>>15,u>>>0}function t(i,s){return i.charCodeAt(s++)+(i.charCodeAt(s++)<<8)+(i.charCodeAt(s++)<<16)+(i.charCodeAt(s)<<24)}function n(i,s){return i.charCodeAt(s++)+(i.charCodeAt(s++)<<8)}function r(i,s){i=i|0,s=s|0;var o=i&65535,a=i>>>16,u=o*s+((a*s&65535)<<16)|0;return u}return W_}var uue;function Kk(){if(uue)return Me;uue=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.compose=Me.merge=Me.$=Me.style=Me.presets=Me.keyframes=Me.fontFace=Me.insertGlobal=Me.insertRule=Me.plugins=Me.styleSheet=void 0,Me.speedy=d,Me.simulations=$,Me.simulate=C,Me.cssLabels=A,Me.isLikeRule=D,Me.idFor=N,Me.css=ct,Me.rehydrate=Fi,Me.flush=zr,Me.select=si,Me.parent=ro,Me.media=Wo,Me.pseudo=ot,Me.active=Ts,Me.any=sl,Me.checked=eu,Me.disabled=tu,Me.empty=ev,Me.enabled=Ic,Me._default=F0,Me.first=tv,Me.firstChild=nv,Me.firstOfType=rv,Me.fullscreen=iv,Me.focus=sv,Me.hover=ov,Me.indeterminate=ed,Me.inRange=td,Me.invalid=Qk,Me.lastChild=Zk,Me.lastOfType=Jk,Me.left=eE,Me.link=tE,Me.onlyChild=av,Me.onlyOfType=nE,Me.optional=_p,Me.outOfRange=uv,Me.readOnly=Tp,Me.readWrite=LM,Me.required=Ip,Me.right=R0,Me.root=O0,Me.scope=lv,Me.target=PM,Me.valid=BM,Me.visited=zM,Me.dir=Nc,Me.lang=rE,Me.not=iE,Me.nthChild=UM,Me.nthLastChild=sE,Me.nthLastOfType=oE,Me.nthOfType=aE,Me.after=uE,Me.before=jM,Me.firstLetter=WM,Me.firstLine=rr,Me.selection=VM,Me.backdrop=cv,Me.placeholder=lE,Me.cssFor=M0,Me.attribsFor=qM;var e=uY(),t=l(e),n=D7t(),r=jAe(),i=U7t(),s=l(i),o=l9t(),a=c9t(),u=l(a);function l(K){return K&&K.__esModule?K:{default:K}}function c(K,oe,Se){return oe in K?Object.defineProperty(K,oe,{value:Se,enumerable:!0,configurable:!0,writable:!0}):K[oe]=Se,K}var f=Me.styleSheet=new n.StyleSheet;f.inject();function d(K){return f.speedy(K)}var h=Me.plugins=f.plugins=new o.PluginSet([o.prefixes,o.contentWrap,o.fallbacks]);h.media=new o.PluginSet,h.fontFace=new o.PluginSet,h.keyframes=new o.PluginSet([o.prefixes,o.fallbacks]);var p=!1,m=typeof window<"u",x=p,b=!1,v=!1;function $(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;x=!!K}function C(){for(var K=arguments.length,oe=Array(K),Se=0;Se<K;Se++)oe[Se]=arguments[Se];return oe=(0,s.default)(oe),oe?x?oe.reduce(function(Le,et){return Le["data-simulate-"+E(et)]="",Le},{}):(b||(console.warn("can't simulate without once calling simulations(true)"),b=!0),v||(console.warn("don't use simulation outside dev"),v=!0),{}):{}}var S=p;function A(K){S=!!K}function E(K){var oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return K.toLowerCase().replace(/[^a-z0-9]/g,oe)}function _(K){var oe=JSON.stringify(K),Se=(0,u.default)(oe).toString(36);return K.label&&K.label.length>0,Se}function D(K){var oe=Object.keys(K).filter(function(Se){return Se!=="toString"});return oe.length!==1?!1:!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(oe[0])}function N(K){var oe=Object.keys(K).filter(function(et){return et!=="toString"});if(oe.length!==1)throw new Error("not a rule");var Se=/data\-css\-([a-zA-Z0-9\-_]+)/,Le=Se.exec(oe[0]);if(!Le)throw new Error("not a rule");return Le[1]}var T=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function L(K){if(K.indexOf(",")===-1)return[K];for(var oe=[],Se=[],Le=0,et;et=T.exec(K);)switch(et[0]){case"(":Le++;break;case")":Le--;break;case",":if(Le)break;oe.push(et.index)}for(et=oe.length;et--;)Se.unshift(K.slice(oe[et]+1)),K=K.slice(0,oe[et]);return Se.unshift(K),Se}function O(K,oe){if(!K)return oe.replace(/\&/g,"");if(!oe)return".css-"+K+",[data-css-"+K+"]";var Se=L(oe).map(function(Le){return Le.indexOf("&")>=0?[Le.replace(/\&/mg,".css-"+K),Le.replace(/\&/mg,"[data-css-"+K+"]")].join(","):".css-"+K+Le+",[data-css-"+K+"]"+Le}).join(",");return x&&/^\&\:/.exec(oe)&&!/\s/.exec(oe)&&(Se+=",.css-"+K+"[data-simulate-"+E(oe)+"],[data-css-"+K+"][data-simulate-"+E(oe)+"]"),Se}function M(K){var oe=K.selector,Se=K.style,Le=h.transform({selector:oe,style:Se});return Le.selector+"{"+(0,r.createMarkupForStyles)(Le.style)+"}"}function R(K){var oe=void 0,Se=void 0,Le=void 0,et=void 0;return Object.keys(K).forEach(function(Ht){Ht.indexOf("&")>=0?(Se=Se||{},Se[Ht]=K[Ht]):Ht.indexOf("@media")===0?(Le=Le||{},Le[Ht]=R(K[Ht])):Ht.indexOf("@supports")===0?(et=et||{},et[Ht]=R(K[Ht])):Ht==="label"?K.label.length>0&&(oe=oe||{},oe.label=S?K.label.join("."):""):(oe=oe||{},oe[Ht]=K[Ht])}),{plain:oe,selects:Se,medias:Le,supports:et}}function P(K,oe){var Se=[],Le=oe.plain,et=oe.selects,Ht=oe.medias,Ri=oe.supports;return Le&&Se.push(M({style:Le,selector:O(K)})),et&&Object.keys(et).forEach(function(Xn){return Se.push(M({style:et[Xn],selector:O(K,Xn)}))}),Ht&&Object.keys(Ht).forEach(function(Xn){return Se.push(Xn+"{"+P(K,Ht[Xn]).join("")+"}")}),Ri&&Object.keys(Ri).forEach(function(Xn){return Se.push(Xn+"{"+P(K,Ri[Xn]).join("")+"}")}),Se}var j=f.inserted={};function z(K){if(!j[K.id]){j[K.id]=!0;var oe=R(K.style),Se=P(K.id,oe);j[K.id]=m?!0:Se,Se.forEach(function(Le){return f.insert(Le)})}}var q=f.registered={};function H(K){q[K.id]||(q[K.id]=K)}function V(K){if(D(K)){var oe=q[N(K)];if(oe==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return oe}return K}var X={};function re(K){if(H(K),z(K),X[K.id])return X[K.id];var oe=c({},"data-css-"+K.id,S&&K.label||"");return Object.defineProperty(oe,"toString",{enumerable:!1,value:function(){return"css-"+K.id}}),X[K.id]=oe,oe}function le(K){for(var oe=[":",".","[",">"," "],Se=!1,Le=K.charAt(0),et=0;et<oe.length;et++)if(Le===oe[et]){Se=!0;break}return Se||K.indexOf("&")>=0}function ue(K,oe){var Se=L(K).map(function(et){return et.indexOf("&")>=0?et:"&"+et}),Le=L(oe).map(function(et){return et.indexOf("&")>=0?et:"&"+et});return Le.reduce(function(et,Ht){return et.concat(Se.map(function(Ri){return Ht.replace(/\&/g,Ri)}))},[]).join(",")}function be(K,oe){return K?"@media "+K.substring(6)+" and "+oe.substring(6):oe}function _e(K){return K.indexOf("@media")===0}function Ne(K){return K.indexOf("@supports")===0}function Y(K,oe){return K?"@supports "+K.substring(9)+" and "+oe.substring(9):oe}function ae(K){for(var oe=[],Se=0;Se<K.length;Se++)Array.isArray(K[Se])?oe=oe.concat(ae(K[Se])):oe=oe.concat(K[Se]);return oe}var he={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function G(K,oe){var Se=oe.selector,Le=Se===void 0?"":Se,et=oe.mq,Ht=et===void 0?"":et,Ri=oe.supp,Xn=Ri===void 0?"":Ri,nd=oe.src,nu=nd===void 0?{}:nd;Array.isArray(nu)||(nu=[nu]),nu=ae(nu),nu.forEach(function(vr){if(D(vr)){var Np=V(vr);if(Np.type!=="css")throw new Error("cannot merge this rule");vr=Np.style}vr=(0,s.default)(vr),vr&&vr.composes&&G(K,{selector:Le,mq:Ht,supp:Xn,src:vr.composes}),Object.keys(vr||{}).forEach(function(oi){if(le(oi))he[oi]&&he[oi].forEach(function(fv){return G(K,{selector:ue(Le,fv),mq:Ht,supp:Xn,src:vr[oi]})}),G(K,{selector:ue(Le,oi),mq:Ht,supp:Xn,src:vr[oi]});else if(_e(oi))G(K,{selector:Le,mq:be(Ht,oi),supp:Xn,src:vr[oi]});else if(Ne(oi))G(K,{selector:Le,mq:Ht,supp:Y(Xn,oi),src:vr[oi]});else if(oi!=="composes"){var Is=K;Xn&&(Is[Xn]=Is[Xn]||{},Is=Is[Xn]),Ht&&(Is[Ht]=Is[Ht]||{},Is=Is[Ht]),Le&&(Is[Le]=Is[Le]||{},Is=Is[Le]),oi==="label"?S&&(K.label=K.label.concat(vr.label)):Is[oi]=vr[oi]}})})}function je(K){var oe={label:[]};G(oe,{src:K});var Se={id:_(oe),style:oe,label:S?oe.label.join("."):"",type:"css"};return re(Se)}var Ce={};Object.defineProperty(Ce,"toString",{enumerable:!1,value:function(){return"css-nil"}});var We=typeof WeakMap<"u"?[Ce,new WeakMap,new WeakMap,new WeakMap]:[Ce];function Ve(K){return function(oe){if(We[oe.length]){for(var Se=We[oe.length],Le=0;Le<oe.length-1;)Se.has(oe[Le])||Se.set(oe[Le],new WeakMap),Se=Se.get(oe[Le]),Le++;if(Se.has(oe[oe.length-1])){var et=Se.get(oe[Le]);if(q[et.toString().substring(4)])return et}}var Ht=K(oe);if(We[oe.length]){for(var Ri=0,Xn=We[oe.length];Ri<oe.length-1;)Xn=Xn.get(oe[Ri]),Ri++;try{Xn.set(oe[Ri],Ht)}catch{}}return Ht}}var gt=typeof WeakMap<"u"?Ve(je):je;function ct(){for(var K=arguments.length,oe=Array(K),Se=0;Se<K;Se++)oe[Se]=arguments[Se];if(oe[0]&&oe[0].length&&oe[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return oe=(0,s.default)(oe),oe?gt(oe):Ce}ct.insert=function(K){var oe={id:_(K),css:K,type:"raw"};H(oe),j[oe.id]||(f.insert(oe.css),j[oe.id]=m?!0:[oe.css])},Me.insertRule=ct.insert,ct.global=function(K,oe){if(oe=(0,s.default)(oe),oe)return ct.insert(M({selector:K,style:oe}))},Me.insertGlobal=ct.global;function _s(K){if(!j[K.id]){var oe=Object.keys(K.keyframes).map(function(Le){var et=h.keyframes.transform({id:K.id,name:Le,style:K.keyframes[Le]});return et.name+"{"+(0,r.createMarkupForStyles)(et.style)+"}"}).join(""),Se=["-webkit-","-moz-","-o-",""].map(function(Le){return"@"+Le+"keyframes "+(K.name+"_"+K.id)+"{"+oe+"}"});Se.forEach(function(Le){return f.insert(Le)}),j[K.id]=m?!0:Se}}ct.keyframes=function(K,oe){oe||(oe=K,K="animation"),oe=(0,s.default)(oe)||{};var Se={id:_({name:K,kfs:oe}),type:"keyframes",name:K,keyframes:oe};return H(Se),_s(Se),K+"_"+Se.id},ct.fontFace=function(K){K=(0,s.default)(K);var oe={id:_(K),type:"font-face",font:K};return H(oe),On(oe),K.fontFamily},Me.fontFace=ct.fontFace,Me.keyframes=ct.keyframes;function On(K){if(!j[K.id]){var oe="@font-face{"+(0,r.createMarkupForStyles)(K.font)+"}";f.insert(oe),j[K.id]=m?!0:[oe]}}function Fi(K){(0,t.default)(j,K.reduce(function(oe,Se){return oe[Se]=!0,oe},{}))}function zr(){j=f.inserted={},q=f.registered={},X={},f.flush(),f.inject()}Me.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var da=Me.style=ct;function si(K){for(var oe=arguments.length,Se=Array(oe>1?oe-1:0),Le=1;Le<oe;Le++)Se[Le-1]=arguments[Le];return K?ct(c({},K,Se)):da(Se)}Me.$=si;function ro(K){for(var oe=arguments.length,Se=Array(oe>1?oe-1:0),Le=1;Le<oe;Le++)Se[Le-1]=arguments[Le];return ct(c({},K+" &",Se))}Me.merge=ct,Me.compose=ct;function Wo(K){for(var oe=arguments.length,Se=Array(oe>1?oe-1:0),Le=1;Le<oe;Le++)Se[Le-1]=arguments[Le];return ct(c({},"@media "+K,Se))}function ot(K){for(var oe=arguments.length,Se=Array(oe>1?oe-1:0),Le=1;Le<oe;Le++)Se[Le-1]=arguments[Le];return ct(c({},K,Se))}function Ts(K){return ot(":active",K)}function sl(K){return ot(":any",K)}function eu(K){return ot(":checked",K)}function tu(K){return ot(":disabled",K)}function ev(K){return ot(":empty",K)}function Ic(K){return ot(":enabled",K)}function F0(K){return ot(":default",K)}function tv(K){return ot(":first",K)}function nv(K){return ot(":first-child",K)}function rv(K){return ot(":first-of-type",K)}function iv(K){return ot(":fullscreen",K)}function sv(K){return ot(":focus",K)}function ov(K){return ot(":hover",K)}function ed(K){return ot(":indeterminate",K)}function td(K){return ot(":in-range",K)}function Qk(K){return ot(":invalid",K)}function Zk(K){return ot(":last-child",K)}function Jk(K){return ot(":last-of-type",K)}function eE(K){return ot(":left",K)}function tE(K){return ot(":link",K)}function av(K){return ot(":only-child",K)}function nE(K){return ot(":only-of-type",K)}function _p(K){return ot(":optional",K)}function uv(K){return ot(":out-of-range",K)}function Tp(K){return ot(":read-only",K)}function LM(K){return ot(":read-write",K)}function Ip(K){return ot(":required",K)}function R0(K){return ot(":right",K)}function O0(K){return ot(":root",K)}function lv(K){return ot(":scope",K)}function PM(K){return ot(":target",K)}function BM(K){return ot(":valid",K)}function zM(K){return ot(":visited",K)}function Nc(K,oe){return ot(":dir("+K+")",oe)}function rE(K,oe){return ot(":lang("+K+")",oe)}function iE(K,oe){var Se=K.split(",").map(function(Le){return Le.trim()}).map(function(Le){return":not("+Le+")"});return Se.length===1?ot(":not("+K+")",oe):si(Se.join(""),oe)}function UM(K,oe){return ot(":nth-child("+K+")",oe)}function sE(K,oe){return ot(":nth-last-child("+K+")",oe)}function oE(K,oe){return ot(":nth-last-of-type("+K+")",oe)}function aE(K,oe){return ot(":nth-of-type("+K+")",oe)}function uE(K){return ot("::after",K)}function jM(K){return ot("::before",K)}function WM(K){return ot("::first-letter",K)}function rr(K){return ot("::first-line",K)}function VM(K){return ot("::selection",K)}function cv(K){return ot("::backdrop",K)}function lE(K){return ct({"::placeholder":K})}function M0(){for(var K=arguments.length,oe=Array(K),Se=0;Se<K;Se++)oe[Se]=arguments[Se];return oe=(0,s.default)(oe),oe?oe.map(function(Le){var et={label:[]};return G(et,{src:Le}),P(_(et),R(et)).join("")}).join(""):""}function qM(){for(var K=arguments.length,oe=Array(K),Se=0;Se<K;Se++)oe[Se]=arguments[Se];oe=(0,s.default)(oe);var Le=oe?oe.map(function(et){N(et);var Ht=Object.keys(et)[0],Ri=et[Ht];return Ht+'="'+(Ri||"")+'"'}).join(" "):"";return Le}return Me}var og={},E2={},lue;function VAe(){if(lue)return E2;lue=1,Object.defineProperty(E2,"__esModule",{value:!0});function e(n){return n.name!=null}E2.isSurfaceInfo=e;function t(n){return n.drawArea instanceof HTMLElement}return E2.isSurface=t,E2}var A2={},V_={};function f9t(){}var Bo={},$1=[],cue=[];function fC(e,t){var n=cue,r,i,s,o;for(o=arguments.length;o-- >2;)$1.push(arguments[o]);for(t&&t.children!=null&&($1.length||$1.push(t.children),delete t.children);$1.length;)if((i=$1.pop())&&i.pop!==void 0)for(o=i.length;o--;)$1.push(i[o]);else typeof i=="boolean"&&(i=null),(s=typeof e!="function")&&(i==null?i="":typeof i=="number"?i=String(i):typeof i!="string"&&(s=!1)),s&&r?n[n.length-1]+=i:n===cue?n=[i]:n.push(i),r=s;var a=new f9t;return a.nodeName=e,a.children=n,a.attributes=t??void 0,a.key=t==null?void 0:t.key,Bo.vnode!==void 0&&Bo.vnode(a),a}function uh(e,t){for(var n in t)e[n]=t[n];return e}var d9t=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function qAe(e,t){return fC(e.nodeName,uh(uh({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var h9t=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,L7=[];function GAe(e){!e._dirty&&(e._dirty=!0)&&L7.push(e)==1&&(Bo.debounceRendering||d9t)(lY)}function lY(){var e,t=L7;for(L7=[];e=t.pop();)e._dirty&&IM(e)}function p9t(e,t,n){return typeof t=="string"||typeof t=="number"?e.splitText!==void 0:typeof t.nodeName=="string"?!e._componentConstructor&&HAe(e,t.nodeName):n||e._componentConstructor===t.nodeName}function HAe(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function XAe(e){var t=uh({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n!==void 0)for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}function g9t(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function cY(e){var t=e.parentNode;t&&t.removeChild(e)}function fue(e,t,n,r,i){if(t==="className"&&(t="class"),t!=="key")if(t==="ref")n&&n(null),r&&r(e);else if(t==="class"&&!i)e.className=r||"";else if(t==="style"){if((!r||typeof r=="string"||typeof n=="string")&&(e.style.cssText=r||""),r&&typeof r=="object"){if(typeof n!="string")for(var s in n)s in r||(e.style[s]="");for(var s in r)e.style[s]=typeof r[s]=="number"&&h9t.test(s)===!1?r[s]+"px":r[s]}}else if(t==="dangerouslySetInnerHTML")r&&(e.innerHTML=r.__html||"");else if(t[0]=="o"&&t[1]=="n"){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,due,o):e.removeEventListener(t,due,o),(e._listeners||(e._listeners={}))[t]=r}else if(t!=="list"&&t!=="type"&&!i&&t in e)m9t(e,t,r??""),(r==null||r===!1)&&e.removeAttribute(t);else{var a=i&&t!==(t=t.replace(/^xlink:?/,""));r==null||r===!1?a?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):typeof r!="function"&&(a?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}}function m9t(e,t,n){try{e[t]=n}catch{}}function due(e){return this._listeners[e.type](Bo.event&&Bo.event(e)||e)}var YAe=[],P7=0,Md=!1,dD=!1;function KAe(){for(var e;e=YAe.pop();)Bo.afterMount&&Bo.afterMount(e),e.componentDidMount&&e.componentDidMount()}function QAe(e,t,n,r,i,s){P7++||(Md=i!=null&&i.ownerSVGElement!==void 0,dD=e!=null&&!("__preactattr_"in e));var o=ZAe(e,t,n,r,s);return i&&o.parentNode!==i&&i.appendChild(o),--P7||(dD=!1,s||KAe()),o}function ZAe(e,t,n,r,i){var s=e,o=Md;if((t==null||typeof t=="boolean")&&(t=""),typeof t=="string"||typeof t=="number")return e&&e.splitText!==void 0&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(s=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(s,e),Mm(e,!0))),s.__preactattr_=!0,s;var a=t.nodeName;if(typeof a=="function")return w9t(e,t,n,r);if(Md=a==="svg"?!0:a==="foreignObject"?!1:Md,a=String(a),(!e||!HAe(e,a))&&(s=g9t(a,Md),e)){for(;e.firstChild;)s.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(s,e),Mm(e,!0)}var u=s.firstChild,l=s.__preactattr_,c=t.children;if(l==null){l=s.__preactattr_={};for(var f=s.attributes,d=f.length;d--;)l[f[d].name]=f[d].value}return!dD&&c&&c.length===1&&typeof c[0]=="string"&&u!=null&&u.splitText!==void 0&&u.nextSibling==null?u.nodeValue!=c[0]&&(u.nodeValue=c[0]):(c&&c.length||u!=null)&&y9t(s,c,n,r,dD||l.dangerouslySetInnerHTML!=null),x9t(s,t.attributes,l),Md=o,s}function y9t(e,t,n,r,i){var s=e.childNodes,o=[],a={},u=0,l=0,c=s.length,f=0,d=t?t.length:0,h,p,m,x,b;if(c!==0)for(var v=0;v<c;v++){var $=s[v],C=$.__preactattr_,S=d&&C?$._component?$._component.__key:C.key:null;S!=null?(u++,a[S]=$):(C||($.splitText!==void 0?!i||$.nodeValue.trim():i))&&(o[f++]=$)}if(d!==0)for(var v=0;v<d;v++){x=t[v],b=null;var S=x.key;if(S!=null)u&&a[S]!==void 0&&(b=a[S],a[S]=void 0,u--);else if(!b&&l<f){for(h=l;h<f;h++)if(o[h]!==void 0&&p9t(p=o[h],x,i)){b=p,o[h]=void 0,h===f-1&&f--,h===l&&l++;break}}b=ZAe(b,x,n,r),m=s[v],b&&b!==e&&b!==m&&(m==null?e.appendChild(b):b===m.nextSibling?cY(m):e.insertBefore(b,m))}if(u)for(var v in a)a[v]!==void 0&&Mm(a[v],!1);for(;l<=f;)(b=o[f--])!==void 0&&Mm(b,!1)}function Mm(e,t){var n=e._component;n?NM(n):(e.__preactattr_!=null&&e.__preactattr_.ref&&e.__preactattr_.ref(null),(t===!1||e.__preactattr_==null)&&cY(e),JAe(e))}function JAe(e){for(e=e.lastChild;e;){var t=e.previousSibling;Mm(e,!0),e=t}}function x9t(e,t,n){var r;for(r in n)!(t&&t[r]!=null)&&n[r]!=null&&fue(e,r,n[r],n[r]=void 0,Md);for(r in t)r!=="children"&&r!=="innerHTML"&&(!(r in n)||t[r]!==(r==="value"||r==="checked"?e[r]:n[r]))&&fue(e,r,n[r],n[r]=t[r],Md)}var B7={};function b9t(e){var t=e.constructor.name;(B7[t]||(B7[t]=[])).push(e)}function e_e(e,t,n){var r=B7[e.name],i;if(e.prototype&&e.prototype.render?(i=new e(t,n),dC.call(i,t,n)):(i=new dC(t,n),i.constructor=e,i.render=v9t),r){for(var s=r.length;s--;)if(r[s].constructor===e){i.nextBase=r[s].nextBase,r.splice(s,1);break}}return i}function v9t(e,t,n){return this.constructor(e,n)}function hD(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,n!==0&&(n===1||Bo.syncComponentUpdates!==!1||!e.base?IM(e,1,i):GAe(e)),e.__ref&&e.__ref(e))}function IM(e,t,n,r){if(!e._disable){var i=e.props,s=e.state,o=e.context,a=e.prevProps||i,u=e.prevState||s,l=e.prevContext||o,c=e.base,f=e.nextBase,d=c||f,h=e._component,p=!1,m,x,b;if(c&&(e.props=a,e.state=u,e.context=l,t!==2&&e.shouldComponentUpdate&&e.shouldComponentUpdate(i,s,o)===!1?p=!0:e.componentWillUpdate&&e.componentWillUpdate(i,s,o),e.props=i,e.state=s,e.context=o),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!p){m=e.render(i,s,o),e.getChildContext&&(o=uh(uh({},o),e.getChildContext()));var v=m&&m.nodeName,$,C;if(typeof v=="function"){var S=XAe(m);x=h,x&&x.constructor===v&&S.key==x.__key?hD(x,S,1,o,!1):($=x,e._component=x=e_e(v,S,o),x.nextBase=x.nextBase||f,x._parentComponent=e,hD(x,S,0,o,!1),IM(x,1,n,!0)),C=x.base}else b=d,$=h,$&&(b=e._component=null),(d||t===1)&&(b&&(b._component=null),C=QAe(b,m,o,n||!c,d&&d.parentNode,!0));if(d&&C!==d&&x!==h){var A=d.parentNode;A&&C!==A&&(A.replaceChild(C,d),$||(d._component=null,Mm(d,!1)))}if($&&NM($),e.base=C,C&&!r){for(var E=e,_=e;_=_._parentComponent;)(E=_).base=C;C._component=E,C._componentConstructor=E.constructor}}if(!c||n?YAe.unshift(e):p||(e.componentDidUpdate&&e.componentDidUpdate(a,u,l),Bo.afterUpdate&&Bo.afterUpdate(e)),e._renderCallbacks!=null)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);!P7&&!r&&KAe()}}function w9t(e,t,n,r){for(var i=e&&e._component,s=i,o=e,a=i&&e._componentConstructor===t.nodeName,u=a,l=XAe(t);i&&!u&&(i=i._parentComponent);)u=i.constructor===t.nodeName;return i&&u&&(!r||i._component)?(hD(i,l,3,n,r),e=i.base):(s&&!a&&(NM(s),e=o=null),i=e_e(t.nodeName,l,n),e&&!i.nextBase&&(i.nextBase=e,o=null),hD(i,l,1,n,r),e=i.base,o&&e!==o&&(o._component=null,Mm(o,!1))),e}function NM(e){Bo.beforeUnmount&&Bo.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?NM(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,cY(t),b9t(e),JAe(t)),e.__ref&&e.__ref(null)}function dC(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}uh(dC.prototype,{setState:function(t,n){var r=this.state;this.prevState||(this.prevState=uh({},r)),uh(r,typeof t=="function"?t(r,this.props):t),n&&(this._renderCallbacks=this._renderCallbacks||[]).push(n),GAe(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),IM(this,2)},render:function(){}});function t_e(e,t,n){return QAe(n,e,{},!1,t,!1)}var $9t={h:fC,createElement:fC,cloneElement:qAe,Component:dC,render:t_e,rerender:lY,options:Bo};const C9t=Object.freeze(Object.defineProperty({__proto__:null,Component:dC,cloneElement:qAe,createElement:fC,default:$9t,h:fC,options:Bo,render:t_e,rerender:lY},Symbol.toStringTag,{value:"Module"})),fY=Lm(C9t);var q_={},hue;function S9t(){if(hue)return q_;hue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(q_,"__esModule",{value:!0});const e=fY,t=Kk();class n extends e.Component{componentDidMount(){const{name:i,tab:s}=this.props;this.props.registerSurface(i,s,this)}componentDidUpdate(){return!1}render(){const{name:i,visible:s,styles:o}=this.props,a=Object.assign({},n.defaultStyles,o),{width:u,height:l}=a;let{maxHeight:c,maxWidth:f}=a;c=l===n.defaultStyles.height?c:l,f=u===n.defaultStyles.width?f:u;const d=t.css({display:s?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:l,width:u,maxHeight:c,maxWidth:f,overflow:"auto"}),h=t.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),p=t.css({boxSizing:"border-box"});return e.h("div",{className:`${d} tf-surface`,ref:m=>this.container=m,"data-visible":s},e.h("div",{className:`${h} tf-label`,ref:m=>this.label=m},i),e.h("div",{className:`${p} tf-draw-area`,ref:m=>this.drawArea=m}))}}return n.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},q_.SurfaceComponent=n,q_}var G_={},pue;function k9t(){if(pue)return G_;pue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(G_,"__esModule",{value:!0});const e=fY,t=Kk();class n extends e.Component{render(){const{tabNames:s,activeTab:o,handleClick:a}=this.props,u=s.length>0?s.map(c=>e.h(r,{key:c,id:c,handleClick:a,isActive:c===o},c)):null,l=t.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return e.h("div",{className:`${l} visor-tabs`},u)}}G_.Tabs=n;class r extends e.Component{render(){const{children:s,isActive:o,handleClick:a,id:u}=this.props,l=t.css({borderBottomColor:o?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return e.h("a",{className:`${l} tf-tab`,"data-isactive":o,onClick:()=>a(u)},s)}}return G_}var gue;function E9t(){if(gue)return V_;gue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(V_,"__esModule",{value:!0});const e=fY,t=Kk(),n=S9t(),r=k9t();class i extends e.Component{static render(a,u,l){return e.render(e.h(i,Object.assign({},l)),a,u)}constructor(a){super(a),this.surfaces=new Map;const u=a.startOpen==null?!0:a.startOpen;this.state={isOpen:u,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(a,u){const l=this.surfaceId(a,u);let c;if(this.surfaces.has(l))c=this.surfaces.get(l);else throw Error(`Surface not found with id: ${l}`);return{container:c.container,label:c.label,drawArea:c.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(a,u){return a+u}setTabs(a){const u=a.map(f=>f.tab),l=this.state.tabs;let c;for(const f of u)l.has(f)||(l.add(f),c=f);c!=null&&this.setState({tabs:l,activeTab:c})}getTabs(){return this.state.tabs}registerSurface(a,u,l){const c=this.surfaceId(a,u);this.surfaces.set(c,l)}keyHandler(a){a.keyCode===192&&(a.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(a){this.setState({activeTab:a})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(a){this.setTabs(a.surfaceList)}render(){const{isOpen:a,isFullscreen:u,activeTab:l}=this.state,{surfaceList:c}=this.props,f=Array.from(this.getTabs().values()),p=u?"90vw":"550px",m=t.css({width:p,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),x=t.css({right:"0"}),b=t.css({right:`calc(-${p} - 10px)`}),v=a?x:b,$=t.css({});return e.h("div",{className:`${m} ${v} visor`,"data-isopen":a,"data-isfullscreen":u},e.h(s,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:u}),e.h(r.Tabs,{tabNames:f,activeTab:l,handleClick:this.setActiveTab.bind(this)}),e.h("div",{className:`${$} visor-surfaces`},c.map(C=>e.h(n.SurfaceComponent,{key:C.name+C.tab,name:C.name,tab:C.tab,styles:C.styles,registerSurface:this.registerSurface.bind(this),visible:l===C.tab}))))}}V_.VisorComponent=i;function s(o){const{isFullScreen:a,fullScreenHandler:u,closeHandler:l}=o,c=t.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),f=t.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),d=t.css({marginLeft:"auto"});return e.h("div",{className:`${c} visor-controls`},e.h("button",{className:`${f}`,onClick:u},a?"Minimize":"Maximize"),e.h("button",{className:`${f} ${d}`,onClick:l},"Hide"))}return V_}var mue;function n_e(){if(mue)return A2;mue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(A2,"__esModule",{value:!0});const e=E9t();let t;const n="Visor",r="tfjs-visor-container";function i(){if(typeof document>"u")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(r)&&t!=null)return t;let o=document.getElementById(r);o==null&&(o=document.createElement("div"),o.id=r,document.body.appendChild(o));let a;function u(f,d){let h=null;return a=e.VisorComponent.render(f,a,{ref:p=>h=p,surfaceList:Array.from(d.values())}),h}const l=new Map,c=u(o,l);return t=new s(c,o,l,u),t}A2.visor=i;class s{constructor(a,u,l,c){this.visorComponent=a,this.el=u,this.surfaceList=l,this.renderVisor=c}surface(a){const{name:u}=a,l=a.tab==null?n:a.tab;if(u==null||!(typeof u=="string"||u instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const c=Object.assign({},a,{tab:l}),f=`${u}-${l}`;return this.surfaceList.has(f)||this.surfaceList.set(f,c),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(u,l)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(a){if(!this.visorComponent.state.tabs.has(a))throw new Error(`Tab '${a}' does not exist`);this.visorComponent.setState({activeTab:a})}}return A2.Visor=s,A2}var yue;function il(){if(yue)return og;yue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=og.__awaiter||function(o,a,u,l){return new(u||(u=Promise))(function(c,f){function d(m){try{p(l.next(m))}catch(x){f(x)}}function h(m){try{p(l.throw(m))}catch(x){f(x)}}function p(m){m.done?c(m.value):new u(function(x){x(m.value)}).then(d,h)}p((l=l.apply(o,a||[])).next())})};Object.defineProperty(og,"__esModule",{value:!0});const t=VAe(),n=n_e();function r(o){if(o instanceof HTMLElement)return o;if(t.isSurface(o))return o.drawArea;if(t.isSurfaceInfo(o))return n.visor().surface({name:o.name,tab:o.tab,styles:o.styles}).drawArea;throw new Error("Not a drawable")}og.getDrawArea=r;function i(o,a){const u=Object.getOwnPropertyNames(o),l=Object.getOwnPropertyNames(a);if(u.length!==l.length)return!1;for(let c=0;c<u.length;c++){const f=u[c];if(o[f]!==a[f])return!1}return!0}og.shallowEquals=i;function s(){return e(this,void 0,void 0,function*(){yield new Promise(o=>requestAnimationFrame(o))})}return og.nextFrame=s,og}var xue;function Ap(){if(xue)return v1;xue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(v1,"__esModule",{value:!0});const e=Kk(),t=il(),n={prepend:!1};function r(o,a,u={}){const l=t.getDrawArea(o),c=e.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),f=e.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),d=Object.assign({},n,u);let h=l.querySelector(`div[data-name=${a}]`);if(!h){if(h=document.createElement("div"),h.setAttribute("class",`${c}`),h.dataset.name=a,d.title){const p=document.createElement("div");p.setAttribute("class",`subsurface-title ${f}`),p.innerText=d.title,h.appendChild(p)}d.prepend?l.insertBefore(h,l.firstChild):l.appendChild(h)}return h}v1.subSurface=r;function i(o){let u=0,l=o;for(;l&&l.clientWidth===0;)l=l.parentElement,u=50;return l.clientWidth-u}v1.getDefaultWidth=i;function s(o){return o.clientHeight===0?200:o.clientHeight}return v1.getDefaultHeight=s,v1}var bue;function A9t(){if(bue)return a1;bue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=a1.__awaiter||function(u,l,c,f){return new(c||(c=Promise))(function(d,h){function p(b){try{x(f.next(b))}catch(v){h(v)}}function m(b){try{x(f.throw(b))}catch(v){h(v)}}function x(b){b.done?d(b.value):new c(function(v){v(b.value)}).then(p,m)}x((f=f.apply(u,l||[])).next())})},t=a1.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(a1,"__esModule",{value:!0});const n=t(Jb),r=Ap(),i=il();function s(u,l,c={}){return e(this,void 0,void 0,function*(){const f=i.getDrawArea(u),d=l,h=Object.assign({},o,c);if(a.has(f)){const _=a.get(f);if(i.shallowEquals(h,_.lastOptions)){yield i.nextFrame();const D=_.view,N=D.changeset().remove(()=>!0).insert(d);yield D.change("values",N).runAsync();return}}const{xLabel:p,yLabel:m,xType:x,yType:b}=h;let v=null;p!=null&&(v={title:p});let $=null;m!=null&&($={title:m});const C={actions:!1,mode:"vega-lite",defaultStyle:!1};let S;h.color!=null?Array.isArray(h.color)?S={field:"index",type:"nominal",scale:{range:h.color}}:S={value:h.color}:S={value:"#4C78A0"};const A={width:h.width||r.getDefaultWidth(f),height:h.height||r.getDefaultHeight(f),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:h.fontSize,titleFontSize:h.fontSize},text:{fontSize:h.fontSize},legend:{labelFontSize:h.fontSize,titleFontSize:h.fontSize}},data:{values:d,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:x,axis:v},y:{field:"value",type:b,axis:$},color:S}};yield i.nextFrame();const E=yield n.default(f,A,C);a.set(f,{view:E.view,lastOptions:h})})}a1.barchart=s;const o={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},a=new Map;return a1}var C1={},vue;function _9t(){if(vue)return C1;vue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=C1.__awaiter||function(a,u,l,c){return new(l||(l=Promise))(function(f,d){function h(x){try{m(c.next(x))}catch(b){d(b)}}function p(x){try{m(c.throw(x))}catch(b){d(b)}}function m(x){x.done?f(x.value):new l(function(b){b(x.value)}).then(h,p)}m((c=c.apply(a,u||[])).next())})},t=C1.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(C1,"__esModule",{value:!0});const n=t(Jb),r=Ap(),i=il();function s(a,u,l={}){return e(this,void 0,void 0,function*(){const c=Object.assign({},o,l),f=i.getDrawArea(a),d=[],h=u.values,p=u.tickLabels||[],m=p.length===0;let x=!0;for(let C=0;C<h.length;C++){const S=m?`Class ${C}`:p[C];m&&p.push(S);for(let A=0;A<h[C].length;A++){const E=m?`Class ${A}`:p[A],_=h[C][A];C===A&&!c.shadeDiagonal?d.push({label:S,prediction:E,count:_,noFill:!0}):(d.push({label:S,prediction:E,count:_,scaleCount:_}),_!==0&&(x=!1))}}if(!c.shadeDiagonal&&x)for(const C of d)C.noFill===!0&&(C.noFill=!1,C.scaleCount=C.count);const b={actions:!1,mode:"vega-lite",defaultStyle:!1},v={width:c.width||r.getDefaultWidth(f),height:c.height||r.getDefaultHeight(f),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:c.fontSize,titleFontSize:c.fontSize},text:{fontSize:c.fontSize},legend:{labelFontSize:c.fontSize,titleFontSize:c.fontSize}},data:{values:d},encoding:{x:{field:"prediction",type:"ordinal",title:c.xLabel||"prediction",scale:{domain:p}},y:{field:"label",type:"ordinal",title:c.yLabel||"label",scale:{domain:p}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:c.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};c.shadeDiagonal===!1&&v.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),c.showTextOverlay&&v.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const $=typeof c.colorMap=="string"?{scheme:c.colorMap}:c.colorMap;v.layer[0].encoding.color.scale.range=$,yield n.default(f,v,b)})}C1.confusionMatrix=s;const o={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]};return C1}var ag={},ug={},wue;function DM(){if(wue)return ug;wue=1,Object.defineProperty(ug,"__esModule",{value:!0});/*
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e(r,i){if(!r)throw new Error(typeof i=="string"?i:i())}ug.assert=e;function t(r,i,s=""){e(n(r,i),s+` Shapes ${r} and ${i} must match`)}ug.assertShapesMatch=t;function n(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;s++)if(r[s]!==i[s])return!1;return!0}return ug.arraysEqual=n,ug.DECIMAL_PLACES_TO_CHECK=4,ug}var $ue;function T9t(){if($ue)return ag;$ue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=ag.__awaiter||function(d,h,p,m){return new(p||(p=Promise))(function(x,b){function v(S){try{C(m.next(S))}catch(A){b(A)}}function $(S){try{C(m.throw(S))}catch(A){b(A)}}function C(S){S.done?x(S.value):new p(function(A){A(S.value)}).then(v,$)}C((m=m.apply(d,h||[])).next())})},t=ag.__importStar||function(d){if(d&&d.__esModule)return d;var h={};if(d!=null)for(var p in d)Object.hasOwnProperty.call(d,p)&&(h[p]=d[p]);return h.default=d,h},n=ag.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(ag,"__esModule",{value:!0});const r=t(Gge),i=n(Jb),s=Ap(),o=DM(),a=il();function u(d,h,p={}){return e(this,void 0,void 0,function*(){const m=Object.assign({},f,p),x=a.getDrawArea(d);let b=h.values;m.rowMajor&&(b=yield l(h.values));const{xTickLabels:v,yTickLabels:$}=h;v!=null&&c(b,v,0),$!=null&&c(b,$,1);const C="@tfidx@",S=[];if(b instanceof r.Tensor){o.assert(b.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const T=yield b.data(),[L,O]=b.shape;for(let M=0;M<L;M++){const R=v?`${v[M]}${C}${M}`:M;for(let P=0;P<O;P++){const j=$?`${$[P]}${C}${P}`:P,z=M*O+P,q=T[z];S.push({x:R,y:j,value:q})}}}else{const T=b;for(let L=0;L<T.length;L++){const O=v?`${v[L]}${C}${L}`:L;for(let M=0;M<T[L].length;M++){const R=$?`${$[M]}${C}${M}`:M,P=T[L][M];S.push({x:O,y:R,value:P})}}}const A={actions:!1,mode:"vega-lite",defaultStyle:!1},E={width:m.width||s.getDefaultWidth(x),height:m.height||s.getDefaultHeight(x),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:m.fontSize,titleFontSize:m.fontSize},text:{fontSize:m.fontSize},legend:{labelFontSize:m.fontSize,titleFontSize:m.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:S},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:m.xType,title:m.xLabel,sort:!1},y:{field:"y",type:m.yType,title:m.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},_=`${C}\\d+$`,D=new RegExp(_);v&&(E.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${_}/), '')`}),$&&(E.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${_}/), '')`}),(v||$)&&(A.tooltip={sanitize:T=>String(T).replace(D,"")});let N;switch(m.colorMap){case"blues":N=["#f7fbff","#4292c6"];break;case"greyscale":N=["#000000","#ffffff"];break;case"viridis":default:N="viridis";break}if(N!=="viridis"){const T=E.encoding.fill;T.scale={range:N}}if(m.domain){const T=E.encoding.fill;T.scale!=null?T.scale=Object.assign({},T.scale,{domain:m.domain}):T.scale={domain:m.domain}}yield i.default(x,E,A)})}ag.heatmap=u;function l(d){return e(this,void 0,void 0,function*(){let h,p;d instanceof r.Tensor?(h=d.shape,p=d.transpose()):(h=[d.length,d[0].length],p=r.tidy(()=>r.tensor2d(d).transpose())),o.assert(p.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const m=yield p.array();p.dispose();const x=[m.length,m[0].length];return o.assert(h[0]===x[1]&&h[1]===x[0],`Unexpected transposed shape. Original ${h} : Transposed ${x}`),m})}function c(d,h,p){const m=d instanceof r.Tensor?d.shape:[d.length,d[0].length];p===0?o.assert(m[0]===h.length,`Length of xTickLabels (${h.length}) must match number of rows (${m[0]})`):p===1&&o.assert(m[1]===h.length,`Length of yTickLabels (${h.length}) must match number of columns (${m[1]})`)}const f={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1};return ag}var S1={};const r_e=Lm(Hpt);var qc={},Cue;function FM(){if(Cue)return qc;Cue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=qc.__awaiter||function(u,l,c,f){return new(c||(c=Promise))(function(d,h){function p(b){try{x(f.next(b))}catch(v){h(v)}}function m(b){try{x(f.throw(b))}catch(v){h(v)}}function x(b){b.done?d(b.value):new c(function(v){v(b.value)}).then(p,m)}x((f=f.apply(u,l||[])).next())})};Object.defineProperty(qc,"__esModule",{value:!0});const t=Gge,n=DM();function r(u){if(!Array.isArray(u))throw new Error("input must be an array");if(u.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const l=u.length;let c=-1/0,f=1/0,d=0,h=0,p=0;for(let x=0;x<l;x++){const b=u[x];b>c&&(c=b),b<f&&(f=b),b===0&&(d+=1),isNaN(b)?h+=1:isFinite(b)||(p+=1)}const m={numVals:l,numZeros:d,numNans:h,max:c,min:f,numInfs:p};return m.max===-1/0&&(m.max=NaN),m.min===1/0&&(m.min=NaN),m}qc.arrayStats=r;function i(u){return e(this,void 0,void 0,function*(){const[l,c,f]=t.tidy(()=>{const d=t.scalar(0,u.dtype),h=u.min(),p=u.max(),m=u.equal(d).sum();return[h,p,m]});return Promise.all([u.data(),l.data(),c.data(),f.data()]).then(([d,h,p,m])=>{const x=d.length;let b=0,v=0;for(let A=0;A<x;A++){const E=d[A];isNaN(E)?b+=1:isFinite(E)||(v+=1)}let $=h[0],C=p[0];return b===x&&($=NaN,C=NaN),{numVals:x,numZeros:m[0],numNans:b,min:$,max:C,numInfs:v}})})}qc.tensorStats=i;function s(u,l,c,f){return e(this,void 0,void 0,function*(){n.assert(u.rank===1,"labels must be a 1D tensor"),n.assert(l.rank===1,"predictions must be a 1D tensor"),n.assert(u.size===l.size,"labels and predictions must be the same length"),f!=null&&n.assert(f.size===l.size,"labels and predictions must be the same length");const d=u.cast("int32"),h=l.cast("int32");c==null&&(c=t.tidy(()=>t.maximum(d.max(),h.max()).cast("int32").dataSync()[0]+1));let p=Promise.resolve(null);return f!=null&&(p=f.data()),Promise.all([d.data(),h.data(),p]).then(([m,x,b])=>{const v=Array(c).fill(0);for(let $=0;$<c;$++)v[$]=Array(c).fill(0);for(let $=0;$<m.length;$++){const C=m[$],S=x[$];b!=null?v[C][S]+=b[$]:v[C][S]+=1}return v})})}qc.confusionMatrix=s;function o(u,l){return e(this,void 0,void 0,function*(){n.assertShapesMatch(u.shape,l.shape,"Error computing accuracy.");const c=u.equal(l),f=c.mean(),d=(yield f.data())[0];return t.dispose([c,f]),d})}qc.accuracy=o;function a(u,l,c){return e(this,void 0,void 0,function*(){return n.assert(u.rank===1,"labels must be a 1D tensor"),n.assert(l.rank===1,"predictions must be a 1D tensor"),n.assert(u.size===l.size,"labels and predictions must be the same length"),c==null&&(c=t.tidy(()=>t.maximum(u.max(),l.max()).dataSync()[0]+1)),Promise.all([u.data(),l.data()]).then(([f,d])=>{const h=Array(c).fill(0),p=Array(c).fill(0);for(let x=0;x<f.length;x++){const b=f[x],v=d[x];h[b]+=1,b===v&&(p[b]+=1)}const m=[];for(let x=0;x<h.length;x++)m.push({count:h[x],accuracy:h[x]===0?0:p[x]/h[x]});return m})})}return qc.perClassAccuracy=a,qc}var H_={},z7="http://www.w3.org/1999/xhtml";const U7={svg:"http://www.w3.org/2000/svg",xhtml:z7,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function dY(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),U7.hasOwnProperty(t)?{space:U7[t],local:e}:e}function I9t(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===z7&&t.documentElement.namespaceURI===z7?t.createElement(e):t.createElementNS(n,e)}}function N9t(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function RM(e){var t=dY(e);return(t.local?N9t:I9t)(t)}function D9t(){}function hY(e){return e==null?D9t:function(){return this.querySelector(e)}}function F9t(e){typeof e!="function"&&(e=hY(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=new Array(o),u,l,c=0;c<o;++c)(u=s[c])&&(l=e.call(u,u.__data__,c,s))&&("__data__"in u&&(l.__data__=u.__data__),a[c]=l);return new Js(r,this._parents)}function R9t(){return[]}function i_e(e){return e==null?R9t:function(){return this.querySelectorAll(e)}}function O9t(e){typeof e!="function"&&(e=i_e(e));for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],a=o.length,u,l=0;l<a;++l)(u=o[l])&&(r.push(e.call(u,u.__data__,l,o)),i.push(u));return new Js(r,i)}var s_e=function(e){return function(){return this.matches(e)}};if(typeof document<"u"){var _2=document.documentElement;if(!_2.matches){var M9t=_2.webkitMatchesSelector||_2.msMatchesSelector||_2.mozMatchesSelector||_2.oMatchesSelector;s_e=function(e){return function(){return M9t.call(this,e)}}}}const o_e=s_e;function L9t(e){typeof e!="function"&&(e=o_e(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],u,l=0;l<o;++l)(u=s[l])&&e.call(u,u.__data__,l,s)&&a.push(u);return new Js(r,this._parents)}function a_e(e){return new Array(e.length)}function P9t(){return new Js(this._enter||this._groups.map(a_e),this._parents)}function pD(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}pD.prototype={constructor:pD,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function B9t(e){return function(){return e}}var Sue="$";function z9t(e,t,n,r,i,s){for(var o=0,a,u=t.length,l=s.length;o<l;++o)(a=t[o])?(a.__data__=s[o],r[o]=a):n[o]=new pD(e,s[o]);for(;o<u;++o)(a=t[o])&&(i[o]=a)}function U9t(e,t,n,r,i,s,o){var a,u,l={},c=t.length,f=s.length,d=new Array(c),h;for(a=0;a<c;++a)(u=t[a])&&(d[a]=h=Sue+o.call(u,u.__data__,a,t),h in l?i[a]=u:l[h]=u);for(a=0;a<f;++a)h=Sue+o.call(e,s[a],a,s),(u=l[h])?(r[a]=u,u.__data__=s[a],l[h]=null):n[a]=new pD(e,s[a]);for(a=0;a<c;++a)(u=t[a])&&l[d[a]]===u&&(i[a]=u)}function j9t(e,t){if(!e)return h=new Array(this.size()),l=-1,this.each(function(A){h[++l]=A}),h;var n=t?U9t:z9t,r=this._parents,i=this._groups;typeof e!="function"&&(e=B9t(e));for(var s=i.length,o=new Array(s),a=new Array(s),u=new Array(s),l=0;l<s;++l){var c=r[l],f=i[l],d=f.length,h=e.call(c,c&&c.__data__,l,r),p=h.length,m=a[l]=new Array(p),x=o[l]=new Array(p),b=u[l]=new Array(d);n(c,f,m,x,b,h,t);for(var v=0,$=0,C,S;v<p;++v)if(C=m[v]){for(v>=$&&($=v+1);!(S=x[$])&&++$<p;);C._next=S||null}}return o=new Js(o,r),o._enter=a,o._exit=u,o}function W9t(){return new Js(this._exit||this._groups.map(a_e),this._parents)}function V9t(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var u=t[a],l=n[a],c=u.length,f=o[a]=new Array(c),d,h=0;h<c;++h)(d=u[h]||l[h])&&(f[h]=d);for(;a<r;++a)o[a]=t[a];return new Js(o,this._parents)}function q9t(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&s!==o.nextSibling&&s.parentNode.insertBefore(o,s),s=o);return this}function G9t(e){e||(e=H9t);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,u=i[s]=new Array(a),l,c=0;c<a;++c)(l=o[c])&&(u[c]=l);u.sort(t)}return new Js(i,this._parents).order()}function H9t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function X9t(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Y9t(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}function K9t(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function Q9t(){var e=0;return this.each(function(){++e}),e}function Z9t(){return!this.node()}function J9t(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&e.call(a,a.__data__,s,i);return this}function eUt(e){return function(){this.removeAttribute(e)}}function tUt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function nUt(e,t){return function(){this.setAttribute(e,t)}}function rUt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function iUt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function sUt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function oUt(e,t){var n=dY(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?tUt:eUt:typeof t=="function"?n.local?sUt:iUt:n.local?rUt:nUt)(n,t))}function pY(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function aUt(e){return function(){this.style.removeProperty(e)}}function uUt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function lUt(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function cUt(e,t,n){return arguments.length>1?this.each((t==null?aUt:typeof t=="function"?lUt:uUt)(e,t,n??"")):u_e(this.node(),e)}function u_e(e,t){return e.style.getPropertyValue(t)||pY(e).getComputedStyle(e,null).getPropertyValue(t)}function fUt(e){return function(){delete this[e]}}function dUt(e,t){return function(){this[e]=t}}function hUt(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function pUt(e,t){return arguments.length>1?this.each((t==null?fUt:typeof t=="function"?hUt:dUt)(e,t)):this.node()[e]}function l_e(e){return e.trim().split(/^|\s+/)}function gY(e){return e.classList||new c_e(e)}function c_e(e){this._node=e,this._names=l_e(e.getAttribute("class")||"")}c_e.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function f_e(e,t){for(var n=gY(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function d_e(e,t){for(var n=gY(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function gUt(e){return function(){f_e(this,e)}}function mUt(e){return function(){d_e(this,e)}}function yUt(e,t){return function(){(t.apply(this,arguments)?f_e:d_e)(this,e)}}function xUt(e,t){var n=l_e(e+"");if(arguments.length<2){for(var r=gY(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?yUt:t?gUt:mUt)(n,t))}function bUt(){this.textContent=""}function vUt(e){return function(){this.textContent=e}}function wUt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function $Ut(e){return arguments.length?this.each(e==null?bUt:(typeof e=="function"?wUt:vUt)(e)):this.node().textContent}function CUt(){this.innerHTML=""}function SUt(e){return function(){this.innerHTML=e}}function kUt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function EUt(e){return arguments.length?this.each(e==null?CUt:(typeof e=="function"?kUt:SUt)(e)):this.node().innerHTML}function AUt(){this.nextSibling&&this.parentNode.appendChild(this)}function _Ut(){return this.each(AUt)}function TUt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function IUt(){return this.each(TUt)}function NUt(e){var t=typeof e=="function"?e:RM(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function DUt(){return null}function FUt(e,t){var n=typeof e=="function"?e:RM(e),r=t==null?DUt:typeof t=="function"?t:hY(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function RUt(){var e=this.parentNode;e&&e.removeChild(this)}function OUt(){return this.each(RUt)}function MUt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function LUt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}function PUt(e){return this.select(e?LUt:MUt)}function BUt(e){return arguments.length?this.property("__data__",e):this.node().__data__}var h_e={},mf=null;if(typeof document<"u"){var zUt=document.documentElement;"onmouseenter"in zUt||(h_e={mouseenter:"mouseover",mouseleave:"mouseout"})}function UUt(e,t,n){return e=p_e(e,t,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&e.call(this,r)}}function p_e(e,t,n){return function(r){var i=mf;mf=r;try{e.call(this,this.__data__,t,n)}finally{mf=i}}}function jUt(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function WUt(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.capture):t[++r]=s;++r?t.length=r:delete this.__on}}}function VUt(e,t,n){var r=h_e.hasOwnProperty(e.type)?UUt:p_e;return function(i,s,o){var a=this.__on,u,l=r(t,s,o);if(a){for(var c=0,f=a.length;c<f;++c)if((u=a[c]).type===e.type&&u.name===e.name){this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=l,u.capture=n),u.value=t;return}}this.addEventListener(e.type,l,n),u={type:e.type,name:e.name,value:t,listener:l,capture:n},a?a.push(u):this.__on=[u]}}function qUt(e,t,n){var r=jUt(e+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,l=a.length,c;u<l;++u)for(i=0,c=a[u];i<s;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(a=t?VUt:WUt,n==null&&(n=!1),i=0;i<s;++i)this.each(a(r[i],t,n));return this}function GUt(e,t,n,r){var i=mf;e.sourceEvent=mf,mf=e;try{return t.apply(n,r)}finally{mf=i}}function g_e(e,t,n){var r=pY(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function HUt(e,t){return function(){return g_e(this,e,t)}}function XUt(e,t){return function(){return g_e(this,e,t.apply(this,arguments))}}function YUt(e,t){return this.each((typeof t=="function"?XUt:HUt)(e,t))}var mY=[null];function Js(e,t){this._groups=e,this._parents=t}function m_e(){return new Js([[document.documentElement]],mY)}Js.prototype=m_e.prototype={constructor:Js,select:F9t,selectAll:O9t,filter:L9t,data:j9t,enter:P9t,exit:W9t,merge:V9t,order:q9t,sort:G9t,call:X9t,nodes:Y9t,node:K9t,size:Q9t,empty:Z9t,each:J9t,attr:oUt,style:cUt,property:pUt,classed:xUt,text:$Ut,html:EUt,raise:_Ut,lower:IUt,append:NUt,insert:FUt,remove:OUt,clone:PUt,datum:BUt,on:qUt,dispatch:YUt};function y_e(e){return typeof e=="string"?new Js([[document.querySelector(e)]],[document.documentElement]):new Js([[e]],mY)}function KUt(e){return y_e(RM(e).call(document.documentElement))}var QUt=0;function x_e(){return new j7}function j7(){this._="@"+(++QUt).toString(36)}j7.prototype=x_e.prototype={constructor:j7,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function yY(){for(var e=mf,t;t=e.sourceEvent;)e=t;return e}function OM(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function ZUt(e){var t=yY();return t.changedTouches&&(t=t.changedTouches[0]),OM(e,t)}function JUt(e){return typeof e=="string"?new Js([document.querySelectorAll(e)],[document.documentElement]):new Js([e??[]],mY)}function ejt(e,t,n){arguments.length<3&&(n=t,t=yY().changedTouches);for(var r=0,i=t?t.length:0,s;r<i;++r)if((s=t[r]).identifier===n)return OM(e,s);return null}function tjt(e,t){t==null&&(t=yY().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=OM(e,t[n]);return i}const njt=Object.freeze(Object.defineProperty({__proto__:null,clientPoint:OM,create:KUt,creator:RM,customEvent:GUt,get event(){return mf},local:x_e,matcher:o_e,mouse:ZUt,namespace:dY,namespaces:U7,select:y_e,selectAll:JUt,selection:m_e,selector:hY,selectorAll:i_e,style:u_e,touch:ejt,touches:tjt,window:pY},Symbol.toStringTag,{value:"Module"})),rjt=Lm(njt);var kue;function MM(){if(kue)return H_;kue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(H_,"__esModule",{value:!0});const e=r_e,t=rjt,n=Kk(),r=il();function i(o,a,u={}){if(a&&a.headers==null)throw new Error('Data to render must have a "headers" property');if(a&&a.values==null)throw new Error('Data to render must have a "values" property');const l=r.getDrawArea(o),c=Object.assign({},s,u);let f=t.select(l).select("table.tf-table");const d=n.css({fontSize:c.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(f.size()===0&&(f=t.select(l).append("table"),f.attr("class",` ${d} tf-table`),f.append("thead").append("tr"),f.append("tbody")),f.size()!==1)throw new Error("Error inserting table");const h=n.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),p=f.select("thead").select("tr").selectAll("th").data(a.headers),m=p.enter().append("th").attr("class",`${h}`);p.merge(m).html(A=>A),p.exit().remove();const x=e.format(",.4~f"),b=f.select("tbody").selectAll("tr").data(a.values),v=b.enter().append("tr"),$=n.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),C=b.merge(v).selectAll("td").data(A=>A),S=C.enter().append("td").attr("class",`${$}`);C.merge(S).html(A=>typeof A=="number"?x(A):A),C.exit().remove(),b.exit().remove()}H_.table=i;const s={fontSize:14};return H_}var Eue;function xY(){if(Eue)return S1;Eue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=S1.__awaiter||function(f,d,h,p){return new(h||(h=Promise))(function(m,x){function b(C){try{$(p.next(C))}catch(S){x(S)}}function v(C){try{$(p.throw(C))}catch(S){x(S)}}function $(C){C.done?m(C.value):new h(function(S){S(C.value)}).then(b,v)}$((p=p.apply(f,d||[])).next())})},t=S1.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(S1,"__esModule",{value:!0});const n=r_e,r=t(Jb),i=Ap(),s=FM(),o=MM(),a={maxBins:12,fontSize:11};function u(f,d,h={}){return e(this,void 0,void 0,function*(){const p=c(d),m=Object.assign({},a,h),x={actions:!1,mode:"vega-lite",defaultStyle:!1},b=i.subSurface(f,"histogram");if(h.stats!==!1){const C=i.subSurface(f,"stats",{prepend:!0});let S;h.stats?S=h.stats:S=s.arrayStats(p.map(A=>A.value)),l(S,C,{fontSize:m.fontSize})}if(p.length===0)return;const v=[];for(let C=0;C<p.length;C++){const S=p[C].value;S!=null&&isFinite(S)&&v.push(p[C])}const $={width:m.width||i.getDefaultWidth(b),height:m.height||i.getDefaultHeight(b),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:v},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:m.fontSize,titleFontSize:m.fontSize},text:{fontSize:m.fontSize},legend:{labelFontSize:m.fontSize,titleFontSize:m.fontSize}},encoding:{x:{bin:{maxbins:m.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:m.color||"#001B44"}}};return r.default(b,$,x)})}S1.histogram=u;function l(f,d,h){const p=n.format(",.4~f"),m=n.format(".4~p"),x=[],b=[];if(f.numVals!=null&&(x.push("Num Vals"),b.push(p(f.numVals))),f.min!=null&&(x.push("Min"),b.push(p(f.min))),f.max!=null&&(x.push("Max"),b.push(p(f.max))),f.numZeros!=null){x.push("# Zeros");let v="";f.numVals&&(v=f.numZeros>0?`(${m(f.numZeros/f.numVals)})`:""),b.push(`${p(f.numZeros)} ${v}`)}if(f.numNans!=null){x.push("# NaNs");let v="";f.numVals&&(v=f.numNans>0?`(${m(f.numNans/f.numVals)})`:""),b.push(`${p(f.numNans)} ${v}`)}if(f.numInfs!=null){x.push("# Infinity");let v="";f.numVals&&(v=f.numInfs>0?`(${m(f.numInfs/f.numVals)})`:""),b.push(`${p(f.numInfs)} ${v}`)}o.table(d,{headers:x,values:[b]},h)}function c(f){if(f.length==null)throw new Error("input data must be an array");if(f.length===0)return[];if(typeof f[0]=="object"){if(f[0].value==null)throw new Error("input data must have a value field");return f}else{const d=Array(f.length);for(let h=0;h<f.length;h++)d[h]={value:f[h]};return d}}return S1}var k1={},Aue;function b_e(){if(Aue)return k1;Aue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=k1.__awaiter||function(u,l,c,f){return new(c||(c=Promise))(function(d,h){function p(b){try{x(f.next(b))}catch(v){h(v)}}function m(b){try{x(f.throw(b))}catch(v){h(v)}}function x(b){b.done?d(b.value):new c(function(v){v(b.value)}).then(p,m)}x((f=f.apply(u,l||[])).next())})},t=k1.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(k1,"__esModule",{value:!0});const n=t(Jb),r=Ap(),i=DM(),s=il();function o(u,l,c={}){return e(this,void 0,void 0,function*(){const f=Array.isArray(l.values[0])?l.values:[l.values],d=f[0].length,h=l.series?l.series:f.map((E,_)=>`Series ${_+1}`);i.assert(h.length===f.length,"Must have an equal number of series labels as there are data series"),c.seriesColors!=null&&i.assert(c.seriesColors.length===f.length,"Must have an equal number of series colors as there are data series");const p=[];for(let E=0;E<d;E++){const _={x:E};h.forEach((D,N)=>{const T=f[N][E].y;_[D]=T,_[`${D}-name`]=D}),p.push(_)}const m=Object.assign({},a,c),x=()=>{if(m.zoomToFit)return{zero:!1};if(m.yAxisDomain!=null)return{domain:m.yAxisDomain}},b={x:{field:"x",type:m.xType,title:m.xLabel},tooltip:[{field:"x",type:"quantitative"},...h.map(E=>({field:E,type:"quantitative"}))]},v=h.map(E=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:E,type:m.yType,title:m.yLabel,scale:x()},color:{field:`${E}-name`,type:"nominal",legend:{values:h,title:null},scale:{range:m.seriesColors}}}})),$={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},C=s.getDrawArea(u),S={width:m.width||r.getDefaultWidth(C),height:m.height||r.getDefaultHeight(C),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:m.fontSize,titleFontSize:m.fontSize},text:{fontSize:m.fontSize},legend:{labelFontSize:m.fontSize,titleFontSize:m.fontSize}},data:{values:p},encoding:b,layer:[...v,$]},A={actions:!1,mode:"vega-lite",defaultStyle:!1};return yield n.default(C,S,A),Promise.resolve()})}k1.linechart=o;const a={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};return k1}var E1={},_ue;function ijt(){if(_ue)return E1;_ue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=E1.__awaiter||function(u,l,c,f){return new(c||(c=Promise))(function(d,h){function p(b){try{x(f.next(b))}catch(v){h(v)}}function m(b){try{x(f.throw(b))}catch(v){h(v)}}function x(b){b.done?d(b.value):new c(function(v){v(b.value)}).then(p,m)}x((f=f.apply(u,l||[])).next())})},t=E1.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(E1,"__esModule",{value:!0});const n=t(Jb),r=Ap(),i=DM(),s=il();function o(u,l,c={}){return e(this,void 0,void 0,function*(){let f=l.values;const d=l.series==null?[]:l.series;f=Array.isArray(f[0])?f:[f];const h=[];f.forEach((C,S)=>{const A=d[S]!=null?d[S]:`Series ${S+1}`,E=C.map(_=>Object.assign({},_,{series:A}));h.push(...E)}),c.seriesColors!=null&&i.assert(c.seriesColors.length===f.length,"Must have an equal number of series colors as there are data series");const p=s.getDrawArea(u),m=Object.assign({},a,c),x={actions:!1,mode:"vega-lite",defaultStyle:!1},b=()=>{if(m.zoomToFit)return{zero:!1};if(m.xAxisDomain!=null)return{domain:m.xAxisDomain}},v=()=>{if(m.zoomToFit)return{zero:!1};if(m.yAxisDomain!=null)return{domain:m.yAxisDomain}},$={width:m.width||r.getDefaultWidth(p),height:m.height||r.getDefaultHeight(p),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:m.fontSize,titleFontSize:m.fontSize},text:{fontSize:m.fontSize},legend:{labelFontSize:m.fontSize,titleFontSize:m.fontSize}},data:{values:h},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:m.xType,title:m.xLabel,scale:b()},y:{field:"y",type:m.yType,title:m.yLabel,scale:v()},color:{field:"series",type:"nominal",scale:{range:m.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield n.default(p,$,x),Promise.resolve()})}E1.scatterplot=o;const a={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};return E1}var A1={},Tue;function sjt(){if(Tue)return A1;Tue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=A1.__awaiter||function(l,c,f,d){return new(f||(f=Promise))(function(h,p){function m(v){try{b(d.next(v))}catch($){p($)}}function x(v){try{b(d.throw(v))}catch($){p($)}}function b(v){v.done?h(v.value):new f(function($){$(v.value)}).then(m,x)}b((d=d.apply(l,c||[])).next())})};Object.defineProperty(A1,"__esModule",{value:!0});const t=b_e(),n=il(),r=Ap();function i(l,c,f,d={}){return e(this,void 0,void 0,function*(){const h=n.getDrawArea(l),p={};for(const v of f)if(/val_/.test(v)){const $=v.replace("val_","");s(p,$);const C=o(c,v,f.indexOf(v));p[$].series.push(v),p[$].values.push(C)}else{const $=o(c,v,f.indexOf(v));s(p,v),p[v].series.push(v),p[v].values.push($)}const m=Object.keys(p),x=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},d),b=[];for(const v of m){const $=r.subSurface(h,v),C=p[v].series,S=p[v].values;C.every(E=>!!E.match("acc"))&&(x.zoomToFitAccuracy?x.zoomToFit=!0:(x.yAxisDomain=[0,1],delete x.zoomToFit));const A=t.linechart($,{values:S,series:C},x);b.push(A)}yield Promise.all(b)})}A1.history=i;function s(l,c){l[c]==null&&(l[c]={series:[],values:[]})}function o(l,c,f){if(Array.isArray(l)){const d=Array.isArray(l[0])?l[f]:l,h=[];for(let p=0;p<d.length;p++){const m=d[p];h.push({x:p,y:m[c]})}return h}else return l.history[c].map((d,h)=>({x:h,y:d}))}function a(l,c,f={}){const d={},h=f.callbacks||["onEpochEnd","onBatchEnd"],p=n.getDrawArea(l),m=Object.assign({},f);delete m.callbacks;function x(v){return($,C)=>e(this,void 0,void 0,function*(){/batch/i.test(v)?m.xLabel="Batch":/epoch/i.test(v)&&(m.xLabel="Epoch");const S=[],A=[];for(const _ of c)if(C[_]!=null){A.push(_);const D=u(d,v,_);D.push({[_]:C[_]}),S.push(D)}const E=r.subSurface(p,v,{title:v});i(E,S,A,m),yield n.nextFrame()})}const b={};return h.forEach(v=>{b[v]=x(v)}),b}A1.fitCallbacks=a;function u(l,c,f){return l[c]==null&&(l[c]={}),l[c][f]==null&&(l[c][f]=[]),l[c][f]}return A1}var _1={},Iue;function ojt(){if(Iue)return _1;Iue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=_1.__awaiter||function(h,p,m,x){return new(m||(m=Promise))(function(b,v){function $(A){try{S(x.next(A))}catch(E){v(E)}}function C(A){try{S(x.throw(A))}catch(E){v(E)}}function S(A){A.done?b(A.value):new m(function(E){E(A.value)}).then($,C)}S((x=x.apply(h,p||[])).next())})};Object.defineProperty(_1,"__esModule",{value:!0});const t=xY(),n=il(),r=MM(),i=Ap(),s=FM();function o(h,p){return e(this,void 0,void 0,function*(){const m=n.getDrawArea(h),x=u(p),b=["Layer Name","Output Shape","# Of Params","Trainable"],v=x.layers.map($=>[$.name,$.outputShape,$.parameters,$.trainable]);r.table(m,{headers:b,values:v})})}_1.modelSummary=o;function a(h,p){return e(this,void 0,void 0,function*(){const m=n.getDrawArea(h),x=yield c(p),b=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],v=i.subSurface(m,"layer-weights-info"),$=x.map(E=>[E.name,E.shape,E.stats.min,E.stats.max,E.weight.size,E.stats.numZeros,E.stats.numNans,E.stats.numInfs]);r.table(v,{headers:b,values:$});const C=i.subSurface(m,"select-layer"),S=i.subSurface(m,"param-distribution"),A=E=>e(this,void 0,void 0,function*(){const D=yield x.filter(N=>N.name===E)[0].weight.data();t.histogram(S,D,{height:150,width:460,stats:!1})});d(x.map(E=>E.name),C,A)})}_1.layer=a;function u(h){return{layers:h.layers.map(l)}}function l(h){let p;return Array.isArray(h.outputShape[0])?p=`[${h.outputShape.map(x=>f(x)).join(", ")}]`:p=f(h.outputShape),{name:h.name,trainable:h.trainable,parameters:h.countParams(),outputShape:p}}function c(h){return e(this,void 0,void 0,function*(){const p=h.getWeights(),m=h.weights,x=p.map(s.tensorStats),b=yield Promise.all(x),v=p.map($=>$.shape);return p.map(($,C)=>({name:m[C].name,stats:b[C],shape:f(v[C]),weight:$}))})}function f(h){const p=h.slice();return p.length===0?"Scalar":(p[0]===null&&(p[0]="batch"),`[${p.join(",")}]`)}function d(h,p,m){const v=`<div><button>Show Values Distribution for:</button>${`
    <select>
      ${h.map(S=>`<option value=${S}>${S}</option>`)}
    </select>
  `}</div>`;p.innerHTML=v;const $=p.querySelector("button"),C=p.querySelector("select");$.addEventListener("click",()=>{m(C.selectedOptions[0].label)})}return _1}var T2={},Nue;function ajt(){if(Nue)return T2;Nue=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=T2.__awaiter||function(i,s,o,a){return new(o||(o=Promise))(function(u,l){function c(h){try{d(a.next(h))}catch(p){l(p)}}function f(h){try{d(a.throw(h))}catch(p){l(p)}}function d(h){h.done?u(h.value):new o(function(p){p(h.value)}).then(c,f)}d((a=a.apply(i,s||[])).next())})};Object.defineProperty(T2,"__esModule",{value:!0});const t=il(),n=MM();function r(i,s,o){return e(this,void 0,void 0,function*(){const a=t.getDrawArea(i),u=["Class","Accuracy","# Samples"],l=[];for(let c=0;c<s.length;c++){const f=o?o[c]:c.toString(),d=s[c];l.push([f,d.accuracy,d.count])}return n.table(a,{headers:u,values:l})})}return T2.perClassAccuracy=r,T2}var I2={},Due;function ujt(){if(Due)return I2;Due=1;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=I2.__awaiter||function(s,o,a,u){return new(a||(a=Promise))(function(l,c){function f(p){try{h(u.next(p))}catch(m){c(m)}}function d(p){try{h(u.throw(p))}catch(m){c(m)}}function h(p){p.done?l(p.value):new a(function(m){m(p.value)}).then(f,d)}h((u=u.apply(s,o||[])).next())})};Object.defineProperty(I2,"__esModule",{value:!0});const t=xY(),n=il(),r=FM();function i(s,o){return e(this,void 0,void 0,function*(){const a=n.getDrawArea(s),u=yield r.tensorStats(o),l=yield o.data();t.histogram(a,l,{height:150,stats:u})})}return I2.valuesDistribution=i,I2}var X_={},Fue;function ljt(){if(Fue)return X_;Fue=1;/** @license See the LICENSE file. */Object.defineProperty(X_,"__esModule",{value:!0});const e="1.5.1";return X_.version=e,X_}var Rue;function cjt(){return Rue||(Rue=1,function(e){function t($){for(var C in $)e.hasOwnProperty(C)||(e[C]=$[C])}Object.defineProperty(e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n=A9t(),r=_9t(),i=T9t(),s=xY(),o=b_e(),a=ijt(),u=MM(),l=sjt(),c=ojt(),f=ajt(),d=ujt(),h=FM(),p=ljt();e.version_vis=p.version;const m={barchart:n.barchart,table:u.table,histogram:s.histogram,linechart:o.linechart,scatterplot:a.scatterplot,confusionMatrix:r.confusionMatrix,heatmap:i.heatmap};e.render=m;const x={accuracy:h.accuracy,perClassAccuracy:h.perClassAccuracy,confusionMatrix:h.confusionMatrix};e.metrics=x;const b={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:f.perClassAccuracy,valuesDistribution:d.valuesDistribution,layer:c.layer,modelSummary:c.modelSummary};e.show=b;var v=n_e();e.visor=v.visor,t(VAe())}(YL)),YL}var fjt=cjt();const Vjt=(e,t,n)=>e.map(r=>({x:r[t],y:r[n]})),djt=(e,t=e.min(),n=e.max())=>({tensor:e.sub(t).div(n.sub(t)),min:t,max:n}),hjt=(e,t,n)=>e.mul(n.sub(t)).add(t),qjt=(e,t,n)=>{let r=0;const i=t.map((s,o)=>{if(t.length-1===o)return n-r;{const a=Math.floor(s*n);return r+=a,a}});return Ws(e,i)},Gjt=()=>{const e=p6e();e.add(D6e({units:1,useBias:!0,activation:"linear",inputDim:1}));const t=Hc.sgd(.1);return e.compile({loss:z9.meanSquaredError,optimizer:t}),e},Hjt=(e,t,n)=>{const{onEpochEnd:r}=fjt.show.fitCallbacks({name:"Training Performance"},["loss"]);return e.fit(t,n,{epochs:20,shuffle:!0,callbacks:{onEpochEnd:(i,s)=>(s=s||{},r(i,s))}})},pjt=(e,t,n)=>e.evaluate(t,n),gjt=async e=>{const t=`localstorage://${e}`;if(!(await Cle())[t])return["No saved models!",null];const i=await f6e(t),s=Hc.sgd(.1);return i.compile({loss:z9.meanSquaredError,optimizer:s}),i instanceof f3?[null,i]:["No saved models!",null]},mjt=(e,t,n,r)=>{let i=null;return fe(()=>{const s=Li([e]),o=djt(s,n.min,n.max),a=t.predict(o.tensor);Array.isArray(a)||(i=hjt(a,r.min,r.max).dataSync()[0])}),i},Oue=e=>{let t;const n=new Set,r=(l,c)=>{const f=typeof l=="function"?l(t):l;if(!Object.is(f,t)){const d=t;t=c??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(h=>h(t,d))}},i=()=>t,a={setState:r,getState:i,getInitialState:()=>u,subscribe:l=>(n.add(l),()=>n.delete(l))},u=t=e(r,i,a);return a},yjt=e=>e?Oue(e):Oue,xjt=e=>e;function bjt(e,t=xjt){const n=GQ.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return GQ.useDebugValue(n),n}const vjt=e=>{const t=yjt(e),n=r=>bjt(t,r);return Object.assign(n,t),n},wjt=e=>vjt(e),qr=wjt(e=>({model:null,xLabel:"sqft_living",yLabel:"price",isDataLoaded:!1,isTrained:!1,terminalTexts:[],trainingLoss:null,testingLoss:null,savedInfo:null,storageID:"linear-regression",loader:{isLoading:!1,status:""},normalisedFeatureMinMax:null,normalisedLabelMinMax:null,trainingLabelTensor:null,trainingFeatureTensor:null,testingLabelTensor:null,testingFeatureTensor:null,plotingPoints:[],setModel:t=>e({model:t}),setTerminalText:t=>{const n={text:t,id:crypto.randomUUID()};e(r=>({terminalTexts:[...r.terminalTexts,n]}))},setIsDataLoaded:t=>e({isDataLoaded:t}),setIsTrained:t=>e({isTrained:t}),setTrainingLoss:t=>e({trainingLoss:t}),setTestingLoss:t=>e({testingLoss:t}),setSavedInfo:t=>e({savedInfo:t}),setLoader:t=>e({loader:t}),setNormalisedFeatureMinMax:t=>e({normalisedFeatureMinMax:t}),setNormalisedLabelMinMax:t=>e({normalisedLabelMinMax:t}),setTrainingLabelTensor:t=>e({trainingLabelTensor:t}),setTrainingFeatureTensor:t=>e({trainingFeatureTensor:t}),setTestingLabelTensor:t=>e({testingLabelTensor:t}),setTestingFeatureTensor:t=>e({testingFeatureTensor:t}),setPlottingPoints:t=>e({plotingPoints:t})}));function $jt(){const[e,t]=Ou.useState(null),n=qr(o=>o.model),r=qr(o=>o.normalisedFeatureMinMax),i=qr(o=>o.normalisedLabelMinMax),s=o=>{if(!n||!r||!i)return;o.preventDefault();const a=o.target,u=new FormData(a),l=parseInt(u.get("inputField")),c=mjt(l,n,r,i);if(c){const f=`${parseInt((c/1e3).toFixed(0)).toLocaleString("en-us")}K`;t(f)}};return lt.jsxs("div",{className:"border-l-2 pl-3",children:[lt.jsx("div",{className:"mb-3 text-3xl flex justify-center",children:lt.jsx("span",{children:"Predict House Price"})}),lt.jsxs("form",{onSubmit:s,children:[lt.jsx("label",{className:"block text-sm",htmlFor:"input",children:"Sq.ft of Living space"}),lt.jsx("input",{min:200,max:1e6,name:"inputField",type:"number",inputMode:"numeric",pattern:"[0-9]*",className:"appearance-none mt-1 bg-white block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",id:"input",placeholder:"2000"}),lt.jsx("button",{className:"my-2",children:"Predict House Price"})]}),e&&lt.jsxs("div",{children:[lt.jsx("span",{children:"Predicted house price:"}),lt.jsx("span",{className:"block text-3xl font-semibold",children:`$${e}`})]})]})}function Cjt(){const[e,t]=Ou.useState(!1),n=qr(u=>u.model),r=qr(u=>u.setTestingLoss),i=qr(u=>u.setTerminalText),s=qr(u=>u.testingFeatureTensor),o=qr(u=>u.testingLabelTensor),a=()=>{if(!n||!s||!o)return;t(!0);const u=pjt(n,s,o);if(!Array.isArray(u)){const l=u.dataSync()[0];r(l),i(`Testing Loss: ${l}`)}};return lt.jsx("div",{children:lt.jsx("div",{children:lt.jsx("button",{onClick:a,disabled:e,children:"Test Model"})})})}function Sjt(){const e=qr(t=>t.terminalTexts);return lt.jsx("div",{className:"flex flex-col bg-black h-28 text-green-700 my-3 p-2 font-mono",children:e.map(t=>lt.jsx("div",{className:"w-full",children:`> ${t.text}`},t.id))})}function kjt(){const[e,t]=Ou.useState(!1),n=qr(o=>o.model),r=qr(o=>o.storageID),i=qr(o=>o.setSavedInfo),s=async()=>{if(!n)return;t(!0);const a=(await n.save(`localstorage://${r}`)).modelArtifactsInfo.dateSaved.toDateString();i(`Model saved: ${a}`)};return lt.jsx("div",{children:lt.jsx("button",{disabled:e,onClick:s,children:"Save Model"})})}function Ejt(){const[e,t]=Ou.useState(!1),n=qr(a=>a.setModel),r=qr(a=>a.setIsTrained),i=qr(a=>a.setTerminalText),s=qr(a=>a.storageID),o=async()=>{t(!0);const[a,u]=await gjt(s);a&&alert(a),u&&typeof u!="string"&&(n(u),r(!0),i("Model loaded from browser storage"))};return lt.jsx("div",{children:lt.jsx("button",{disabled:e,onClick:o,children:"Load saved model"})})}function Ajt(){const e=qr(t=>t.loader);return e.isLoading?lt.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:lt.jsxs("div",{className:"flex flex-col items-center",children:[lt.jsx("div",{className:"w-16 h-16 border-4 border-t-blue-500 border-gray-200 rounded-full animate-spin"}),lt.jsx("p",{className:"mt-4 text-white text-lg font-semibold",children:e.status})]})}):null}const _jt=Ou.lazy(()=>V7(()=>import("./VisorControls-YNrMCojY.js"),[])),Tjt=Ou.lazy(()=>V7(()=>import("./index-CrECcAmi.js"),[])),Ijt=Ou.lazy(()=>V7(()=>import("./LoadData-B5rRlQMY.js"),[])),Njt=()=>{const e=qr(n=>n.isTrained),t=qr(n=>n.isDataLoaded);return lt.jsxs(lt.Fragment,{children:[lt.jsx(Ajt,{}),lt.jsx(cIe,{}),lt.jsxs(lt.Fragment,{children:[lt.jsx("div",{className:"my-3 flex gap-2",children:lt.jsxs(Ou.Suspense,{fallback:lt.jsx("div",{children:"Loading"}),children:[lt.jsx(Ijt,{}),t&&lt.jsx(_jt,{})]})}),lt.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[lt.jsxs("div",{className:"my-3",children:[t&&lt.jsxs("div",{className:"flex gap-3 justify-between",children:[lt.jsx(Ou.Suspense,{fallback:lt.jsx("div",{children:"Loading"}),children:lt.jsx(Tjt,{})}),lt.jsx("span",{children:"Or"}),lt.jsx(Ejt,{})]}),e&&lt.jsxs(lt.Fragment,{children:[lt.jsx(Sjt,{}),lt.jsxs("div",{className:"flex gap-3 justify-between",children:[lt.jsx(Cjt,{}),lt.jsx(kjt,{})]})]})]}),e&&lt.jsx($jt,{})]})]})]})};function Djt(){return lt.jsx(lt.Fragment,{children:lt.jsx("div",{className:"container max-w-[900px]",children:lt.jsx(Njt,{})})})}aIe.createRoot(document.getElementById("root")).render(lt.jsx(Ou.StrictMode,{children:lt.jsx(Djt,{})}));export{Vhe as D,fa as L,Z6e as O,U as a,fe as b,gNe as c,fjt as d,ce as e,zIe as f,Vjt as g,lw as h,qjt as i,lt as j,Gjt as k,djt as n,Ou as r,G7 as s,Hjt as t,qr as u};
